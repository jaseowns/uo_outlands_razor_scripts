# This is an automated backup - check out https://outlands.uorazorscripts.com/script/e634828d-b1be-475e-b858-cf8898f56557 for latest
# Automation by Jaseowns
## Script: One key to recall to next rune in book (R)
## Created by: Jaseowns#6694
#############################################

# One key to recall to next rune in book by Jaseowns
# UO Outlands

if not varexist recallNextRunePosition
    @setvar! recallNextRunePosition 0
endif

if recallNextRunePosition = 0
    @setvar! recallNextRunePosition 1
elseif recallNextRunePosition = 1
    @setvar! recallNextRunePosition 2
elseif recallNextRunePosition = 2
    @setvar! recallNextRunePosition 3
elseif recallNextRunePosition = 3
    @setvar! recallNextRunePosition 4
elseif recallNextRunePosition = 4
    @setvar! recallNextRunePosition 5
elseif recallNextRunePosition = 5
    @setvar! recallNextRunePosition 6
elseif recallNextRunePosition = 6
    @setvar! recallNextRunePosition 7
elseif recallNextRunePosition = 7
    @setvar! recallNextRunePosition 8
elseif recallNextRunePosition = 8
    @setvar! recallNextRunePosition 9
elseif recallNextRunePosition = 9
    @setvar! recallNextRunePosition 10
elseif recallNextRunePosition = 10
    @setvar! recallNextRunePosition 11
elseif recallNextRunePosition = 11
    @setvar! recallNextRunePosition 12
elseif recallNextRunePosition = 12
    @setvar! recallNextRunePosition 13
elseif recallNextRunePosition = 13
    @setvar! recallNextRunePosition 14
elseif recallNextRunePosition = 14
    @setvar! recallNextRunePosition 15
elseif recallNextRunePosition = 15
    @setvar! recallNextRunePosition 16
elseif recallNextRunePosition = 16
    @setvar! recallNextRunePosition 17
elseif recallNextRunePosition = 17
    @setvar! recallNextRunePosition 18
elseif recallNextRunePosition = 18
    @setvar! recallNextRunePosition 19
elseif recallNextRunePosition = 19
    @setvar! recallNextRunePosition 20
elseif recallNextRunePosition = 20
    @setvar! recallNextRunePosition 21
elseif recallNextRunePosition = 21
    @setvar! recallNextRunePosition 22
elseif recallNextRunePosition = 22
    @setvar! recallNextRunePosition 23
elseif recallNextRunePosition = 23
    @setvar! recallNextRunePosition 24
elseif recallNextRunePosition = 24
    @setvar! recallNextRunePosition 25
elseif recallNextRunePosition = 25
    @setvar! recallNextRunePosition 26
elseif recallNextRunePosition = 26
    @setvar! recallNextRunePosition 1
endif


if not findtype "runebook" backpack and not findtype "runetome" backpack
    overhead "We do not have a runebook or runetome" 34
    stop
endif

if not varexist farmingBook
    if counttype "runebook" backpack = 1 and counttype "runetome" backpack = 0 and findtype "runebook" backpack as myBook
        overhead "Automatically selected your one runebook" 88
        @setvar farmingBook myBook
    elseif counttype "runebook" backpack = 0 and counttype "runetome" backpack = 1 and findtype "runetome" backpack as myBook
        overhead "Automatically selected your one runetome" 88
        @setvar farmingBook myBook
    else
        overhead "Select your farming book (runebook or runetome)" 88
        @setvar farmingBook 
    endif
endif

if farmingBook = 0 or not find farmingBook backpack
    unsetvar farmingBook
    replay
endif

if mana < 12
    overhead "Need more mana... trying again" 34
    wait 500
    replay
endif



@setvar! escapePlanUseMagery 0
if skill "Magery" >= 60
    if counttype "Black Pearl%s%" self >= 1 and counttype "Blood Moss" self >= 1 and counttype "Mandrake Root%s%" self >= 1
        @setvar! escapePlanUseMagery 1
    else
        if findtype "reagent satchel" self as satchel
            if counttype "Black Pearl%s%" satchel >= 1 and counttype "Blood Moss" satchel >= 1 and counttype "Mandrake Root%s%" satchel >= 1
                @setvar! escapePlanUseMagery 1
            endif
        endif
        if escapePlanUseMagery = 0
            overhead "No regs, using scroll instead" 34
        endif
    endif
endif


getlabel farmingBook desc
@setvar! escapePlanGumpId 1551740969
@setvar! secondaryGumpResponse 0
if "rune tome" in desc
    
    if escapePlanUseMagery = 1 
        if recallNextRunePosition = 1
            @setvar! recallHomeGumpResponse 200
        elseif recallNextRunePosition = 2
            @setvar! recallHomeGumpResponse 201
        elseif recallNextRunePosition = 3
            @setvar! recallHomeGumpResponse 202
        elseif recallNextRunePosition = 4
            @setvar! recallHomeGumpResponse 203
        elseif recallNextRunePosition = 5
            @setvar! recallHomeGumpResponse 204
        elseif recallNextRunePosition = 6
            @setvar! recallHomeGumpResponse 205
        elseif recallNextRunePosition = 7
            @setvar! recallHomeGumpResponse 206
        elseif recallNextRunePosition = 8
            @setvar! recallHomeGumpResponse 207
        elseif recallNextRunePosition = 9
            @setvar! recallHomeGumpResponse 208
        elseif recallNextRunePosition = 10
            @setvar! recallHomeGumpResponse 209
        elseif recallNextRunePosition = 11
            @setvar! recallHomeGumpResponse 210
        elseif recallNextRunePosition = 12
            @setvar! recallHomeGumpResponse 211
        elseif recallNextRunePosition = 13
            @setvar! recallHomeGumpResponse 212
        elseif recallNextRunePosition = 14
            @setvar! recallHomeGumpResponse 213
        elseif recallNextRunePosition = 15
            @setvar! recallHomeGumpResponse 214
        elseif recallNextRunePosition = 16
            @setvar! recallHomeGumpResponse 215
        elseif recallNextRunePosition = 16
            @setvar! recallHomeGumpResponse 215
        elseif recallNextRunePosition = 17
            @setvar! recallHomeGumpResponse 216
        elseif recallNextRunePosition = 18
            @setvar! recallHomeGumpResponse 217
        elseif recallNextRunePosition = 19
            @setvar! recallHomeGumpResponse 218
        elseif recallNextRunePosition = 20
            @setvar! recallHomeGumpResponse 219
        elseif recallNextRunePosition = 21
            @setvar! recallHomeGumpResponse 220
        elseif recallNextRunePosition = 22
            @setvar! recallHomeGumpResponse 221
        elseif recallNextRunePosition = 23
            @setvar! recallHomeGumpResponse 222
        elseif recallNextRunePosition = 24
            @setvar! recallHomeGumpResponse 223
        elseif recallNextRunePosition = 25
            @setvar! recallHomeGumpResponse 224
        elseif recallNextRunePosition = 26
            @setvar! recallHomeGumpResponse 225
        else
            // default to start
            @setvar! recallNextRunePosition 1
            @setvar! recallHomeGumpResponse 200
        endif

        if recallHomeGumpResponse = 201 or recallHomeGumpResponse = 203 or recallHomeGumpResponse = 205 or recallHomeGumpResponse = 207 or recallHomeGumpResponse = 209 or recallHomeGumpResponse = 211 or recallHomeGumpResponse = 213 or recallHomeGumpResponse = 215 or recallHomeGumpResponse = 217 or recallHomeGumpResponse = 219 or recallHomeGumpResponse = 221 or recallHomeGumpResponse = 223 or recallHomeGumpResponse = 223 or recallHomeGumpResponse = 225
            @setvar! secondaryGumpResponse 20
        else 
            @setvar! secondaryGumpResponse 10
        endif
    else
        if recallNextRunePosition = 1
            @setvar! recallHomeGumpResponse 100
        elseif recallNextRunePosition = 2
            @setvar! recallHomeGumpResponse 101
        elseif recallNextRunePosition = 3
            @setvar! recallHomeGumpResponse 102
        elseif recallNextRunePosition = 4
            @setvar! recallHomeGumpResponse 103
        elseif recallNextRunePosition = 5
            @setvar! recallHomeGumpResponse 104
        elseif recallNextRunePosition = 6
            @setvar! recallHomeGumpResponse 105
        elseif recallNextRunePosition = 7
            @setvar! recallHomeGumpResponse 106
        elseif recallNextRunePosition = 8
            @setvar! recallHomeGumpResponse 107
        elseif recallNextRunePosition = 9
            @setvar! recallHomeGumpResponse 108
        elseif recallNextRunePosition = 10
            @setvar! recallHomeGumpResponse 109
        elseif recallNextRunePosition = 11
            @setvar! recallHomeGumpResponse 110
        elseif recallNextRunePosition = 12
            @setvar! recallHomeGumpResponse 111
        elseif recallNextRunePosition = 13
            @setvar! recallHomeGumpResponse 112
        elseif recallNextRunePosition = 14
            @setvar! recallHomeGumpResponse 113
        elseif recallNextRunePosition = 15
            @setvar! recallHomeGumpResponse 114
        elseif recallNextRunePosition = 16
            @setvar! recallHomeGumpResponse 115
        elseif recallNextRunePosition = 16
            @setvar! recallHomeGumpResponse 115
        elseif recallNextRunePosition = 17
            @setvar! recallHomeGumpResponse 116
        elseif recallNextRunePosition = 18
            @setvar! recallHomeGumpResponse 117
        elseif recallNextRunePosition = 19
            @setvar! recallHomeGumpResponse 118
        elseif recallNextRunePosition = 20
            @setvar! recallHomeGumpResponse 119
        elseif recallNextRunePosition = 21
            @setvar! recallHomeGumpResponse 120
        elseif recallNextRunePosition = 22
            @setvar! recallHomeGumpResponse 121
        elseif recallNextRunePosition = 23
            @setvar! recallHomeGumpResponse 122
        elseif recallNextRunePosition = 24
            @setvar! recallHomeGumpResponse 123
        elseif recallNextRunePosition = 25
            @setvar! recallHomeGumpResponse 124
        elseif recallNextRunePosition = 26
            @setvar! recallHomeGumpResponse 125
        else
            // default to start
            @setvar! recallNextRunePosition 1
            @setvar! recallHomeGumpResponse 100
        endif
    endif


    @setvar! escapePlanGumpId 167090027
elseif "runebook" in desc

    if escapePlanUseMagery = 1 
        if recallNextRunePosition = 1
            @setvar! recallHomeGumpResponse 5
        elseif recallNextRunePosition = 2
            @setvar! recallHomeGumpResponse 11
        elseif recallNextRunePosition = 3
            @setvar! recallHomeGumpResponse 17
        elseif recallNextRunePosition = 4
            @setvar! recallHomeGumpResponse 23
        elseif recallNextRunePosition = 5
            @setvar! recallHomeGumpResponse 29
        elseif recallNextRunePosition = 6
            @setvar! recallHomeGumpResponse 35
        elseif recallNextRunePosition = 7
            @setvar! recallHomeGumpResponse 41
        elseif recallNextRunePosition = 8
            @setvar! recallHomeGumpResponse 47
        elseif recallNextRunePosition = 9
            @setvar! recallHomeGumpResponse 53
        elseif recallNextRunePosition = 10
            @setvar! recallHomeGumpResponse 59
        elseif recallNextRunePosition = 11
            @setvar! recallHomeGumpResponse 65
        elseif recallNextRunePosition = 12
            @setvar! recallHomeGumpResponse 71
        elseif recallNextRunePosition = 13
            @setvar! recallHomeGumpResponse 77
        elseif recallNextRunePosition = 14
            @setvar! recallHomeGumpResponse 83
        elseif recallNextRunePosition = 15
            @setvar! recallHomeGumpResponse 89
        elseif recallNextRunePosition = 16
            @setvar! recallHomeGumpResponse 95  
        else
            // default to start
            @setvar! recallNextRunePosition 1
            @setvar! recallHomeGumpResponse 5
        endif

    else
        if recallNextRunePosition = 1
            @setvar! recallHomeGumpResponse 2
        elseif recallNextRunePosition = 2
            @setvar! recallHomeGumpResponse 8
        elseif recallNextRunePosition = 3
            @setvar! recallHomeGumpResponse 14
        elseif recallNextRunePosition = 4
            @setvar! recallHomeGumpResponse 20
        elseif recallNextRunePosition = 5
            @setvar! recallHomeGumpResponse 26
        elseif recallNextRunePosition = 6
            @setvar! recallHomeGumpResponse 32
        elseif recallNextRunePosition = 7
            @setvar! recallHomeGumpResponse 38
        elseif recallNextRunePosition = 8
            @setvar! recallHomeGumpResponse 44
        elseif recallNextRunePosition = 9
            @setvar! recallHomeGumpResponse 50
        elseif recallNextRunePosition = 10
            @setvar! recallHomeGumpResponse 56
        elseif recallNextRunePosition = 11
            @setvar! recallHomeGumpResponse 62
        elseif recallNextRunePosition = 12
            @setvar! recallHomeGumpResponse 68
        elseif recallNextRunePosition = 13
            @setvar! recallHomeGumpResponse 74
        elseif recallNextRunePosition = 14
            @setvar! recallHomeGumpResponse 80
        elseif recallNextRunePosition = 15
            @setvar! recallHomeGumpResponse 86
        elseif recallNextRunePosition = 16
            @setvar! recallHomeGumpResponse 92
        else
            // default to start
            @setvar! recallNextRunePosition 1
            @setvar! recallHomeGumpResponse 2
        endif
    endif
else
    overhead "Unknown escape plan" 34
    unsetvar farmingBook
    replay
endif

hotkey '> Interrupt'
while targetexists  
    hotkey 'Cancel Current Target'
    wait 200
endwhile

while not gumpexists escapePlanGumpId
    dclick farmingBook
    wait 200
endwhile
gumpresponse recallHomeGumpResponse escapePlanGumpId
if secondaryGumpResponse > 0
    waitforgump escapePlanGumpId 5000
    gumpresponse secondaryGumpResponse escapePlanGumpId
endif
wait 200
gumpclose escapePlanGumpId
if insysmsg "There are no charges left on that item."
    overhead "Oh no! Out of charges!" 34
endif

if listexists jaseowns_PreviousScript
    foreach myScript in jaseowns_PreviousScript
        hotkey myScript
    endfor
endif

if name = "Jase Owns"
    hotkey "Play Script: Mage\MageBot"
endif