# This is an automated backup - check out https://outlands.uorazorscripts.com/script/7aba7670-e30e-489d-86ec-c95e79ad57c6 for latest
# Automation by Jaseowns
## Script: Lord Glacier's Chill DEXXER AUTO PILOT - UO OUTLANDS RAZOR SCRIPT - v2.1.9
## Created by: danstock._98439#0
#############################################

/////////
////////                                Lord Glaciers Chill DEXXER AUTO PILOT - UO OUTLANDS RAZOR SCRIPT - version 2.1.9
///////
//////                                      UO Outlands Razor script - Released Feb 18, 2025 - Last Updated September 10, 2025
/////                                           Compiled by DanStock. (aka. Lord Glacier)
////
///



                                                              ################################
                                                             //      QUICK MODE CHANGE:      \\
                                                            ####################################
                                                                
                                                                @setvar! DUNGEONMODE 1
                                                                @setvar! WILDERNESSMODE 0
                                                                    
                                                                # DUNGEON = Auto FIND GATE
                                                                # WILDERNESS = Auto RECALL

                                                            ####################################
                                                             ##################################




          ################################                    ################################                    ###############################
         //  SUGGESTED SKILL TEMPLATE 1: \\                  //  SUGGESTED SKILL TEMPLATE 2: \\                  //     REQ INVENTORY ITEMS:    \\
        //         (PURE DEXXER)          \\                //        (TRIBARD DEXXER)        \\                //       (* or suggested)        \\
        ####################################                ####################################                ################################### 

    #            120  Chivalry                                       120  Chivalry                                   Book of Chivalry
    #            120  Arms Lore                                      120  Peacemaking                                Healers Codex
    #            100  Tactics                                        120  Discordance                                Potion Codex
    #             80  Weapon Skill                                   120  Provocation                                Weapon/Shield/Bard Codex
    #             80  Anatomy                                        100  Tactics                                    Clean Bandages
    #             80  Healing                                        80   Weapon Skill                               Potion Satchel (w/ potions)
    #             80  Parrying (or Alchemy)                          60   Focus (or Forensic)                        Trapped pouches             
    #             60  Focus                                                                                          Delectable food trays
    #                                                                                                                Aspect Armour & Weapon
    #        ASPECT: FROST/FROST                                ASPECT: LYRIC/LRYIC                                  Aspect crystals
    #                 (or FROST/VOID)                                 (or FROST/VOID)                                Adventurers rope *
    #                                                                                                                Skinning knife *
    #        CHAIN:  Melee Swing Speed                          CHAIN:  Melee Swing Speed                            Scissors [blessed] *
    #                Melee Damage/Ignore AR                             Damage to Barded                             Wooden Box w/ copper key 
    #                Melee Aspect Chance                                Effective Barding                            Wizard Satchel *                                                   

        ##################################                  ##################################                  ##################################
         ################################                    ################################                    ################################
          ##############################                      ##############################                      ##############################




    ///////////////////////
    //    CHANGE LOG:    //
    ///////////////////////

    #       Sep 09, 2025 - version 2.1.9:  I think it's finished!! Lots of minor changes to targeting, skinning and other cosmetic tweaks (email any issues to: dan@danstockman.com)
    #       Sep 05, 2025 - version 2.1.8:  Fixed spelling error in Aggressive stance switching codes
    #       Sep 04, 2025 - version 2.1.7:  Tweaks and adjustments throughout - still trying to squash the target hangup (might have got it this time)
    #       Aug 29, 2025 - version 2.1.6:  Fixed bug in gold drop (if loot was in lockbox) and hopefully fixed the targeting hangup bug
    #       Aug 26, 2025 - version 2.1.5:  Adjusted targeting section to avoid hangup and fixed bug in gold drop loop
    #       Jul 31, 2025 - version 2.1.4:  Added some more descriptions in the variable sections 
    #       Jul 30, 2025 - version 2.1.3:  Final touches - just trying to dial in all the timings on everything.  Done... unless I find more lol
    #       Jul 28, 2025 - version 2.1.2:  Few more tweaks and adjustments (mostly to Gold Drop, Loot Storage and Arrow Cleanup sections)
    #       Jul 25, 2025 - version 2.1.1:  Adjusted arrow pickup code and other minor timing and order of operations tweaks throughout (99.99% done now, I think!)
    #       Jul 24, 2025 - version 2.1.0:  Tweaked the attack target timing, fixed bug in Gold Drop loop and added more bandage/heal pot checkpoints
    #       Jul 03, 2025 - version 2.0.9:  Bard archers will now switch to Incendiary ammo while targets are provoked (if using 'Auto Stance Switching')
    #       Jul 02, 2025 - version 2.0.8:  Fixed broken target checker
    #       Jun 30, 2025 - version 2.0.7:  Found and squashed a couple more minor bugs and added new target checker
    #       Jun 26, 2025 - version 2.0.6:  More minor stuff - calling it done for now! (unless I find any more bugs lol)
    #       Jun 26, 2025 - version 2.0.5:  More small tweaks, adjustments and improvements
    #       Jun 23, 2025 - version 2.0.4:  Bug fixes and minor adjustments in barding skills section
    #       Jun 19, 2025 - version 2.0.3:  Minor adjustments and bug fixes - getting close to "finished"
    #       Jun 17, 2025 - version 2.0.2:  Fixed error in AutoExplosionPots section and tweaked the order of a few things in the combat loop
    #       Jun 15, 2025 - version 2.0.1:  Public re-release of updated script (no more required cooldowns, improved target and healing systems, more features, etc.)



    /////////////////
    //    TIPS:    //
    /////////////////

    //    Disclaimer:  I AM NOT AN EXPERT!  I have only played Outlands for a little over a year and a half now (with 90% of that time spent harvesting - main PVM account is only at 14 links) 
    //    This is also the first and only MMO I have played since I last logged out of my OSI accounts on Great Lakes shard back in 2003.  
    //    So take any of my advice with that in mind - I am still a noob.  If you have 30+ links and millions of gold, there is probably a better way to do things, but this works for me at my stage!
    //    I have zero prior experience scripting and I have made these primarily for my own benefit!!  I am learning as I go...
    //    Mostly, I make these scripts in order to play on my Asus ROG Ally handheld - but I have come to enjoy the challenge of making them work for as many builds as possible.
    //    I do not really use Discord (I only installed it to join Outlands - then discovered I had an older account already).  Lots of people message me there, but I rarely check it (sorry).
    //    That being said, I do my best to fix reported bugs (dan@danstockman.com) but usually do not have time to respond to requests for custom stuff (but appreciate any ideas, for sure!)
    //    Since I do not personally use all aspects of the script (and do all my editing in Notepad on my PC at work lol) some bugs take longer for me to find - but I am always adjusting and updating!  Thanks for being patient!
    //    If you see me out in Avadon, my apologies if I dont respond (its a pain to type on the ROG Ally), but to do enjoy hearing that people use my scripts.  Appreciate the support!  GOOD LUCK OUT THERE :)


#     IMPT: FIRST RUN OF SCRIPT SHOULD BE DONE IN HOUSE/INN ROOM/BANK (ie. location of your Auto Recall rune) AND TAKES ROUGHLY 20 SECONDS TO COMPLETE INITIAL (ONE TIME) SETUP!
#           Initial setup can be redone by setting 'ResetScriptPermanentVariable' variable to 1 below!
#           Or you can re-target script variables individually in the 'Options' tab above the script

#     This script does it all for a dexxer!  MOBs will be automatically targeted and attacked and you will be kept healed and buffed (based on your settings below)
#     I play primarily using a handheld (Asus ROG Ally) and this script does everything for me - aside from movement and looting (which cannot be scripted)
#     The script can even reset your loadouts and backpack (w/ anti theft and organization options) after DEATH or after AUTO RECALL
#     My own "self tested" skill templates are listed at the top of the script - the script is versatile and should work with many builds, but those two (Tribard and Pure Dexxer) are what I test with!
#     Script runs in two basic modes (PEACE and WAR) which vary whether you are in COMBAT or NO TARGETS scenarios
#     Toggling WAR MODE while in COMBAT will result in a change of WEAPON/SHIELD STANCES (if enabled)
#     Toggling WAR MODE while NO TARGETS are nearby will result in triggering AUTO RECALL or AUTO FIND GATE (depending on DUNGEON or WILDERNESS settings at top of script)
#     My previous COOLDOWNS are no longer 'required' for script functionality!  You can still add them for bars, etc. (you do not need to set any triggers or anything)
#     Script displays tons of OVERHEAD MESSAGES - these can be disabled in the variable section (minimal target indicators remain - it is my preferred mode!)
#     Recommend using Razor FILTERS to cancel redundant system messages, spam, etc.
#     Script can auto TARGET and ATTACK nearby REDS (variable below) or AUTO RECALL/AUTO DUNGEON GATE instead
#     Optional AUTO RECALL when RED is in target range or when WEIGHT LIMIT reached (or can use tracking skill - with range options below)
#     Built in AUTO RECALL only uses scrolls in charged runebooks (no Magery skill on templates)
#     While RED is tracked/targeted in DUNGEONMODE script will use DUNGEON ESCAPE mode to locate and activate MOONGATES while keeping you alive (if enabled below)
#     If WEAPON ABILITIES are activated, you can add additional optional COOLDOWNS for your weapon abilities (see below) for bars
#     Adjust WEAPON ABILITY COOLDOWN time if using ARMS LORE skill (in variable section)
#     CHIVALRY skill will prioritize healing (aims to keep 4-5 holy symbols available at all times for NOBLE SACRIFICE or HOLY LIGHT) and then prioritizes DIVINE FURY for swing speed
#     Extra symbols will be used for ENEMY OF ONE and/or CLOSE WOUNDS/CLEANSE BY FIRE (use of Chivalry Mastery Chain Links or HOLY ASPECT can increase max symbols)
#     If AUTO PURPLE POTS is activated (and 80+ ALCHEMY skill), script will throw potions at target during combat loop (range options below)
#     Script uses ORGANIZER AGENT-01 for optional MAIN INVENTORY pouch organization
#     If using LOOT CHEST in your HOME/INN/BANK to store goods, script uses ORGANIZER AGENTS 06-09 as sub-containers you can set inside the chest to organize items further
#     If enabled and WOODEN BOX and COPPER KEY found in inventory, script will automactially store and lock any looted items when not in combat
#     If AUTO WEAPON CODEX switching is activated: PEACE = 'Flaying/Wildswing/Blackguard/Arcane/Dragon Stances'  WAR/PROVOKE = 'Incendiary/Monkey/Aggressive Stances'  FROSTSHELL/BLEED/POISON/LOWHP = 'Fowling/Crab/Defensive Stances'
#     If AUTO PARRY CODEX switching is activated:  PEACE = 'Shield Bash/Last Stand Stances'  WAR/PROVOKE = 'Bulwark/Last Stand Stances'  FROSTSHELL/BLEED/POISON/LOWHP = 'Warding/Barrier Stances'
#     Highly recommend use of HEALERS CODEX and POTION CODEX to reduce healing times and buff damage resistance (Adjust HEAL POTION COOLDOWN time if using potion codex - in variable section)
#     Use ASPECT of choice (I use FROST ARMOUR & WEAPON, which works really well... plus, it suits Glacier!)
#     Now includes support for BARDING SKILLS.  I incorporated my original Chiv-TriBard-Archer script into this one and now it works with any weapon type or arrangement of skills!
#     If using BARDING SKILLS, please make sure that [ShowBardingDurations are all DISPLAYED in the UO client
#     Bards must have 6 points in 'Self Taught' (Bard Codex) to drop Musicianship skill (Tri Bard)
#     Script can even deal with DEATH - will search for a healer, auto resurrect, recall home, resupply, heal, activate aspect and even setup your pack with pouch stacks, etc.
#     All of these options puts the script VERY close to the maximum size (will crash the UO client if scripts exceeds ~500k characters) - so be careful adding anything extra!
#     The script is designed to be as "modular" as possible, allowing for unused sections to be removed if need be (at your own risk!)
#     I believe everything is finally working as intended.  Hopefully build version 2.1.9 is the final product, but always check back for new updates!!




                                                                //////////////////////////////
                                                                //    RESET SCRIPT HERE:    //
                                                                //////////////////////////////

                                    ////  SET THIS VALUE TO '1' AND RUN SCRIPT TO UNSET ALL PERMANENT SCRIPT VARIABLES:  \\\\

                                                        @setvar! ResetScriptPermanentVariables 0

                           #############  THEN RETURN 'ResetScriptPermanentVariables' TO '0' TO RESTART INITIAL SETUP...  ##############
                           #####    (Or you can re-target script variables individually in the 'Options' tab above the script!)    #####





     ###################################################
    ###    OPTIONAL COOLDOWNS TO ADD IN UO CLIENT:    ###
    ###               (case sensitive!)               ###
     ###################################################

    # Bandaging (set as bandage timer) 
    # Healing Potion
    # Weapon Ability

    // CHIVALRY ONLY:
        # Holy Light
        # Noble Sacrifice
        # Cleanse By Fire
        # Close Wounds
        # Divine Fury
        # Enemy Of One
        # Consecrate Weapon
    // SWORDS ONLY:
        # Spinslash Ability
        # Rend Ability
        # Chop Ability
    // MACING ONLY:
        # Pummel Ability
        # Stun Ability
        # Smash Ability
    // FENCING ONLY:
        # Gambit Ability
        # Swiftstrikes Ability
        # Bane Ability
    // ARCHERY ONLY:
        # Skirmish Ability
        # Full Draw Ability
        # Repeater Ability
    // WRESTLING ONLY:
        # Brawl Ability
        # Haymaker Ability
        # Takedown Ability
    // BARDING ONLY:
        # Peacemaking
        # Provocation
        # Discordance
        # Pacified
        # Provoked
        # Discorded
        # Peacemaking Buff
        # Provocation Buff
        # Discordance Buff
    // FROST ASPECT ONLY:
        # Frost Shell Cooldown 
        # Frost Shell Active
    // ALCHEMY ONLY:
        # Purple Potion 



                    ###########################################################################################################################
                    #  MOST FEATURES ARE TURNED 'OFF' BY DEFAULT! PLEASE CHECK THE 'VARIABLES' SECTION BELOW CAREFULLY DURING INITIAL SETUP!  #
                    ###########################################################################################################################



     ###############################
    ###      USER VARIABLES:      ###
     ###############################

//////////////////////////
//      OFFENSIVE:      //
//////////////////////////

@setvar! EnableAlwaysTargetClosest 1
    # Enabling this setting will attack closest MOB at all times
    # Otherwise target will remain locked until it is dead or out of attack range (or script restart)

if skill 'Archery' > 50
    @setvar! TargetAttackRange 10
    # Attack range if using Archery skill
else
    @setvar! TargetAttackRange 2
    # Attack range if using Swords, Macing, Fencing or Wrestling
endif

@setvar! EnableAutoTaunting 0
    # Requires 80+ Parrying skill

@setvar! EnableAutoPoisonWeaponinHand 0
    # Requires 80+ Poisoning/Taste ID skill


//////////////////////////
//      DEFENSIVE:      //
//////////////////////////

@setvar! ActivateAutoHealHPdiff 45
    # Set HP diff to trigger prioritized healing loop (set potion/bandage trigger points below)

@setvar! EnableAutoParalyzePouch 1
    # Will automatically pop trapped pouches if paralyzed (will also trigger auto recall/gating, if enabled)

@setvar! EnableFrostAspect 0
@setvar! FrostAspectTier 0
    # Set your Frost Aspect level (if using Frost Aspect)
    # This will automatically set your Frost Shell Cooldown length

@setvar! EnableWeaponCheck 0
@setvar! EnableShieldCheck 0
    # Checks hand for weapon and/or shield and will equip if missing (based on weapon skill and inventory)
    # Prioritizes aspect weapon and ignores unidentified magic items


/////////////////////////
//      CHIVALRY:      //
/////////////////////////

@setvar! EnableDivineFury 1
@setvar! EnableEnemyOfOne 1
@setvar! EnableConsecrateWeapon 1
    # Chivalry offensive buffs, if enabled, will trigger and auto renew during combat
    # Buffs will not trigger if you will be left with lower than 4 symbols (to keep Holy Light/Noble Sacrifice available)
    # Priority is given to Divine Fury over the others

@setvar! EnableHolyLight 1
@setvar! EnableNobleSacrifice 1
@setvar! EnableCloseWounds 1
@setvar! EnableCleanseByFire 0
    # Chivalry defensive buffs, if enabled, will also trigger during combat as needed

@setvar! HolyLightHPdiff 50
@setvar! NobleSacrificeHPdiff 80
    # Set your trigger points for Chivalry heals (if enabled above) 


//////////////////
//   POTIONS:   //
//////////////////

@setvar! EnableHealPotion 1
@setvar! EnableCurePotion 1
@setvar! EnableRefreshPotion 1

@setvar! HealPotionHPdiff 35
@setvar! RefreshPotionSPdiff 10
    # Adjust HP diff set points for Heal and Refresh potion 
    # Cure pots will be used as needed (if enabled)

@setvar! EnableStrengthPotion 0
@setvar! EnableAgilityPotion 0
@setvar! EnableMagicResistPotion 0
    # Strength, Agility and Resist potions will auto-buff when effects wear off (if enabled)

if skill 'Alchemy' >= 80
    @setvar! HealingPotionCooldown 7000
else
    @setvar! HealingPotionCooldown 10000
endif
    # This only affects your optional cooldown bars (script uses other checks to verify heal pots are available)

@setvar! EnableAutoExplosionPots 0
@setvar! PurplePotionTargetRange 2
@setvar! PurplePotionCooldown 15000
    # Requires 80+ Alchemy skill to make potions sticky (increase range if using Archery skill - or if preferred) 
    # WARNING: throwing potions in a crowded dungeon may cause you to flag criminal in rare cases! USE AT OWN RISK

@setvar! EnableUsePotionKegs 0
    # Will auto fill empty bottles from potion kegs if inventory counts drop below set amount
    # Requires empty bottles and kegs of each type in inventory (pack extra empty bottles for explosion pots)

    # Set your potion amounts (if using kegs): 
    if EnableUsePotionKegs = 1
        @setvar! HealingPotionAmount 5
        @setvar! CurePotionAmount 5
        @setvar! RefreshPotionAmount 5
        @setvar! StrengthPotionAmount 0
        @setvar! AgilityPotionAmount 0
        @setvar! ResistPotionAmount 0
        @setvar! ExplosionPotionAmount 0
    endif


//////////////////////////
//        CODEX:        //
//////////////////////////

    ######################
    #      STANCES:      #
    ######################

@setvar! EnableWeaponCodexHotbar 0
@setvar! EnableWeaponCodexSwitching 0
@setvar! SwitchWeaponCodexCooldown 1000

@setvar! SetCodexStance 0
        # '0' for 'Disabled'
        # '1' for 'First Weapon Stance'
        # '2' for 'Second Weapon Stance'
        # '3' for 'Third Weapon Stance'
        # '4' for 'Fourth Weapon Stance'
        # '5' for 'Fifth Weapon Stance'
        # '6' for 'Auto Stance Switching'
            // Auto:  PEACE = 'Flaying/Wildswing/Blackguard/Arcane/Dragon Stances'  WAR/PROVOKE = 'Incendiary/Monkey/Cleave Stances'  FROSTSHELL/BLEED/POISON/LOWHP = 'Fowling/Crab/Defensive Stances'
            // Must set 'EnableWeaponCodexSwitching' to '1' in order use 'Auto Stance Switching'

@setvar! EnableShieldCodexHotbar 0
@setvar! EnableShieldCodexSwitching 0
@setvar! SwitchShieldCodexCooldown 1000

    @setvar! SetShieldCodexStance 0
        # '0' for 'Disabled'
        # '1' for 'Shield Bash Stance'
        # '2' for 'Warding Stance'
        # '3' for 'Testudo Stance'
        # '4' for 'Mirror Stance'
        # '5' for 'Bulwark Stance'
        # '6' for 'Auto Shield Stance Switching'
            // Auto:  PEACE = 'Shield Bash Stance'  WAR = 'Bulwark Stance'  FROSTSHELL/BLEED/POISON/LOWHP = 'Warding Stance'
            // Must set 'EnableShieldCodexSwitching' to '1' in order use 'Auto Shield Stance Switching'

    if EnableWeaponCodexSwitching = 1 or EnableShieldCodexSwitching = 1
        if WILDERNESSMODE = 1
            # Keep enough mana to Recall in wilderness:
                @setvar! SwitchCodexManaAmount 15
        elseif DUNGEONMODE = 1
            # Mana can go lower while dungeon farming:
                @setvar! SwitchCodexManaAmount 4
        else 
            # Leave this set to '0' unless otherwise directed
                @setvar! SwitchCodexManaAmount 0
        endif
    endif

    #######################
    #  WEAPON ABILITIES:  #
    #######################

@setvar! EnableWeaponAbilities 0
@setvar! EnableWeaponAbilityHotbar 0

    if skill 'Arms Lore' >= 80
        @setvar! WeaponAbilityCooldown 30000
    else
        @setvar! WeaponAbilityCooldown 60000
    endif

    // Enable only one Weapon Ability at a time (per codex)!  

        # SWORDS:
    @setvar! UseSpinslashAbility 0
    @setvar! UseRendAbility 0
    @setvar! UseChopAbility 0
        # MACING:
    @setvar! UsePummelAbility 0
    @setvar! UseStunAbility 0
    @setvar! UseSmashAbility 0
        # FENCING:
    @setvar! UseGambitAbility 0
    @setvar! UseSwiftstrikesAbility 0
    @setvar! UseBaneAbility 0
        # ARCHERY:
    @setvar! UseSkirmishAbility 0
    @setvar! UseFullDrawAbility 0
    @setvar! UseRepeaterAbility 0
        # WRESTLING:
    @setvar! UseBrawlAbility 0
    @setvar! UseHaymakerAbility 0
    @setvar! UseTakedownAbility 0


    #######################
    #  WEAPON FINISHERS:  #
    #######################

@setvar! EnableWeaponFinisher 0
    # '0' for 'Disabled'
    # '1' for 'First Weapon Finisher'
    # '2' for 'Second Weapon Finisher'
    # '3' for 'Auto Finisher Switching'
        // Auto:  PEACE/WAR = 'First Weapon Finisher'  FROSTSHELL/BLEED/POISON/LOWHP = 'Second Weapon Finisher'

    #######################
    #  SHIELD FINISHERS:  #
    #######################

@setvar! EnableShieldCodexFinisher 0
    # '0' for 'Disabled'
    # '1' for 'Last Stand Finisher'
    # '2' for 'Barrier Finisher'
    # '3' for 'Auto Shield Finisher Switching'
        // Auto: PEACE/WAR = 'Last Stand Finisher'  FROSTSHELL/BLEED/POISON/LOWHP = 'Barrier Finisher'


//////////////////////////
//       BARDING:       //
//////////////////////////

@setvar! EnablePeacemaking 0
@setvar! EnableProvocation 0
@setvar! EnableDiscordance 0
    # Will automatically Peace, Discord and, if targets available, Provoke enemies before attacking

@setvar! PeacemakingReapply 30000
@setvar! ProvocationReapply 45000
@setvar! DiscordanceReapply 60000
    # Script will reapply if bard break is detected (by default) and/or when variable above is met

@setvar! EnablePeacemakingBuff 0
@setvar! EnableProvocationBuff 0
@setvar! EnableDiscordanceBuff 0
    # Will automatically renew Barding Buffs (if enabled)


//////////////////////////
//       UTILITY:       //
//////////////////////////

@setvar! EnableOverheadMessages 1
    # Overhead messages can be turned off (minimal target indicators will remain)

@setvar! EnableEatingFood 1
    # Will automatically eat delectable food trays when not buffed (important for swing speed!)

@setvar! EnableAutoCarving 0
    # Requires skinning knife and will automatically carve nearby corpses

@setvar! EnableAutoSatchels 0
    # Will automatically move potions and/or reagents in backpack to satchels

@setvar! EnableGoldVacuum 0
    # Will automatically pickup discarded gold nearby

@setvar! EnableDungeonCleanup 0
    # Will automatically pickup discarded resources nearby (regs, ingots, boards, etc.)
    
@setvar! EnableArrowCleanup 0
    # Will automatically pickup arrows or bolts from the ground (if Archery skill > 50) 
    
@setvar! EnableDropGoldWhenOverweight 0
@setvar! DropGoldAmount 250
    # Will drop set amount of gold when overweight until no longer impeded 

@setvar! EnableLootBag 0
    # Will open your selected LOOTBAG when unloading at HOME/INN/BANK
    # This should be the bag that is set as your 'Grab Bag' in Gridloot, etc.

@setvar! EnablePutLootinLockBox 0
    # Must have WOODEN BOX and COPPER KEY and loot will be automatically secured while FARMING
    @setvar! StoreLootTimer 0
        # StoreLootTimer is the delay between targets to trigger loot storage

@setvar! AfterKillTimer 0
    # AfterKillTimer sets the delay after eliminating your target (to give time to loot, etc.) while still keeping you safe
    # Increase slightly if carving corpses or set to 0 for instant re-targeting

@setvar! EnableArcheryWarningMessage 1
@setvar! ArcheryLowAmmoWarningAmount 10
    # Overhead warning (independant of other Overhead Messages) for low archery ammuniton (if Archery skill > 50) 

@setvar! EnableWeightWarningMessage 1
@setvar! GreenWarningDiffWeight 50
@setvar! YellowWarningDiffWeight 25
@setvar! RedWeightLimitDiffWeight 10
    # Weight limit will trigger AUTO RECALL or AUTO DUNGEON GATE if enabled below (otherwise just an overhead message)


/////////////////////////
//  AUTO RECALL/GATE:  //
/////////////////////////

    ##########################
    #   STAND YOUR GROUND:   #
    ##########################

        # Instead of recalling/retreating from PKs, you can choose to fight back instead:
            @setvar! EnableStandYourGround 0
                # Will engage nearby PKs instead of attempting to escape!
                @setvar! EnableSwitchToFastWeaponForPVP 0
                    # Uses Interrupt Weapons: katana, cutlass, scimitar, kryss, bow, club, hammerpick, or war axe

    ##########################
    #      PK TRIGGERS:      #
    ##########################

    //  RED RECALL/ESCAPE (w/ TRACKING SKILL):  //
        if skill 'Tracking' >= 50 and EnableStandYourGround != 1
            @setvar! EnableTrackingAutoRecall 1
                # Make sure "Ignore Houses/Ships" is checked in the Tracking skill menu!
            @setvar! PKTrackingRange 50
                # Range can be 40, 50 or 60 tiles (or 0 will trigger Auto Recall regardless of range)
            @setvar! EnableRedAlertOverhead 1
                # If your build has tracking skill, I highly recommend setting up a Razor overhead message instead of using the script one:
                    // This will display PK name/distance overhead when tracked!
                    // Add overhead message w/ a trigger of "Now tracking" and message "[ RED ALERT: {3} ]"  (hue 335)
                    // Then a second with a trigger of "Distance to destination" and message "[ {4} TILES AWAY! ]"  (hue 253)
                    // Once complete you should disable "EnableRedAlertOverhead" above

    //  RED RECALL/ESCAPE (w/ NO TRACKING SKILL):  //
        elseif skill 'Tracking' < 50 and EnableStandYourGround != 1
            @setvar! EnablePKradar 1
                # PK radar must be enabled for Auto Red Recall/Dungeon Gate to function (w/o Tracking Skill)

            if WILDERNESSMODE = 1
                # Auto Recall if PK comes into target range (wilderness only):
                    @setvar! EnableAutoRedRecall 1
            elseif DUNGEONMODE = 1
                # Auto Dungeon Gate if PK comes into target range (dungeons only):
                    @setvar! EnableAutoRedDungeonGate 1
            endif

            if EnablePKradar = 1
                if WILDERNESSMODE = 1
                    @setvar! EnableAutoRedRecall 1
                elseif DUNGEONMODE = 1
                    @setvar! EnableAutoRedDungeonGate 1
                endif
            endif
            # Will only trigger if RED is within target range (~12 tiles) - but can still be helpful!
        endif

    ##########################
    #    WEIGHT TRIGGERS:    #
    ##########################

    if WILDERNESSMODE = 1
        @setvar! EnableAutoWeightRecall 0
    elseif DUNGEONMODE = 1
        @setvar! EnableAutoWeightDungeonGate 0
        @setvar! EnableRecallAfterDungeonGate 0
    endif

    ##########################
    # RESURRECTION TRIGGERS: #
    ##########################

    @setvar! EnableRecallAfterResurrection 0
        # Must have [blessed] runebook charged w/ scrolls (even if 'EnableCastRecall' is turned on)
    @setvar! EnableDressAfterResurrection 0
        # Must have a Razor 'Dress List' named 'UltimateDexxer' for all your [blessed] wearables


    #########################################################
    ####  YOU CAN TRIGGER YOUR OWN RAZOR RECALL SCRIPT:  ####
    #########################################################

    # Enable use of your own Razor script for Auto Recall (otherwise script will prompt for a Runebook and use built-in auto recall):
        @setvar! EnableDIYRecallScript 0
            createlist DIYRecallScriptList

        // Type the name of your own Home Recall Razor script here:
            pushlist DIYRecallScriptList " YOUR RECALL SCRIPT NAME "
                # Must use built-in Home Recall script if using Infinite Loop setting!


    ##########################################################
    ####  OR USE THE BUILT-IN AUTO RECALL/ESCAPE SCRIPT:  ####
    ##########################################################

    //  AUTO RECALL DESTINATION (choose only one):
        @setvar! OwnerInnRecall 0
        @setvar! CoOwnerInnRecall 0
        @setvar! InsideHouseRecall 0
        @setvar! OutsideHouseRecall 0
        @setvar! BankRecall 0

        if OutsideHouseRecall = 1
            @setvar! EnableCloseMyDoor 0
            @setvar! MyDoor 0x0000000
                # Use ">info" to ID your own house door (to quickly close it behind you)
        endif

        @setvar! EnableAutoRecallOverheadMessages 1
        @setvar! HideAtHomeorInn 0

    //  LOADOUT RESET (after RECALL): 
        #  Safe, Repair Bench, Resource Stockpile, Storage Shelf, Magic Recycler and/or Loot Chest must be found within 2 tiles!
        #  Storage Tomes can be locked down (within 2 tiles) or located inside Loot Chest

            @setvar! EnableSafeDeposit 0
                # Will deposit all gold and doubloons found in inventory
            @setvar! EnableRepairBench 0
                # Will repair all equipment (Repair Bench must have charges available)
            @setvar! EnableResourceStockpile 0
                # Will deposit all resources (ingots, boards, gems, etc.)
            @setvar! EnableStorageShelf 0
                # Will restock shelf and then resupply a fresh loadout
            @setvar! EnableMagicRecycler 0
                # Will add all unidentified magic items to your Recycler 
                @setvar! EnableRecycleItemsWhenFull 0
                    # If Recycler is full, it will attempt to ID, Recycle and deposit resources (if stockpile nearby) before adding items
            @setvar! EnableStorageTomes 0
                # Will add items to any nearby storage tomes (skill scrolls, dyes, runes, maps, cards, etc)
            @setvar! EnableReagentSplitter 0
                # Will split reagents into smaller stacks after shelf resupply
            @setvar! EnableLootChest 0
                # Will open selected chest to store non-shelf/stockpile/tome items in your HOME/INN/BANK (uses Razor organizer agents 06-09)

            //  UNLOAD/RESUPPLY/REPAIR/CHIV GATE (after weight recalls only):  //
                # Infinite Loop will unload/resupply and then Chiv Gate back to custom location (weight recalls only):
                    @setvar! EnableInfiniteLoop 0
                        # ( Must use built-in Home Recall script if using Infinite Loop setting! ) \\
                    @setvar! InfiniteLoopDestination 1
                        # Set destination to '1' for dungeon Chiv Gate (will auto select your last gated dungeon)
                        # or '2' for wilderness custom location Chiv Gate

            @setvar! EnableResetInventoryAfterDeath 0
            @setvar! EnableSetMainPouchOrganizer01 0
            # This variable will reorganize your backpack after death (see instructions below)
                # Storage shelf loadout must consist of the following:
                //  Requires an equal amount of TRAPPED POUCHES and SCISSORS [blessed]
                //  Requires 1 UNTRAPPED POUCH (for main inventory - optionally set as Organizer Agent-01 above) and 1 BAG (for loot, etc.)
                //  Script will put scissors in each trapped pouch (to keep them from being grabbed during future shelf loading)
                //  Script then STACKS any trapped pouches on top of your main inventory pouch
                //  Loot bag will be moved into main inventory pouch and automatically set as your Grab Bag for Gridloot, etc.
                //  Script will then hide the stack underneath an ATLAS and put a DECOY TRAPPED POUCH out in the open
                //  ASPECT WEAPON and ARMOR will be re-activated automatically and HP restored to MAX
                //  Loadout reset finishes by opening backpack, main pouch, loot bag and any satchels


/////////////////////////
//    SCRIPT MODES:    //
/////////////////////////

    // I use this variable to setup multiple "modes" with different hotkeys.
        # Same script (copy and paste and update variables), just different setups (Dungeon, Infinite Loop, Wilderness, etc.)
        # Just change the number and overhead message for each one (will only display overhead when switching modes)

        if ScriptMode = 1
            // Do nothing
        else
            overhead "[ DUNGEON MODE ]" 2338
            @setvar! ScriptMode 1
        endif


////////////////////////
//  MOB IGNORE LIST:  //
////////////////////////

removelist animalsIgnoreList
createlist animalsIgnoreList
    pushlist animalsIgnoreList "a plover"
    pushlist animalsIgnoreList "a sheep"
    pushlist animalsIgnoreList "a frenzied ostard"
    pushlist animalsIgnoreList "a tundra ostard"
    pushlist animalsIgnoreList "a desert ostard"
    pushlist animalsIgnoreList "a forest ostard"
    pushlist animalsIgnoreList "a finch"
    pushlist animalsIgnoreList "a sparrow"
    pushlist animalsIgnoreList "a towhee"
    pushlist animalsIgnoreList "a lapwing"
    pushlist animalsIgnoreList "a silverback"
    pushlist animalsIgnoreList "a crow"
    pushlist animalsIgnoreList "a woodpecker"
    pushlist animalsIgnoreList "a horse"
    pushlist animalsIgnoreList "a swift"
    pushlist animalsIgnoreList "a skylark"
    pushlist animalsIgnoreList "a hawk"
    pushlist animalsIgnoreList "a chickadee"
    pushlist animalsIgnoreList "a cat"
    pushlist animalsIgnoreList "a dog"
    pushlist animalsIgnoreList "a black bear"
    pushlist animalsIgnoreList "a brown bear"
    pushlist animalsIgnoreList "a bull"
    pushlist animalsIgnoreList "a cow"
    pushlist animalsIgnoreList "a chicken"
    pushlist animalsIgnoreList "a bird"
    pushlist animalsIgnoreList "an eagle"
    pushlist animalsIgnoreList "a nuthatch"
    pushlist animalsIgnoreList "an elk"
    pushlist animalsIgnoreList "a great hart"
    pushlist animalsIgnoreList "a kingfisher"
    pushlist animalsIgnoreList "a hind"
    pushlist animalsIgnoreList "a llama"
    pushlist animalsIgnoreList "a sand crab"
    pushlist animalsIgnoreList "a pig"
    pushlist animalsIgnoreList "a polar bear"
    pushlist animalsIgnoreList "a walrus"
    pushlist animalsIgnoreList "a cougar"
    pushlist animalsIgnoreList "a goat"
    pushlist animalsIgnoreList "a raven"
    pushlist animalsIgnoreList "a magpie"
    pushlist animalsIgnoreList "a warbler"
    pushlist animalsIgnoreList "a tern"
    pushlist animalsIgnoreList "a nightingale"
    pushlist animalsIgnoreList "a wren"
    pushlist animalsIgnoreList "red rubble"
    pushlist animalsIgnoreList "a spirit wolf"
    pushlist animalsIgnoreList "a spirit sabertus"
    pushlist animalsIgnoreList "a death asp"
    pushlist animalsIgnoreList "a death adder"

/////////////////////////
//  END OF VARIABLES!  //
/////////////////////////





########  EDIT BELOW THIS LINE AT YOUR OWN RISK!  ####  EDIT BELOW THIS LINE AT YOUR OWN RISK!  ####  EDIT BELOW THIS LINE AT YOUR OWN RISK!  ####  EDIT BELOW THIS LINE AT YOUR OWN RISK!  ########





/////////////////////
//  SCRIPT RESET:  //
/////////////////////

if ResetScriptPermanentVariables = 1
    unsetvar AutoRecallChargedRunebook
    unsetvar FirstRunDexxer
    unsetvar DexxerAutoPilot
    unsetvar LootBag
    unsetvar LootChest
    overhead "[ SCRIPT VARIABLES RESET... ]" 333
    sysmsg "Please return 'ResetScriptPermanentVariable' to 0 to continue!" 153
    stop
endif


///////////////////////
//   TIMER SETUPS:   //
///////////////////////

if not timerexists "WorldSaveTimer"
    createtimer "WorldSaveTimer"
    settimer "WorldSaveTimer" 0
endif

if not timerexists "NoTargetTimer"
    createtimer "NoTargetTimer"
    settimer "NoTargetTimer" 0
endif

if not timerexists "WeaponAbilityTimer"
    createtimer "WeaponAbilityTimer"
    settimer "WeaponAbilityTimer" 0
endif

if not timerexists 'LootTimer'
    createtimer 'LootTimer'
    settimer 'LootTimer' 0
endif

if not timerexists 'PurplePotionTimer'
    createtimer 'PurplePotionTimer'
    settimer 'PurplePotionTimer' 0
endif

if not timerexists 'WeightTimer'
    createtimer 'WeightTimer'
    settimer 'WeightTimer' 0
endif

if not timerexists 'PKRadar'
    createtimer 'PKRadar'
    settimer 'PKRadar' 0
endif

if not timerexists 'AmIclosestMOB'
    createtimer 'AmIclosestMOB'
    settimer 'AmIclosestMOB' 0
endif

if not timerexists 'TauntingTimer'
    createtimer 'TauntingTimer'
    settimer 'TauntingTimer' 0
endif

if not timerexists "WeaponCodexTimer"
    createtimer "WeaponCodexTimer"
    settimer "WeaponCodexTimer" 0
endif

if not timerexists "WeaponCodexCheckTimer"
    createtimer "WeaponCodexCheckTimer"
    settimer "WeaponCodexCheckTimer" 2000
endif

if not timerexists "ShieldCodexTimer"
    createtimer "ShieldCodexTimer"
    settimer "ShieldCodexTimer" 0
endif

if not timerexists "ShieldCodexCheckTimer"
    createtimer "ShieldCodexCheckTimer"
    settimer "ShieldCodexCheckTimer" 2000
endif

if not timerexists "DungeonEscape"
    createtimer "DungeonEscape"
    settimer "DungeonEscape" 0
endif

if not timerexists "ArrowCleanupTimer" 
    createtimer "ArrowCleanupTimer" 
    settimer "ArrowCleanupTimer"  1000
endif 

if not timerexists "DungeonCleanup"
    createtimer "DungeonCleanup"
    settimer "DungeonCleanup" 0
endif

if not timerexists "DungeonCleanupRadar"
    createtimer "DungeonCleanupRadar"
    settimer "DungeonCleanupRadar" 0
endif

if not timerexists 'TargetTimer'
    createtimer 'TargetTimer'
    settimer 'TargetTimer' 4500
endif

if not timerexists 'REDALERT'
    createtimer 'REDALERT'
    settimer 'REDALERT' 0
endif

if not timerexists 'MANAWAIT'
    createtimer 'MANAWAIT'
    settimer 'MANAWAIT' 4500
endif

if not timerexists 'MURDERTARGET'
    createtimer 'MURDERTARGET'
    settimer 'MURDERTARGET' 4500
endif

if not timerexists 'GETCLOSER'
    createtimer 'GETCLOSER'
    settimer 'GETCLOSER' 4500
endif

if not timerexists 'GATEHERE'
    createtimer 'GATEHERE'
    settimer 'GATEHERE' 4500
endif

if not timerexists 'RECALLDELAY'
    createtimer 'RECALLDELAY'
    settimer 'RECALLDELAY' 4500
endif

if not timerexists 'CANNOTSEE'
    createtimer 'CANNOTSEE'
    settimer 'CANNOTSEE' 4500
endif

if not timerexists 'TOOFAR'
    createtimer 'TOOFAR'
    settimer 'TOOFAR' 4500
endif

if not timerexists 'HEALERSEARCH'
    createtimer 'HEALERSEARCH'
    settimer 'HEALERSEARCH' 4500
endif

if not timerexists 'RUNAWAY'
    createtimer 'RUNAWAY'
    settimer 'RUNAWAY' 6000
endif

if not timerexists 'STORELOOT'
    createtimer 'STORELOOT'
    settimer 'STORELOOT' 6000
endif

if not timerexists 'ATTACKTIMER'
    createtimer 'ATTACKTIMER'
    settimer 'ATTACKTIMER' 15000
endif

if not timerexists 'overweightMessageTimer'
    createtimer 'overweightMessageTimer'
    settimer 'overweightMessageTimer' 4500
endif

if not timerexists 'noTargetMessageTimer'
    createtimer 'noTargetMessageTimer'
    settimer 'noTargetMessageTimer' 4500
endif

if not timerexists 'searchingMessageTimer'
    createtimer 'searchingMessageTimer'
    settimer 'searchingMessageTimer' 4500
endif

if not timerexists "inventorycheck"
    createtimer "inventorycheck"
    settimer "inventorycheck" 5000
endif

if not timerexists 'foodMessageTimer'
    createtimer 'foodMessageTimer'
    settimer 'foodMessageTimer' 4500
endif

if not timerexists 'pouchMessageTimer'
    createtimer 'pouchMessageTimer'
    settimer 'pouchMessageTimer' 4500
endif

if not timerexists 'aidsMessageTimer'
    createtimer 'aidsMessageTimer'
    settimer 'aidsMessageTimer' 4500
endif

if not timerexists 'PotionKegTimer'
    createtimer 'PotionKegTimer'
    settimer 'PotionKegTimer' 3500
endif

if not timerexists 'whiteMessageTimer'
    createtimer 'whiteMessageTimer'
    settimer 'whiteMessageTimer' 4500
endif

if not timerexists 'blueMessageTimer'
    createtimer 'blueMessageTimer'
    settimer 'blueMessageTimer' 4500
endif

if not timerexists 'blackMessageTimer'
    createtimer 'blackMessageTimer'
    settimer 'blackMessageTimer' 4500
endif

if not timerexists 'purpleMessageTimer'
    createtimer 'purpleMessageTimer'
    settimer 'purpleMessageTimer' 15000
endif

if not timerexists 'orangeMessageTimer'
    createtimer 'orangeMessageTimer'
    settimer 'orangeMessageTimer' 4500
endif

if not timerexists 'yellowMessageTimer'
    createtimer 'yellowMessageTimer'
    settimer 'yellowMessageTimer' 4500
endif

if not timerexists 'HealPotionTimer'
    createtimer 'HealPotionTimer'
    settimer 'HealPotionTimer' 11000
endif

if not timerexists 'redMessageTimer'
    createtimer 'redMessageTimer'
    settimer 'redMessageTimer' 4500
endif

if not timerexists 'OrganizerAgentTimer'
    createtimer 'OrganizerAgentTimer'
    settimer 'OrganizerAgentTimer' 15000
endif

if not timerexists 'SkinningTimer'
    createtimer 'SkinningTimer'
    settimer 'SkinningTimer' 5000
endif

if not timerexists 'WizardSatchelTimer'
    createtimer 'WizardSatchelTimer'
    settimer 'WizardSatchelTimer' 60000
endif

if not timerexists 'PotionSatchelTimer'
    createtimer 'PotionSatchelTimer'
    settimer 'PotionSatchelTimer' 60000
endif

if not timerexists "QuiverTimer"
    createtimer "QuiverTimer" 
    settimer "QuiverTimer" 30000
endif 

if not timerexists 'HolyLightTimer'
    createtimer 'HolyLightTimer'
    settimer 'HolyLightTimer' 31000
endif

if not timerexists 'NobleSacrificeTimer'
    createtimer 'NobleSacrificeTimer'
    settimer 'NobleSacrificeTimer' 31000
endif

if not timerexists 'ChivalryPrevented'
    createtimer 'ChivalryPrevented'
    settimer 'ChivalryPrevented' 5000
endif

if not timerexists "SongBuffDelay"
    createtimer "SongBuffDelay"
    settimer "SongBuffDelay" 0
endif

if not timerexists 'Musicianship'
    createtimer 'Musicianship'
    settimer 'Musicianship' 5000
endif

if not timerexists 'DiscordanceTimer'
    createtimer 'DiscordanceTimer'
    settimer 'DiscordanceTimer' 11000
endif

if not timerexists 'PeacemakingTimer'
    createtimer 'PeacemakingTimer'
    settimer 'PeacemakingTimer' 11000
endif

if not timerexists 'ProvocationTimer'
    createtimer 'ProvocationTimer'
    settimer 'ProvocationTimer' 11000
endif

if not timerexists "NextTargetCheck"
    createtimer "NextTargetCheck"
    settimer "NextTargetCheck" 0
endif

if not timerexists "NextTargetTimer"
    createtimer "NextTargetTimer"
    settimer "NextTargetTimer" 0
endif

if not timerexists "ProvoCheck"
    createtimer "ProvoCheck"
    settimer "ProvoCheck" 0
endif

if not timerexists "AttackingTimer" 
    createtimer "AttackingTimer" 
    settimer "AttackingTimer" 1000
endif 

if not timerexists 'TargetAcquired'
    createtimer 'TargetAcquired'
    settimer 'TargetAcquired' 4000
endif

if not timerexists 'CloseWoundsTimer'
    createtimer 'CloseWoundsTimer'
    settimer 'CloseWoundsTimer' 31000
endif

if not timerexists 'CleanseByFireTimer'
    createtimer 'CleanseByFireTimer'
    settimer 'CleanseByFireTimer' 31000
endif

if not timerexists 'DivineFuryTimer'
    createtimer 'DivineFuryTimer'
    settimer 'DivineFuryTimer' 31000
endif

if not timerexists 'EnemyOfOneTimer'
    createtimer 'EnemyOfOneTimer'
    settimer 'EnemyOfOneTimer' 31000
endif

if not timerexists 'ConsecrateWeaponTimer'
    createtimer 'ConsecrateWeaponTimer'
    settimer 'ConsecrateWeaponTimer' 31000
endif

if not timerexists 'AmmunitionTimer'
    createtimer 'AmmunitionTimer'
    settimer 'AmmunitionTimer' 6000
endif

if not timerexists "Provoked"
    createtimer "Provoked"
    settimer "Provoked" 30000
endif

if not timerexists "Pacified"
    createtimer "Pacified"
    settimer "Pacified" 30000
endif

if not timerexists "Discorded"
    createtimer "Discorded"
    settimer "Discorded" 30000
endif 
    
if not timerexists "ProvokedTimer"
    createtimer "ProvokedTimer"
    settimer "ProvokedTimer" 31000
endif

if not timerexists "PacifiedTimer"
    createtimer "PacifiedTimer"
    settimer "PacifiedTimer" 31000
endif

if not timerexists "DiscordedTimer"
    createtimer "DiscordedTimer"
    settimer "DiscordedTimer" 31000
endif

if not timerexists "Provocation"
    createtimer "Provocation"
    settimer "Provocation" 11000
endif

if not timerexists "Discordance"
    createtimer "Discordance"
    settimer "Discordance" 11000
endif

if not timerexists "Peacemaking"
    createtimer "Peacemaking"
    settimer "Peacemaking" 11000
endif

if not timerexists "DiscoCheck"
    createtimer "DiscoCheck"
    settimer "DiscoCheck" 0
endif

if not timerexists "PeaceCheck"
    createtimer "PeaceCheck"
    settimer "PeaceCheck" 0
endif

if not timerexists "RendTimer"
    createtimer "RendTimer"
    settimer "RendTimer" 0
endif

if not timerexists "AfterKill"
    createtimer "AfterKill"
    settimer "AfterKill" 500
endif

if not timerexists "GoldRadar"
    createtimer "GoldRadar"
    settimer "GoldRadar" 0
endif

if not timerexists "InfiniteLoop"
    createtimer "InfiniteLoop"
    settimer "InfiniteLoop" 30000
endif

if not timerexists "CleanupRadar"
    createtimer "CleanupRadar"
    settimer "CleanupRadar" 0
endif

if not timerexists "SatchelTimer"
    createtimer "SatchelTimer"
    settimer "SatchelTimer" 0
endif

if not timerexists "BoltCleanupRadar"
    createtimer "BoltCleanupRadar"
    settimer "BoltCleanupRadar" 0
endif

if not timerexists "ArrowCleanupRadar"
    createtimer "ArrowCleanupRadar"
    settimer "ArrowCleanupRadar" 0
endif

if not timerexists "PotFillTimer" 
    createtimer "PotFillTimer" 
    settimer "PotFillTimer" 5000
endif 

if not timerexists "ClearIgnoreTimer"
    createtimer "ClearIgnoreTimer"
    settimer "ClearIgnoreTimer" 30000
endif 

if not timerexists "ClearSysmsgTimer"
    createtimer "ClearSysmsgTimer"
    settimer "ClearSysmsgTimer"30000
endif 

if timer "ClearIgnoreTimer" > 30000
    clearignore 
    settimer "ClearIgnoreTimer" 0
endif 

if timer "ClearSysmsgTimer"> 30000
    clearsysmsg
    settimer "ClearSysmsgTimer" 0
endif 


    //////////////////////
    //  INITIAL SETUP:  //
    //////////////////////

if not dead
    if not varexist DexxerAutoPilot
        overhead "Lord Glacier's Chill Dexxer Auto Pilot Script" 2234
        # '
        overhead "version 2.1.9" 2234
        wait 1000
        overhead "Last Updated: September 10, 2025" 88
        wait 2500
        overhead "Thank you for trying my Dexxer AUTO PILOT script!  It appears this may be your first time running it..." 0
        wait 4000
        overhead "IMPT: Please make sure to check and adjust your required VARIABLES!" 153
        wait 3500
        overhead "Read the TIPS section at the beginning of the script for more info" 0
        wait 4000
        setvar DexxerAutoPilot 1
        sysmsg "Beginning Lord Glacier's Chill Dexxer Auto Pilot script...... " 88
        # '
        wait 1000
    endif

    if EnableAutoRedRecall = 1 or EnableAutoWeightRecall = 1 or EnableRecallAfterResurrection = 1 or EnableRecallAfterDungeonGate = 1  and EnableDIYRecallScript != 1
        if not varexist AutoRecallChargedRunebook
            wait 500
            overhead "Please select your escape runebook..." 253
            wait 500
            overhead "You have enabled Auto Recall (PK or Weight) and must select a charged runebook to continue..." 0
            setvar AutoRecallChargedRunebook
            sysmsg "Does not work with casting (Recall Scrolls in Runebook only - to first location) uness you modify the script." 153
            wait 1500
        endif
    endif

    if EnableAutoRedRecall = 1 or EnableAutoWeightRecall = 1 or EnableRecallAfterResurrection = 1 or EnableRecallAfterDungeonGate = 1 and EnableLootChest = 1
        if not varexist LootChest
            wait 500
            overhead "Please select a secure container to store your Loot..." 253
            sysmsg "Can be disabled under script variables section." 0
            wait 1000
            overhead "Anything that will not go into a Resource Stockpile, Storage Shelf, Tomes or Magic Recycler" 0
            overhead "(ie. Skill Orbs, Research Mats, Paragon chests, etc.)"
            setvar LootChest
            sysmsg "Use Razor Organizer Agents 06 - 09 for the Loot Chest and its contents - organize to your own liking!" 0
            wait 1500
        endif
    endif

    if EnableLootBag = 1 and IHAVEDIED != 1
        if EnableAutoRedRecall = 1 or EnableAutoWeightRecall = 1 or EnableRecallAfterResurrection = 1 or EnableRecallAfterDungeonGate = 1
            if not varexist LootBag
                wait 500
                overhead "Please select your loot bag..." 253
                wait 1000
                overhead "This should be whatever is set as your 'Grab Bag' and will be opened when unloading loot after recalling..." 0
                @setvar! LootBag
                wait 500
                while targetexists
                    wait 100
                endwhile
            endif
            if not find LootBag self
                sysmsg "Loot Bag not found!" 0
                wait 500
                overhead "Select your new loot bag..." 253
                wait 500
                @setvar! LootBag
                wait 500
                while targetexists
                    wait 100
                endwhile
            endif
        endif
    endif

    if not varexist FirstRunDexxer
        overhead "Ok, looks like you are all set!" 84
        wait 2000
        overhead "Good luck out there!" 2234
        overhead "         - Dan (aka. Lord Glacier)" 2234
        wait 1500
        setvar FirstRunDexxer 1
    endif
endif



        ###############################
       ###    SCRIPT STARTS HERE:    ###
        ###############################


////////////////////////
//  BEGIN ALIVE LOOP  //
////////////////////////

while not dead
    if EnableTrackingAutoRecall = 1 and skill 'Tracking' > 50
        if not findbuff 'tracking'
            while not gumpexists 4267467659
                useskill 'tracking'
                wait 250
            endwhile
            if gumpexists 4267467659
                while not insysmsg "You will now hunt all hostile players."
                    gumpresponse 8 4267467659
                    waitforgump 4267467659 5000
                endwhile
                gumpresponse 6 4267467659
                wait 500
                clearsysmsg
            endif
            gumpclose 4267467659
            if EnableOverheadMessages = 1
                overhead "[ RED RECALL ACTIVATED! ]" 334
            endif
        endif
    endif

    if EnableTrackingAutoRecall = 1
        if PKTrackingRange = 60
            if insysmsg ": 60 step" or insysmsg "60 space" or insysmsg ": 59 step" or insysmsg "59 space" or insysmsg ": 58 step" or insysmsg "58 space" or insysmsg ": 57 step" or insysmsg "57 space" or insysmsg ": 56 step" or insysmsg "56 space" or insysmsg ": 55 step" or insysmsg "55 space" or insysmsg ": 54 step" or insysmsg "54 space" or insysmsg ": 53 step" or insysmsg "53 space" or insysmsg ": 52 step" or insysmsg "52 space" or insysmsg ": 51 step" or insysmsg "51 space" or insysmsg ": 50 step" or insysmsg "50 space" or insysmsg ": 49 step" or insysmsg "49 space" or insysmsg ": 48 step" or insysmsg "48 space" or insysmsg ": 47 step" or insysmsg "47 space" or insysmsg ": 46 step" or insysmsg "46 space" or insysmsg ": 45 step" or insysmsg "45 space" or insysmsg ": 44 step" or insysmsg "44 space" or insysmsg ": 43 step" or insysmsg "43 space" or insysmsg ": 42 step" or insysmsg "42 space" or insysmsg ": 41 step" or insysmsg "41 space" or insysmsg ": 40 step" or insysmsg "40 space" or insysmsg ": 39 step" or insysmsg "39 space" or insysmsg ": 38 step" or insysmsg "38 space" or insysmsg ": 37 step" or insysmsg "37 space" or insysmsg ": 36 step" or insysmsg "36 space" or insysmsg ": 35 step" or insysmsg "35 space" or insysmsg ": 34 step" or insysmsg "34 space" or insysmsg ": 33 step" or insysmsg "33 space" or insysmsg ": 32 step" or insysmsg "32 space" or insysmsg ": 31 step" or insysmsg "31 space" or insysmsg ": 30 step" or insysmsg "30 space" or insysmsg ": 29 step" or insysmsg "29 space" or insysmsg ": 28 step" or insysmsg "28 space" or insysmsg ": 27 step" or insysmsg "27 space" or insysmsg ": 26 step" or insysmsg "26 space" or insysmsg ": 25 step" or insysmsg "25 space" or insysmsg ": 24 step" or insysmsg "24 space" or insysmsg ": 23 step" or insysmsg "23 space" or insysmsg ": 22 step" or insysmsg "22 space" or insysmsg ": 21 step" or insysmsg "21 space" or insysmsg ": 20 step" or insysmsg "20 space" or insysmsg ": 19 step" or insysmsg "19 space" or insysmsg ": 18 step" or insysmsg "18 space" or insysmsg ": 17 step" or insysmsg "17 space" or insysmsg ": 16 step" or insysmsg "16 space" or insysmsg ": 15 step" or insysmsg "15 space" or insysmsg ": 14 step" or insysmsg "14 space" or insysmsg ": 13 step" or insysmsg "13 space" or insysmsg ": 12 step" or insysmsg "12 space" or insysmsg ": 11 step" or insysmsg "11 space" or insysmsg ": 10 step" or insysmsg "10 space" or insysmsg ": 9 step" or insysmsg "(9 space" or insysmsg ": 8 step" or insysmsg "(8 space" or insysmsg ": 7 step" or insysmsg "(7 space" or insysmsg ": 6 step" or insysmsg "(6 space" or insysmsg ": 5 step" or insysmsg "(5 space" or insysmsg ": 4 step" or insysmsg "(4 space" or insysmsg ": 3 step" or insysmsg "(3 space" or insysmsg ": 2 step" or insysmsg "(2 space" or insysmsg ": 1 step" or insysmsg "(1 space" or insysmsg ": 0 step" or insysmsg "(0 space"
                hotkey 'Toggle War Only'
                if EnableRedAlertOverhead = 1
                    overhead "[ !! RED ALERT !! ]" 37
                endif
                @setvar! RedTargetFound 1
                @setvar! WarModeToggledWhileFighting 0
                clearsysmsg
            endif
        elseif PKTrackingRange = 50
            if insysmsg ": 50 step" or insysmsg "50 space" or insysmsg ": 49 step" or insysmsg "49 space" or insysmsg ": 48 step" or insysmsg "48 space" or insysmsg ": 47 step" or insysmsg "47 space" or insysmsg ": 46 step" or insysmsg "46 space" or insysmsg ": 45 step" or insysmsg "45 space" or insysmsg ": 44 step" or insysmsg "44 space" or insysmsg ": 43 step" or insysmsg "43 space" or insysmsg ": 42 step" or insysmsg "42 space" or insysmsg ": 41 step" or insysmsg "41 space" or insysmsg ": 40 step" or insysmsg "40 space" or insysmsg ": 39 step" or insysmsg "39 space" or insysmsg ": 38 step" or insysmsg "38 space" or insysmsg ": 37 step" or insysmsg "37 space" or insysmsg ": 36 step" or insysmsg "36 space" or insysmsg ": 35 step" or insysmsg "35 space" or insysmsg ": 34 step" or insysmsg "34 space" or insysmsg ": 33 step" or insysmsg "33 space" or insysmsg ": 32 step" or insysmsg "32 space" or insysmsg ": 31 step" or insysmsg "31 space" or insysmsg ": 30 step" or insysmsg "30 space" or insysmsg ": 29 step" or insysmsg "29 space" or insysmsg ": 28 step" or insysmsg "28 space" or insysmsg ": 27 step" or insysmsg "27 space" or insysmsg ": 26 step" or insysmsg "26 space" or insysmsg ": 25 step" or insysmsg "25 space" or insysmsg ": 24 step" or insysmsg "24 space" or insysmsg ": 23 step" or insysmsg "23 space" or insysmsg ": 22 step" or insysmsg "22 space" or insysmsg ": 21 step" or insysmsg "21 space" or insysmsg ": 20 step" or insysmsg "20 space" or insysmsg ": 19 step" or insysmsg "19 space" or insysmsg ": 18 step" or insysmsg "18 space" or insysmsg ": 17 step" or insysmsg "17 space" or insysmsg ": 16 step" or insysmsg "16 space" or insysmsg ": 15 step" or insysmsg "15 space" or insysmsg ": 14 step" or insysmsg "14 space" or insysmsg ": 13 step" or insysmsg "13 space" or insysmsg ": 12 step" or insysmsg "12 space" or insysmsg ": 11 step" or insysmsg "11 space" or insysmsg ": 10 step" or insysmsg "10 space" or insysmsg ": 9 step" or insysmsg "(9 space" or insysmsg ": 8 step" or insysmsg "(8 space" or insysmsg ": 7 step" or insysmsg "(7 space" or insysmsg ": 6 step" or insysmsg "(6 space" or insysmsg ": 5 step" or insysmsg "(5 space" or insysmsg ": 4 step" or insysmsg "(4 space" or insysmsg ": 3 step" or insysmsg "(3 space" or insysmsg ": 2 step" or insysmsg "(2 space" or insysmsg ": 1 step" or insysmsg "(1 space" or insysmsg ": 0 step" or insysmsg "(0 space"
                hotkey 'Toggle War Only'
                if EnableRedAlertOverhead = 1
                    overhead "[ !! RED ALERT !! ]" 37
                endif
                @setvar! RedTargetFound 1
                @setvar! WarModeToggledWhileFighting 0
                clearsysmsg
            endif
        elseif PKTrackingRange = 40
            if insysmsg ": 40 step" or insysmsg "40 space" or insysmsg ": 39 step" or insysmsg "39 space" or insysmsg ": 38 step" or insysmsg "38 space" or insysmsg ": 37 step" or insysmsg "37 space" or insysmsg ": 36 step" or insysmsg "36 space" or insysmsg ": 35 step" or insysmsg "35 space" or insysmsg ": 34 step" or insysmsg "34 space" or insysmsg ": 33 step" or insysmsg "33 space" or insysmsg ": 32 step" or insysmsg "32 space" or insysmsg ": 31 step" or insysmsg "31 space" or insysmsg ": 30 step" or insysmsg "30 space" or insysmsg ": 29 step" or insysmsg "29 space" or insysmsg ": 28 step" or insysmsg "28 space" or insysmsg ": 27 step" or insysmsg "27 space" or insysmsg ": 26 step" or insysmsg "26 space" or insysmsg ": 25 step" or insysmsg "25 space" or insysmsg ": 24 step" or insysmsg "24 space" or insysmsg ": 23 step" or insysmsg "23 space" or insysmsg ": 22 step" or insysmsg "22 space" or insysmsg ": 21 step" or insysmsg "21 space" or insysmsg ": 20 step" or insysmsg "20 space" or insysmsg ": 19 step" or insysmsg "19 space" or insysmsg ": 18 step" or insysmsg "18 space" or insysmsg ": 17 step" or insysmsg "17 space" or insysmsg ": 16 step" or insysmsg "16 space" or insysmsg ": 15 step" or insysmsg "15 space" or insysmsg ": 14 step" or insysmsg "14 space" or insysmsg ": 13 step" or insysmsg "13 space" or insysmsg ": 12 step" or insysmsg "12 space" or insysmsg ": 11 step" or insysmsg "11 space" or insysmsg ": 10 step" or insysmsg "10 space" or insysmsg ": 9 step" or insysmsg "(9 space" or insysmsg ": 8 step" or insysmsg "(8 space" or insysmsg ": 7 step" or insysmsg "(7 space" or insysmsg ": 6 step" or insysmsg "(6 space" or insysmsg ": 5 step" or insysmsg "(5 space" or insysmsg ": 4 step" or insysmsg "(4 space" or insysmsg ": 3 step" or insysmsg "(3 space" or insysmsg ": 2 step" or insysmsg "(2 space" or insysmsg ": 1 step" or insysmsg "(1 space" or insysmsg ": 0 step" or insysmsg "(0 space"
                hotkey 'Toggle War Only'
                if EnableRedAlertOverhead = 1
                    overhead "[ !! RED ALERT !! ]" 37
                endif
                @setvar! RedTargetFound 1
                @setvar! WarModeToggledWhileFighting 0
                clearsysmsg
            endif
        elseif PKTrackingRange = 0
            if insysmsg "Now tracking"
                hotkey 'Toggle War Only'
                if EnableRedAlertOverhead = 1
                    overhead "[ !! RED ALERT !! ]" 37
                endif
                @setvar! RedTargetFound 1
                @setvar! WarModeToggledWhileFighting 0
                clearsysmsg
            endif
        endif
    endif

    if EnablePKradar = 1
        if timer "PKRadar" > 1000
            hotkey 'Next Murderer Player Target'
            wait 250
            if insysmsg "No one matching that was found"
                settimer "PKRadar" 0
                clearsysmsg
            else
                hotkey 'Toggle War Only'
                @setvar! RedTargetFound 1
                @setvar! WarModeToggledWhileFighting 0
                @setvar! TimeToGo 1
                @setvar! MurdererTarget lasttarget
            endif
        endif
    endif

    if paralyzed and EnableAutoParalyzePouch = 1
        if findtype "pouch" self
            yell "[pouch"
            wait 250
            hotkey 'Toggle War Only'
            @setvar! RedTargetFound 1
            @setvar! WarModeToggledWhileFighting 0
            @setvar! TimeToGo 1
        else
            if timer pouchMessageTimer > 5000 and EnableOverheadMessages = 1
                overhead "[ NO MORE POUCHES! ]" 337
                settimer pouchMessageTimer 0
            endif
        endif
    endif

    if EnableDropGoldWhenOverweight = 1
        if weight > maxweight and diffhits < ActivateAutoHealHPdiff 
            if timer overweightMessageTimer > 4500
                overhead "[ OVERWEIGHT! ]" 34
                settimer overweightMessageTimer 0
            endif

            if DropGoldAmount != 0
                clearignore
                @setvar! DisableVacuums 1
                wait 250 

                if EnablePutLootinLockBox = 1
                    if findtype "wooden box" self as lockbox
                        if findtype "copper key" self as key
                            clearignore
                            getlabel lockbox lockboxlabel
                            wait 100
                            if "items" in lockboxlabel
                                // Do nothing
                            else
                                dclick key
                                wft 1500
                                target lockbox
                                if EnableOverheadMessages = 1
                                    overhead "[loot box unlocked]" 84
                                endif
                                wait 500
                                if insysmsg "It appears to be locked."
                                    dclick key
                                    wft 1500
                                    target lockbox
                                    wait 250
                                endif
                            endif
                        elseif EnableOverheadMessages = 1
                            overhead "[ NO LOCKBOX KEY! ]" 337
                        endif
                    endif
                endif

                while weight > maxweight and diffhits < ActivateAutoHealHPdiff 
                    if findtype "gold coin" self as easycomeeasygo
                        lift easycomeeasygo DropGoldAmount
                        droprelloc 0 0
                        getlabel backpack packdesc
                        if EnableOverheadMessages = 1
                            overhead "[ DROPPING GOLD... ]" 149
                        endif
                        wait 250
                        if insysmsg "cannot drop anything"
                            drop backpack -1 -1 -1
                            break 
                        endif
                        wait 250
                    else 
                        break 
                    endif
                    if diffhits > ActivateAutoHealHPdiff 
                        break
                    endif 
                endwhile

                if diffhits > ActivateAutoHealHPdiff 
                    break
                endif 
            endif
        endif
    endif 


    ///////////////////////////
    //  BEGIN AUTO HEALING:  //
    ///////////////////////////

    while diffhits >= ActivateAutoHealHPdiff or poisoned 
        if dead
            replay
        endif

        if paralyzed and EnableAutoParalyzePouch = 1
            if findtype "pouch" self
                yell "[pouch"
                wait 250
                hotkey 'Toggle War Only'
                @setvar! RedTargetFound 1
                @setvar! WarModeToggledWhileFighting 0
                @setvar! TimeToGo 1
            else
                if timer pouchMessageTimer > 5000 and EnableOverheadMessages = 1
                    overhead "[ NO MORE POUCHES! ]" 337
                    settimer pouchMessageTimer 0
                endif
            endif
        endif

        if EnableHealPotion = 1 and diffhits >= HealPotionHPdiff
            if findtype "Yellow Potion" self as HealPot
                getlabel HealPot HealPotlabel
                if "next" in HealPotlabel
                    // Do nothing
                else
                    @setvar! HealPotionCheck 0

                    if counttype 3852 self as HealPotCount
                        @setvar! HealPotionCheck HealPotCount
                    endif

                    clearsysmsg
                    dclicktype 3852
                    getlabel backpack backpackdesc
                    wait 250

                    if HealPotionCheck != counttype 3852 self or insysmsg "potion satchel used"
                        settimer 'HealPotionTimer' 0
                        cooldown "Healing Potion" HealingPotionCooldown
                        if EnableOverheadMessages = 1
                            if insysmsg "potion satchel used"
                                overhead '[ FREE HEAL POTION ]' 253
                            else
                                overhead "[ HEAL POTION ]" 253
                            endif
                        endif 
                        clearsysmsg
                    endif
                endif
            else
                if timer 'yellowMessageTimer' > 4500
                    overhead "[ NO HEAL POTS! ]" 337
                    settimer 'yellowMessageTimer' 0
                endif
            endif
        endif

        if diffhits > 0 and not bandaging
            if skill 'healing' >= 30
                if findtype 'clean bandage%s%' self
                    if targetexists
                        hotkey 'cancel current target'
                    endif
                    hotkey 'Bandage Self'
                    if EnableOverheadMessages = 1 
                        if aidsMessageTimer > 5000
                            overhead "[ BANDAGING... ]" 88
                            settimer aidsMessageTimer 0
                            wait 500
                        endif
                    endif
                else
                    if timer aidsMessageTimer > 5000 and EnableOverheadMessages = 1
                        overhead "[ OUT OF BANDAGES! ]" 337
                        settimer aidsMessageTimer 0
                    endif
                endif
            endif
        endif

        if EnableCurePotion = 1
            while poisoned
                if findtype "Orange Potion" self
                    dclicktype "Orange Potion"
                    if EnableOverheadMessages = 1 and timer 'orangeMessageTimer' > 3500
                        overhead "[ CURE POTION ]" 44
                        settimer 'orangeMessageTimer' 0
                    endif
                    wait 250
                else
                    if timer 'orangeMessageTimer' > 5000
                        overhead "[ NO CURE POTS! ]" 337
                        settimer 'orangeMessageTimer' 0
                    endif
                endif
                if diffhits > 40
                    break
                endif
            endwhile
        endif

        while not gumpexists 1387930325
            say "[ChivalryHotbar"
        endwhile

        if gumpexists 1387930325
            if ingump "12/" 1387930325
                @setvar! HolySymbols 12
                @setvar! HolyLightAvailable 1
                @setvar! NobleSacrificeAvailable 1
                @setvar! CleanseByFireAvailable 1
                @setvar! CloseWoundsAvailable 1
                @setvar! DivineFuryAvailable 1
                @setvar! EnemyOfOneAvailable 1
                @setvar! ConsecrateWeaponAvailable 1
            elseif ingump "13/" 1387930325
                @setvar! HolySymbols 13
                @setvar! HolyLightAvailable 1
                @setvar! NobleSacrificeAvailable 1
                @setvar! CleanseByFireAvailable 1
                @setvar! CloseWoundsAvailable 1
                @setvar! DivineFuryAvailable 1
                @setvar! EnemyOfOneAvailable 1
                @setvar! ConsecrateWeaponAvailable 1
            elseif ingump "14/" 1387930325
                @setvar! HolySymbols 14
                @setvar! HolyLightAvailable 1
                @setvar! NobleSacrificeAvailable 1
                @setvar! CleanseByFireAvailable 1
                @setvar! CloseWoundsAvailable 1
                @setvar! DivineFuryAvailable 1
                @setvar! EnemyOfOneAvailable 1
                @setvar! ConsecrateWeaponAvailable 1
            elseif ingump "15/" 1387930325
                @setvar! HolySymbols 15
                @setvar! HolyLightAvailable 1
                @setvar! NobleSacrificeAvailable 1
                @setvar! CleanseByFireAvailable 1
                @setvar! CloseWoundsAvailable 1
                @setvar! DivineFuryAvailable 1
                @setvar! EnemyOfOneAvailable 1
                @setvar! ConsecrateWeaponAvailable 1
            elseif ingump "16/" 1387930325
                @setvar! HolySymbols 16
                @setvar! HolyLightAvailable 1
                @setvar! NobleSacrificeAvailable 1
                @setvar! CleanseByFireAvailable 1
                @setvar! CloseWoundsAvailable 1
                @setvar! DivineFuryAvailable 1
                @setvar! EnemyOfOneAvailable 1
                @setvar! ConsecrateWeaponAvailable 1
            elseif ingump "17/" 1387930325
                @setvar! HolySymbols 17
                @setvar! HolyLightAvailable 1
                @setvar! NobleSacrificeAvailable 1
                @setvar! CleanseByFireAvailable 1
                @setvar! CloseWoundsAvailable 1
                @setvar! DivineFuryAvailable 1
                @setvar! EnemyOfOneAvailable 1
                @setvar! ConsecrateWeaponAvailable 1
            elseif ingump "18/" 1387930325
                @setvar! HolySymbols 18
                @setvar! HolyLightAvailable 1
                @setvar! NobleSacrificeAvailable 1
                @setvar! CleanseByFireAvailable 1
                @setvar! CloseWoundsAvailable 1
                @setvar! DivineFuryAvailable 1
                @setvar! EnemyOfOneAvailable 1
                @setvar! ConsecrateWeaponAvailable 1
            elseif ingump "19/" 1387930325
                @setvar! HolySymbols 19
                @setvar! HolyLightAvailable 1
                @setvar! NobleSacrificeAvailable 1
                @setvar! CleanseByFireAvailable 1
                @setvar! CloseWoundsAvailable 1
                @setvar! DivineFuryAvailable 1
                @setvar! EnemyOfOneAvailable 1
                @setvar! ConsecrateWeaponAvailable 1
            elseif ingump "20/" 1387930325
                @setvar! HolySymbols 20
                @setvar! HolyLightAvailable 1
                @setvar! NobleSacrificeAvailable 1
                @setvar! CleanseByFireAvailable 1
                @setvar! CloseWoundsAvailable 1
                @setvar! DivineFuryAvailable 1
                @setvar! EnemyOfOneAvailable 1
                @setvar! ConsecrateWeaponAvailable 1
            elseif ingump "21/" 1387930325
                @setvar! HolySymbols 21
                @setvar! HolyLightAvailable 1
                @setvar! NobleSacrificeAvailable 1
                @setvar! CleanseByFireAvailable 1
                @setvar! CloseWoundsAvailable 1
                @setvar! DivineFuryAvailable 1
                @setvar! EnemyOfOneAvailable 1
                @setvar! ConsecrateWeaponAvailable 1
            elseif ingump "11/" 1387930325
                @setvar! HolySymbols 11
                @setvar! HolyLightAvailable 1
                @setvar! NobleSacrificeAvailable 1
                @setvar! CleanseByFireAvailable 1
                @setvar! CloseWoundsAvailable 1
                @setvar! DivineFuryAvailable 1
                @setvar! EnemyOfOneAvailable 1
                @setvar! ConsecrateWeaponAvailable 1
            elseif ingump "10/" 1387930325
                @setvar! HolySymbols 10
                @setvar! HolyLightAvailable 1
                @setvar! NobleSacrificeAvailable 1
                @setvar! CleanseByFireAvailable 1
                @setvar! CloseWoundsAvailable 1
                @setvar! DivineFuryAvailable 1
                @setvar! EnemyOfOneAvailable 1
                @setvar! ConsecrateWeaponAvailable 1
            elseif ingump "9/" 1387930325
                @setvar! HolySymbols 9
                @setvar! HolyLightAvailable 1
                @setvar! NobleSacrificeAvailable 1
                @setvar! CleanseByFireAvailable 1
                @setvar! CloseWoundsAvailable 1
                @setvar! DivineFuryAvailable 1
                @setvar! EnemyOfOneAvailable 1
                @setvar! ConsecrateWeaponAvailable 1
            elseif ingump "8/" 1387930325
                @setvar! HolySymbols 8
                @setvar! HolyLightAvailable 1
                @setvar! NobleSacrificeAvailable 1
                @setvar! CleanseByFireAvailable 1
                @setvar! CloseWoundsAvailable 1
                @setvar! DivineFuryAvailable 1
                @setvar! EnemyOfOneAvailable 1
                @setvar! ConsecrateWeaponAvailable 1
            elseif ingump "7/" 1387930325
                @setvar! HolySymbols 7
                @setvar! HolyLightAvailable 1
                @setvar! NobleSacrificeAvailable 1
                @setvar! CleanseByFireAvailable 1
                @setvar! CloseWoundsAvailable 1
                @setvar! DivineFuryAvailable 1
                @setvar! EnemyOfOneAvailable 0
                @setvar! ConsecrateWeaponAvailable 1
            elseif ingump "6/" 1387930325
                @setvar! HolySymbols 6
                @setvar! HolyLightAvailable 1
                @setvar! NobleSacrificeAvailable 1
                @setvar! CleanseByFireAvailable 0
                @setvar! CloseWoundsAvailable 0
                @setvar! DivineFuryAvailable 0
                @setvar! EnemyOfOneAvailable 0
                @setvar! ConsecrateWeaponAvailable 0
            elseif ingump "5/" 1387930325
                @setvar! HolySymbols 5
                @setvar! HolyLightAvailable 1
                @setvar! NobleSacrificeAvailable 1
                @setvar! CleanseByFireAvailable 0
                @setvar! CloseWoundsAvailable 0
                @setvar! DivineFuryAvailable 0
                @setvar! EnemyOfOneAvailable 0
                @setvar! ConsecrateWeaponAvailable 0
            elseif ingump "4/" 1387930325
                @setvar! HolySymbols 4
                @setvar! HolyLightAvailable 0
                @setvar! NobleSacrificeAvailable 1
                @setvar! CleanseByFireAvailable 0
                @setvar! CloseWoundsAvailable 0
                @setvar! DivineFuryAvailable 0
                @setvar! EnemyOfOneAvailable 0
                @setvar! ConsecrateWeaponAvailable 0
            elseif ingump "3/" 1387930325
                @setvar! HolySymbols 3
                @setvar! HolyLightAvailable 0
                @setvar! NobleSacrificeAvailable 0
                @setvar! CleanseByFireAvailable 0
                @setvar! CloseWoundsAvailable 0
                @setvar! DivineFuryAvailable 0
                @setvar! EnemyOfOneAvailable 0
                @setvar! ConsecrateWeaponAvailable 0
            elseif ingump "2/" 1387930325
                @setvar! HolySymbols 2
                @setvar! HolyLightAvailable 0
                @setvar! NobleSacrificeAvailable 0
                @setvar! CleanseByFireAvailable 0
                @setvar! CloseWoundsAvailable 0
                @setvar! DivineFuryAvailable 0
                @setvar! EnemyOfOneAvailable 0
                @setvar! ConsecrateWeaponAvailable 0
            elseif ingump "1/" 1387930325
                @setvar! HolySymbols 1
                @setvar! HolyLightAvailable 0
                @setvar! NobleSacrificeAvailable 0
                @setvar! CleanseByFireAvailable 0
                @setvar! CloseWoundsAvailable 0
                @setvar! DivineFuryAvailable 0
                @setvar! EnemyOfOneAvailable 0
                @setvar! ConsecrateWeaponAvailable 0
            elseif ingump "0/" 1387930325
                @setvar! HolySymbols 0
                @setvar! HolyLightAvailable 0
                @setvar! NobleSacrificeAvailable 0
                @setvar! CleanseByFireAvailable 0
                @setvar! CloseWoundsAvailable 0
                @setvar! DivineFuryAvailable 0
                @setvar! EnemyOfOneAvailable 0
                @setvar! ConsecrateWeaponAvailable 0
            endif
        endif

        if EnableNobleSacrifice = 1
            if diffhits >= NobleSacrificeHPdiff and skill "Chivalry" >= 80 and timer 'NobleSacrificeTimer' > 31000 and timer 'ChivalryPrevented' > 5000 and NobleSacrificeAvailable = 1
                clearsysmsg
                yell "[NobleSacrifice"
                wait 250
                if insysmsg "You do not have enough holy"
                    settimer 'ChivalryPrevented' 0
                    clearsysmsg
                else
                    wft 1000
                    target 'self'
                    if EnableOverheadMessages = 1
                        overhead "[ NOBLE SACRIFICE! ]" 155
                    endif
                    settimer 'NobleSacrificeTimer' 0
                    cooldown "Noble Sacrifice" 31000
                    settimer 'ChivalryPrevented' 4000
                endif
                wait 250
            endif
        endif

        if EnableHolyLight = 1
            if diffhits >= HolyLightHPdiff and skill "Chivalry" >= 95 and timer 'HolyLightTimer' > 31000 and timer 'ChivalryPrevented' > 5000 and HolyLightAvailable = 1
                clearsysmsg
                yell "[HolyLight"
                wait 250
                if insysmsg "You do not have enough holy"
                    settimer 'ChivalryPrevented' 0
                    clearsysmsg
                else
                    if EnableOverheadMessages = 1
                        overhead "[ HOLY LIGHT! ]" 254
                    endif
                    settimer 'HolyLightTimer' 0
                    cooldown "Holy Light" 31000
                    settimer 'ChivalryPrevented' 4000
                endif
                wait 250
            endif
        endif

        if timer "AttackingTimer" > 500 and find ClosestTarget ground -1 -1 TargetAttackRange 
            attack ClosestTarget
            settimer "AttackingTimer" 0
        endif

        if EnableRefreshPotion = 1 and diffstam >= RefreshPotionSPdiff
            if findtype "Red Potion" self
                dclicktype "Red Potion"
                if EnableOverheadMessages = 1
                    overhead "[ REFRESH POTION ]" 37
                endif
                wait 250
            else
                if timer redMessageTimer > 4500
                    overhead "[ NO REFRESH POTS! ]" 337
                    settimer redMessageTimer 0
                endif
            endif
        endif

        if insysmsg "world is saving"
            settimer "WorldSaveTimer" 0
            if EnableOverheadMessages = 1
                overhead "[ WORLD SAVING... ]" 253
            endif
            while timer "WorldSaveTimer" < 4500
                if insysmsg "save complete"
                    break
                endif
                wait 100
            endwhile
            if EnableOverheadMessages = 1
                overhead "[ SAVE COMPLETE! ]" 253
            endif
        endif

        if EnableWeightWarningMessage = 1
            if diffweight < GreenWarningDiffWeight and diffweight > YellowWarningDiffWeight and timer "WeightTimer" > 6000
                if EnableOverheadMessages = 1
                    overhead "[ WEIGHT WARNING... ]" 77
                    settimer "WeightTimer" 0
                else
                    overhead "  " 77
                    settimer "WeightTimer" 0
                endif
            elseif diffweight < YellowWarningDiffWeight and diffweight > RedWeightLimitDiffWeight and timer "WeightTimer" > 6000
                if EnableOverheadMessages = 1
                    overhead "[ WEIGHT WARNING! ]" 153
                    settimer "WeightTimer" 0
                else
                    overhead "  " 153
                    settimer "WeightTimer" 0
                endif
            elseif diffweight < RedWeightLimitDiffWeight and timer "WeightTimer" > 6000
                if EnableOverheadMessages = 1
                    overhead "[ WEIGHT LIMIT REACHED! ]" 37
                    settimer "WeightTimer" 0
                else
                    overhead "  " 37
                    settimer "WeightTimer" 0
                endif

                if EnableAutoWeightRecall = 1 and not find ClosestTarget ground -1 -1 8 and WILDERNESSMODE = 1
                    wait 1000
                    hotkey 'Toggle War Only'
                    @setvar! AutoWeightRecall 1
                    @setvar! WarModeToggledWhileFighting 0
                    break
                elseif EnableAutoWeightRecall = 1 and find ClosestTarget ground -1 -1 8 and WILDERNESSMODE = 1
                    if timer "RECALLDELAY" > 3500 and EnableAutoRecallOverheadMessages = 1
                        overhead "[ WAITING TO RECALL... ]" 149
                        settimer "RECALLDELAY" 0
                    endif
                    wait 500
                elseif EnableAutoWeightDungeonGate = 1 and DUNGEONMODE = 1
                    wait 500
                    hotkey 'Toggle War Only'
                    @setvar! TimeToGo 1
                    break
                else
                    if EnableOverheadMessages = 1
                        overhead "[ OVERWEIGHT! ]" 337
                    else
                        overhead "  " 337
                    endif
                    wait 1500
                    overhead "[ STOPPING SCRIPT! ]" 88
                endif
            endif
        endif

        if EnableUsePotionKegs = 1 and findtype 'empty bottle%s%' self and findtype 'keg' self
            @setvar! PotionStockCheck 0
            while PotionStockCheck < 7 and findtype 'empty bottle%s%' self
                if PotionStockCheck = 0 and ExplosionPotionAmount != 0
                    @setvar! PotionType 3853
                    @setvar! KegColour 419
                    @setvar! PotionAmounttoFill ExplosionPotionAmount
                    @setvar! PotionStockCheck 1
                elseif PotionStockCheck = 1 and HealingPotionAmount != 0
                    @setvar! PotionType 3852
                    @setvar! KegColour 253
                    @setvar! PotionAmounttoFill HealingPotionAmount
                    @setvar! PotionStockCheck 2
                elseif PotionStockCheck = 2 and CurePotionAmount != 0
                    @setvar! PotionType 3847
                    @setvar! KegColour 44
                    @setvar! PotionAmounttoFill CurePotionAmount
                    @setvar! PotionStockCheck 3
                elseif PotionStockCheck = 3 and RefreshPotionAmount != 0
                    @setvar! PotionType 3851
                    @setvar! KegColour 37
                    @setvar! PotionAmounttoFill RefreshPotionAmount
                    @setvar! PotionStockCheck 4
                elseif PotionStockCheck = 4 and StrengthPotionAmount != 0
                    @setvar! PotionType 3849
                    @setvar! KegColour 956
                    @setvar! PotionAmounttoFill StrengthPotionAmount
                    @setvar! PotionStockCheck 5
                elseif PotionStockCheck = 5 and AgilityPotionAmount != 0
                    @setvar! PotionType 3848
                    @setvar! KegColour 93
                    @setvar! PotionAmounttoFill AgilityPotionAmount
                    @setvar! PotionStockCheck 6
                elseif PotionStockCheck = 6 and ResistPotionAmount != 0
                    @setvar! PotionType 3846
                    @setvar! KegColour 1109
                    @setvar! PotionAmounttoFill ResistPotionAmount
                    @setvar! PotionStockCheck 7
                else
                    break
                endif
                
                while counttype PotionType self < PotionAmounttoFill
                    if timer "AttackingTimer" > 500 and find ClosestTarget ground -1 -1 TargetAttackRange 
                        attack ClosestTarget
                        settimer "AttackingTimer" 0
                    endif
                    
                    if not findtype 'empty bottle%s%' self
                        if EnableOverheadMessages = 1 and timer 'PotionKegTimer' > 5000
                            overhead "[ NO EMPTY BOTTLES... ]" 337
                            settimer 'PotionKegTimer' 0 
                        endif
                        break
                    endif
                    
                    if findtype 'keg' self KegColour as myKeg
                        dclick myKeg
                        wait 250
                        if EnableOverheadMessages = 1
                            if timer 'PotionKegTimer' > 2000
                                overhead '[ FILLING POTS... ]' KegColour
                                settimer 'PotionKegTimer' 0
                            endif
                        endif
                    else 
                        if EnableOverheadMessages = 1 and timer 'PotionKegTimer' > 5000
                            overhead "[ NO KEG TO USE... ]" KegColour
                            settimer 'PotionKegTimer' 0 
                        endif
                        break
                    endif
                endwhile
                
                if counttype PotionType self < PotionAmounttoFill and not findtype 'empty bottle%s%' self
                    if EnableOverheadMessages = 1 and timer 'PotionKegTimer' > 5000
                        overhead "[ NO EMPTY BOTTLES... ]" 337
                        settimer 'PotionKegTimer' 0 
                    endif
                    break
                endif
            endwhile
        endif
    endwhile

    ////////////////////////
    //  END HEALING LOOP  //
    ////////////////////////


    //////////////////////////
    //  BEGIN AUTO RECALL:  //
    //////////////////////////

    if warmode on and WarModeToggledWhileFighting != 1
        if EnableStandYourGround = 1 and RedTargetFound = 1
            settimer "TargetAcquired" 4000
            settimer "NoTargetTimer" 4000
            while find MurdererTarget ground -1 -1 16
                if noto MurdererTarget = "Murderer" and find MurdererTarget ground -1 -1 8

                    if timer "NoTargetTimer" < 4000
                        if EnableOverheadMessages = 1
                            overhead "[ STANDING GROUND! ]" 2114
                        else
                            overhead "  " 2114
                        endif
                        settimer "NoTargetTimer" 0
                    endif

                    if EnableAutoParalyzePouch = 1
                        if paralyzed
                            if findtype "pouch" self
                                yell "[pouch"
                            else
                                if EnableOverheadMessages = 1
                                    overhead "[ NO MORE POUCHES! ]" 337
                                endif
                            endif
                        endif
                    endif

                    if skill 'Healing' > 30
                        if not bandaging
                            if hp < maxhp or poisoned or findbuff "bleed" or findbuff "disease"
                                hotkey "Bandage Self"
                            endif
                        endif
                    endif

                    if timer "TargetAcquired" > 3500
                        if EnableOverheadMessages = 1
                            overhead " RED " 337 MurdererTarget
                        else
                            overhead "  " 337 MurdererTarget
                        endif
                        settimer "TargetAcquired" 0
                    endif

                    attack MurdererTarget
                    wait 500

                    if EnableSwitchToFastWeaponForPVP = 1
                        if skill 'Swordsmanship' >= 50 and not findtype '5119|5046|5185' hand
                            if findtype '5119|5046|5185' self as fastweapon
                                dclick fast weapon
                                wait 250
                            endif
                        elseif skill 'Mace Fighting' >= 50 and not findtype '5040|5044|5181' hand
                            if findtype '5040|5044|5181' self as fastweapon
                                dclick fast weapon
                                wait 250
                            endif
                        elseif skill 'Fencing' >= 50 and not findtype '5121' hand
                            if findtype '5121' self as fastweapon
                                dclick fast weapon
                                wait 500
                            endif
                        elseif skill 'Archery' >= 50 and not findtype '5042' hand
                            if findtype '5042' self as fastweapon
                                dclick fast weapon
                                wait 250
                            endif
                        endif
                        wait 500
                        if not findtype 'Order shield|heater shield|metal shield|Chaos shield|bone shield|bronze shield|buckler |kite shield|wooden shield|parrying gauche' lefthand
                            if findtype 'Order shield|heater shield|metal shield|Chaos shield|heater shield|bone shield|bronze shield|buckler |kite shield|wooden shield|parrying gauche' self as shield
                                dclick shield
                                wait 250
                            endif
                        endif
                    endif

                    if diffhits > 25 and timer 'HealPotionTimer' > HealingPotionCooldown
                        if findtype "Yellow Potion" self as healpot
                            dclick healpot
                            wait 250
                            settimer 'HealPotionTimer' 0
                            cooldown 'Healing Potion' HealingPotionCooldown
                        endif
                    endif

                    if poisoned
                        if findtype "Orange Potion" self as curepot
                            dclick curepot
                            wait 250
                        endif
                    endif

                    if stam < maxstam
                        if findtype "Red Potion" self as refreshpot
                            dclick refreshpot
                            wait 250
                        endif
                    endif

                    if findtype "Purple Potion" self as Molotov and skill 'Alchemy' >= 80
                        if find MurdererTarget ground -1 -1 12 and PurplePotionReady = 1
                            dclick Molotov
                            wft 1000
                            target MurdererTarget
                            cooldown "Purple Potion" 15000
                        endif
                    endif
                endif
            endwhile

            if EnableOverheadMessages = 1
                if timer "NoTargetTimer" > 4000
                    overhead "[ RED TARGET LOST... ]" 37
                    settimer "NoTargetTimer" 0
                endif
            else
                if timer "NoTargetTimer" > 4000
                    overhead "  " 37
                    settimer "NoTargetTimer" 0
                endif
            endif

            @setvar! RedTargetFound 0
            hotkey 'Toggle Peace Only'
            replay
        elseif EnableAutoWeightRecall = 1 and AutoWeightRecall = 1 and DUNGEONMODE != 1
            if EnableDIYRecallScript = 1
                @setvar! AutoWeightRecall 0
                foreach RecallScript in DIYRecallScriptList
                    script RecallScript
                endfor
            else
                if targetexists
                    hotkey 'Cancel Current Target'
                endif

                hotkey 'Toggle Peace only'
                clearsysmsg

                while not varexist AutoRecallChargedRunebook and EnableDIYRecallScript != 1
                    overhead "Select your escape runebook..." 253
                    @setvar! AutoRecallChargedRunebook
                    wait 2500
                endwhile

                while mana < 11
                    if timer "MANAWAIT" > 4000 and EnableOverheadMessages = 1
                        overhead "[ WAITING FOR MANA... ]" 12
                        settimer "MANAWAIT" 0
                    endif
                    wait 500
                endwhile
                    if EnableOverheadMessages = 1
                        overhead "[ AUTO WEIGHT RECALL! ]" 88
                        wait 1000
                    endif
                    @setvar! AutoWeightRecall 0

                @setvar! RECALLTIME 1
            endif
        elseif EnableAutoRedRecall = 1 and RedTargetFound = 1 and DUNGEONMODE != 1
            if EnableDIYRecallScript = 1
                @setvar! RedTargetFound 0
                foreach RecallScript in DIYRecallScriptList
                    script RecallScript
                endfor
            else
                if targetexists
                    hotkey 'Cancel Current Target'
                endif

                hotkey 'Toggle Peace only'
                clearsysmsg

                while not varexist AutoRecallChargedRunebook and EnableDIYRecallScript != 1
                    overhead "Select your escape runebook..." 253
                    @setvar! AutoRecallChargedRunebook
                    wait 2500
                endwhile

                while mana < 11
                    if timer "MANAWAIT" > 4000 and EnableOverheadMessages = 1
                        overhead "[ WAITING FOR MANA... ]" 12
                        settimer "MANAWAIT" 0
                    endif
                    wait 500
                endwhile

                @setvar! RECALLTIME 1
            endif
        elseif EnableRecallAfterDungeonGate = 1 and DungeonGateThenTimeToGo = 1
            if EnableDIYRecallScript = 1
                @setvar! DungeonGateThenTimeToGo 0
                foreach RecallScript in DIYRecallScriptList
                    script RecallScript
                endfor
            else
                if targetexists
                    hotkey 'Cancel Current Target'
                endif

                hotkey 'Toggle Peace only'
                clearsysmsg

                while not varexist AutoRecallChargedRunebook and EnableDIYRecallScript != 1
                    overhead "Select your escape runebook..." 253
                    @setvar! AutoRecallChargedRunebook
                    wait 2500
                endwhile

                while mana < 11
                    if timer "MANAWAIT" > 4000 and EnableOverheadMessages = 1
                        overhead "[ WAITING FOR MANA... ]" 12
                        settimer "MANAWAIT" 0
                    endif
                    wait 500
                endwhile

                if EnableOverheadMessages = 1
                    overhead "[ AUTO RECALL! ]" 88
                endif
                @setvar! DungeonGateThenTimeToGo 0
                @setvar! TimeToGo 0
                @setvar! RECALLTIME 1
            endif
        elseif EnableRecallAfterResurrection = 1 and ResThenTimeToGo = 1
            if EnableDIYRecallScript = 1
                @setvar! ResThenTimeToGo 0
                foreach RecallScript in DIYRecallScriptList
                    script RecallScript
                endfor
            else
                if targetexists
                    hotkey 'Cancel Current Target'
                endif

                hotkey 'Toggle Peace only'
                clearsysmsg

                while not varexist AutoRecallChargedRunebook and EnableDIYRecallScript != 1
                    overhead "Select your escape runebook..." 253
                    @setvar! AutoRecallChargedRunebook
                    wait 2500
                endwhile

                while mana < 11
                    if timer "MANAWAIT" > 4000 and EnableOverheadMessages = 1
                        overhead "[ WAITING FOR MANA... ]" 12
                        settimer "MANAWAIT" 0
                    endif
                    wait 500
                endwhile

                if EnableOverheadMessages = 1
                    overhead "[ AUTO RECALL! ]" 88
                    wait 1000
                endif
                @setvar! ResThenTimeToGo 0
                @setvar! RecallScrollsOnly 1
                @setvar! RECALLTIME 1
            endif
        elseif AutoRecallTime = 1
            if EnableDIYRecallScript = 1
                @setvar! AutoRecallTime 0
                foreach RecallScript in DIYRecallScriptList
                    script RecallScript
                endfor
            else
                if targetexists
                    hotkey 'Cancel Current Target'
                endif

                hotkey 'Toggle Peace only'
                clearsysmsg

                while not varexist AutoRecallChargedRunebook and EnableDIYRecallScript != 1
                    overhead "Select your escape runebook..." 253
                    @setvar! AutoRecallChargedRunebook
                    wait 2500
                endwhile

                while mana < 11
                    if timer "MANAWAIT" > 4000 and EnableOverheadMessages = 1
                        overhead "[ WAITING FOR MANA... ]" 12
                        settimer "MANAWAIT" 0
                    endif
                    wait 500
                endwhile

                if EnableOverheadMessages = 1
                    overhead "[ AUTO RECALL! ]" 88
                    wait 1000
                endif
                @setvar! AutoRecallTime 0
                @setvar! RECALLTIME 1
            endif
        elseif EnableAutoRedDungeonGate = 1 or EnableAutoWeightDungeonGate = 1 and TimeToGo = 1

            if RedTargetFound = 1 and timer "REDALERT" > 4500 and EnableOverheadMessages = 1
                overhead "[ !! RED ALERT !! ]" 37
                settimer "REDALERT" 0
            endif

            settimer "DungeonEscape" 0
            wait 500

            while timer "DungeonEscape" < 120000
                if EnablePKradar = 1
                    if timer "PKRadar" > 1000
                        hotkey 'Next Murderer Player Target'
                        wait 500
                        if insysmsg "No one matching that was found"
                            settimer "PKRadar" 0
                            clearsysmsg
                        else
                            if EnableRedAlertOverhead = 1 and timer "REDALERT" > 4500 and EnableOverheadMessages = 1
                                overhead "[ !! RED ALERT !! ]" 37
                                settimer "REDALERT" 0
                            endif
                        endif
                    endif
                endif

                if insysmsg "world is saving"
                    settimer "WorldSaveTimer" 0
                    if EnableOverheadMessages = 1
                        overhead "[ WORLD SAVING... ]" 253
                    endif
                    while timer "WorldSaveTimer" < 4500
                        if insysmsg "save complete"
                            break
                        endif
                        wait 100
                    endwhile
                    if EnableOverheadMessages = 1
                        overhead "[ SAVE COMPLETE! ]" 253
                    endif
                endif

                # DUNGEON ESCAPE W/ RED TARGET #

                while find MurdererTarget ground -1 -1 12
                    if timer "MURDERTARGET" > 4500
                        if EnableOverheadMessages = 1
                            overhead " RED " 337 MurdererTarget
                        else
                            overhead "  " 337 MurdererTarget
                        endif
                        settimer "MURDERTARGET" 0
                    endif

                    if EnableAutoParalyzePouch = 1
                        if paralyzed
                            if findtype "pouch" self
                                yell "[pouch"
                            else
                                if EnableOverheadMessages = 1
                                    overhead "[ NO MORE POUCHES! ]" 337
                                endif
                            endif
                        endif
                    endif

                    if diffhits > 0 and not bandaging
                        if skill 'healing' >= 30
                            if findtype 'clean bandage%s%' self
                                if targetexists
                                    hotkey 'cancel current target'
                                endif
                                hotkey 'Bandage Self'
                                if EnableOverheadMessages = 1 
                                    if aidsMessageTimer > 5000
                                        overhead "[ BANDAGING... ]" 88
                                        settimer aidsMessageTimer 0
                                        wait 500
                                    endif
                                endif
                            else
                                if timer aidsMessageTimer > 5000 and EnableOverheadMessages = 1
                                    overhead "[ OUT OF BANDAGES! ]" 337
                                    settimer aidsMessageTimer 0
                                endif
                            endif
                        endif
                    endif

                    if EnableCurePotion = 1
                        while poisoned
                            if findtype "Orange Potion" self
                                dclicktype "Orange Potion"
                                if EnableOverheadMessages = 1 and timer 'orangeMessageTimer' > 3500
                                    overhead "[ CURE POTION ]" 44
                                    settimer 'orangeMessageTimer' 0
                                endif
                                wait 250
                            else
                                if timer 'orangeMessageTimer' > 5000
                                    overhead "[ NO CURE POTS! ]" 337
                                    settimer 'orangeMessageTimer' 0
                                endif

                                if diffhits >= 30 or not findtype 3972 self or not findtype 3973 self
                                    break
                                endif
                            endif
                        endwhile
                    endif

                    if EnableHealPotion = 1 and diffhits >= HealPotionHPdiff
                        if findtype "Yellow Potion" self as HealPot
                            getlabel HealPot HealPotlabel
                            if "next" in HealPotlabel
                                // Do nothing
                            else
                                @setvar! HealPotionCheck 0

                                if counttype 3852 self as HealPotCount
                                    @setvar! HealPotionCheck HealPotCount
                                endif

                                clearsysmsg
                                dclicktype 3852
                                getlabel backpack backpackdesc
                                wait 250

                                if HealPotionCheck != counttype 3852 self or insysmsg "potion satchel used"
                                    settimer 'HealPotionTimer' 0
                                    cooldown "Healing Potion" HealingPotionCooldown
                                    if EnableOverheadMessages = 1
                                        if insysmsg "potion satchel used"
                                            overhead '[ FREE HEAL POTION ]' 253
                                        else
                                            overhead "[ HEAL POTION ]" 253
                                        endif
                                    endif 
                                    clearsysmsg
                                endif
                            endif
                        else
                            if timer 'yellowMessageTimer' > 4500
                                overhead "[ NO HEAL POTS! ]" 337
                                settimer 'yellowMessageTimer' 0
                            endif
                        endif
                    endif

                    if insysmsg "world is saving"
                        settimer "WorldSaveTimer" 0
                        if EnableOverheadMessages = 1
                            overhead "[ WORLD SAVING... ]" 253
                        endif
                        while timer "WorldSaveTimer" < 4500
                            if insysmsg "save complete"
                                break
                            endif
                            wait 100
                        endwhile
                        if EnableOverheadMessages = 1
                            overhead "[ SAVE COMPLETE! ]" 253
                        endif
                    endif

                    if EnableStrengthPotion = 1 
                        if insysmsg "You may now use a strength" or not findbuff "Strength"
                            if findtype "White Potion" self
                                dclicktype "White Potion"
                                if EnableOverheadMessages = 1
                                    overhead "[ STRENGTH POTION ]" 956
                                endif
                                wait 250
                                clearsysmsg
                            else
                                if timer whiteMessageTimer > 4500
                                    overhead "[ NO STRENGTH POTS! ]" 337
                                    settimer whiteMessageTimer 0
                                endif
                            endif
                        endif
                    endif 

                    if EnableAgilityPotion = 1 and not findbuff "Agility"
                        if findtype "Blue Potion" self
                            dclicktype "Blue Potion"
                            if EnableOverheadMessages = 1
                                overhead "[ AGILITY POTION ]" 93
                            endif
                            wait 250
                        else
                            if timer blueMessageTimer > 4500
                            overhead "[ NO AGILITY POTS! ]" 337
                                settimer blueMessageTimer 0
                            endif
                        endif
                    endif

                    if EnableRefreshPotion = 1 and diffstam > RefreshPotionSPdiff
                        if findtype "Red Potion" self
                            dclicktype "Red Potion"
                            if EnableOverheadMessages = 1
                                overhead "[ REFRESH POTION ]" 37
                            endif
                            wait 250
                        else
                            if timer redMessageTimer > 4500
                                overhead "[ NO REFRESH POTS! ]" 337
                                settimer redMessageTimer 0
                            endif
                        endif
                    endif

                    if EnableAutoParalyzePouch = 1
                        if paralyzed
                            if findtype "pouch" self
                                yell "[pouch"
                                hotkey 'Toggle War Only'
                                @setvar! RedTargetFound 1
                                @setvar WarModeToggledWhileFighting 0
                                replay
                            else
                                overhead "[ NO MORE POUCHES! ]" 337
                            endif
                        endif
                    endif

                    while not gumpexists 3899019871 and findtype "blue moongate" ground 0 1 2 as EscapeGate
                        dclick EscapeGate
                    endwhile

                    if gumpexists 3899019871 and findtype "blue moongate" ground 0 1 2 as EscapeGate
                        while gumpexists 3899019871 and findtype "blue moongate" ground 0 1 2 as EscapeGate
                            gumpresponse 2 3899019871
                            wait 250
                        endwhile
                        wait 1500
                        @setvar! TimeToGo 0
                        if EnableDIYRecallScript = 1
                            foreach RecallScript in DIYRecallScriptList
                                script RecallScript
                            endfor
                        else
                            hotkey 'Toggle War Only'
                            @setvar! DungeonGateThenTimeToGo 1
                            replay
                        endif
                    endif

                    while not gumpexists 3899019871 and findtype 30528 ground 2091 1 1 as EscapeGate
                        dclick EscapeGate
                    endwhile

                    if gumpexists 3899019871 and findtype 30528 ground 2091 1 1 as EscapeGate
                        while gumpexists 3899019871 and findtype 30528 ground 2091 1 1 as EscapeGate
                            gumpresponse 2 3899019871
                            wait 250
                        endwhile
                        wait 1500
                        @setvar! TimeToGo 0
                        if EnableDIYRecallScript = 1
                            foreach RecallScript in DIYRecallScriptList
                                script RecallScript
                            endfor
                        else
                            hotkey 'Toggle War Only'
                            @setvar! DungeonGateThenTimeToGo 1
                            replay
                        endif
                    endif

                    while not gumpexists 3773199800 and findtype "blue moongate" ground -1 1 2 as EscapeGate
                        dclick EscapeGate
                    endwhile

                    if gumpexists 3773199800 and findtype "blue moongate" ground -1 1 2 as EscapeGate
                        while gumpexists 3773199800 and findtype "blue moongate" ground -1 1 2 as EscapeGate
                                gumpresponse 2 3773199800
                                wait 250
                        endwhile
                        wait 1500
                        @setvar! TimeToGo 0
                        if EnableDIYRecallScript = 1
                            foreach RecallScript in DIYRecallScriptList
                                script RecallScript
                            endfor
                        else
                            hotkey 'Toggle War Only'
                            @setvar! DungeonGateThenTimeToGo 1
                            replay
                        endif
                    endif

                    while not gumpexists 3899019871 and findtype "moongate" ground -1 -1 2 as EscapeGate
                        dclick EscapeGate
                    endwhile

                    if gumpexists 3899019871 and findtype "moongate" ground -1 -1 2 as EscapeGate
                        while gumpexists 3899019871 and findtype "moongate" ground -1 -1 2 as EscapeGate
                            gumpresponse 2 3899019871
                            wait 250
                        endwhile
                        wait 1500
                        @setvar! TimeToGo 0
                        if EnableDIYRecallScript = 1
                            foreach RecallScript in DIYRecallScriptList
                                script RecallScript
                            endfor
                            hotkey 'Toggle War Only'
                            @setvar! DungeonGateThenTimeToGo 1
                            replay
                        endif
                    endif

                    if findtype "moongate" ground -1 1 12 or findtype "blue moongate" ground -1 1 12 as EscapeGate
                        if timer "GETCLOSER" > 4500
                            if EnableOverheadMessages = 1
                                overhead "[ GET CLOSER! ]" 77
                            else
                                overhead "  " 77
                            endif
                            settimer "GETCLOSER" 0
                        endif

                        if timer "GATEHERE" > 500
                            overhead "  " 253 EscapeGate
                            settimer "GATEHERE" 0
                        endif
                    else
                        if timer "RUNAWAY" > 6000
                            if EnableOverheadMessages = 1
                                overhead "[ GET TO A GATE... ]" 2114
                            else
                                overhead "  " 2114
                            endif
                            settimer "RUNAWAY" 0
                        endif
                    endif

                    if not warmode
                        if EnableOverheadMessages = 1
                            overhead "[ ESCAPE CANCELLED! ]" 88
                        else
                            overhead "  " 88
                        endif
                        replay
                    endif
                endwhile

                # DUNGEON ESCAPE W/ NO RED TARGET #
                    if EnableStrengthPotion = 1 
                        if insysmsg "You may now use a strength" or not findbuff "Strength"
                            if findtype "White Potion" self
                                dclicktype "White Potion"
                                if EnableOverheadMessages = 1
                                    overhead "[ STRENGTH POTION ]" 956
                                endif
                                wait 250
                                clearsysmsg
                            else
                                if timer whiteMessageTimer > 4500
                                    overhead "[ NO STRENGTH POTS! ]" 337
                                    settimer whiteMessageTimer 0
                                endif
                            endif
                        endif
                    endif 

                    if EnableAgilityPotion = 1 and not findbuff "Agility"
                        if findtype "Blue Potion" self
                            dclicktype "Blue Potion"
                            if EnableOverheadMessages = 1
                                overhead "[ AGILITY POTION ]" 93
                            endif
                            wait 250
                        else
                            if timer blueMessageTimer > 4500
                            overhead "[ NO AGILITY POTS! ]" 337
                                settimer blueMessageTimer 0
                            endif
                        endif
                    endif

                    if EnableMagicResistPotion = 1 and not findbuff "Magic Resist"
                        if findtype "Black Potion" self
                            dclicktype "Black Potion"
                            if EnableOverheadMessages = 1
                                overhead "[ RESIST POTION ]" 1109
                            endif
                            wait 250
                        else
                            if timer blackMessageTimer > 4500
                                overhead "[ NO RESIST POTS! ]" 337
                                settimer blackMessageTimer 0
                            endif
                        endif
                    endif

                    if EnableRefreshPotion = 1 and diffstam > RefreshPotionSPdiff
                        if findtype "Red Potion" self
                            dclicktype "Red Potion"
                            if EnableOverheadMessages = 1
                                overhead "[ REFRESH POTION ]" 37
                            endif
                            wait 250
                        else
                            if timer redMessageTimer > 4500
                                overhead "[ NO REFRESH POTS! ]" 337
                                settimer redMessageTimer 0
                            endif
                        endif
                    endif
                    
                    if paralyzed
                        if findtype "pouch" self 
                            yell "[pouch"
                            wait 250
                        else
                            if timer pouchMessageTimer > 5000
                                overhead "[ NO MORE POUCHES! ]" 337
                                settimer pouchMessageTimer 0
                            endif
                        endif
                    endif

                    if diffhits > 0 and not bandaging
                        if skill 'healing' >= 30
                            if findtype 'clean bandage%s%' self
                                if targetexists
                                    hotkey 'cancel current target'
                                endif
                                hotkey 'Bandage Self'
                                if EnableOverheadMessages = 1 
                                    if aidsMessageTimer > 5000
                                        overhead "[ BANDAGING... ]" 88
                                        settimer aidsMessageTimer 0
                                        wait 500
                                    endif
                                endif
                            else
                                if timer aidsMessageTimer > 5000 and EnableOverheadMessages = 1
                                    overhead "[ OUT OF BANDAGES! ]" 337
                                    settimer aidsMessageTimer 0
                                endif
                            endif
                        endif
                    endif

                    if EnableCurePotion = 1
                        while poisoned
                            if findtype "Orange Potion" self
                                dclicktype "Orange Potion"
                                if EnableOverheadMessages = 1 and timer 'orangeMessageTimer' > 3500
                                    overhead "[ CURE POTION ]" 44
                                    settimer 'orangeMessageTimer' 0
                                endif
                                wait 250
                            else
                                if timer 'orangeMessageTimer' > 5000
                                    overhead "[ NO CURE POTS! ]" 337
                                    settimer 'orangeMessageTimer' 0
                                endif

                                if diffhits >= 30 or not findtype 3972 self or not findtype 3973 self
                                    break
                                endif
                            endif
                        endwhile
                    endif

                    if EnableHealPotion = 1 and diffhits >= HealPotionHPdiff
                        if findtype "Yellow Potion" self as HealPot
                            getlabel HealPot HealPotlabel
                            if "next" in HealPotlabel
                                // Do nothing
                            else
                                @setvar! HealPotionCheck 0

                                if counttype 3852 self as HealPotCount
                                    @setvar! HealPotionCheck HealPotCount
                                endif

                                clearsysmsg
                                dclicktype 3852
                                getlabel backpack backpackdesc
                                wait 250

                                if HealPotionCheck != counttype 3852 self or insysmsg "potion satchel used"
                                    settimer 'HealPotionTimer' 0
                                    cooldown "Healing Potion" HealingPotionCooldown
                                    if EnableOverheadMessages = 1
                                        if insysmsg "potion satchel used"
                                            overhead '[ FREE HEAL POTION ]' 253
                                        else
                                            overhead "[ HEAL POTION ]" 253
                                        endif
                                    endif 
                                    clearsysmsg
                                endif
                            endif
                        else
                            if timer 'yellowMessageTimer' > 4500
                                overhead "[ NO HEAL POTS! ]" 337
                                settimer 'yellowMessageTimer' 0
                            endif
                        endif
                    endif

                    if EnableNobleSacrifice = 1
                        if diffhits > 50 and skill "Chivalry" >= 80 and timer "NobleSacrificeTimer" > 31000 and timer "ChivalryPrevented" > 5000
                            clearsysmsg
                            yell "[NobleSacrifice"
                            wait 250
                            if insysmsg "You do not have enough holy"
                                settimer "ChivalryPrevented" 0
                                clearsysmsg
                            else
                                wft 1000
                                target 'self'
                                if EnableOverheadMessages = 1
                                    overhead "[ NOBLE SACRIFICE! ]" 155
                                endif
                                settimer "NobleSacrificeTimer" 0
                                cooldown "Noble Sacrifice" 31000
                                settimer "ChivalryPrevented" 0
                            endif
                            wait 250
                        endif
                    endif

                    if EnableHolyLight = 1
                        if diffhits > 30 and skill "Chivalry" >= 95 and timer "HolyLightTimer" > 31000 and timer "ChivalryPrevented" > 5000
                            clearsysmsg
                            yell "[HolyLight"
                            wait 250
                            if insysmsg "You do not have enough holy"
                                settimer "ChivalryPrevented" 0
                                clearsysmsg
                            else
                                if EnableOverheadMessages = 1
                                    overhead "[ HOLY LIGHT! ]" 254
                                endif
                                settimer "HolyLightTimer" 0
                                cooldown "Holy Light" 31000
                                settimer "ChivalryPrevented" 0
                            endif
                            wait 250
                        endif
                    endif

                    if not warmode
                        if EnableOverheadMessages = 1
                            overhead "[ ESCAPE CANCELLED! ]" 88
                        else
                            overhead "  " 88
                        endif
                        replay
                    endif

                    while not gumpexists 3899019871 and findtype "blue moongate" ground 0 1 2 as EscapeGate
                        dclick EscapeGate
                    endwhile

                    if gumpexists 3899019871 and findtype "blue moongate" ground 0 1 2 as EscapeGate
                        while gumpexists 3899019871 and findtype "blue moongate" ground 0 1 2 as EscapeGate
                            gumpresponse 2 3899019871
                            wait 250
                        endwhile
                        wait 1500
                        @setvar! TimeToGo 0
                        if EnableDIYRecallScript = 1
                            foreach RecallScript in DIYRecallScriptList
                                script RecallScript
                            endfor
                        else
                            hotkey 'Toggle War Only'
                            @setvar! DungeonGateThenTimeToGo 1
                            replay
                        endif
                    endif

                    while not gumpexists 3899019871 and findtype 30528 ground 2091 1 1 as EscapeGate
                        dclick EscapeGate
                    endwhile

                    if gumpexists 3899019871 and findtype 30528 ground 2091 1 1 as EscapeGate
                        while gumpexists 3899019871 and findtype 30528 ground 2091 1 1 as EscapeGate
                            gumpresponse 2 3899019871
                            wait 250
                        endwhile
                        @setvar! TimeToGo 0
                        if EnableDIYRecallScript = 1
                            foreach RecallScript in DIYRecallScriptList
                                script RecallScript
                            endfor
                        else
                            hotkey 'Toggle War Only'
                            @setvar! DungeonGateThenTimeToGo 1
                            replay
                        endif
                    endif

                    while not gumpexists 3773199800 and findtype "blue moongate" ground -1 1 2 as EscapeGate
                        dclick EscapeGate
                    endwhile

                    if gumpexists 3773199800 and findtype "blue moongate" ground -1 1 2 as EscapeGate
                        while gumpexists 3773199800 and findtype "blue moongate" ground -1 1 2 as EscapeGate
                            gumpresponse 2 3773199800
                            wait 250
                        endwhile
                        wait 1500
                        @setvar! TimeToGo 0
                        if EnableDIYRecallScript = 1
                            foreach RecallScript in DIYRecallScriptList
                                script RecallScript
                            endfor
                        else
                            hotkey 'Toggle War Only'
                            @setvar! DungeonGateThenTimeToGo 1
                            replay
                        endif
                    endif

                    while not gumpexists 3899019871 and findtype "moongate" ground -1 -1 2 as EscapeGate
                        dclick EscapeGate
                    endwhile

                    if gumpexists 3899019871 and findtype "moongate" ground -1 -1 2 as EscapeGate
                        while gumpexists 3899019871 and findtype "moongate" ground -1 -1 2 as EscapeGate
                            gumpresponse 2 3899019871
                            wait 250
                        endwhile
                        wait 1500
                        @setvar! TimeToGo 0
                        if EnableDIYRecallScript = 1
                            foreach RecallScript in DIYRecallScriptList
                                script RecallScript
                            endfor
                        else
                            hotkey 'Toggle War Only'
                            @setvar! DungeonGateThenTimeToGo 1
                            replay
                        endif
                    endif

                    if findtype "moongate" ground -1 1 12 or findtype "blue moongate" ground -1 1 12 as EscapeGate
                        if timer "GETCLOSER" > 4500
                            if EnableOverheadMessages = 1
                                overhead "[ GET CLOSER! ]" 77
                            else
                                overhead "  " 77
                            endif
                            settimer "GETCLOSER" 0
                        endif
                        if timer "GATEHERE" > 500
                            overhead "  " 253 EscapeGate
                            settimer "GATEHERE" 0
                        endif
                    else
                        if timer "RUNAWAY" > 6000
                            if EnableOverheadMessages = 1
                                overhead "[ GET TO A GATE... ]" 2114
                            else
                                overhead "  " 2114
                            endif
                            settimer "RUNAWAY" 0
                        endif
                    endif
                endwhile
        elseif EnableAutoRedRecall = 0 and EnableAutoWeightRecall = 0 
            // Do nothing
        elseif EnableAutoRedDungeonGate = 0 and EnableAutoWeightDungeonGate = 0 
            // Do nothing
        elseif TimeToGo = 0 and WarModeToggledWhileFighting = 1
           @setvar! WarModeToggledWhileFighting 0
        endif
    endif

    if RECALLTIME = 1
        if EnableInfiniteLoop = 1
            settimer "InfiniteLoop" 0
        endif

        dclick AutoRecallChargedRunebook
        waitforgump 1551740969
        gumpresponse 2
        wait 1000

        for 5
        wait 500
        if insysmsg 'Your concentration is disturbed'
            dclick AutoRecallChargedRunebook
            waitforgump 1551740969
            gumpresponse 2
            wait 1000
            clearsysmsg
        endif
        endfor

        if insysmsg 'Your concentration is disturbed'
            for 5
                if diffhits > 25 and timer 'HealPotionTimer' > HealingPotionCooldown
                    if findtype "Yellow Potion" self as healpot
                        dclick healpot
                        wait 250
                        settimer 'HealPotionTimer' 0
                        cooldown "Healing Potion" HealingPotionCooldown
                        if EnableOverheadMessages = 1
                            overhead "[ HEAL POTION ]" 253
                        endif
                    endif
                endif

                while poisoned
                    if findtype "Orange Potion" self as curepot
                        dclick curepot
                        wait 250
                    endif
                endwhile

                clearsysmsg
                overhead '[ INTERUPTED! ]' 153
                wait 2500
                dclick AutoRecallChargedRunebook
                waitforgump 1551740969
                gumpresponse 2
                wait 1000
                if insysmsg 'Your concentration is disturbed'
                    wait 1500
                else
                    break
                endif
            endfor
        endif

        if OutsideHouseRecall = 1
            wait 2500
            if find MyDoor ground -1 -1 2 and EnableCloseMyDoor = 1
                dclick MyDoor
                overhead "*door slams!*" 0 MyDoor
                wait 1000
            endif
            wait 2500
        elseif OwnerInnRecall = 1
            wait 500
            say "Innkeeper, I need a room!" 2234
            waitforgump 2393832411
            gumpresponse 4
            wait 1500
        elseif CoOwnerInnRecall = 1
            wait 500
            say "Innkeeper, I need a room!" 2234
            waitforgump 2393832411
            gumpresponse 5
            wait 500
            gumpresponse 100
            wait 1500
        elseif InsideHouseRecall = 1
            wait 500
        elseif BankRecall = 1
            say "Open my bank!" 2234
            wait 1000
        else
            wait 500
        endif

        if HideAtHomeorInn = 1
            useskill "Hiding"
        endif

        clearignore
        @setvar! RecallScrollsOnly 0
        @setvar! RECALLTIME 0

        if EnableResetInventoryAfterDeath = 1 and IHAVEDIED = 1
            if EnableAutoRecallOverheadMessages = 1
                overhead "[ RESETTING LOADOUT... ]" 77
                wait 500
            endif
        endif

        if IHAVEDIED != 1
            if EnableWeaponCheck = 1 
                if skill 'Swordsmanship' >= 50
                    if not findtype '30988|5049|3909|3911|3915|3917|3934|3937|5046|5115|5119|5182|5185|5187|31128|31190' self
                        overhead "[ NO WEAPON! ]" 337
                    else
                        if not findtype '30988|5049|3909|3911|3915|3917|3934|3937|5046|5115|5119|5182|5185|5187|31128|31190' hand
                            if findtype '30988|5049|3909|3911|3915|3917|3934|3937|5046|5115|5119|5182|5185|5187|31128|31190' backpack as weapon
                                for 10
                                getlabel weapon WeaponLabel
                                wait 500
                                if "aspect" in WeaponLabel
                                    break
                                else
                                    @ignore weapon
                                    wait 150
                                    if findtype '30988|5049|3909|3911|3915|3917|3934|3937|5046|5115|5119|5182|5185|5187|31128|31190' backpack as weapon
                                        getlabel weapon WeaponLabel
                                    endif
                                endif
                                endfor
                                wait 150
                                dclick weapon
                                wait 500
                            endif
                        endif
                    endif
                elseif skill 'Mace Fighting' >= 50
                    if not findtype '3568|3713|3721|3932|5040|5044|5112|5127|5177|5179|5181|30991|30999|31000|31001|31014|31178|31180|31182' self
                        overhead "[ NO WEAPON! ]" 337
                    else
                        if not findtype '3568|3713|3721|3932|5040|5044|5112|5127|5177|5179|5181|30991|30999|31000|31001|31014|31178|31180|31182' hand
                            if findtype '3568|3713|3721|3932|5040|5044|5112|5127|5177|5179|5181|30991|30999|31000|31001|31014|31178|31180|31182' backpack as weapon
                                for 10
                                getlabel weapon WeaponLabel
                                wait 500
                                if "aspect" in WeaponLabel
                                    break
                                else
                                    @ignore weapon
                                    wait 150
                                    if findtype '3568|3713|3721|3932|5040|5044|5112|5127|5177|5179|5181|30991|30999|31000|31001|31014|31178|31180|31182' backpack as weapon
                                        getlabel weapon WeaponLabel
                                    endif
                                endif
                                endfor
                                wait 150
                                dclick weapon
                                wait 500
                            endif
                        endif
                    endif
                elseif skill 'Fencing' >= 50
                    if not findtype '3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' self
                        overhead "[ NO WEAPON! ]" 337
                    else
                        if not findtype '3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' hand
                            if findtype '3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' backpack as weapon
                                for 10
                                getlabel weapon WeaponLabel
                                wait 500
                                if "aspect" in WeaponLabel
                                    break
                                else
                                    @ignore weapon
                                    wait 150
                                    if findtype '3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' backpack as weapon
                                        getlabel weapon WeaponLabel
                                    endif
                                endif
                                endfor
                                wait 150
                                dclick weapon
                                wait 500
                            endif
                        endif
                    endif
                elseif skill 'Archery' >= 50
                    if not findtype '3920|5042|5117|30990|30993|30994|30995|31184|31186' self
                        overhead "[ NO WEAPON! ]" 337
                    else
                        if not findtype '3920|5042|5117|30990|30993|30994|30995|31184|31186' hand
                            if findtype '3920|5042|5117|30990|30993|30994|30995|31184|31186' backpack as weapon
                                for 10
                                getlabel weapon WeaponLabel
                                wait 500
                                if "aspect" in WeaponLabel
                                    break
                                else
                                    @ignore weapon
                                    wait 150
                                    if findtype '3920|5042|5117|30990|30993|30994|30995|31184|31186' backpack as weapon
                                        getlabel weapon WeaponLabel
                                    endif
                                endif
                                endfor
                                wait 150
                                dclick weapon
                                wait 500
                            endif
                        endif
                    endif
                elseif skill 'Wrestling' >= 50
                    if not findtype '22187|31141|31142' self
                        overhead "[ NO WEAPON! ]" 337
                    else
                        if not findtype '22187|31141|31142' hand
                            if findtype '22187|31141|31142' backpack as weapon
                                for 4
                                    getlabel weapon WeaponLabel
                                    wait 250
                                    if "aspect" in WeaponLabel
                                        break
                                    else
                                        @ignore weapon
                                        wait 150
                                        if findtype '22187|31141|31142' backpack as weapon
                                            getlabel weapon WeaponLabel
                                        endif
                                    endif
                                endfor
                                dclick weapon
                                wait 750
                            endif
                        endif
                    endif
                endif
            endif

            if EnableShieldCheck = 1 and skill 'Parrying' > 0
                if not findtype 'Order shield|buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|wooden shield|parrying gauche' lefthand
                    if findtype 'Order shield|buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|wooden shield|parrying gauche' backpack as shield
                        for 4
                            getlabel shield ShieldLabel
                            wait 250
                            if "unidentified" in ShieldLabel
                                @ignore shield
                                wait 150
                                if findtype 'Order shield|buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|wooden shield|parrying gauche' backpack as shield
                                    getlabel shield ShieldLabel
                                endif
                            else
                                break
                            endif
                        endfor
                        dclick shield
                        wait 500
                    endif
                endif
            endif

            wait 500

            if EnableLootBag = 1
                dclick LootBag
                wait 500
            endif

            if EnableLootChest = 1
                dclick LootChest
                wait 500
            endif

            if EnablePutLootinLockBox = 1
                if findtype "wooden box" self as lockbox
                    if findtype "copper key" self as key
                        clearignore
                        getlabel lockbox lockboxlabel
                        wait 250
                        if "items" in lockboxlabel
                            dclick lockbox
                            wait 500
                        else
                            dclick key
                            wft 1500
                            target lockbox
                            if EnableAutoRecallOverheadMessages = 1
                                overhead "[loot box unlocked]" 84
                            endif
                            wait 500
                            dclick lockbox
                            wait 250
                            if insysmsg "It appears to be locked."
                                dclick key
                                wft 1500
                                target lockbox
                                wait 500
                                dclick lockbox
                            endif
                        endif
                    elseif EnableAutoRecallOverheadMessages = 1
                        overhead "[ NO LOCKBOX KEY! ]" 337
                    endif
                endif
            endif

            wait 500

            if EnableSafeDeposit = 1
                if findtype "bank deposit safe" ground -1 -1 2 as safe
                    clearignore
                    while findtype "gold coin" self as gold
                        if findtype "wooden box" self as lockbox
                            if findtype "copper key" self as key
                                getlabel lockbox lockboxlabel
                                if "items" in lockboxlabel
                                    wait 500
                                else
                                    dclick key
                                    wft 1500
                                    target lockbox
                                    wait 250
                                    if insysmsg "It appears to be locked."
                                        dclick key
                                        wft 1500
                                        target lockbox
                                        wait 250
                                    endif
                                endif
                            elseif EnableAutoRecallOverheadMessages = 1
                                overhead "[ NO LOCKBOX KEY! ]" 337
                            endif
                        endif
                        
                        if EnableAutoRecallOverheadMessages = 1
                            overhead "[ DEPOSITING GOLD... ]" 149
                        else
                            overhead "  " 149
                        endif
                        
                        menu safe 0
                        wait 500
                    endwhile
                    while findtype 2539 self as dubs
                        if EnableAutoRecallOverheadMessages = 1
                            overhead "[ DEPOSITING DUBS... ]" 149
                        else
                            overhead "  " 149
                        endif
                        
                        menu safe 0
                        wait 500
                    endwhile
                elseif EnableAutoRecallOverheadMessages = 1
                    overhead "[ NO BANK SAFE FOUND ]" 337
                    wait 1500
                endif
            endif

            if EnableResourceStockpile = 1
                if findtype "resource container" ground -1 -1 2 as resource
                    menu resource 0
                    wft 500
                    target self
                        if EnableAutoRecallOverheadMessages = 1
                            overhead "[ PILING RESOURCES... ]" 84
                        else
                            overhead "  " 84
                        endif
                    wait 1500
                elseif EnableAutoRecallOverheadMessages = 1
                    overhead "[ NO RESOURCE STOCKPILE FOUND ]" 337
                    wait 1500
                endif
            endif

            if EnableRepairBench = 1
                if findtype "repair bench" ground -1 -1 3 as RepairBench
                    clearsysmsg
                    dclick RepairBench
                    wait 500
                    if insysmsg "You do not have any items equipped or in your backpack in need of repairs."
                        if EnableAutoRecallOverheadMessages = 1
                            overhead "[ NOTHING TO REPAIR! ]" 0
                        endif
                        wait 1500
                    else
                        if EnableAutoRecallOverheadMessages = 1
                            overhead "[ REPAIRING EQUIPMENT... ]" 339
                        else
                            overhead "  " 339
                        endif
                        settimer RepairTimer 0
                    while timer RepairTimer <= 5000
                        if insysmsg "Repair"
                            break
                        endif
                    endwhile
                        if EnableAutoRecallOverheadMessages = 1
                            overhead "[ ITEMS REPAIRED! ]" 0
                            wait 500
                            overhead "Repair took: {{RepairTimer}}ms" 77
                        else
                            overhead "  " 0
                        endif
                        removetimer RepairTimer
                        wait 500
                    endif
                elseif EnableAutoRecallOverheadMessages = 1
                    overhead "[ NO REPAIR BENCH FOUND ]" 337
                    wait 1500
                endif
            endif

            if EnableMagicRecycler = 1
                if findtype "ornate elven chest|magic item recycler" ground -1 -1 2 as recycler
                    for 2
                    getlabel recycler recyclerdesc

                    if EnableRecycleItemsWhenFull = 1
                        if "(125 items" in recyclerdesc
                            dclick recycler
                            waitforgump 4045111101
                            gumpresponse 7
                            waitforgump 4045111101
                            gumpresponse 6
                            waitforgump 4045111101
                            gumpresponse 6

                            if EnableAutoRecallOverheadMessages = 1
                                overhead "[ RECYCLING JUNK... ]" 66
                            else
                                overhead "  " 66
                            endif

                            wait 500
                            gumpclose 4045111101

                            if EnableResourceStockpile = 1
                                if findtype "resource container" ground -1 -1 2 as resource
                                    menu resource 0
                                    wft 1500
                                    target recycler
                                    wait 500
                                    if EnableAutoRecallOverheadMessages = 1
                                        overhead "[ PILING RESOURCES... ]" 112
                                    else
                                        overhead "  " 112
                                    endif
                                    wait 500
                                elseif EnableAutoRecallOverheadMessages = 1
                                    overhead "[ NO RESOURCE STOCKPILE FOUND ]" 337
                                endif
                            endif

                            menu recycler 1
                            getlabel backpack backpacklabel

                            if insysmsg "0 recyclable"
                                break
                            else
                                if EnableAutoRecallOverheadMessages = 1
                                    overhead "[ ADDING TO RECYCLER... ]" 6
                                else
                                    overhead "  " 6
                                endif
                                wait 1500
                            endif
                            break
                        endif
                    endif
                    
                    menu recycler 1
                    wait 500
                    if insysmsg "0 recyclable"
                        if EnableAutoRecallOverheadMessages = 1 and timer "inventorycheck" > 5000
                            overhead "[ NO MAGIC LOOT! ]" 6
                        elseif timer "inventorycheck" > 5000
                            overhead "  " 6
                        endif
                        break
                    else
                        if EnableAutoRecallOverheadMessages = 1
                            overhead "[ ADDING TO RECYCLER... ]" 6
                        else
                            overhead "  " 6
                        endif
                        settimer "inventorycheck" 0
                        wait 1500
                    endif
                    
                    wait 500
                    endfor
                elseif EnableAutoRecallOverheadMessages = 1
                    overhead "[ NO MAGIC ITEM RECYCLER FOUND ]" 337
                endif
            endif

            if EnableLootChest = 1
                dclick LootChest
                if EnableAutoRecallOverheadMessages = 1
                    overhead "[ STASHING LOOT... ]" 69
                else
                    overhead "  " 69
                endif
                wait 500
                for 2
                hotkey "Organizer Agent-06"
                wait 250
                hotkey "Organizer Agent-07"
                wait 250
                hotkey "Organizer Agent-08"
                wait 250
                hotkey "Organizer Agent-09"
                wait 250
                endfor
                while queued
                    wait 100
                endwhile
            endif

            if EnableStorageTomes = 1
                if findtype "book" ground -1 -1 2 as StorageTome or findtype "book" LootChest as StorageTome
                    while findtype "book" ground -1 -1 2 as StorageTome
                        menu StorageTome 0
                        if EnableAutoRecallOverheadMessages = 1 and timer "inventorycheck" > 3500
                            overhead "[ STORING TOME ITEMS... ]" 2117
                            settimer "inventorycheck" 0
                        elseif EnableAutoRecallOverheadMessages = 0 and timer "inventorycheck" > 3500
                            overhead "  " 2117
                            settimer "inventorycheck" 0
                        endif
                        wait 250
                        @ignore StorageTome
                    endwhile
                    while findtype "book" LootChest as StorageTome
                        menu StorageTome 0
                        if EnableAutoRecallOverheadMessages = 1 and timer "inventorycheck" > 3500
                            overhead "[ STORING TOME ITEMS... ]" 2117
                            settimer "inventorycheck" 0
                        elseif EnableAutoRecallOverheadMessages = 0 and timer "inventorycheck" > 3500
                            overhead "  " 2117
                            settimer "inventorycheck" 0
                        endif
                        wait 250
                        @ignore StorageTome
                    endwhile
                    @clearignore
                elseif EnableAutoRecallOverheadMessages = 1
                    overhead "[ NO STORAGE TOMES FOUND ]" 337
                    wait 1500
                endif
            endif
        endif

        if EnableStorageShelf = 1
            if findtype "storage shelf" ground -1 -1 2 as shelf
                if IHAVEDIED != 1
                    menu shelf 0
                    wft 500
                    target self
                    if EnableAutoRecallOverheadMessages = 1
                        overhead "[ STORING GOODS... ]" 2114
                    else
                        overhead "  " 2114
                    endif
                    wait 500
                    gumpclose 3232825965
                    wait 1000
                endif
                menu shelf 1
                if EnableAutoRecallOverheadMessages = 1
                    overhead "[ RESUPPLYING... ]" 93
                    wait 500
                else
                    overhead "  " 93
                endif
                wait 1000
            elseif EnableAutoRecallOverheadMessages = 1
                overhead "[ NO STORAGE SHELF FOUND ]" 337
                wait 1500
            endif
        endif

        if EnableResetInventoryAfterDeath = 1 and IHAVEDIED = 1
            clearignore

            if skill 'healing' > 0 and hp < maxhp and not bandaging
                if findtype 'clean bandage%s%' self and not bandaging
                    hotkey 'Bandage Self'
                    if EnableAutoRecallOverheadMessages = 1
                        overhead "[ BANDAGING... ]" 88
                        wait 500
                    endif
                endif
                wait 500
            endif

            if EnableNobleSacrifice = 1
                if diffhits > 50 and skill "Chivalry" >= 80 and timer "NobleSacrificeTimer" > 31000 and timer "ChivalryPrevented" > 5000
                    clearsysmsg
                    yell "[NobleSacrifice"
                    wait 250
                    if insysmsg "You do not have enough holy"
                        settimer "ChivalryPrevented" 0
                        clearsysmsg
                    else
                        wft 1000
                        target 'self'
                        if EnableOverheadMessages = 1
                            overhead "[ NOBLE SACRIFICE! ]" 155
                        endif
                        settimer "NobleSacrificeTimer" 0
                        cooldown "Noble Sacrifice" 31000
                        settimer "ChivalryPrevented" 0
                    endif
                    wait 250
                endif
            endif

            if not varexist maininventorybag or not find maininventorybag self
                overhead "[ SELECT MAIN POUCH... ]" 253
                @setvar! maininventorybag
                wft 500
                while targetexists
                    wait 100
                endwhile
                overhead "[ MAIN POUCH SET! ]" 93
                wait 500
            endif

            lift maininventorybag
            wait 500
            drop backpack 69 69 0
            wait 500

            if EnableSetMainPouchOrganizer01 = 1
                hotkey 'Set Organizer Hotbag-01'
                wft 1000
                target maininventorybag
                if EnableAutoRecallOverheadMessages = 1
                    overhead "[ POUCH SET TO AGENT-01! ]" 84
                endif
                wait 500
            endif

            dclick maininventorybag
            wait 1000
            sysmsg "Auto-selecting your loot/grab bag..." 0
            hotkey 'Set Grab Item Hotbag'
            wft 1500

            while targetexists
                if findtype 'bag' self as grabbag
                    target grabbag
                    wait 500
                else
                    wait 1000
                    sysmsg "Auto-select failed!  Please manually target your loot/grab bag!" 0
                    wait 1000
                    overhead "[ SELECT GRAB BAG... ]" 253
                    wait 3500
                endif
                wait 500
            endwhile
            overhead "[ GRAB BAG SET! ]" 93
            wait 500

            if EnableLootBag = 1
                if not find LootBag self
                    wait 500
                    overhead "Select your new loot bag..." 253
                    wait 500
                    @setvar! LootBag
                    wait 500
                    while targetexists
                        wait 100
                    endwhile
                endif
            endif

            if find grabbag self
                lift grabbag
                wait 500
                drop maininventorybag -1 -1 -1
                wait 500
                @ignore maininventorybag
            endif

            while findtype 'scissors' self
                if findtype 'scissors' self as myscissors
                    if findtype 'pouch' self as trappedpouch
                        lift myscissors
                        wait 250
                        drop trappedpouch
                        wait 750
                        lift trappedpouch
                        wait 250
                        drop backpack 69 69 0
                        @ignore trappedpouch
                        @ignore myscissors
                    endif
                endif

                wait 500
                while queued
                    wait 100
                endwhile
            endwhile

            clearignore

            while findtype 'pouch' backpack as decoypouch
                getlabel decoypouch decoypouchlabel
                wait 250
                if '(1 items' in decoypouchlabel
                    lift decoypouch
                    drop backpack 97 97 0
                    break
                else
                    @ignore decoypouch
                endif
            endwhile

            if findtype 'atlas' backpack as hidemypouchstack
                lift hidemypouchstack
                drop backpack 72 66 0
                wait 500
            else
                say "[atlas"
                wait 500
                if findtype 'atlas' backpack as hidemypouchstack
                    lift hidemypouchstack
                    drop backpack 72 66 0
                    wait 500
                endif
            endif

            if EnableAutoRecallOverheadMessages = 1
                overhead "[ ACTIVATING ASPECT... ]" 2234
                wait 500
            endif

            say "[aspect"
            waitforgump 2424293173
            gumpresponse 8
            wait 500
            gumpresponse 8
            wait 250
            gumpresponse 17
            wait 500
            gumpresponse 17
            wait 250
            gumpclose 2424293173
            dclick backpack
            wait 250

            if findtype "storage shelf" ground -1 -1 2 as shelf
                menu shelf 1
                wait 500
            endif

            if find maininventorybag self
                dclick maininventorybag
                wait 500
            endif

            if findtype 'alchemists satchel' self as BagofPot
                dclick BagofPot
                wait 500
            endif

            if findtype 'reagent satchel' self as WizardBag
                dclick WizardBag
                wait 500
            endif

            if find grabbag self
                dclick grabbag
                wait 500
            endif

            clearignore
            @setvar! IHAVEDIED 0
            overhead "[ RESET COMPLETE! ]" 69
            wait 500
        endif

        if EnableUsePotionKegs = 1 and findtype 'empty bottle%s%' self and findtype 'keg' self
            @setvar! PotionStockCheck 0
            while PotionStockCheck < 7 and findtype 'empty bottle%s%' self
                if PotionStockCheck = 0 and ExplosionPotionAmount != 0
                    @setvar! PotionType 3853
                    @setvar! KegColour 419
                    @setvar! PotionAmounttoFill ExplosionPotionAmount
                    @setvar! PotionStockCheck 1
                elseif PotionStockCheck = 1 and HealingPotionAmount != 0
                    @setvar! PotionType 3852
                    @setvar! KegColour 253
                    @setvar! PotionAmounttoFill HealingPotionAmount
                    @setvar! PotionStockCheck 2
                elseif PotionStockCheck = 2 and CurePotionAmount != 0
                    @setvar! PotionType 3847
                    @setvar! KegColour 44
                    @setvar! PotionAmounttoFill CurePotionAmount
                    @setvar! PotionStockCheck 3
                elseif PotionStockCheck = 3 and RefreshPotionAmount != 0
                    @setvar! PotionType 3851
                    @setvar! KegColour 37
                    @setvar! PotionAmounttoFill RefreshPotionAmount
                    @setvar! PotionStockCheck 4
                elseif PotionStockCheck = 4 and StrengthPotionAmount != 0
                    @setvar! PotionType 3849
                    @setvar! KegColour 956
                    @setvar! PotionAmounttoFill StrengthPotionAmount
                    @setvar! PotionStockCheck 5
                elseif PotionStockCheck = 5 and AgilityPotionAmount != 0
                    @setvar! PotionType 3848
                    @setvar! KegColour 93
                    @setvar! PotionAmounttoFill AgilityPotionAmount
                    @setvar! PotionStockCheck 6
                elseif PotionStockCheck = 6 and ResistPotionAmount != 0
                    @setvar! PotionType 3846
                    @setvar! KegColour 1109
                    @setvar! PotionAmounttoFill ResistPotionAmount
                    @setvar! PotionStockCheck 7
                else
                    break
                endif
                
                while counttype PotionType self < PotionAmounttoFill
                    if timer "AttackingTimer" > 500 and find ClosestTarget ground -1 -1 TargetAttackRange 
                        attack ClosestTarget
                        settimer "AttackingTimer" 0
                    endif
                    
                    if not findtype 'empty bottle%s%' self
                        if EnableOverheadMessages = 1 and timer 'PotionKegTimer' > 5000
                            overhead "[ NO EMPTY BOTTLES... ]" 337
                            settimer 'PotionKegTimer' 0 
                        endif
                        break
                    endif
                    
                    if findtype 'keg' self KegColour as myKeg
                        dclick myKeg
                        wait 250
                        if EnableOverheadMessages = 1
                            if timer 'PotionKegTimer' > 2000
                                overhead '[ FILLING POTS... ]' KegColour
                                settimer 'PotionKegTimer' 0
                            endif
                        endif
                    else 
                        if EnableOverheadMessages = 1 and timer 'PotionKegTimer' > 5000
                            overhead "[ NO KEG TO USE... ]" KegColour
                            settimer 'PotionKegTimer' 0 
                        endif
                        break
                    endif
                endwhile
                
                if counttype PotionType self < PotionAmounttoFill and not findtype 'empty bottle%s%' self 
                    if EnableOverheadMessages = 1 and timer 'PotionKegTimer' > 5000
                        overhead "[ NO EMPTY BOTTLES... ]" 337
                        settimer 'PotionKegTimer' 0 
                    endif
                    break
                endif
            endwhile
        endif

        if EnableReagentSplitter = 1
            if findtype "reagent satchel" self
                while findtype "reagent satchel" self as MyWizardBag
                    getlabel MyWizardBag MyWizardBagdesc
                    if 'decorative' in MyWizardBagdesc
                        @ignore MyWizardBag
                    else
                        break
                    endif
                endwhile
                sysmsg "Disable 'EnableReagentSplitter' in script variables to turn off this feature!" 0
                dclick MyWizardBag
                wait 500
                if EnableAutoRecallOverheadMessages = 1 and timer "inventorycheck" > 3500
                    overhead "[ SPLITTING REGS... ]" 111
                    settimer "inventorycheck" 0
                elseif EnableAutoRecallOverheadMessages = 0 and timer "inventorycheck" > 3500
                    overhead "  " 111
                    settimer "inventorycheck" 0
                endif
                @setvar! amount 0
                @setvar! regsID 3981
                @setvar! myCounter 0
                while findtype regsID self as r
                    @setvar! myCounter index
                    @ignore r
                endwhile
                @clearignore
                if counttype regsID self <= 15
                    @setvar! amount 2
                elseif counttype regsID self <= 30
                    @setvar! amount 4
                elseif counttype regsID self <= 50
                    @setvar! amount 10
                elseif counttype regsID self <= 100
                    @setvar! amount 20
                elseif counttype regsID self <= 150
                    @setvar! amount 30
                elseif counttype regsID self <= 200
                    @setvar! amount 40
                else
                    @setvar! amount 50
                endif
                    while findtype regsID self as regs
                        @setvar! moveRegs 0
                        if myCounter = 0
                            @setvar! moveRegs 1
                        elseif myCounter != 0 and not find regs MyWizardBag
                            @setvar! moveRegs 1
                        endif
                        if moveRegs = 1
                            if index = 0
                                lift regs amount
                                drop MyWizardBag 44 65 0
                                wait 150
                            elseif index = 1
                                lift regs amount
                                drop MyWizardBag 68 65 0
                                wait 150
                            elseif index = 2
                                lift regs amount
                                drop MyWizardBag 96 65 0
                                wait 150
                            elseif index = 3
                                lift regs amount
                                drop MyWizardBag 121 65 0
                                wait 150
                            else
                                lift regs amount
                                drop MyWizardBag 142 65 0
                                wait 150
                            endif
                        endif
                        @ignore regs
                        if moveRegs = 1
                            wait 500
                        endif
                    endwhile
                    @setvar! regsID 3962
                    @setvar! myCounter 0
                    while findtype regsID self as r
                        @setvar! myCounter index
                        @ignore r
                    endwhile
                    @clearignore
                    if counttype regsID self <= 10
                        @setvar! amount 2
                    elseif counttype regsID self <= 20
                        @setvar! amount 4
                    elseif counttype regsID self <= 50
                        @setvar! amount 10
                    elseif counttype regsID self <= 100
                        @setvar! amount 20
                    elseif counttype regsID self <= 150
                        @setvar! amount 30
                    elseif counttype regsID self <= 200
                        @setvar! amount 40
                    else
                        @setvar! amount 50
                    endif
                    while findtype regsID self as regs
                        @setvar! moveRegs 0
                        if myCounter = 0
                            @setvar! moveRegs 1
                        elseif myCounter != 0 and not find regs MyWizardBag
                            @setvar! moveRegs 1
                        endif
                    if moveRegs = 1
                        if index = 0
                            lift regs amount
                            drop MyWizardBag 44 76 0
                            wait 150
                        elseif index = 1
                            lift regs amount
                            drop MyWizardBag 68 76 0
                            wait 150
                        elseif index = 2
                            lift regs amount
                            drop MyWizardBag 96 76 0
                            wait 150
                        elseif index = 3
                            lift regs amount
                            drop MyWizardBag 121 76 0
                            wait 150
                        else
                            lift regs amount
                            drop MyWizardBag 142 76 0
                            wait 150
                        endif
                    endif
                        @ignore regs
                        if moveRegs = 1
                            wait 500
                        endif
                    endwhile
                    @setvar! regsID 3976
                    @setvar! myCounter 0
                    while findtype regsID self as r
                        @setvar! myCounter index
                        @ignore r
                    endwhile
                    @clearignore
                    if counttype regsID self <= 10
                        @setvar! amount 2
                    elseif counttype regsID self <= 20
                        @setvar! amount 4
                    elseif counttype regsID self <= 50
                        @setvar! amount 10
                    elseif counttype regsID self <= 100
                        @setvar! amount 20
                    elseif counttype regsID self <= 150
                        @setvar! amount 30
                    elseif counttype regsID self <= 200
                        @setvar! amount 40
                    else
                        @setvar! amount 50
                    endif
                    while findtype regsID self as regs
                        @setvar! moveRegs 0
                        if myCounter = 0
                            @setvar! moveRegs 1
                        elseif myCounter != 0 and not find regs MyWizardBag
                            @setvar! moveRegs 1
                        endif
                        if moveRegs = 1
                            if index = 0
                                lift regs amount
                                drop MyWizardBag 44 88 0
                                wait 150
                            elseif index = 1
                                lift regs amount
                                drop MyWizardBag 68 88 0
                                wait 150
                            elseif index = 2
                                lift regs amount
                                drop MyWizardBag 96 88 0
                                wait 150
                            elseif index = 3
                                lift regs amount
                                drop MyWizardBag 121 88 0
                                wait 150
                            else
                                lift regs amount
                                drop MyWizardBag 142 88 0
                                wait 150
                            endif
                        endif
                        @ignore regs
                        if moveRegs = 1
                            wait 500
                        endif
                    endwhile
                    @setvar! regsID 3974
                    @setvar! myCounter 0
                    while findtype regsID self as r
                        @setvar! myCounter index
                        @ignore r
                    endwhile
                    @clearignore
                    if counttype regsID self <= 10
                        @setvar! amount 2
                    elseif counttype regsID self <= 20
                        @setvar! amount 4
                    elseif counttype regsID self <= 50
                        @setvar! amount 10
                    elseif counttype regsID self <= 100
                        @setvar! amount 20
                    elseif counttype regsID self <= 150
                        @setvar! amount 30
                    elseif counttype regsID self <= 200
                        @setvar! amount 40
                    else
                        @setvar! amount 50
                    endif
                    while findtype regsID self as regs
                        @setvar! moveRegs 0
                        if myCounter = 0
                            @setvar! moveRegs 1
                        elseif myCounter != 0 and not find regs MyWizardBag
                            @setvar! moveRegs 1
                        endif
                        if moveRegs = 1
                            if index = 0
                                lift regs amount
                                drop MyWizardBag 44 100 0
                                wait 150
                            elseif index = 1
                                lift regs amount
                                drop MyWizardBag 68 100 0
                                wait 150
                            elseif index = 2
                                lift regs amount
                                drop MyWizardBag 96 100 0
                                wait 150
                            elseif index = 3
                                lift regs amount
                                drop MyWizardBag 121 100 0
                                wait 150
                            else
                                lift regs amount
                                drop MyWizardBag 142 100 0
                                wait 150
                            endif
                        endif
                        @ignore regs
                        if moveRegs = 1
                            wait 500
                        endif
                    endwhile
                    @setvar! regsID 3980
                    @setvar! myCounter 0
                    while findtype regsID self as r
                        @setvar! myCounter index
                        @ignore r
                    endwhile
                    @clearignore
                    if counttype regsID self <= 10
                        @setvar! amount 2
                    elseif counttype regsID self <= 20
                        @setvar! amount 4
                    elseif counttype regsID self <= 50
                        @setvar! amount 10
                    elseif counttype regsID self <= 100
                        @setvar! amount 20
                    elseif counttype regsID self <= 150
                        @setvar! amount 30
                    elseif counttype regsID self <= 200
                        @setvar! amount 40
                    else
                        @setvar! amount 50
                    endif
                    while findtype regsID self as regs
                        @setvar! moveRegs 0
                        if myCounter = 0
                            @setvar! moveRegs 1
                        elseif myCounter != 0 and not find regs MyWizardBag
                            @setvar! moveRegs 1
                        endif
                        if moveRegs = 1
                            if index = 0
                                lift regs amount
                                drop MyWizardBag 44 112 0
                                wait 150
                            elseif index = 1
                                lift regs amount
                                drop MyWizardBag 68 112 0
                                wait 150
                            elseif index = 2
                                lift regs amount
                                drop MyWizardBag 96 112 0
                                wait 150
                            elseif index = 3
                                lift regs amount
                                drop MyWizardBag 121 112 0
                                wait 150
                            else
                                lift regs amount
                                drop MyWizardBag 142 112 0
                                wait 150
                            endif
                        endif
                        @ignore regs
                        if moveRegs = 1
                            wait 500
                        endif
                    endwhile
                    @setvar! regsID 3973
                    @setvar! myCounter 0
                    while findtype regsID self as r
                        @setvar! myCounter index
                        @ignore r
                    endwhile
                    @clearignore
                    if counttype regsID self <= 10
                        @setvar! amount 2
                    elseif counttype regsID self <= 20
                        @setvar! amount 4
                    elseif counttype regsID self <= 50
                        @setvar! amount 10
                    elseif counttype regsID self <= 100
                        @setvar! amount 20
                    elseif counttype regsID self <= 150
                        @setvar! amount 30
                    elseif counttype regsID self <= 200
                        @setvar! amount 40
                    else
                        @setvar! amount 50
                    endif
                    while findtype regsID self as regs
                        @setvar! moveRegs 0
                        if myCounter = 0
                            @setvar! moveRegs 1
                        elseif myCounter != 0 and not find regs MyWizardBag
                            @setvar! moveRegs 1
                        endif
                        if moveRegs = 1
                            if index = 0
                                lift regs amount
                                drop MyWizardBag 44 124 0
                                wait 150
                            elseif index = 1
                                lift regs amount
                                drop MyWizardBag 68 124 0
                                wait 150
                            elseif index = 2
                                lift regs amount
                                drop MyWizardBag 96 124 0
                                wait 150
                            elseif index = 3
                                lift regs amount
                                drop MyWizardBag 121 124 0
                                wait 150
                            else
                                lift regs amount
                                drop MyWizardBag 142 124 0
                                wait 150
                            endif
                        endif
                        @ignore regs
                        if moveRegs = 1
                            wait 500
                        endif
                    endwhile
                    @setvar! regsID 3963
                    @setvar! myCounter 0
                    while findtype regsID self as r
                        @setvar! myCounter index
                        @ignore r
                    endwhile
                    @clearignore
                    if counttype regsID self <= 10
                        @setvar! amount 2
                    elseif counttype regsID self <= 20
                        @setvar! amount 4
                    elseif counttype regsID self <= 50
                        @setvar! amount 10
                    elseif counttype regsID self <= 100
                        @setvar! amount 20
                    elseif counttype regsID self <= 150
                        @setvar! amount 30
                    elseif counttype regsID self <= 200
                        @setvar! amount 40
                    else
                        @setvar! amount 50
                    endif
                    while findtype regsID self as regs
                        @setvar! moveRegs 0
                        if myCounter = 0
                            @setvar! moveRegs 1
                        elseif myCounter != 0 and not find regs MyWizardBag
                            @setvar! moveRegs 1
                        endif
                        if moveRegs = 1
                            if index = 0
                                lift regs amount
                                drop MyWizardBag 44 136 0
                                wait 150
                            elseif index = 1
                                lift regs amount
                                drop MyWizardBag 68 136 0
                                wait 150
                            elseif index = 2
                                lift regs amount
                                drop MyWizardBag 96 136 0
                                wait 150
                            elseif index = 3
                                lift regs amount
                                drop MyWizardBag 121 136 0
                                wait 150
                            else
                                lift regs amount
                                drop MyWizardBag 142 136 0
                                wait 150
                            endif
                        endif
                        @ignore regs
                        if moveRegs = 1
                            wait 500
                        endif
                    endwhile
                    @setvar! regsID 3972
                    @setvar! myCounter 0
                    while findtype regsID self as r
                        @setvar! myCounter index
                        @ignore r
                    endwhile
                    @clearignore
                    if counttype regsID self <= 10
                        @setvar! amount 2
                    elseif counttype regsID self <= 20
                        @setvar! amount 4
                    elseif counttype regsID self <= 50
                        @setvar! amount 10
                    elseif counttype regsID self <= 100
                        @setvar! amount 20
                    elseif counttype regsID self <= 150
                        @setvar! amount 30
                    elseif counttype regsID self <= 200
                        @setvar! amount 40
                    else
                        @setvar! amount 50
                    endif
                    while findtype regsID self as regs
                        @setvar! moveRegs 0
                        if myCounter = 0
                            @setvar! moveRegs 1
                        elseif myCounter != 0 and not find regs MyWizardBag
                            @setvar! moveRegs 1
                        endif
                        if moveRegs = 1
                            if index = 0
                                lift regs amount
                                drop MyWizardBag 44 148 0
                                wait 150
                            elseif index = 1
                                lift regs amount
                                drop MyWizardBag 68 148 0
                                wait 150
                            elseif index = 2
                                lift regs amount
                                drop MyWizardBag 96 148 0
                                wait 150
                            elseif index = 3
                                lift regs amount
                                drop MyWizardBag 121 148 0
                                wait 150
                            else
                                lift regs amount
                                drop MyWizardBag 142 148 0
                                wait 150
                            endif
                        endif
                        @ignore regs
                        if moveRegs = 1
                            wait 500
                        endif
                    endwhile
                    @setvar! regsID 8012
                    @setvar! myCounter 0
                    while findtype regsID self as r
                        @setvar! myCounter index
                        @ignore r
                    endwhile
                    @clearignore
                    if counttype regsID self <= 5
                        @setvar! amount 1
                    elseif counttype regsID self <= 10
                        @setvar! amount 2
                    elseif counttype regsID self <= 20
                        @setvar! amount 4
                    elseif counttype regsID self <= 40
                        @setvar! amount 8
                    else
                        @setvar! amount 15
                    endif
                    while findtype regsID self as regs
                        @setvar! moveRegs 0
                        if myCounter = 0
                            @setvar! moveRegs 1
                        elseif myCounter != 0 and not find regs MyWizardBag
                            @setvar! moveRegs 1
                        endif
                        @ignore regs
                        if moveRegs = 1
                            wait 500
                        endif
                    endwhile
                elseif EnableAutoRecallOverheadMessages = 1
                    overhead "[ NO WIZARD BAG! ]" 337
                endif
            endif

            if EnableInfiniteLoop = 1 and RedTargetFound != 1 and SkipInfiniteLoop != 1
                @setvar! TimeToGo 0
                @setvar! RECALLTIME 0
                if skill 'Healing' > 30
                    if not bandaging
                        if hp < maxhp or poisoned or findbuff "bleed" or findbuff "disease"
                            if EnableOverheadMessages = 1
                                overhead '[ BANDAGING... ]' 88
                            endif
                            hotkey "Bandage Self"
                            wait 500
                        endif
                    endif
                endif

                if EnableNobleSacrifice = 1
                    if diffhits > 50 and skill "Chivalry" >= 80 and timer "NobleSacrificeTimer" > 31000 and timer "ChivalryPrevented" > 5000
                        clearsysmsg
                        yell "[NobleSacrifice"
                        wait 250
                        if insysmsg "You do not have enough holy"
                            settimer "ChivalryPrevented" 0
                            clearsysmsg
                        else
                            wft 1000
                            target 'self'
                            if EnableOverheadMessages = 1
                                overhead "[ NOBLE SACRIFICE! ]" 155
                            endif
                            settimer "NobleSacrificeTimer" 0
                            cooldown "Noble Sacrifice" 31000
                        endif
                        wait 250
                    endif
                endif

                if EnableHolyLight = 1
                    if diffhits > 30 and skill "Chivalry" >= 95 and timer "HolyLightTimer" > 31000 and timer "ChivalryPrevented" > 5000
                        clearsysmsg
                        yell "[HolyLight"
                        wait 250
                        if insysmsg "You do not have enough holy"
                            settimer "ChivalryPrevented" 0
                            clearsysmsg
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ HOLY LIGHT! ]" 254
                            endif
                            settimer "HolyLightTimer" 0
                            cooldown "Holy Light" 31000
                        endif
                        wait 250
                    endif
                endif

                while timer "InfiniteLoop" < 30000
                    if timer "NoTargetTimer" < 4000
                        if EnableOverheadMessages = 1
                            overhead "[ WAITING TO LOOP... ]" 2234
                            settimer "NoTargetTimer" 0
                        else
                            overhead "[ . . . ]" 2234
                            settimer "NoTargetTimer" 0
                        endif
                    endif
                    wait 500
                    if warmode
                        @setvar! SkipInfiniteLoop 1
                        break
                    endif
                endwhile

            if EnableOverheadMessage = 1
                overhead "[ !! INFINITE LOOP !! ]" 419
            else
                overhead "    " 419
            endif

            if SkipInfiniteLoop != 1
                say '[SacredJourney'
                wait 1000
                for 5
                if insysmsg "You have been in combat"
                    wait 2000
                    say '[SacredJourney'
                    wait 1000
                else
                    break
                endif
                endfor
                waitforgump 1482653814
                if InfiniteLoopDestination = 2
                    gumpresponse 4
                elseif InfiniteLoopDestination = 1
                    gumpresponse 2
                endif
                wait 1500
                for 5
                if findtype 30528 ground -1 -1 1 as ChivGate
                    dclick ChivGate
                    wait 1500
                    break
                else
                    wait 1000
                endif
                endfor
                waitforgump
                gumpresponse 2
                wait 1000
                hotkey "Organizer Agent-01"
                replay
            else
                overhead "[ SCRIPT COMPLETE! ]" 88
                hotkey "Organizer Agent-01"
                @setvar! IHAVEDIED 0
                @setvar! DisableVacuums 0
                @setvar! TimeToGo 0
                @setvar! SkipInfiniteLoop 0
                @setvar! RedTargetFound 0
                @setvar! WarModeToggledWhileFighting 0
                @setvar! RECALLTIME 0
                stop
            endif
        else
            overhead "[ SCRIPT COMPLETE! ]" 88
            hotkey "Organizer Agent-01"
            @setvar! IHAVEDIED 0
            @setvar! DisableVacuums 0
            @setvar! TimeToGo 0
            @setvar! SkipInfiniteLoop 0
            @setvar! RedTargetFound 0
            @setvar! WarModeToggledWhileFighting 0
            @setvar! RECALLTIME 0
            stop
        endif
    endif

    //////////////////////////
    //   END AUTO RECALL    //
    //////////////////////////


    ///////////////////////
    //      CHECKS:      //
    ///////////////////////

    if insysmsg "Captcha successful" and EnableOverheadMessages = 1
        overhead "[ CAPTCHA SUCCESSFUL! ]" 84
        clearsysmsg
    endif

    if not findbuff 'food satisfaction' and findtype "tray" self and EnableEatingFood = 1
        if findtype "tray" self as Food
            if EnableOverheadMessages = 1
                overhead "[ EATING FOOD... ]" 88
            endif
            dclick Food
            wait 500
        endif
    endif

    if EnableSetMainPouchOrganizer01 = 1
        if timer "OrganizerAgentTimer" > 15000
            hotkey 'Organizer Agent-01'
            settimer "OrganizerAgentTimer" 0
        endif
    endif

    if EnableWeaponCheck = 1 and IHAVEDIED != 1
        if skill 'Swordsmanship' >= 50
            if not findtype '30988|5049|3909|3911|3915|3917|3934|3937|5046|5115|5119|5182|5185|5187|31128|31190' self
                overhead "[ NO WEAPON! ]" 337
                wait 2000
                sysmsg "Please acquire a weapon before you start this script!" 0
                stop
            else
                if not findtype '30988|5049|3909|3911|3915|3917|3934|3937|5046|5115|5119|5182|5185|5187|31128|31190' hand
                    if findtype '30988|5049|3909|3911|3915|3917|3934|3937|5046|5115|5119|5182|5185|5187|31128|31190' backpack as weapon
                        for 10
                        getlabel weapon WeaponLabel
                        wait 250
                        if "aspect" in WeaponLabel
                            break
                        else 
                            @ignore weapon
                            wait 150
                            if findtype '30988|5049|3909|3911|3915|3917|3934|3937|5046|5115|5119|5182|5185|5187|31128|31190' backpack as weapon
                                getlabel weapon WeaponLabel
                            endif
                        endif
                        endfor
                        wait 150
                        dclick weapon
                        wait 250
                    endif
                endif
            endif
        elseif skill 'Mace Fighting' >= 50
            if not findtype '31180|3568|3713|3721|3932|5040|5044|5112|5127|5177|5179|5181|30991|30999|31000|31001|31014|31178|31180|31182' self
                overhead "[ NO WEAPON! ]" 337
                wait 2000
                sysmsg "Please acquire a weapon before you start this script!" 0
                stop
            else
                if not findtype '31180|3568|3713|3721|3932|5040|5044|5112|5127|5177|5179|5181|30991|30999|31000|31001|31014|31178|31180|31182' hand
                    if findtype '31180|3568|3713|3721|3932|5040|5044|5112|5127|5177|5179|5181|30991|30999|31000|31001|31014|31178|31180|31182' backpack as weapon
                        for 10
                        getlabel weapon WeaponLabel
                        wait 250
                        if "aspect" in WeaponLabel
                            break
                        else
                            @ignore weapon
                            wait 150
                            if findtype '31180|3568|3713|3721|3932|5040|5044|5112|5127|5177|5179|5181|30991|30999|31000|31001|31014|31178|31180|31182' backpack as weapon
                                getlabel weapon WeaponLabel
                            endif
                        endif
                        endfor
                        wait 150
                        dclick weapon
                        wait 250
                    endif
                endif
            endif
        elseif skill 'Fencing' >= 50
            if not findtype '3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' self
                overhead "[ NO WEAPON! ]" 337
                wait 2000
                sysmsg "Please acquire a weapon before you start this script!" 0
                stop
            else
                if not findtype '3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' hand
                    if findtype '3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' backpack as weapon
                        for 10
                        getlabel weapon WeaponLabel
                        wait 250
                        if "aspect" in WeaponLabel
                            break
                        else
                            @ignore weapon
                            wait 150
                            if findtype '3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' backpack as weapon
                                getlabel weapon WeaponLabel
                            endif
                        endif
                        endfor
                        wait 150
                        dclick weapon
                        wait 250
                    endif
                endif
            endif
        elseif skill 'Archery' >= 50
            if not findtype '3920|5042|5117|30990|30993|30994|30995|31184|31186' self
                overhead "[ NO WEAPON! ]" 337
                wait 2000
                sysmsg "Please acquire a weapon before you start this script!" 0
                stop
            else
                if not findtype '3920|5042|5117|30990|30993|30994|30995|31184|31186' hand
                    if findtype '3920|5042|5117|30990|30993|30994|30995|31184|31186' backpack as weapon
                        for 10
                        getlabel weapon WeaponLabel
                        wait 250
                        if "aspect" in WeaponLabel
                            break
                        else
                            @ignore weapon
                            wait 150
                            if findtype '3920|5042|5117|30990|30993|30994|30995|31184|31186' backpack as weapon
                                getlabel weapon WeaponLabel
                            endif
                        endif
                        endfor
                        wait 150
                        dclick weapon
                        wait 250
                    endif
                endif
            endif
        elseif skill 'Wrestling' >= 50
            if not findtype '22187|31141|31142' self
                overhead "[ NO WEAPON! ]" 337
                wait 2000
                sysmsg "Please acquire a weapon before you start this script!" 0
                stop
            else
                if not findtype '22187|31141|31142' hand
                    if findtype '22187|31141|31142' backpack as weapon
                        for 4
                        getlabel weapon WeaponLabel
                        wait 250
                        if "aspect" in WeaponLabel
                            break
                        elseif "unidentified" in WeaponLabel
                            @ignore weapon
                            wait 150
                            if findtype '22187|31141|31142' backpack as weapon
                                getlabel weapon WeaponLabel
                            endif
                        else
                            @ignore weapon
                            wait 150
                            if findtype '22187|31141|31142' backpack as weapon
                                getlabel weapon WeaponLabel
                            endif
                        endif
                        endfor
                        wait 150
                        dclick weapon
                        wait 250
                    endif
                endif
            endif
        endif
    endif

    if EnableShieldCheck = 1 and skill 'Parrying' > 0 and IHAVEDIED != 1
        if not findtype 'Order shield|buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|wooden shield|parrying gauche' lefthand
            if findtype 'Order shield|buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|wooden shield|parrying gauche' backpack as shield
                getlabel shield ShieldLabel
                    for 4
                        wait 250
                        if "unidentified" in ShieldLabel
                            @ignore shield
                            wait 150
                            if findtype 'Order shield|buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|wooden shield|parrying gauche' backpack as shield
                                getlabel shield ShieldLabel
                            endif
                        endif
                    endfor
                wait 150
                dclick shield
                wait 250
            endif
        endif
    endif

    if EnableUsePotionKegs = 1 and findtype 'empty bottle%s%' self and findtype 'keg' self and diffhits < ActivateAutoHealHPdiff
        @setvar! PotionStockCheck 0
        while PotionStockCheck < 7 and findtype 'empty bottle%s%' self
            if PotionStockCheck = 0 and ExplosionPotionAmount != 0
                @setvar! PotionType 3853
                @setvar! KegColour 419
                @setvar! PotionAmounttoFill ExplosionPotionAmount
                @setvar! PotionStockCheck 1
            elseif PotionStockCheck = 1 and HealingPotionAmount != 0
                @setvar! PotionType 3852
                @setvar! KegColour 253
                @setvar! PotionAmounttoFill HealingPotionAmount
                @setvar! PotionStockCheck 2
            elseif PotionStockCheck = 2 and CurePotionAmount != 0
                @setvar! PotionType 3847
                @setvar! KegColour 44
                @setvar! PotionAmounttoFill CurePotionAmount
                @setvar! PotionStockCheck 3
            elseif PotionStockCheck = 3 and RefreshPotionAmount != 0
                @setvar! PotionType 3851
                @setvar! KegColour 37
                @setvar! PotionAmounttoFill RefreshPotionAmount
                @setvar! PotionStockCheck 4
            elseif PotionStockCheck = 4 and StrengthPotionAmount != 0
                @setvar! PotionType 3849
                @setvar! KegColour 956
                @setvar! PotionAmounttoFill StrengthPotionAmount
                @setvar! PotionStockCheck 5
            elseif PotionStockCheck = 5 and AgilityPotionAmount != 0
                @setvar! PotionType 3848
                @setvar! KegColour 93
                @setvar! PotionAmounttoFill AgilityPotionAmount
                @setvar! PotionStockCheck 6
            elseif PotionStockCheck = 6 and ResistPotionAmount != 0
                @setvar! PotionType 3846
                @setvar! KegColour 1109
                @setvar! PotionAmounttoFill ResistPotionAmount
                @setvar! PotionStockCheck 7
            else
                break
            endif
            
            while counttype PotionType self < PotionAmounttoFill
                if timer "AttackingTimer" > 500 and find ClosestTarget ground -1 -1 TargetAttackRange 
                    attack ClosestTarget
                    settimer "AttackingTimer" 0
                endif
                
                if not findtype 'empty bottle%s%' self
                    if EnableOverheadMessages = 1 and timer 'PotionKegTimer' > 5000
                        overhead "[ NO EMPTY BOTTLES... ]" 337
                        settimer 'PotionKegTimer' 0 
                    endif
                    break
                endif
                
                if findtype 'keg' self KegColour as myKeg
                    dclick myKeg
                    wait 250
                    if EnableOverheadMessages = 1
                        if timer 'PotionKegTimer' > 2000
                            overhead '[ FILLING POTS... ]' KegColour
                            settimer 'PotionKegTimer' 0
                        endif
                    endif
                else 
                    if EnableOverheadMessages = 1 and timer 'PotionKegTimer' > 5000
                        overhead "[ NO KEG TO USE... ]" KegColour
                        settimer 'PotionKegTimer' 0 
                    endif
                    break
                endif
            endwhile
                
            if counttype PotionType self < PotionAmounttoFill and not findtype 'empty bottle%s%' self 
                if EnableOverheadMessages = 1 and timer 'PotionKegTimer' > 5000
                    overhead "[ NO EMPTY BOTTLES... ]" 337
                    settimer 'PotionKegTimer' 0 
                endif
                break
            endif
        endwhile
    endif

    if EnableArrowCleanup = 1 and skill 'Archery' > 50
        while findtype 7163|3903 ground -1 -1 2 as item and diffhits < ActivateAutoHealHPdiff 
            if timer "ArrowCleanupTimer" > 3500
                if EnableOverheadMessages = 1
                    overhead '[ CLEANUP... ]' 93
                    settimer "ArrowCleanupTimer" 0
                else 
                    overhead '  ' 93
                    settimer "ArrowCleanupTimer" 0
                endif 
            endif
            hotkey "Grab Item"
            wft 1000
            target item
            wait 250
        endwhile

        if findtype "quiver" self as MyQuiver and timer "QuiverTimer" > 30000
            while findtype "quiver" self as MyQuiver
                getlabel MyQuiver MyQuiverdesc
                wait 250
                if 'decorative' in MyQuiverdesc
                    @ignore MyQuiver
                    wait 500
                else
                    break
                endif
            endwhile
            settimer "QuiverTimer" 0
            menu MyQuiver 0
            wait 250
        endif

        if findtype 7163 ground -1 -1 10 as bolt and timer "BoltCleanupRadar" > 3500
            overhead "" 93 bolt
            settimer "BoltCleanupRadar" 0
        endif

        if findtype 3903 ground -1 -1 10 as arrow and timer "ArrowCleanupRadar" > 3500
            overhead "" 37 arrow
            settimer "ArrowCleanupRadar" 0
        endif
    endif
        
    if EnableDungeonCleanup = 1 and diffhits < ActivateAutoHealHPdiff
        while findtype "iron ingot%s|board%s|cut up leather|3972|3962|3963|3980|3976|3973|3974|3981" ground -1 -1 2 as item
            if EnableOverheadMessages = 1
                if timer "DungeonCleanup" > 1500
                    overhead '[ CLEANUP... ]' 420
                    settimer "DungeonCleanup" 0
                endif
            else
                if timer "DungeonCleanup" > 1500
                    overhead '  ' 420
                    settimer "DungeonCleanup" 0
                endif
            endif
            hotkey "Grab Item"
            wft 1000
            target item
            wait 250
        endwhile
        if findtype "iron ingot%s|board%s|cut up leather|3972|3962|3963|3980|3976|3973|3974|3981" ground -1 -1 15 as dungeonjunk and timer "DungeonCleanupRadar" > 3500
            overhead "  " 420 dungeonjunk
            settimer "DungeonCleanupRadar" 0
        endif
    endif

    if EnablePKradar = 1
        if timer "PKRadar" > 1000
            hotkey 'Next Murderer Player Target'
            wait 250
            if insysmsg "No one matching that was found"
                settimer "PKRadar" 0
                clearsysmsg
            else
                hotkey 'Toggle War Only'
                @setvar! RedTargetFound 1
                @setvar! WarModeToggledWhileFighting 0
                @setvar! TimeToGo 1
                @setvar! MurdererTarget lasttarget
                replay
            endif
        endif
    endif

    if insysmsg "world is saving"
        settimer "WorldSaveTimer" 0
        if EnableOverheadMessages = 1
            overhead "[ WORLD SAVING... ]" 253
        endif
        while timer "WorldSaveTimer" < 4500
            if insysmsg "save complete"
                break
            endif
            wait 100
        endwhile
        if EnableOverheadMessages = 1
            overhead "[ SAVE COMPLETE! ]" 253
        endif
    endif


    ////////////////////////
    //     BARD BUFFS:    //
    ////////////////////////

    if skill 'Peacemaking' >= 50 or skill 'Provocation' >= 50 or skill 'Discordance' >= 50 and diffhits < ActivateAutoHealHPdiff
        if EnablePeacemakingBuff = 1 and not findbuff "Song Of Peacemaking" and timer 'Musicianship' > 5000 and timer 'PeacemakingTimer' > 11000 and timer "SongBuffDelay" > 10500
            skill "Peacemaking"
            wft 1500
            if insysmsg "What instrument shall you play?"
                if findtype "standing harp|sackbut|bamboo flute|tambourine|drum|lute|lap harp|gemshorn|hurdy gurdy|psaltery|shawm|vielle" as Instrument
                    target Instrument
                    wait 250
                else
                    if EnableOverheadMessages = 1
                        overhead "[ NO INSTRUMENT! ]" 337
                    endif
                endif
            endif
            if not insysmsg "This is not a musical instrument"
                wft 1500
                target backpack
                if EnableOverheadMessages = 1
                    overhead "[ j PEACEMAKING BUFF... j ]" 84
                endif
                cooldown "Peacemaking Buff" 900000
                settimer 'Musicianship' 0
                settimer "SongBuffDelay" 0
            endif
        endif

        if EnableDiscordanceBuff = 1 and not findbuff "Song Of Discordance" and timer 'Musicianship' > 5000 and timer 'DiscordanceTimer' > 11000 and timer "SongBuffDelay" > 10500
            skill "Discordance"
            wft 1500
            if insysmsg "What instrument shall you play?"
                if findtype "standing harp|sackbut|bamboo flute|tambourine|drum|lute|lap harp|gemshorn|hurdy gurdy|psaltery|shawm|vielle" as Instrument
                    target Instrument
                    wait 250
                else
                    if EnableOverheadMessages = 1
                        overhead "[ NO INSTRUMENT! ]" 337
                    endif
                endif
            endif
            if not insysmsg "This is not a musical instrument"
                wft 1500
                target backpack
                if EnableOverheadMessages = 1
                    overhead "[ j DISCORDANCE BUFF... j ]" 69
                endif
                cooldown "Discordance Buff" 900000
                settimer 'Musicianship' 0
                settimer "SongBuffDelay" 0
            endif
        endif

        if EnableProvocationBuff = 1 and not findbuff "Song of Provocation" and timer 'Musicianship' > 5000 and timer 'ProvocationTimer' > 11000 and timer "SongBuffDelay" > 10500
            skill "Provocation"
            wft 1500
            if insysmsg "What instrument shall you play?"
                if findtype "standing harp|sackbut|bamboo flute|tambourine|drum|lute|lap harp|gemshorn|hurdy gurdy|psaltery|shawm|vielle" as Instrument
                    target Instrument
                    wait 250
                else
                    if EnableOverheadMessages = 1
                        overhead "[ NO INSTRUMENT! ]" 337
                    endif
                endif
            endif
            if not insysmsg "This is not a musical instrument"
                wft 1500
                target backpack
                if EnableOverheadMessages = 1
                    overhead "[ j PROVOCATION BUFF... j ]" 2117
                endif
                cooldown "Provocation Buff" 900000
                settimer 'Musicianship' 0
                settimer "SongBuffDelay" 0
            endif
        endif
    endif


    /////////////////////////
    //     FIND TARGET:    //
    /////////////////////////

    if find ClosestTarget ground -1 -1 TargetAttackRange and TargetisnotClosest != 1
        if timer "AttackingTimer" > 500 
            attack ClosestTarget
            settimer "AttackingTimer" 0
        endif
    else
        @setvar! TargetisnotClosest 0

        if targetexists
            hotkey 'cancel current target'
        endif

        hotkey 'target closest grey monster'
        getlabel backpack backpacklabel
        @setvar ClosestTarget lasttarget
        @setvar TargetToAnalyze lasttarget


        ////////////////////////////
        //     NO TARGET LOOP:    //
        ////////////////////////////

        if not find TargetToAnalyze ground -1 -1 12
            
            if warmode and WarModeToggledWhileFighting = 1
                hotkey 'Toggle Peace Only'
                @setvar! WarModeToggledWhileFighting 0
            endif
            
            if timer noTargetMessageTimer > 3500
                if EnableOverheadMessages = 1
                    overhead '[ NOTHING TO TARGET... ]' 2338
                else
                    overhead '  ' 2338
                endif
                settimer noTargetMessageTimer 0
            endif

            if EnableHealPotion = 1 and diffhits >= HealPotionHPdiff
                if findtype "Yellow Potion" self as HealPot
                    getlabel HealPot HealPotlabel
                    if "next" in HealPotlabel
                        // Do nothing
                    else
                        @setvar! HealPotionCheck 0

                        if counttype 3852 self as HealPotCount
                            @setvar! HealPotionCheck HealPotCount
                        endif

                        clearsysmsg
                        dclicktype 3852
                        getlabel backpack backpackdesc
                        wait 250

                        if HealPotionCheck != counttype 3852 self or insysmsg "potion satchel used"
                            settimer 'HealPotionTimer' 0
                            cooldown "Healing Potion" HealingPotionCooldown
                            if EnableOverheadMessages = 1
                                if insysmsg "potion satchel used"
                                    overhead '[ FREE HEAL POTION ]' 253
                                else
                                    overhead "[ HEAL POTION ]" 253
                                endif
                            endif 
                            clearsysmsg
                        endif
                    endif
                else
                    if timer 'yellowMessageTimer' > 4500
                        overhead "[ NO HEAL POTS! ]" 337
                        settimer 'yellowMessageTimer' 0
                    endif
                endif
            endif

            if diffhits > 0 and not bandaging
                if skill 'healing' >= 30
                    if findtype 'clean bandage%s%' self
                        if targetexists
                            hotkey 'cancel current target'
                        endif
                        hotkey 'Bandage Self'
                        if EnableOverheadMessages = 1 
                            if aidsMessageTimer > 5000
                                overhead "[ BANDAGING... ]" 88
                                settimer aidsMessageTimer 0
                                wait 500
                            endif
                        endif
                    else
                        if timer aidsMessageTimer > 5000 and EnableOverheadMessages = 1
                            overhead "[ OUT OF BANDAGES! ]" 337
                            settimer aidsMessageTimer 0
                        endif
                    endif
                endif
            endif

            if weight > maxweight and EnableDropGoldWhenOverweight = 1
                if timer overweightMessageTimer > 4500
                    overhead "[ OVERWEIGHT! ]" 34
                    settimer overweightMessageTimer 0
                endif

                if DropGoldAmount != 0
                    clearignore
                    @setvar! DisableVacuums 1
                    wait 250 

                    if EnablePutLootinLockBox = 1
                        if findtype "wooden box" self as lockbox
                            if findtype "copper key" self as key
                                clearignore
                                getlabel lockbox lockboxlabel
                                wait 100
                                if "items" in lockboxlabel
                                    // Do nothing
                                else
                                    dclick key
                                    wft 1500
                                    target lockbox
                                    if EnableOverheadMessages = 1
                                        overhead "[loot box unlocked]" 84
                                    endif
                                    wait 500
                                    if insysmsg "It appears to be locked."
                                        dclick key
                                        wft 1500
                                        target lockbox
                                        wait 250
                                    endif
                                endif
                            elseif EnableOverheadMessages = 1
                                overhead "[ NO LOCKBOX KEY! ]" 337
                            endif
                        endif
                    endif

                    while weight > maxweight
                        if findtype "gold coin" self as easycomeeasygo
                            lift easycomeeasygo DropGoldAmount
                            droprelloc 0 0
                            getlabel backpack packdesc
                            if EnableOverheadMessages = 1
                                overhead "[ DROPPING GOLD... ]" 149
                            endif
                            wait 250
                            if insysmsg "cannot drop anything"
                                drop backpack -1 -1 -1
                                break 
                            endif
                            wait 250
                        else 
                            break 
                        endif
                    endwhile
                endif
            endif

            if EnableAutoSatchels = 1
                if findtype "3962|3963|3972|3973|3974|3976|3980|3981" backpack and findtype "reagent satchel" self as MyWizardBag
                    while findtype "reagent satchel" self as MyWizardBag
                        getlabel MyWizardBag MyWizardBagdesc
                        if 'decorative' in MyWizardBagdesc
                            @ignore MyWizardBag
                        else
                            break
                        endif
                    endwhile
                    if timer "WizardSatchelTimer" > 60000
                        menu MyWizardBag 0
                        wait 250
                        settimer "WizardSatchelTimer" 0
                    endif
                endif
                if findtype "Yellow Potion|Orange Potion|Red Potion|White Potion|Blue Potion|Black Potion|" backpack and findtype 31262 self as MyPotBag
                    if timer "PotionSatchelTimer" > 60000
                        menu MyPotBag 0
                        wait 250
                        settimer "PotionSatchelTimer" 0
                    endif
                endif
            endif

            if EnableAutoCarving = 1
                while findtype "corpse" ground -1 -1 2 as deadbody and diffhits < ActivateAutoHealHPdiff 
                    if findtype 11552 self
                        if targetexists
                            hotkey 'cancel current target'
                        endif
                        while not targetexists
                            skill 'forensicevaluation'
                        endwhile
                        if targetexists and find deadbody ground -1 -1 2
                            target 'self'
                            @ignore deadbody
                            wait 500
                        endif
                        if insysmsg "You dont see anything nearby"
                            clearsysmsg 
                            break
                        else
                            if EnableOverheadMessages = 1 and timer SkinningTimer > 3000 
                                overhead "[ SKINNING... ]" 333
                                settimer SkinningTimer 0
                            endif
                        endif 
                    else 
                        if EnableOverheadMessages = 1 and timer SkinningTimer > 15000
                            overhead "[ NO SKINNING KNIFE ]" 337
                            settimer SkinningTimer 0
                            break
                        endif  
                    endif 
                endwhile
            endif 

            if EnableGoldVacuum = 1 and DisableVacuums != 1
                if findtype "gold coin" ground -1 -1 12 as droppedmoney and timer "GoldRadar" > 3500
                    overhead "  " 149 droppedmoney
                    settimer "GoldRadar" 0
                endif
                while findtype "gold coin" ground -1 -1 2 as droppedmoney and diffhits < ActivateAutoHealHPdiff
                    overhead "  " 149
                    hotkey "Grab Item"
                    wft 2500
                    target droppedmoney
                    wait 250
                    if insysmsg "Invalid or inaccessible item"
                        wait 500
                        @ignore droppedmoney
                    endif
                    wait 250
                endwhile
            endif

            if EnableDungeonCleanup = 1 and DisableVacuums != 1
                while findtype "iron ingot%s|board%s|cut up leather|3972|3962|3963|3980|3976|3973|3974|3981" ground -1 -1 2 as item and diffhits < ActivateAutoHealHPdiff
                    if EnableOverheadMessages = 1
                        if timer "DungeonCleanup" > 1500
                            overhead '[ CLEANUP... ]' 420
                            settimer "DungeonCleanup" 0
                        endif
                    else
                        if timer "DungeonCleanup" > 1500
                            overhead '  ' 420
                            settimer "DungeonCleanup" 0
                        endif
                    endif
                    hotkey "Grab Item"
                    wft 1000
                    target item
                    wait 250
                endwhile

                if findtype "iron ingot%s|board%s|cut up leather|3972|3962|3963|3980|3976|3973|3974|3981" ground -1 -1 15 as dungeonjunk and timer "DungeonCleanupRadar" > 3500
                    overhead "  " 420 dungeonjunk
                    settimer "DungeonCleanupRadar" 0
                endif
            endif

            if EnableArrowCleanup = 1 and skill 'Archery' > 50
                while findtype 7163|3903 ground -1 -1 2 as item and diffhits < ActivateAutoHealHPdiff 
                    if timer "ArrowCleanupTimer" > 3500
                        if EnableOverheadMessages = 1
                            overhead '[ CLEANUP... ]' 93
                            settimer "ArrowCleanupTimer" 0
                        else 
                            overhead '  ' 93
                            settimer "ArrowCleanupTimer" 0
                        endif 
                    endif
                    hotkey "Grab Item"
                    wft 1000
                    target item
                    wait 250
                endwhile

                if findtype "quiver" self as MyQuiver and timer "QuiverTimer" > 30000
                    while findtype "quiver" self as MyQuiver
                        getlabel MyQuiver MyQuiverdesc
                        wait 250
                        if 'decorative' in MyQuiverdesc
                            @ignore MyQuiver
                            wait 500
                        else
                            break
                        endif
                    endwhile
                    settimer "QuiverTimer" 0
                    menu MyQuiver 0
                    wait 250
                endif
                
                if findtype 7163 ground -1 -1 10 as bolt and timer "BoltCleanupRadar" > 3500
                    overhead "  " 93 bolt
                    settimer "BoltCleanupRadar" 0
                endif

                if findtype 3903 ground -1 -1 10 as arrow and timer "ArrowCleanupRadar" > 3500
                    overhead "  " 37 arrow
                    settimer "ArrowCleanupRadar" 0
                endif
            endif

            if timer "SatchelTimer" > 15000 and findtype "reagent satchel" self
                for 2
                if findtype "reagent satchel" self as MyWizardBag
                    getlabel MyWizardBag MyWizardBagdesc
                    if "decorative" in MyWizardBagdesc
                        ignore MyWizardBag
                    else
                        menu MyWizardBag 0
                        settimer "SatchelTimer" 0
                        wait 250
                        break
                    endif
                endif
                endfor
            endif

            if timer "SatchelTimer" > 15000 and findtype 31262 self as MyPotBag
                menu MyPotBag 0
                settimer "SatchelTimer" 0
                wait 250
            endif

            if findtype "quiver" self as MyQuiver and timer "QuiverTimer" > 30000
                while findtype "quiver" self as MyQuiver
                    getlabel MyQuiver MyQuiverdesc
                    wait 250
                    if 'decorative' in MyQuiverdesc
                        @ignore MyQuiver
                        wait 500
                    else
                        break
                    endif
                endwhile
                settimer "QuiverTimer" 0
                menu MyQuiver 0
                wait 250
            endif

            if EnableTrackingAutoRecall = 1
                if PKTrackingRange = 60
                    if insysmsg ": 60 step" or insysmsg "60 space" or insysmsg ": 59 step" or insysmsg "59 space" or insysmsg ": 58 step" or insysmsg "58 space" or insysmsg ": 57 step" or insysmsg "57 space" or insysmsg ": 56 step" or insysmsg "56 space" or insysmsg ": 55 step" or insysmsg "55 space" or insysmsg ": 54 step" or insysmsg "54 space" or insysmsg ": 53 step" or insysmsg "53 space" or insysmsg ": 52 step" or insysmsg "52 space" or insysmsg ": 51 step" or insysmsg "51 space" or insysmsg ": 50 step" or insysmsg "50 space" or insysmsg ": 49 step" or insysmsg "49 space" or insysmsg ": 48 step" or insysmsg "48 space" or insysmsg ": 47 step" or insysmsg "47 space" or insysmsg ": 46 step" or insysmsg "46 space" or insysmsg ": 45 step" or insysmsg "45 space" or insysmsg ": 44 step" or insysmsg "44 space" or insysmsg ": 43 step" or insysmsg "43 space" or insysmsg ": 42 step" or insysmsg "42 space" or insysmsg ": 41 step" or insysmsg "41 space" or insysmsg ": 40 step" or insysmsg "40 space" or insysmsg ": 39 step" or insysmsg "39 space" or insysmsg ": 38 step" or insysmsg "38 space" or insysmsg ": 37 step" or insysmsg "37 space" or insysmsg ": 36 step" or insysmsg "36 space" or insysmsg ": 35 step" or insysmsg "35 space" or insysmsg ": 34 step" or insysmsg "34 space" or insysmsg ": 33 step" or insysmsg "33 space" or insysmsg ": 32 step" or insysmsg "32 space" or insysmsg ": 31 step" or insysmsg "31 space" or insysmsg ": 30 step" or insysmsg "30 space" or insysmsg ": 29 step" or insysmsg "29 space" or insysmsg ": 28 step" or insysmsg "28 space" or insysmsg ": 27 step" or insysmsg "27 space" or insysmsg ": 26 step" or insysmsg "26 space" or insysmsg ": 25 step" or insysmsg "25 space" or insysmsg ": 24 step" or insysmsg "24 space" or insysmsg ": 23 step" or insysmsg "23 space" or insysmsg ": 22 step" or insysmsg "22 space" or insysmsg ": 21 step" or insysmsg "21 space" or insysmsg ": 20 step" or insysmsg "20 space" or insysmsg ": 19 step" or insysmsg "19 space" or insysmsg ": 18 step" or insysmsg "18 space" or insysmsg ": 17 step" or insysmsg "17 space" or insysmsg ": 16 step" or insysmsg "16 space" or insysmsg ": 15 step" or insysmsg "15 space" or insysmsg ": 14 step" or insysmsg "14 space" or insysmsg ": 13 step" or insysmsg "13 space" or insysmsg ": 12 step" or insysmsg "12 space" or insysmsg ": 11 step" or insysmsg "11 space" or insysmsg ": 10 step" or insysmsg "10 space" or insysmsg ": 9 step" or insysmsg "(9 space" or insysmsg ": 8 step" or insysmsg "(8 space" or insysmsg ": 7 step" or insysmsg "(7 space" or insysmsg ": 6 step" or insysmsg "(6 space" or insysmsg ": 5 step" or insysmsg "(5 space" or insysmsg ": 4 step" or insysmsg "(4 space" or insysmsg ": 3 step" or insysmsg "(3 space" or insysmsg ": 2 step" or insysmsg "(2 space" or insysmsg ": 1 step" or insysmsg "(1 space" or insysmsg ": 0 step" or insysmsg "(0 space"
                        hotkey 'Toggle War Only'
                        if EnableRedAlertOverhead = 1
                            overhead "[ !! RED ALERT !! ]" 37
                        endif
                        @setvar! RedTargetFound 1
                        @setvar! WarModeToggledWhileFighting 0
                        clearsysmsg
                        replay
                    endif
                elseif PKTrackingRange = 50
                    if insysmsg ": 50 step" or insysmsg "50 space" or insysmsg ": 49 step" or insysmsg "49 space" or insysmsg ": 48 step" or insysmsg "48 space" or insysmsg ": 47 step" or insysmsg "47 space" or insysmsg ": 46 step" or insysmsg "46 space" or insysmsg ": 45 step" or insysmsg "45 space" or insysmsg ": 44 step" or insysmsg "44 space" or insysmsg ": 43 step" or insysmsg "43 space" or insysmsg ": 42 step" or insysmsg "42 space" or insysmsg ": 41 step" or insysmsg "41 space" or insysmsg ": 40 step" or insysmsg "40 space" or insysmsg ": 39 step" or insysmsg "39 space" or insysmsg ": 38 step" or insysmsg "38 space" or insysmsg ": 37 step" or insysmsg "37 space" or insysmsg ": 36 step" or insysmsg "36 space" or insysmsg ": 35 step" or insysmsg "35 space" or insysmsg ": 34 step" or insysmsg "34 space" or insysmsg ": 33 step" or insysmsg "33 space" or insysmsg ": 32 step" or insysmsg "32 space" or insysmsg ": 31 step" or insysmsg "31 space" or insysmsg ": 30 step" or insysmsg "30 space" or insysmsg ": 29 step" or insysmsg "29 space" or insysmsg ": 28 step" or insysmsg "28 space" or insysmsg ": 27 step" or insysmsg "27 space" or insysmsg ": 26 step" or insysmsg "26 space" or insysmsg ": 25 step" or insysmsg "25 space" or insysmsg ": 24 step" or insysmsg "24 space" or insysmsg ": 23 step" or insysmsg "23 space" or insysmsg ": 22 step" or insysmsg "22 space" or insysmsg ": 21 step" or insysmsg "21 space" or insysmsg ": 20 step" or insysmsg "20 space" or insysmsg ": 19 step" or insysmsg "19 space" or insysmsg ": 18 step" or insysmsg "18 space" or insysmsg ": 17 step" or insysmsg "17 space" or insysmsg ": 16 step" or insysmsg "16 space" or insysmsg ": 15 step" or insysmsg "15 space" or insysmsg ": 14 step" or insysmsg "14 space" or insysmsg ": 13 step" or insysmsg "13 space" or insysmsg ": 12 step" or insysmsg "12 space" or insysmsg ": 11 step" or insysmsg "11 space" or insysmsg ": 10 step" or insysmsg "10 space" or insysmsg ": 9 step" or insysmsg "(9 space" or insysmsg ": 8 step" or insysmsg "(8 space" or insysmsg ": 7 step" or insysmsg "(7 space" or insysmsg ": 6 step" or insysmsg "(6 space" or insysmsg ": 5 step" or insysmsg "(5 space" or insysmsg ": 4 step" or insysmsg "(4 space" or insysmsg ": 3 step" or insysmsg "(3 space" or insysmsg ": 2 step" or insysmsg "(2 space" or insysmsg ": 1 step" or insysmsg "(1 space" or insysmsg ": 0 step" or insysmsg "(0 space"
                        hotkey 'Toggle War Only'
                        if EnableRedAlertOverhead = 1
                            overhead "[ !! RED ALERT !! ]" 37
                        endif
                        @setvar! RedTargetFound 1
                        @setvar! WarModeToggledWhileFighting 0
                        clearsysmsg
                        replay
                    endif
                elseif PKTrackingRange = 40
                    if insysmsg ": 40 step" or insysmsg "40 space" or insysmsg ": 39 step" or insysmsg "39 space" or insysmsg ": 38 step" or insysmsg "38 space" or insysmsg ": 37 step" or insysmsg "37 space" or insysmsg ": 36 step" or insysmsg "36 space" or insysmsg ": 35 step" or insysmsg "35 space" or insysmsg ": 34 step" or insysmsg "34 space" or insysmsg ": 33 step" or insysmsg "33 space" or insysmsg ": 32 step" or insysmsg "32 space" or insysmsg ": 31 step" or insysmsg "31 space" or insysmsg ": 30 step" or insysmsg "30 space" or insysmsg ": 29 step" or insysmsg "29 space" or insysmsg ": 28 step" or insysmsg "28 space" or insysmsg ": 27 step" or insysmsg "27 space" or insysmsg ": 26 step" or insysmsg "26 space" or insysmsg ": 25 step" or insysmsg "25 space" or insysmsg ": 24 step" or insysmsg "24 space" or insysmsg ": 23 step" or insysmsg "23 space" or insysmsg ": 22 step" or insysmsg "22 space" or insysmsg ": 21 step" or insysmsg "21 space" or insysmsg ": 20 step" or insysmsg "20 space" or insysmsg ": 19 step" or insysmsg "19 space" or insysmsg ": 18 step" or insysmsg "18 space" or insysmsg ": 17 step" or insysmsg "17 space" or insysmsg ": 16 step" or insysmsg "16 space" or insysmsg ": 15 step" or insysmsg "15 space" or insysmsg ": 14 step" or insysmsg "14 space" or insysmsg ": 13 step" or insysmsg "13 space" or insysmsg ": 12 step" or insysmsg "12 space" or insysmsg ": 11 step" or insysmsg "11 space" or insysmsg ": 10 step" or insysmsg "10 space" or insysmsg ": 9 step" or insysmsg "(9 space" or insysmsg ": 8 step" or insysmsg "(8 space" or insysmsg ": 7 step" or insysmsg "(7 space" or insysmsg ": 6 step" or insysmsg "(6 space" or insysmsg ": 5 step" or insysmsg "(5 space" or insysmsg ": 4 step" or insysmsg "(4 space" or insysmsg ": 3 step" or insysmsg "(3 space" or insysmsg ": 2 step" or insysmsg "(2 space" or insysmsg ": 1 step" or insysmsg "(1 space" or insysmsg ": 0 step" or insysmsg "(0 space"
                        hotkey 'Toggle War Only'
                        if EnableRedAlertOverhead = 1
                            overhead "[ !! RED ALERT !! ]" 37
                        endif
                        @setvar! RedTargetFound 1
                        @setvar! WarModeToggledWhileFighting 0
                        clearsysmsg
                        replay
                    endif
                elseif PKTrackingRange = 0
                    if insysmsg "Now tracking"
                        hotkey 'Toggle War Only'
                        if EnableRedAlertOverhead = 1
                            overhead "[ !! RED ALERT !! ]" 37
                        endif
                        @setvar! RedTargetFound 1
                        @setvar! WarModeToggledWhileFighting 0
                        clearsysmsg
                        replay
                    endif
                endif
            endif

            if EnablePKradar = 1
                if timer "PKRadar" > 1000
                    hotkey 'Next Murderer Player Target'
                    wait 250
                    if insysmsg "No one matching that was found"
                        settimer "PKRadar" 0
                        clearsysmsg
                    else
                        hotkey 'Toggle War Only'
                        @setvar! RedTargetFound 1
                        @setvar! WarModeToggledWhileFighting 0
                        @setvar! TimeToGo 1
                        @setvar! MurdererTarget lasttarget
                        replay
                    endif
                endif
            endif

            while warmode
                if EnableAutoRedRecall = 1 or EnableAutoWeightRecall = 1 and WILDERNESSMODE = 1
                    overhead "[ RECALLING IN... ]" 2114
                    if not warmode
                        break
                    endif
                    wait 500
                    overhead "3" 69
                    wait 1000
                    if not warmode
                        break
                    endif
                    overhead "2" 69
                    wait 1000
                    if not warmode
                        break
                    endif
                    overhead "1" 69
                    wait 500
                    if not warmode
                        break
                    else
                        @setvar! AutoRecallTime 1
                        @setvar! SkipInfiniteLoop 1
                        replay
                    endif
                elseif EnableAutoRedDungeonGate = 1 or EnableAutoWeightDungeonGate = 1 and DUNGEONMODE = 1
                    if EnableOverheadMessages = 1
                        overhead "[ DUNGEON ESCAPE! ]" 2117
                    else
                        overhead "" 2117
                    endif
                    hotkey 'Toggle War Only'
                    @setvar! TimeToGo 1
                    @setvar! SkipInfiniteLoop 1
                    replay
                endif
            endwhile

            if EnableWeightWarningMessage = 1
                if diffweight < GreenWarningDiffWeight and diffweight > YellowWarningDiffWeight and timer "WeightTimer" > 6000
                    if EnableOverheadMessages = 1
                        overhead "[ WEIGHT WARNING... ]" 77
                        settimer "WeightTimer" 0
                    else
                        overhead "  " 77
                        settimer "WeightTimer" 0
                    endif
                    elseif diffweight < YellowWarningDiffWeight and diffweight > RedWeightLimitDiffWeight and timer "WeightTimer" > 6000
                    if EnableOverheadMessages = 1
                        overhead "[ WEIGHT WARNING! ]" 153
                        settimer "WeightTimer" 0
                    else
                        overhead "  " 153
                        settimer "WeightTimer" 0
                    endif
                elseif diffweight < RedWeightLimitDiffWeight and timer "WeightTimer" > 6000
                    if EnableOverheadMessages = 1
                        overhead "[ WEIGHT LIMIT REACHED! ]" 37
                        settimer "WeightTimer" 0
                    else
                        overhead "  " 37
                        settimer "WeightTimer" 0
                    endif

                    if EnableAutoWeightRecall = 1 and not find ClosestTarget ground -1 -1 8 and WILDERNESSMODE = 1
                        wait 1000
                        if EnableInfiniteLoop = 1
                            settimer "InfiniteLoop" 0
                        endif
                        hotkey 'Toggle War Only'
                        @setvar! AutoWeightRecall 1
                        @setvar! WarModeToggledWhileFighting 0
                        replay
                    elseif EnableAutoWeightRecall = 1 and find ClosestTarget ground -1 -1 8 and WILDERNESSMODE = 1
                        if EnableInfiniteLoop = 1
                            settimer "InfiniteLoop" 0
                        endif
                        if timer "RECALLDELAY" > 3500 and EnableAutoRecallOverheadMessages = 1
                            overhead "[ WAITING TO RECALL... ]" 149
                            settimer "RECALLDELAY" 0
                        endif
                        wait 500
                    elseif EnableAutoWeightDungeonGate = 1 and DUNGEONMODE = 1
                        wait 1000
                        if EnableInfiniteLoop = 1
                            settimer "InfiniteLoop" 0
                        endif
                        hotkey 'Toggle War Only'
                        @setvar! TimeToGo 1
                        replay
                    else
                        if EnableOverheadMessages = 1
                            overhead "[ OVERWEIGHT! ]" 337
                        else
                            overhead "  " 337
                        endif
                        sysmsg "Time to head home and unload your loot!" 0
                        settimer "WeightTimer" 0
                    endif
                endif
            endif

            if EnableArcheryWarningMessage = 1 and skill 'Archery' >= 50
                if findtype 'stubnose crossbow|tower guard crossbow|balestra|heavy crossbow|crossbow' hand
                    @setvar! AMMO 1
                elseif findtype 'long bow|bow|recurve bow|composite bow' hand
                    @setvar AMMO 2
                endif

                if counttype "crossbow bolt" self < ArcheryLowAmmoWarningAmount and timer "AmmunitionTimer" > 6000 and AMMO = 1
                    overhead "[ AMMO LOW! ]" 37
                    settimer 'AmmunitionTimer' 0
                endif

                if counttype "arrow" self < ArcheryLowAmmoWarningAmount and timer 'AmmunitionTimer' > 6000 and AMMO = 2
                    overhead "[ AMMO LOW! ]" 37
                    settimer 'AmmunitionTimer' 0
                endif
            endif

            if insysmsg "It appears to be locked."
                clearsysmsg
                replay
            endif

            if warmode on
                @setvar! TimeToGo 1
                replay
            endif

            if not varexist "NoLockbox"
                @setvar! NoLockbox 0
            endif

            if findtype "wooden box" self and findtype "copper key" self
                @setvar! NoLockbox 0
            endif

            if EnablePutLootinLockBox = 1 and NoLockbox != 1 and timer LootTimer > 5000 and not warmode
                if not findtype "wooden box" self or not findtype "copper key" self
                    if EnableOverheadMessages = 1
                        overhead "[ NO LOCKBOX FOUND! ]" 337
                    endif
                    @setvar! NoLockbox 1
                    wait 1500
                elseif counttype 2474 self > 1 or counttype 4110 self > 1
                    if EnableOverheadMessages = 1
                        overhead "[ TOO MANY LOCKBOXES/KEYS! ]" 337
                    endif
                    @setvar! NoLockbox 1
                    wait 1500
                else
                    clearsysmsg
                    hotkey 'Target closest grey monster'
                    wait 250
                    if insysmsg "matching that was found"
                        if findtype "wooden box" self as lockbox and findtype "copper key" self as key
                            if findtype '31017|31019|31021|31023|31025|31027|31029|31031|31033|31035|31037|31038|31041|31043|31045|31047|31049|31051|31053|31055|3821|31169|31172|31190|31128|31142|31141|31002|31130|31000|31001|31180|31182|31178|30991|30999|31014|20014|20012|20010|20008|20006|30992|30997|31176|31188|30998|30989|30996|30995|31186|31184|30994|30990|30993|37181|4026|4025|31010|31008|31007|31006|31015|31005|31009|31012|31011|31004|31003|31191|39911|17686|31014|30994|31142|31190|24434|43206|29363|43166|22336|29348|17087|3985|8826|3827|29030|3836|5981|4248|5359|3839|3838|3843|2597|29036|48407|3865|3859|3885|3856|3878|3877|3873|3861|3862|576|5123|7177|7027|3920|5131|5179|5075|5060|5076|5042|10245|3938|3913|7169|3909|5063|5089|7170|7033|3762|5040|5103|5117|7181|7029|3568|6264|3742|5139|6263|7026|5125|3740|5121|5204|5105|5185|5078|5115|7175|5059|7034|3713|3915|5112|5070|5049|5205|5046|7035|3911|7179|5106|5143|3573|3719|5177|7610|5181|3917|5132|7031|5207|5056|5085|3763|5129|5187|3721|5138|3570|5101|5061|5074|5142|5182|5146|6265|5090|5203|5044|5144|3932|5201|5127|3572|7173|5135|3937|3571|22326|27611|9917|3821|5356|8455|5362|45315|8454|22187|5901|126867981|7982|7983|7984|7985|7986|7987|7988|7989|7990|7991|7992|7993|7994|7995|7996|7997|7998|7999|8000|8001|8002|8003|8004|8005|8006|8007|8008|8009|8010|8011|8012|8013|8014|8015|8016|8017|8018|8019|8020|8021|8022|8023|8024|8025|8026|8027|8028|8029|8030|8031|8032|8033|8034|8035|8036|8037|8038|8039|8040|8041|8042|8033|8044|39889|39891|39892|39896|39897|39898|39905|39909|39911|39912|39916|39917|39918|3843|3838|3839|3842|15296|15297|29025|29034|29036|2472|2475|3648|3649|3650|3651|3708|3712|29832|29833|7107' backpack as loottostore
                                getlabel lockbox lockboxLabel
                                wait 250
                                if "items" in lockboxLabel
                                    if EnableOverheadMessages = 1 and timer "STORELOOT" > 5000
                                        overhead "[ SECURING LOOT... ]" 149
                                        settimer "STORELOOT" 0
                                    endif
                                else
                                    if EnableOverheadMessages = 1
                                        overhead "[loot box unlocked]" 84
                                    endif
                                    dclick key
                                    wft 1500
                                    target lockbox
                                    wait 250
                                    if EnableOverheadMessages = 1 and timer "STORELOOT" > 5000
                                        overhead "[ SECURING LOOT... ]" 149
                                        settimer "STORELOOT" 0
                                    endif
                                endif
                                while findtype '31017|31019|31021|31023|31025|31027|31029|31031|31033|31035|31037|31038|31041|31043|31045|31047|31049|31051|31053|31055|3821|31169|31172|31190|31128|31142|31141|31002|31130|31000|31001|31180|31182|31178|30991|30999|31014|20014|20012|20010|20008|20006|30992|30997|31176|31188|30998|30989|30996|30995|31186|31184|30994|30990|30993|37181|4026|4025|31010|31008|31007|31006|31015|31005|31009|31012|31011|31004|31003|31191|39911|17686|31014|30994|31142|31190|24434|43206|29363|43166|22336|29348|17087|3985|8826|3827|29030|3836|5981|4248|5359|3839|3838|3843|2597|29036|48407|3865|3859|3885|3856|3878|3877|3873|3861|3862|576|5123|7177|7027|3920|5131|5179|5075|5060|5076|5042|10245|3938|3913|7169|3909|5063|5089|7170|7033|3762|5040|5103|5117|7181|7029|3568|6264|3742|5139|6263|7026|5125|3740|5121|5204|5105|5185|5078|5115|7175|5059|7034|3713|3915|5112|5070|5049|5205|5046|7035|3911|7179|5106|5143|3573|3719|5177|7610|5181|3917|5132|7031|5207|5056|5085|3763|5129|5187|3721|5138|3570|5101|5061|5074|5142|5182|5146|6265|5090|5203|5044|5144|3932|5201|5127|3572|7173|5135|3937|3571|22326|27611|9917|3821|5356|8455|5362|45315|8454|22187|5901|126867981|7982|7983|7984|7985|7986|7987|7988|7989|7990|7991|7992|7993|7994|7995|7996|7997|7998|7999|8000|8001|8002|8003|8004|8005|8006|8007|8008|8009|8010|8011|8012|8013|8014|8015|8016|8017|8018|8019|8020|8021|8022|8023|8024|8025|8026|8027|8028|8029|8030|8031|8032|8033|8034|8035|8036|8037|8038|8039|8040|8041|8042|8033|8044|39889|39891|39892|39896|39897|39898|39905|39909|39911|39912|39916|39917|39918|3843|3838|3839|3842|15296|15297|29025|29034|29036|2472|2475|3648|3649|3650|3651|3708|3712|29832|29833|7107' backpack as loottostore
                                    if find loottostore lockbox
                                        @ignore loottostore
                                    else
                                        clearsysmsg
                                        lift loottostore 9999
                                        drop lockbox -1 -1 -1
                                        wait 500
                                        if insysmsg "It appears to be locked."
                                            dclick key
                                            wft 1500
                                            target lockbox
                                            wait 250
                                            clearsysmsg
                                        endif
                                    endif
                                    if warmode
                                        settimer "LootTimer" 0
                                        hotkey 'Toggle Peace Only'
                                        if EnableOverheadMessages = 1
                                            overhead "[ LOCKBOX SKIPPED! ]" 420
                                        else
                                            overhead "  " 420
                                        endif
                                        replay
                                    endif
                                endwhile
                                dclick key
                                wft 1500
                                target lockbox
                                if EnableOverheadMessages = 1
                                    overhead "[loot box locked]" 69
                                endif
                                @setvar! NeedtoSecureLoot 0
                            endif
                            getlabel lockbox lockboxLabel
                            wait 250
                            if "items" in lockboxLabel
                                dclick key
                                wft 1500
                                target lockbox
                                @setvar! NeedtoSecureLoot 0
                                settimer "LootTimer" 0
                            endif
                        endif
                    endif
                endif
            endif

            if targetexists
                hotkey 'cancel current target'
            endif
            replay

        //////////////////////////
        //     TARGET CHECK:    //
        //////////////////////////

        elseif not dead TargetToAnalyze and find TargetToAnalyze ground -1 -1 12
            while diffhits < ActivateAutoHealHPdiff 
                if diffhits >= ActivateAutoHealHPdiff 
                    replay
                endif 

                if find ClosestTarget ground -1 -1 TargetAttackRange or find TargetToAnalyze ground -1 -1 TargetAttackRange or find lasttarget ground -1 -1 TargetAttackRange
                    attack lasttarget
                    attack ClosestTarget
                    attack TargetToAnalyze
                endif

                if EnableHealPotion = 1 and diffhits >= HealPotionHPdiff
                    if findtype "Yellow Potion" self as HealPot
                        getlabel HealPot HealPotlabel
                        if "next" in HealPotlabel
                            // Do nothing
                        else
                            @setvar! HealPotionCheck 0

                            if counttype 3852 self as HealPotCount
                                @setvar! HealPotionCheck HealPotCount
                            endif

                            clearsysmsg
                            dclicktype 3852
                            getlabel backpack backpackdesc
                            wait 250

                            if HealPotionCheck != counttype 3852 self or insysmsg "potion satchel used"
                                settimer 'HealPotionTimer' 0
                                cooldown "Healing Potion" HealingPotionCooldown
                                if EnableOverheadMessages = 1
                                    if insysmsg "potion satchel used"
                                        overhead '[ FREE HEAL POTION ]' 253
                                    else
                                        overhead "[ HEAL POTION ]" 253
                                    endif
                                endif 
                                clearsysmsg
                            endif
                        endif
                    else
                        if timer 'yellowMessageTimer' > 4500
                            overhead "[ NO HEAL POTS! ]" 337
                            settimer 'yellowMessageTimer' 0
                        endif
                    endif
                endif

                if diffhits > 0 and not bandaging
                    if skill 'healing' >= 30
                        if findtype 'clean bandage%s%' self
                            if targetexists
                                hotkey 'cancel current target'
                            endif
                            hotkey 'Bandage Self'
                            if EnableOverheadMessages = 1 
                                if aidsMessageTimer > 5000
                                    overhead "[ BANDAGING... ]" 88
                                    settimer aidsMessageTimer 0
                                    wait 500
                                endif
                            endif
                        else
                            if timer aidsMessageTimer > 5000 and EnableOverheadMessages = 1
                                overhead "[ OUT OF BANDAGES! ]" 337
                                settimer aidsMessageTimer 0
                            endif
                        endif
                    endif
                endif

                if EnableFrostAspect = 1
                    if insysmsg "Frost Shell activated"
                        cooldown "Frost Shell Active" 5000
                        if EnableOverheadMessages = 1
                            overhead "[ FROST SHELL! ]" 2234
                        else
                            overhead "  " 2234
                        endif
                        if FrostAspectTier = 0
                            cooldown "Frost Shell Cooldown" 30000
                        elseif FrostAspectTier = 1
                            cooldown "Frost Shell Cooldown" 29000
                        elseif FrostAspectTier = 2
                            cooldown "Frost Shell Cooldown" 28000
                        elseif FrostAspectTier = 3
                            cooldown "Frost Shell Cooldown" 27000
                        elseif FrostAspectTier = 4
                            cooldown "Frost Shell Cooldown" 26000
                        elseif FrostAspectTier = 5
                            cooldown "Frost Shell Cooldown" 25000
                        elseif FrostAspectTier = 6
                            cooldown "Frost Shell Cooldown" 24000
                        elseif FrostAspectTier = 7
                            cooldown "Frost Shell Cooldown" 23000
                        elseif FrostAspectTier = 8
                            cooldown "Frost Shell Cooldown" 22000
                        elseif FrostAspectTier = 9
                            cooldown "Frost Shell Cooldown" 21000
                        elseif FrostAspectTier = 10
                            cooldown "Frost Shell Cooldown" 20000
                        elseif FrostAspectTier = 11
                            cooldown "Frost Shell Cooldown" 19000
                        elseif FrostAspectTier = 12
                            cooldown "Frost Shell Cooldown" 18000
                        elseif FrostAspectTier = 13
                            cooldown "Frost Shell Cooldown" 17000
                        elseif FrostAspectTier = 14
                            cooldown "Frost Shell Cooldown" 16000
                        elseif FrostAspectTier = 15
                            cooldown "Frost Shell Cooldown" 15000
                        elseif FrostAspectTier = 14
                            cooldown "Frost Shell Cooldown" 15000
                        endif
                        clearsysmsg
                    endif
                endif

                if EnableGoldVacuum = 1 and DisableVacuums != 1
                    if findtype "gold coin" ground -1 -1 12 as droppedmoney and timer "GoldRadar" > 3500
                        overhead "  " 149 droppedmoney
                        settimer "GoldRadar" 0
                    endif
                    while findtype "gold coin" ground -1 -1 2 as droppedmoney and diffhits < ActivateAutoHealHPdiff
                        overhead "  " 149
                        hotkey "Grab Item"
                        wft 2500
                        target droppedmoney
                        wait 250
                        if insysmsg "Invalid or inaccessible item"
                            wait 500
                            @ignore droppedmoney
                        endif
                        wait 250
                    endwhile
                endif

                if EnableDungeonCleanup = 1 and DisableVacuums != 1
                    while findtype "iron ingot%s|board%s|cut up leather|3972|3962|3963|3980|3976|3973|3974|3981" ground -1 -1 2 as item and diffhits < ActivateAutoHealHPdiff
                        if EnableOverheadMessages = 1
                            if timer "DungeonCleanup" > 1500
                                overhead '[ CLEANUP... ]' 420
                                settimer "DungeonCleanup" 0
                            endif
                        else
                            if timer "DungeonCleanup" > 1500
                                overhead '  ' 420
                                settimer "DungeonCleanup" 0
                            endif
                        endif
                        hotkey "Grab Item"
                        wft 1000
                        target item
                        wait 250
                    endwhile

                    if findtype "iron ingot%s|board%s|cut up leather|3972|3962|3963|3980|3976|3973|3974|3981" ground -1 -1 15 as dungeonjunk and timer "DungeonCleanupRadar" > 3500
                        overhead "  " 420 dungeonjunk
                        settimer "DungeonCleanupRadar" 0
                    endif
                endif

                if EnableArrowCleanup = 1 and skill 'Archery' > 50
                    while findtype 7163|3903 ground -1 -1 2 as item and diffhits < ActivateAutoHealHPdiff 
                        if timer "ArrowCleanupTimer" > 3500
                            if EnableOverheadMessages = 1
                                overhead '[ CLEANUP... ]' 93
                                settimer "ArrowCleanupTimer" 0
                            else 
                                overhead '  ' 93
                                settimer "ArrowCleanupTimer" 0
                            endif 
                        endif
                        hotkey "Grab Item"
                        wft 1000
                        target item
                        wait 250
                    endwhile
                        
                    if findtype "quiver" self as MyQuiver and timer "QuiverTimer" > 30000
                        while findtype "quiver" self as MyQuiver
                            getlabel MyQuiver MyQuiverdesc
                            wait 250
                            if 'decorative' in MyQuiverdesc
                                @ignore MyQuiver
                                wait 500
                            else
                                break
                            endif
                        endwhile
                        settimer "QuiverTimer" 0
                        menu MyQuiver 0
                        wait 250
                    endif

                    if findtype 7163 ground -1 -1 10 as bolt and timer "BoltCleanupRadar" > 3500
                        overhead "  " 93 bolt
                        settimer "BoltCleanupRadar" 0
                    endif

                    if findtype 3903 ground -1 -1 10 as arrow and timer "ArrowCleanupRadar" > 3500
                        overhead "  " 37 arrow
                        settimer "ArrowCleanupRadar" 0
                    endif
                endif

                if timer searchingMessageTimer > 10000
                    if EnableOverheadMessages = 1
                        overhead '[ ANALYZING TARGETS... ]' 90
                    endif
                    settimer searchingMessageTimer 0
                endif 

                if insysmsg "world is saving"
                    settimer "WorldSaveTimer" 0
                    if EnableOverheadMessages = 1
                        overhead "[ WORLD SAVING... ]" 253
                    endif
                    while timer "WorldSaveTimer" < 4500
                        if insysmsg "save complete"
                            break
                        endif
                        wait 100
                    endwhile
                    if EnableOverheadMessages = 1
                        overhead "[ SAVE COMPLETE! ]" 253
                    endif
                endif

                if find TargetToAnalyze ground -1 -1 12
                    getlabel TargetToAnalyze tempLabel

                    if inlist animalsIgnoreList tempLabel
                        if EnableOverheadMessages = 1
                            overhead "[ IGNORING MOB... ]" 44 TargetToAnalyze
                        else 
                            overhead "  " 44 TargetToAnalyze
                        endif
                        @ignore TargetToAnalyze
                        break
                    else
                        skill 'begging'
                    
                        while not targetexists
                            if insysmsg 'you must wait'
                                break
                            endif
                        endwhile
                        
                        if not insysmsg 'you must wait'
                            target TargetToAnalyze
                            getlabel backpack packdesc
                        endif

                        if not dead TargetToAnalyze
                            if insysmsg "Target cannot be seen"
                                if timer "CANNOTSEE" > 4500 and EnableOverheadMessages = 1
                                    overhead  "[ CANNOT BE SEEN! ]" 44 TargetToAnalyze
                                    settimer "CANNOTSEE" 0
                                    settimer "TargetAcquired" 0
                                elseif timer "CANNOTSEE" > 4500 and EnableOverheadMessages = 0
                                    overhead "  " 44 TargetToAnalyze
                                    settimer "CANNOTSEE" 0
                                    settimer "TargetAcquired" 0
                                endif
                            elseif insysmsg "That is too far away."
                                if timer "TOOFAR" > 4500 and EnableOverheadMessages = 1
                                    overhead "[ TOO FAR AWAY! ]" 44 TargetToAnalyze
                                    settimer "TOOFAR" 0
                                    settimer "TargetAcquired" 0
                                elseif timer "TOOFAR" > 4500 and EnableOverheadMessages = 0
                                    overhead "  " 44 TargetToAnalyze
                                    settimer "TOOFAR" 0
                                    settimer "TargetAcquired" 0
                                endif
                            elseif insysmsg "Perhaps" or insysmsg "You are too far away from them" or insysmsg "They do not appear to have anything to offer you" or insysmsg "You must wait"
                                if insysmsg "You must wait"
                                    hotkey 'target closest grey monster'
                                    getlabel backpack packdesc
                                    @setvar! TargetToAnalyze lasttarget
                                    clearsysmsg
                                endif

                                hotkey 'target closest grey monster'
                                getlabel backpack packdesc
                                @setvar! ClosestTarget lasttarget
                               
                                if find TargetToAnalyze ground -1 -1 TargetAttackRange and TargetToAnalyze = ClosestTarget
                                    if timer "NoTargetTimer" > 2000 
                                        if EnableOverheadMessages = 1
                                            overhead "  TARGET  " 69 TargetToAnalyze 
                                        else 
                                            overhead "  " 69 TargetToAnalyze 
                                        endif 
                                        settimer "NoTargetTimer" 0
                                    endif
                                    settimer "TargetAcquired" 0
                                    @setvar! previousTarget currentTarget

                                    if TargetToAnalyze = ClosestTarget
                                        attack ClosestTarget        
                                    else 
                                        replay
                                    endif 

                                    if timer "ATTACKTIMER" > 4000
                                        if EnableOverheadMessages = 1
                                            overhead "[ ATTACKING! ]" 69
                                            settimer "ATTACKTIMER" 0
                                            settimer "NoTargetTimer" 0
                                            settimer "TargetAcquired" 0
                                        else
                                            settimer "ATTACKTIMER" 0
                                            settimer "NoTargetTimer" 0
                                            settimer "TargetAcquired" 0
                                            settimer "AttackingTimer" 500
                                        endif
                                    endif
                                    break
                                elseif find TargetToAnalyze ground -1 -1 12
                                    if timer "NoTargetTimer" > 3500 
                                        if EnableOverheadMessages = 1
                                            overhead "[ GET CLOSER! ]" 69 TargetToAnalyze
                                        else
                                            overhead "  " 69 TargetToAnalyze
                                        endif
                                        settimer "NoTargetTimer" 0
                                        settimer "TargetAcquired" 0
                                    endif
                                endif
                            endif
                        else 
                            break
                        endif
                    endif
                else 
                    break
                endif
                        
                if EnableAlwaysTargetClosest = 1
                    if timer "AmIclosestMOB" > 500 and timer "ATTACKTIMER" > 2500
                        hotkey 'Target Closest Grey Monster'
                        getlabel backpack backpacklabel
                        @setvar! TargetCheck lasttarget
                        if ClosestTarget != TargetCheck
                            settimer "AmIclosestMOB" 0
                            @setvar! TargetisnotClosest 1
                            if EnableOverheadMessages = 1 
                               if timer "NoTargetTimer" > 4000 and timer "TargetAcquired" > 4000 
                                    overhead '[ RETARGETING... ]' 88
                                    settimer "TargetAcquired" 0
                                    settimer "NoTargetTimer" 0
                                endif
                            else
                                if timer "NoTargetTimer" > 4000 and timer "TargetAcquired" > 4000 
                                    if EnableOverheadMessages = 1
                                        overhead "  TARGET  " 88 TargetCheck
                                    else 
                                        overhead "  " 88 TargetCheck
                                    endif 
                                    settimer "TargetAcquired" 0
                                    settimer "NoTargetTimer" 0
                                endif
                            endif
                            @setvar! TargetCheck 0
                            break
                        else
                            attack ClosestTarget
                            attack TargetCheck
                            settimer "AmIclosestMOB" 0
                            @setvar! TargetCheck 0
                            @setvar! TargetisnotClosest 0
                            break 
                        endif
                    endif
                endif

                if find ClosestTarget ground -1 -1 TargetAttackRange
                    break
                endif                
        
                if targetexists
                    hotkey 'cancel current target'
                endif
            endwhile
        endif
    endif


    //////////////////////////
    //  BEGIN COMBAT LOOP:  //
    //////////////////////////
            
    while not dead ClosestTarget and find ClosestTarget ground -1 -1 TargetAttackRange 
        if dead ClosestTarget or not find ClosestTarget ground -1 -1 TargetAttackRange
            @setvar! SwitchtoIncendiaryAmmo 0
            replay
        endif

        if diffhits >= ActivateAutoHealHPdiff 
            replay
        endif 

        getlabel ClosestTarget TargetDesc
        
        if EnableOverheadMessages = 1
            if timer 'TargetAcquired' > 3000
                if "Paragon" in TargetDesc and find ClosestTarget ground -1 -1 12 and not dead ClosestTarget
                    overhead "  PARAGON!  " 12 ClosestTarget
                    settimer "TargetAcquired" 0
                    settimer "NoTargetTimer" 0
                    attack ClosestTarget
                elseif find ClosestTarget ground -1 -1 TargetAttackRange and not dead ClosestTarget
                    overhead "  TARGET  " 253 ClosestTarget
                    settimer "TargetAcquired" 0
                    settimer "NoTargetTimer" 0
                    attack ClosestTarget
                endif
            endif
        else
            if timer 'TargetAcquired' > 3000
                if "Paragon" in TargetDesc and find ClosestTarget ground -1 -1 12 and not dead ClosestTarget
                    overhead "  " 12 ClosestTarget
                    settimer "TargetAcquired" 0
                    settimer "NoTargetTimer" 0
                    attack ClosestTarget
                elseif find ClosestTarget ground -1 -1 TargetAttackRange and not dead ClosestTarget
                    overhead "  " 253 ClosestTarget
                    settimer "TargetAcquired" 0
                    settimer "NoTargetTimer" 0
                    attack ClosestTarget
                endif
            endif
        endif

        if EnableAlwaysTargetClosest = 1
            if timer "AmIclosestMOB" > 500 and timer "ATTACKTIMER" > 2500
                hotkey 'Target Closest Grey Monster'
                getlabel backpack backpacklabel
                @setvar! TargetCheck lasttarget
                if ClosestTarget != TargetCheck
                    settimer "AmIclosestMOB" 0
                    @setvar! TargetisnotClosest 1
                    if EnableOverheadMessages = 1 
                       if timer "NoTargetTimer" > 4000 and timer "TargetAcquired" > 4000 
                            overhead '[ RETARGETING... ]' 88
                            settimer "TargetAcquired" 0
                            settimer "NoTargetTimer" 0
                        endif
                    else
                        if timer "NoTargetTimer" > 4000 and timer "TargetAcquired" > 4000 
                            overhead '  ' 88 TargetCheck
                            settimer "TargetAcquired" 0
                            settimer "NoTargetTimer" 0
                        endif
                    endif
                    @setvar! TargetCheck 0
                    replay
                else
                    attack ClosestTarget
                    attack TargetCheck
                    settimer "AmIclosestMOB" 0
                    @setvar! TargetCheck 0
                    @setvar! TargetisnotClosest 0
                endif
            endif
        endif
        
        if timer "AttackingTimer" > 500 
            if find ClosestTarget ground -1 -1 TargetAttackRange 
                attack ClosestTarget
                settimer "AttackingTimer" 0
            else 
                replay
            endif 
        endif

        if EnableHealPotion = 1 and diffhits >= HealPotionHPdiff
            if findtype "Yellow Potion" self as HealPot
                getlabel HealPot HealPotlabel
                if "next" in HealPotlabel
                    // Do nothing
                else
                    @setvar! HealPotionCheck 0

                    if counttype 3852 self as HealPotCount
                        @setvar! HealPotionCheck HealPotCount
                    endif

                    clearsysmsg
                    dclicktype 3852
                    getlabel backpack backpackdesc
                    wait 250

                    if HealPotionCheck != counttype 3852 self or insysmsg "potion satchel used"
                        settimer 'HealPotionTimer' 0
                        cooldown "Healing Potion" HealingPotionCooldown
                        if EnableOverheadMessages = 1
                            if insysmsg "potion satchel used"
                                overhead '[ FREE HEAL POTION ]' 253
                            else
                                overhead "[ HEAL POTION ]" 253
                            endif
                        endif 
                        clearsysmsg
                    endif
                endif
            else
                if timer 'yellowMessageTimer' > 4500
                    overhead "[ NO HEAL POTS! ]" 337
                    settimer 'yellowMessageTimer' 0
                endif
            endif
        endif

        if diffhits > 0 and not bandaging
            if skill 'healing' >= 30
                if findtype 'clean bandage%s%' self
                    if targetexists
                        hotkey 'cancel current target'
                    endif
                    hotkey 'Bandage Self'
                    if EnableOverheadMessages = 1 
                        if aidsMessageTimer > 5000
                            overhead "[ BANDAGING... ]" 88
                            settimer aidsMessageTimer 0
                            wait 500
                        endif
                    endif
                else
                    if timer aidsMessageTimer > 5000 and EnableOverheadMessages = 1
                        overhead "[ OUT OF BANDAGES! ]" 337
                        settimer aidsMessageTimer 0
                    endif
                endif
            endif
        endif

        if EnablePKradar = 1
            if timer "PKRadar" > 1000
                hotkey 'Next Murderer Player Target'
                wait 250
                if insysmsg "No one matching that was found"
                    settimer "PKRadar" 0
                    clearsysmsg
                else
                    hotkey 'Toggle War Only'
                    @setvar! RedTargetFound 1
                    @setvar! WarModeToggledWhileFighting 0
                    @setvar! TimeToGo 1
                    @setvar! MurdererTarget lasttarget
                    replay
                endif
            endif
        endif

        if EnableAutoParalyzePouch = 1
            if paralyzed
                if findtype "pouch" self
                    yell "[pouch"
                    hotkey 'Toggle War Only'
                    replay
                else
                    if EnableOverheadMessages = 1
                        overhead "[ NO MORE POUCHES! ]" 337
                    endif
                endif
            endif
        endif


    ///////////////////////
    //  BARDING SKILLS:  //
    ///////////////////////

        if dead ClosestTarget
            @setvar! SwitchtoIncendiaryAmmo 0
            break
        endif

        if timer "AttackingTimer" > 500 
            if find ClosestTarget ground -1 -1 TargetAttackRange 
                attack ClosestTarget
                settimer "AttackingTimer" 0
            else 
                replay
            endif 
        endif

        if diffhits >= ActivateAutoHealHPdiff 
            replay
        endif 

        if skill "Provocation" >= 50 and EnableProvocation = 1
            if timer "NextTargetCheck" > 1000
                hotkey 'Next Grey Monster Target'
                wait 150
                @setvar! NextClosestTarget lasttarget
                getlabel NextClosestTarget descNextTarget
                if NextClosestTarget != ClosestTarget
                    for 4
                    if find NextClosestTarget ground -1 -1 12 and ClosestTarget != NextClosestTarget
                        if timer "NextTargetTimer" > 3500
                            if "Paragon" in descNextTarget
                                if EnableOverheadMessages = 1 and not dead NextClosestTarget
                                    overhead "  PARAGON!  " 12 NextClosestTarget
                                elseif not dead NextClosestTarget
                                    overhead "  " 12 NextClosestTarget
                                endif
                            else
                                if EnableOverheadMessages = 1 and not dead NextClosestTarget
                                    overhead "  PROVO TARGET  " 2117 NextClosestTarget
                                elseif not dead NextClosestTarget
                                    overhead "  " 2117 NextClosestTarget
                                endif
                            endif
                            settimer "NextTargetTimer" 0
                        endif
                        break
                    else
                        hotkey 'Next Grey Monster Target'
                        wait 150
                        @setvar! NextClosestTarget lasttarget
                        getlabel NextClosestTarget descNextTarget
                    endif
                    endfor
                endif

                if NextClosestTarget != ClosestTarget and find NextClosestTarget ground -1 -1 8
                    @setvar! NeedtoProvoke 1
                    @setvar! NeedtoPacify 0
                    @setvar! NeedtoDiscord 0
                    @setvar! SwitchtoIncendiaryAmmo 1
                else
                    @setvar! NeedtoProvoke 0
                    @setvar! NeedtoPacify 1
                    @setvar! SwitchtoIncendiaryAmmo 0
                endif

                hotkey 'Target Closest Grey Monster'
                wait 150
                @setvar! ClosestTarget lasttarget
                getlabel ClosestTarget descTarget
                settimer "NextTargetCheck" 0
            endif

            if timer "ProvoCheck" > 2000
                if find ClosestTarget gound -1 -1 TargetAttackRange and find NextClosestTarget ground -1 -1 12 and ClosestTarget != NextClosestTarget
                    getlabel ClosestTarget descTarget
                    getlabel NextClosestTarget descNextTarget
                    wait 150
                    if "provoked" in descTarget
                        if timer "ProvokedTimer" > 31000
                            settimer "ProvokedTimer" 0
                        endif
                        @setvar! NeedtoProvoke 0
                        settimer "ProvoCheck" 0
                        @setvar! SwitchtoIncendiaryAmmo 1
                    else
                        settimer "ProvokedTimer" 31000
                        @setvar! NeedtoProvoke 1
                        @setvar! NeedtoPacify 0
                        @setvar! NeedtoDiscord 0
                        settimer "ProvoCheck" 0
                        @setvar! SwitchtoIncendiaryAmmo 0
                    endif
                else
                    @setvar! NeedtoProvoke 0
                    settimer "ProvoCheck" 0
                endif
            endif
        endif

        if skill 'Peacemaking' >= 50 or skill 'Discordance' >= 50
            if skill "Peacemaking" >= 50 and EnablePeacemaking = 1
                if timer "PeaceCheck" > 2000
                    if find ClosestTarget ground -1 -1 TargetAttackRange
                        getlabel ClosestTarget descTarget
                        wait 150
                        if "pacified" in descTarget
                            if timer "PacifiedTimer" > 31000
                                settimer "PacifiedTimer" 0
                            endif
                            @setvar! NeedtoPacify 0
                            settimer "PeaceCheck" 0
                        elseif "provoked" in descTarget or "provoked" in descNextTarget
                            @setvar! NeedtoPacify 0
                            settimer "PeaceCheck" 0
                        else
                            settimer "PacifiedTimer" 31000
                            @setvar! NeedtoPacify 1
                            settimer "PeaceCheck" 0
                        endif
                    else
                        break
                    endif
                endif
            endif

            if skill "Discordance" >= 50 and EnableDiscordance = 1 and diffhits <= ActivateAutoHealHPdiff 
                if timer "DiscoCheck" > 2000
                    if find ClosestTarget gound -1 -1 TargetAttackRange
                        getlabel ClosestTarget descTarget
                        wait 150
                        if "discord" in descTarget
                            if find NextClosestTarget ground -1 -1 8 and ClosestTarget != NextClosestTarget and NextClosestTarget != 0
                                getlabel NextClosestTarget descNextTarget
                                wait 150
                                if "discord" in descNextTarget
                                    @setvar! NeedtoDiscord 0
                                    settimer "DiscoCheck" 0
                                else
                                    @setvar! NeedtoDiscord 2
                                    settimer "DiscoCheck" 0
                                endif
                            else
                                if timer "DiscordedTimer" > 31000
                                    settimer "DiscordedTimer" 0
                                endif
                                @setvar! NeedtoDiscord 0
                                settimer "DiscoCheck" 0
                            endif
                        else
                            settimer "DiscordedTimer" 31000
                            @setvar! NeedtoDiscord 1
                            settimer "DiscoCheck" 0
                        endif
                    endif
                endif
            endif
        endif

        if skill "Provocation" >= 50 and EnableProvocation = 1
            if NeedtoProvoke = 1
                clearsysmsg
                for 5
                if timer "ProvokedTimer" < 31000 or not find "NextClosestTarget" ground -1 -1 TargetAttackRange 
                    @setvar! NeedtoProvoke 0
                    @setvar! NeedtoPacify 0
                    @setvar! NeedtoDiscord 1
                    break
                elseif ClosestTarget = NextClosestTarget
                    @setvar! NeedtoProvoke 0
                    @setvar! NeedtoPacify 1
                    @setvar! NeedtoDiscord 1
                    break
                elseif timer "Provocation" > 11000 and timer "Musicianship" > 5000
                    skill "Provocation"
                    wft 1000
                    target NextClosestTarget
                    wait 150
                    if insysmsg 'Target cannot be seen'
                        if EnableOverheadMessages = 1 and not dead NextClosestTarget
                            overhead "[ CANNOT SEE TARGET... ]" 339 NextClosestTarget
                        elseif not dead NextClosestTarget
                            sysmsg "Provoke target cannot be seen..." 2117
                        endif
                        @setvar! NeedtoProvoke 0
                        @setvar! NeedtoPacify 1
                        @setvar! NeedtoDiscord 1
                        settimer "Provocation" 0
                        settimer "ProvoCheck" 0
                        settimer "NextTargetTimer" 0
                        cooldown "Provocation" 11000
                        clearsysmsg
                        break
                    elseif insysmsg "You must wait"
                        clearsysmsg
                        wait 500
                    elseif insysmsg 'That is too far away.'
                        if EnableOverheadMessages = 1 and not dead NextClosestTarget
                            overhead '[ TOO FAR AWAY! ]' 339 NextClosestTarget
                        elseif not dead NextClosestTarget
                            sysmsg "Provoke target is too far away... " 2117
                        endif
                        @setvar! NeedtoProvoke 0
                        @setvar! NeedtoPacify 1
                        @setvar! NeedtoDiscord 1
                        settimer "Provocation" 0
                        cooldown "Provocation" 11000
                        settimer "ProvoCheck" 0
                        settimer "NextTargetTimer" 0
                        clearsysmsg
                        break
                    else
                        if EnableOverheadMessages = 1
                            overhead "[ j PROVOKING... j ]" 2117
                        else
                            overhead ' j ' 2117
                        endif
                        target ClosestTarget
                        wait 250
                    endif
                    if insysmsg 'You play successfully, provoking'
                        if not dead ClosestTarget
                            if EnableOverheadMessages = 1
                                overhead '[ j PROVOKED! j ]' 2117 ClosestTarget
                                overhead '[ j PROVOKED! j ]' 2117 NextClosestTarget
                                settimer "TargetAcquired" 0
                                settimer "NextTargetTimer" 0
                            else
                                overhead ' j ' 2117 ClosestTarget
                                overhead ' j ' 2117 NextClosestTarget
                                settimer "TargetAcquired" 0
                                settimer "NextTargetTimer" 0
                            endif
                        endif
                        if EnableOverheadMessages = 1
                            sysmsg "You play an aggressive tune, provoking rage into your targets..." 2117
                        endif
                        settimer "Musicianship" 0
                        settimer "Provocation" 0
                        cooldown "Provocation" 11000
                        cooldown "Provoked" ProvocationReapply
                        @setvar! NeedtoProvoke 0
                        @setvar! NeedtoPacify 0
                        @setvar! NeedtoDiscord 1
                        @setvar! SwitchtoIncendiaryAmmo 1
                        break
                    elseif insysmsg 'You fail to incite'
                        if EnableOverheadMessages = 1
                            overhead '[ PROVO FAIL! ]' 337
                            settimer "TargetAcquired" 0
                            settimer "NextTargetTimer" 0
                        else
                            if not dead ClosestTarget
                                overhead '  ' 337 ClosestTarget
                                overhead '  ' 337 NextClosestTarget
                                settimer "TargetAcquired" 0
                                settimer "NextTargetTimer" 0
                            endif
                        endif
                        sysmsg "You fail to provoke your targets!" 339
                        settimer "Provocation" 5500
                        @setvar! NeedtoProvoke 1
                        @setvar! NeedtoPacify 0
                        @setvar! NeedtoDiscord 1
                        break
                    elseif insysmsg 'Target cannot be seen'
                        if EnableOverheadMessages = 1
                            overhead "[ CANNOT BE SEEN... ]" 337
                        endif
                        replay
                    elseif insysmsg 'That is too far away.'
                        if EnableOverheadMessages = 1
                            overhead '[ TOO FAR AWAY! ]' 43 ClosestTarget
                        endif
                        replay
                    elseif insysmsg 'The creatures you are trying to provoke are too far away from each'
                        if EnableOverheadMessages = 1
                            overhead '[ TOO FAR APART! ]' 153 ClosestTarget
                            overhead '[ TOO FAR APART! ]' 153 NextClosestTarget
                        endif
                        wait 250
                        @setvar! NeedtoProvoke 0
                        @setvar! NeedtoPacify 1
                        @setvar! NeedtoDiscord 1
                        break
                    elseif insysmsg 'tell someone to attack themselves!'
                        if EnableOverheadMessages = 1
                            overhead '[ SELF TARGET FAIL... ]' 337
                        else
                            overhead '  ' 337
                        endif
                        replay
                    else
                        wait 250
                    endif
                endif
                endfor
            endif
        endif
            
        if skill "Peacemaking" >= 50 and EnablePeacemaking = 1 
            if NeedtoPacify = 1
                clearsysmsg
                if timer "Pacified" > 30000 and timer "Peacemaking" > 11000 and timer "Musicianship" > 5000
                    skill "Peacemaking"
                    wft 1500
                    if insysmsg "What instrument shall you play?"
                        if findtype "standing harp|sackbut|bamboo flute|tambourine|drum|lute|lap harp|gemshorn|hurdy gurdy|psaltery|shawm|vielle" as Instrument
                            target Instrument
                            wait 250
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ NO INSTRUMENT! ]" 337
                            endif
                        endif
                    endif

                    if not insysmsg "This is not a musical instrument"
                        target ClosestTarget
                        wait 250
                    endif

                    if insysmsg "Target cannot be seen"
                        if EnableOverheadMessages = 1
                            overhead "[ CANNOT BE SEEN... ]" 337
                        endif
                        replay
                    elseif insysmsg 'That is too far away.'
                        if EnableOverheadMessages = 1 and not dead ClosestTarget
                            overhead '[ TOO FAR AWAY! ]' 43 ClosestTarget
                        endif
                        replay
                    elseif insysmsg "You must wait"
                        if EnableOverheadMessages = 1
                            overhead "[ WAITING... ]" 84
                        endif
                        settimer "Discordance" 5000
                        settimer "Provocation" 5000
                        wait 500
                    elseif insysmsg "You play successfully, pacifying your"
                        if EnableOverheadMessages = 1
                            overhead "[ j PACIFYING... j ]" 84
                        else
                            overhead " j " 84
                        endif
                        cooldown "Pacified" PeacemakingReapply
                        settimer "Musicianship" 0
                        settimer "Peacemaking" 0
                        cooldown "Peacemaking" 11000
                        if not dead ClosestTarget
                            if EnableOverheadMessages = 1
                                wait 250
                                overhead "[ j PACIFIED! j ]" 84 ClosestTarget
                            else
                                overhead ' j ' 84 ClosestTarget
                                settimer "TargetAcquired" 0
                            endif
                        endif
                        if EnableOverheadMessages = 1
                            sysmsg "You play a calming tune, pacifying your target..." 84
                        endif
                    elseif insysmsg "you fail to pacify your opponent"
                        if EnableOverheadMessages = 1
                            overhead "[ PACIFY FAIL! ]" 337
                        else
                            overhead '  ' 337 ClosestTarget
                            overhead '  ' 337
                        endif
                        sysmsg "You fail to pacify your target!" 337
                        settimer "Peacemaking" 5500
                    else
                        if not find ClosestTarget ground -1 -1 TargetAttackRange or dead ClosestTarget
                            break
                        endif
                    endif
                endif
            endif
        endif

        if skill "Discordance" >= 50 and EnableDiscordance = 1 and diffhits <= ActivateAutoHealHPdiff 
            if NeedtoDiscord = 1
                clearsysmsg
                if timer "Discorded" > 31000 and timer "DiscordanceTimer" > 11000 and timer "Musicianship" > 5000
                    skill "Discordance"
                    wft 1500
                    if insysmsg "What instrument shall you play?"
                        if findtype "standing harp|sackbut|bamboo flute|tambourine|drum|lute|lap harp|gemshorn|hurdy gurdy|psaltery|shawm|vielle" as Instrument
                            target Instrument
                            wait 250
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ NO INSTRUMENT! ]" 337
                            endif
                        endif
                    elseif not insysmsg "This is not a musical instrument"
                        target ClosestTarget
                        wait 250
                        if insysmsg "Target cannot be seen."
                            if EnableOverheadMessages = 1
                                overhead "[ CANNOT BE SEEN... ]" 337
                            endif
                            replay
                        elseif insysmsg "You must wait"
                            settimer "Peacemaking" 5000
                        elseif insysmsg "You play successfully"
                            if EnableOverheadMessages = 1
                                overhead "[ j DISCORDING... j ]" 69
                            else
                                overhead " j " 69
                            endif
                            cooldown "Discorded" DiscordanceReapply
                            settimer "Musicianship" 0
                            settimer "Discorded" 0
                            cooldown "Discordance" 11000
                            if not dead ClosestTarget
                                if EnableOverheadMessages = 1
                                    overhead "[ j DISCORDED! j ]" 69 ClosestTarget
                                else
                                    overhead ' j ' 69 ClosestTarget
                                    settimer "TargetAcquired" 0
                                endif
                            endif
                            if EnableOverheadMessages = 1
                                sysmsg "You play a mesmerizing tune, disrupting your target's focus..." 69
                                # '
                            endif
                        elseif insysmsg "fail to discord"
                            settimer "Discordance" 5500
                            if EnableOverheadMessages = 1
                                overhead "[ DISCORD FAIL! ]" 337
                            else
                                overhead '  ' 337 ClosestTarget
                                overhead '  ' 337
                                settimer "TargetAcquired" 0
                            endif
                            sysmsg "You fail to discord your target!" 337
                        else
                            if not find ClosestTarget ground -1 -1 TargetAttackRange or dead ClosestTarget
                                break
                            endif
                        endif
                    else
                        if not find ClosestTarget ground -1 -1 TargetAttackRange or dead ClosestTarget
                            break
                        endif
                    endif
                endif
            elseif NeedtoDiscord = 2
                if timer "Discorded" > 3100 and timer "DiscordanceTimer" > 11000 and timer "Musicianship" > 5000 and diffhits <= ActivateAutoHealHPdiff 
                    skill "Discordance"
                    wft 1500
                    if insysmsg "What instrument shall you play?"
                        if findtype "standing harp|sackbut|bamboo flute|tambourine|drum|lute|lap harp|gemshorn|hurdy gurdy|psaltery|shawm|vielle" as Instrument
                            target Instrument
                            wait 250
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ NO INSTRUMENT! ]" 337
                            endif
                        endif
                    elseif not insysmsg "This is not a musical instrument"
                        clearsysmsg
                        target NextClosestTarget
                        wait 250
                        if insysmsg "Target cannot be seen."
                            if EnableOverheadMessages = 1
                                overhead "[ CANNOT BE SEEN... ]" 337
                            endif
                            replay
                        elseif insysmsg "You must wait"
                            settimer "Peacemaking" 5000
                            wait 500
                        elseif insysmsg "You play successfully, disrupting your opponent"
                            if EnableOverheadMessages = 1
                                overhead "[ j DISCORDING... j ]" 69
                            else
                                overhead " j " 69
                            endif
                            wait 250
                            cooldown "Discorded" DiscordanceReapply
                            settimer "Musicianship" 0
                            settimer "Discordance" 0
                            cooldown "Discordance" 11000
                            if not dead ClosestTarget
                                if EnableOverheadMessages = 1
                                    overhead "[ j DISCORDED! j]" 69 NextClosestTarget
                                else
                                    overhead ' j ' 69 NextClosestTarget
                                    settimer "NextTargetTimer" 0
                                endif
                            endif
                            if EnableOverheadMessages = 1
                                sysmsg "You play another doozey and distract your provoked target, too!" 69
                            endif
                        elseif insysmsg "fail to discord"
                            settimer "Discordance" 5500
                            if EnableOverheadMessages = 1
                                overhead "[ DISCORD FAIL! ]" 37
                            else
                                overhead '  ' 37
                                settimer "NextTargetTimer" 0
                            endif
                            sysmsg "You fail to discord your target!" 337
                            wait 250
                        else
                            if not find ClosestTarget ground -1 -1 TargetAttackRange or dead ClosestTarget
                                break
                            endif
                        endif
                    else
                        if not find ClosestTarget ground -1 -1 TargetAttackRange or dead ClosestTarget
                            break
                        endif
                    endif
                endif
            endif
        endif

        if weight > maxweight and EnableDropGoldWhenOverweight = 1
            if timer overweightMessageTimer > 4500
                overhead "[ OVERWEIGHT! ]" 34
                settimer overweightMessageTimer 0
            endif

            if DropGoldAmount != 0
                clearignore
                @setvar! DisableVacuums 1
                wait 250 

                if EnablePutLootinLockBox = 1
                    if findtype "wooden box" self as lockbox
                        if findtype "copper key" self as key
                            clearignore
                            getlabel lockbox lockboxlabel
                            wait 100
                            if "items" in lockboxlabel
                                // Do nothing
                            else
                                dclick key
                                wft 1500
                                target lockbox
                                if EnableOverheadMessages = 1
                                    overhead "[loot box unlocked]" 84
                                endif
                                wait 500
                                if insysmsg "It appears to be locked."
                                    dclick key
                                    wft 1500
                                    target lockbox
                                    wait 250
                                endif
                            endif
                        elseif EnableOverheadMessages = 1
                            overhead "[ NO LOCKBOX KEY! ]" 337
                        endif
                    endif
                endif

                while weight > maxweight
                    if findtype "gold coin" self as easycomeeasygo
                        lift easycomeeasygo DropGoldAmount
                        droprelloc 0 0
                        getlabel backpack packdesc
                        if EnableOverheadMessages = 1
                            overhead "[ DROPPING GOLD... ]" 149
                        endif
                        wait 250
                        if insysmsg "cannot drop anything"
                            drop backpack -1 -1 -1
                            break 
                        endif
                        wait 250
                    else 
                        break 
                    endif
                endwhile
            endif
        endif

        if EnableHealPotion = 1 and diffhits >= HealPotionHPdiff
            if findtype "Yellow Potion" self as HealPot
                getlabel HealPot HealPotlabel
                if "next" in HealPotlabel
                    // Do nothing
                else
                    @setvar! HealPotionCheck 0

                    if counttype 3852 self as HealPotCount
                        @setvar! HealPotionCheck HealPotCount
                    endif

                    clearsysmsg
                    dclicktype 3852
                    getlabel backpack backpackdesc
                    wait 250

                    if HealPotionCheck != counttype 3852 self or insysmsg "potion satchel used"
                        settimer 'HealPotionTimer' 0
                        cooldown "Healing Potion" HealingPotionCooldown
                        if EnableOverheadMessages = 1
                            if insysmsg "potion satchel used"
                                overhead '[ FREE HEAL POTION ]' 253
                            else
                                overhead "[ HEAL POTION ]" 253
                            endif
                        endif 
                        clearsysmsg
                    endif
                endif
            else
                if timer 'yellowMessageTimer' > 4500
                    overhead "[ NO HEAL POTS! ]" 337
                    settimer 'yellowMessageTimer' 0
                endif
            endif
        endif


        ///////////////////////
        //  CHIVALRY BUFFS:  //
        ///////////////////////

            while not gumpexists 1387930325
                say "[ChivalryHotbar"
            endwhile

            if gumpexists 1387930325
                if ingump "12/" 1387930325
                    @setvar! HolySymbols 12
                    @setvar! HolyLightAvailable 1
                    @setvar! NobleSacrificeAvailable 1
                    @setvar! CleanseByFireAvailable 1
                    @setvar! CloseWoundsAvailable 1
                    @setvar! DivineFuryAvailable 1
                    @setvar! EnemyOfOneAvailable 1
                    @setvar! ConsecrateWeaponAvailable 1
                elseif ingump "13/" 1387930325
                    @setvar! HolySymbols 13
                    @setvar! HolyLightAvailable 1
                    @setvar! NobleSacrificeAvailable 1
                    @setvar! CleanseByFireAvailable 1
                    @setvar! CloseWoundsAvailable 1
                    @setvar! DivineFuryAvailable 1
                    @setvar! EnemyOfOneAvailable 1
                    @setvar! ConsecrateWeaponAvailable 1
                elseif ingump "14/" 1387930325
                    @setvar! HolySymbols 14
                    @setvar! HolyLightAvailable 1
                    @setvar! NobleSacrificeAvailable 1
                    @setvar! CleanseByFireAvailable 1
                    @setvar! CloseWoundsAvailable 1
                    @setvar! DivineFuryAvailable 1
                    @setvar! EnemyOfOneAvailable 1
                    @setvar! ConsecrateWeaponAvailable 1
                elseif ingump "15/" 1387930325
                    @setvar! HolySymbols 15
                    @setvar! HolyLightAvailable 1
                    @setvar! NobleSacrificeAvailable 1
                    @setvar! CleanseByFireAvailable 1
                    @setvar! CloseWoundsAvailable 1
                    @setvar! DivineFuryAvailable 1
                    @setvar! EnemyOfOneAvailable 1
                    @setvar! ConsecrateWeaponAvailable 1
                elseif ingump "16/" 1387930325
                    @setvar! HolySymbols 16
                    @setvar! HolyLightAvailable 1
                    @setvar! NobleSacrificeAvailable 1
                    @setvar! CleanseByFireAvailable 1
                    @setvar! CloseWoundsAvailable 1
                    @setvar! DivineFuryAvailable 1
                    @setvar! EnemyOfOneAvailable 1
                    @setvar! ConsecrateWeaponAvailable 1
                elseif ingump "17/" 1387930325
                    @setvar! HolySymbols 17
                    @setvar! HolyLightAvailable 1
                    @setvar! NobleSacrificeAvailable 1
                    @setvar! CleanseByFireAvailable 1
                    @setvar! CloseWoundsAvailable 1
                    @setvar! DivineFuryAvailable 1
                    @setvar! EnemyOfOneAvailable 1
                    @setvar! ConsecrateWeaponAvailable 1
                elseif ingump "18/" 1387930325
                    @setvar! HolySymbols 18
                    @setvar! HolyLightAvailable 1
                    @setvar! NobleSacrificeAvailable 1
                    @setvar! CleanseByFireAvailable 1
                    @setvar! CloseWoundsAvailable 1
                    @setvar! DivineFuryAvailable 1
                    @setvar! EnemyOfOneAvailable 1
                    @setvar! ConsecrateWeaponAvailable 1
                elseif ingump "19/" 1387930325
                    @setvar! HolySymbols 19
                    @setvar! HolyLightAvailable 1
                    @setvar! NobleSacrificeAvailable 1
                    @setvar! CleanseByFireAvailable 1
                    @setvar! CloseWoundsAvailable 1
                    @setvar! DivineFuryAvailable 1
                    @setvar! EnemyOfOneAvailable 1
                    @setvar! ConsecrateWeaponAvailable 1
                elseif ingump "20/" 1387930325
                    @setvar! HolySymbols 20
                    @setvar! HolyLightAvailable 1
                    @setvar! NobleSacrificeAvailable 1
                    @setvar! CleanseByFireAvailable 1
                    @setvar! CloseWoundsAvailable 1
                    @setvar! DivineFuryAvailable 1
                    @setvar! EnemyOfOneAvailable 1
                    @setvar! ConsecrateWeaponAvailable 1
                elseif ingump "21/" 1387930325
                    @setvar! HolySymbols 21
                    @setvar! HolyLightAvailable 1
                    @setvar! NobleSacrificeAvailable 1
                    @setvar! CleanseByFireAvailable 1
                    @setvar! CloseWoundsAvailable 1
                    @setvar! DivineFuryAvailable 1
                    @setvar! EnemyOfOneAvailable 1
                    @setvar! ConsecrateWeaponAvailable 1
                elseif ingump "11/" 1387930325
                    @setvar! HolySymbols 11
                    @setvar! HolyLightAvailable 1
                    @setvar! NobleSacrificeAvailable 1
                    @setvar! CleanseByFireAvailable 1
                    @setvar! CloseWoundsAvailable 1
                    @setvar! DivineFuryAvailable 1
                    @setvar! EnemyOfOneAvailable 1
                    @setvar! ConsecrateWeaponAvailable 1
                elseif ingump "10/" 1387930325
                    @setvar! HolySymbols 10
                    @setvar! HolyLightAvailable 1
                    @setvar! NobleSacrificeAvailable 1
                    @setvar! CleanseByFireAvailable 1
                    @setvar! CloseWoundsAvailable 1
                    @setvar! DivineFuryAvailable 1
                    @setvar! EnemyOfOneAvailable 1
                    @setvar! ConsecrateWeaponAvailable 1
                elseif ingump "9/" 1387930325
                    @setvar! HolySymbols 9
                    @setvar! HolyLightAvailable 1
                    @setvar! NobleSacrificeAvailable 1
                    @setvar! CleanseByFireAvailable 1
                    @setvar! CloseWoundsAvailable 1
                    @setvar! DivineFuryAvailable 1
                    @setvar! EnemyOfOneAvailable 1
                    @setvar! ConsecrateWeaponAvailable 1
                elseif ingump "8/" 1387930325
                    @setvar! HolySymbols 8
                    @setvar! HolyLightAvailable 1
                    @setvar! NobleSacrificeAvailable 1
                    @setvar! CleanseByFireAvailable 1
                    @setvar! CloseWoundsAvailable 1
                    @setvar! DivineFuryAvailable 1
                    @setvar! EnemyOfOneAvailable 1
                    @setvar! ConsecrateWeaponAvailable 1
                elseif ingump "7/" 1387930325
                    @setvar! HolySymbols 7
                    @setvar! HolyLightAvailable 1
                    @setvar! NobleSacrificeAvailable 1
                    @setvar! CleanseByFireAvailable 1
                    @setvar! CloseWoundsAvailable 1
                    @setvar! DivineFuryAvailable 1
                    @setvar! EnemyOfOneAvailable 0
                    @setvar! ConsecrateWeaponAvailable 1
                elseif ingump "6/" 1387930325
                    @setvar! HolySymbols 6
                    @setvar! HolyLightAvailable 1
                    @setvar! NobleSacrificeAvailable 1
                    @setvar! CleanseByFireAvailable 0
                    @setvar! CloseWoundsAvailable 0
                    @setvar! DivineFuryAvailable 0
                    @setvar! EnemyOfOneAvailable 0
                    @setvar! ConsecrateWeaponAvailable 0
                elseif ingump "5/" 1387930325
                    @setvar! HolySymbols 5
                    @setvar! HolyLightAvailable 1
                    @setvar! NobleSacrificeAvailable 1
                    @setvar! CleanseByFireAvailable 0
                    @setvar! CloseWoundsAvailable 0
                    @setvar! DivineFuryAvailable 0
                    @setvar! EnemyOfOneAvailable 0
                    @setvar! ConsecrateWeaponAvailable 0
                elseif ingump "4/" 1387930325
                    @setvar! HolySymbols 4
                    @setvar! HolyLightAvailable 0
                    @setvar! NobleSacrificeAvailable 1
                    @setvar! CleanseByFireAvailable 0
                    @setvar! CloseWoundsAvailable 0
                    @setvar! DivineFuryAvailable 0
                    @setvar! EnemyOfOneAvailable 0
                    @setvar! ConsecrateWeaponAvailable 0
                elseif ingump "3/" 1387930325
                    @setvar! HolySymbols 3
                    @setvar! HolyLightAvailable 0
                    @setvar! NobleSacrificeAvailable 0
                    @setvar! CleanseByFireAvailable 0
                    @setvar! CloseWoundsAvailable 0
                    @setvar! DivineFuryAvailable 0
                    @setvar! EnemyOfOneAvailable 0
                    @setvar! ConsecrateWeaponAvailable 0
                elseif ingump "2/" 1387930325
                    @setvar! HolySymbols 2
                    @setvar! HolyLightAvailable 0
                    @setvar! NobleSacrificeAvailable 0
                    @setvar! CleanseByFireAvailable 0
                    @setvar! CloseWoundsAvailable 0
                    @setvar! DivineFuryAvailable 0
                    @setvar! EnemyOfOneAvailable 0
                    @setvar! ConsecrateWeaponAvailable 0
                elseif ingump "1/" 1387930325
                    @setvar! HolySymbols 1
                    @setvar! HolyLightAvailable 0
                    @setvar! NobleSacrificeAvailable 0
                    @setvar! CleanseByFireAvailable 0
                    @setvar! CloseWoundsAvailable 0
                    @setvar! DivineFuryAvailable 0
                    @setvar! EnemyOfOneAvailable 0
                    @setvar! ConsecrateWeaponAvailable 0
                elseif ingump "0/" 1387930325
                    @setvar! HolySymbols 0
                    @setvar! HolyLightAvailable 0
                    @setvar! NobleSacrificeAvailable 0
                    @setvar! CleanseByFireAvailable 0
                    @setvar! CloseWoundsAvailable 0
                    @setvar! DivineFuryAvailable 0
                    @setvar! EnemyOfOneAvailable 0
                    @setvar! ConsecrateWeaponAvailable 0
                endif
            endif

            if EnableDivineFury = 1
                if timer "DivineFuryTimer" > 31000 and timer "ChivalryPrevented" > 5000 and DivineFuryAvailable = 1
                    clearsysmsg
                    yell "[DivineFury"
                    wait 250
                    if not insysmsg "You do not have enough holy"
                        settimer "DivineFuryTimer" 0
                        settimer "ChivalryPrevented" 4000
                        cooldown "Divine Fury" 31000
                        if EnableOverheadMessages = 1
                            overhead "[ DIVINE FURY! ]" 2117
                        endif
                    else
                        settimer "ChivalryPrevented" 0
                    endif
                    wait 250
                endif
            endif

            if EnableEnemyOfOne = 1
                if timer "EnemyOfOneTimer" > 31000 and timer "ChivalryPrevented" > 5000 and timer "DivineFuryTimer" < 31000 and EnemyOfOneAvailable = 1
                    yell "[EnemyOfOne"
                    wait 250
                    if not insysmsg "You do not have enough holy"
                        settimer "EnemyOfOneTimer" 0
                        settimer "ChivalryPrevented" 4000
                        cooldown "Enemy Of One" 31000
                        if EnableOverheadMessages = 1
                            overhead "[ ENEMY OF ONE! ]" 332
                        endif
                    else
                        settimer "ChivalryPrevented" 0
                    endif
                    wait 250
                endif
            endif

            if EnableConsecrateWeapon = 1
                if timer "ConsecrateWeaponTimer" > 3100 and timer "ChivalryPrevented" > 5000 and timer "DivineFuryTimer" < 31000 and ConsecrateWeaponAvailable = 1
                    yell "[ConsecrateWeapon"
                    wait 250
                    if not insysmsg "You do not have enough holy" and not insysmsg "You must wait a moment"
                        settimer "ConsecrateWeaponTimer" 0
                        settimer "ChivalryPrevented" 4000
                        cooldown "Consecrate Weapon" 31000
                        if EnableOverheadMessages = 1
                            overhead "[ CONSECRATE WEAPON! ]" 2206
                        endif
                    else
                        settimer "ChivalryPrevented" 0
                    endif
                    wait 250
                endif
            endif

            if EnableCloseWounds = 1
                if findbuff "bleed" or findbuff "disease"
                    if skill "chivalry" >= 70 and timer "CloseWoundsTimer" > 31000 and timer "ChivalryPrevented" > 5000 and timer "DivineFuryTimer" < 31000 and CloseWoundsAvailable = 1
                        clearsysmsg
                        yell "[CloseWounds"
                        wait 250
                        if insysmsg "You do not have enough holy"
                            settimer "ChivalryPrevented" 0
                            clearsysmsg
                        else
                            settimer "CloseWoundsTimer" 0
                            settimer "ChivalryPrevented" 4000
                            cooldown "Close Wounds" 31000
                            if EnableOverheadMessages = 1
                                overhead "[ CLOSE WOUNDS! ]" 48
                            endif
                        endif
                        wait 250
                    endif
                endif
            endif

            if EnableCleanseByFire = 1
                if poisoned and timer "CleanseByFireTimer" > 31000 and timer "ChivalryPrevented" > 5000 and timer "DivineFuryTimer" < 31000 and CleanseByFireAvailable = 1
                    clearsysmsg
                    yell "[CleanseByFire"
                    wait 250
                    if insysmsg "You do not have enough holy"
                        settimer "ChivalryPrevented" 0
                        clearsysmsg
                    else
                        settimer "CleanseByFireTimer" 0
                        settimer "ChivalryPrevented" 4000
                        cooldown "Cleanse By Fire" 31000
                        if EnableOverheadMessages = 1
                            overhead "[ CLEANSE BY FIRE! ]" 43
                        endif
                    endif
                    wait 250
                endif
            endif

            if insysmsg "world is saving"
                settimer "WorldSaveTimer" 0
                if EnableOverheadMessages = 1
                    overhead "[ WORLD SAVING... ]" 253
                endif
                while timer "WorldSaveTimer" < 4500
                    if insysmsg "save complete"
                        break
                    endif
                    wait 100
                endwhile
                if EnableOverheadMessages = 1
                    overhead "[ SAVE COMPLETE! ]" 253
                endif
            endif

            if EnableFrostAspect = 1
                if insysmsg "Frost Shell activated"
                    cooldown "Frost Shell Active" 5000
                    if EnableOverheadMessages = 1
                        overhead "[ FROST SHELL! ]" 2234
                    else
                        overhead "  " 2234
                    endif
                    if FrostAspectTier = 0
                        cooldown "Frost Shell Cooldown" 30000
                    elseif FrostAspectTier = 1
                        cooldown "Frost Shell Cooldown" 29000
                    elseif FrostAspectTier = 2
                        cooldown "Frost Shell Cooldown" 28000
                    elseif FrostAspectTier = 3
                        cooldown "Frost Shell Cooldown" 27000
                    elseif FrostAspectTier = 4
                        cooldown "Frost Shell Cooldown" 26000
                    elseif FrostAspectTier = 5
                        cooldown "Frost Shell Cooldown" 25000
                    elseif FrostAspectTier = 6
                        cooldown "Frost Shell Cooldown" 24000
                    elseif FrostAspectTier = 7
                        cooldown "Frost Shell Cooldown" 23000
                    elseif FrostAspectTier = 8
                        cooldown "Frost Shell Cooldown" 22000
                    elseif FrostAspectTier = 9
                        cooldown "Frost Shell Cooldown" 21000
                    elseif FrostAspectTier = 10
                        cooldown "Frost Shell Cooldown" 20000
                    elseif FrostAspectTier = 11
                        cooldown "Frost Shell Cooldown" 19000
                    elseif FrostAspectTier = 12
                        cooldown "Frost Shell Cooldown" 18000
                    elseif FrostAspectTier = 13
                        cooldown "Frost Shell Cooldown" 17000
                    elseif FrostAspectTier = 14
                        cooldown "Frost Shell Cooldown" 16000
                    elseif FrostAspectTier = 15
                        cooldown "Frost Shell Cooldown" 15000
                    elseif FrostAspectTier = 14
                        cooldown "Frost Shell Cooldown" 15000
                    endif
                    clearsysmsg
                endif
            endif

            if EnableTrackingAutoRecall = 1
                if PKTrackingRange = 60
                    if insysmsg ": 60 step" or insysmsg "60 space" or insysmsg ": 59 step" or insysmsg "59 space" or insysmsg ": 58 step" or insysmsg "58 space" or insysmsg ": 57 step" or insysmsg "57 space" or insysmsg ": 56 step" or insysmsg "56 space" or insysmsg ": 55 step" or insysmsg "55 space" or insysmsg ": 54 step" or insysmsg "54 space" or insysmsg ": 53 step" or insysmsg "53 space" or insysmsg ": 52 step" or insysmsg "52 space" or insysmsg ": 51 step" or insysmsg "51 space" or insysmsg ": 50 step" or insysmsg "50 space" or insysmsg ": 49 step" or insysmsg "49 space" or insysmsg ": 48 step" or insysmsg "48 space" or insysmsg ": 47 step" or insysmsg "47 space" or insysmsg ": 46 step" or insysmsg "46 space" or insysmsg ": 45 step" or insysmsg "45 space" or insysmsg ": 44 step" or insysmsg "44 space" or insysmsg ": 43 step" or insysmsg "43 space" or insysmsg ": 42 step" or insysmsg "42 space" or insysmsg ": 41 step" or insysmsg "41 space" or insysmsg ": 40 step" or insysmsg "40 space" or insysmsg ": 39 step" or insysmsg "39 space" or insysmsg ": 38 step" or insysmsg "38 space" or insysmsg ": 37 step" or insysmsg "37 space" or insysmsg ": 36 step" or insysmsg "36 space" or insysmsg ": 35 step" or insysmsg "35 space" or insysmsg ": 34 step" or insysmsg "34 space" or insysmsg ": 33 step" or insysmsg "33 space" or insysmsg ": 32 step" or insysmsg "32 space" or insysmsg ": 31 step" or insysmsg "31 space" or insysmsg ": 30 step" or insysmsg "30 space" or insysmsg ": 29 step" or insysmsg "29 space" or insysmsg ": 28 step" or insysmsg "28 space" or insysmsg ": 27 step" or insysmsg "27 space" or insysmsg ": 26 step" or insysmsg "26 space" or insysmsg ": 25 step" or insysmsg "25 space" or insysmsg ": 24 step" or insysmsg "24 space" or insysmsg ": 23 step" or insysmsg "23 space" or insysmsg ": 22 step" or insysmsg "22 space" or insysmsg ": 21 step" or insysmsg "21 space" or insysmsg ": 20 step" or insysmsg "20 space" or insysmsg ": 19 step" or insysmsg "19 space" or insysmsg ": 18 step" or insysmsg "18 space" or insysmsg ": 17 step" or insysmsg "17 space" or insysmsg ": 16 step" or insysmsg "16 space" or insysmsg ": 15 step" or insysmsg "15 space" or insysmsg ": 14 step" or insysmsg "14 space" or insysmsg ": 13 step" or insysmsg "13 space" or insysmsg ": 12 step" or insysmsg "12 space" or insysmsg ": 11 step" or insysmsg "11 space" or insysmsg ": 10 step" or insysmsg "10 space" or insysmsg ": 9 step" or insysmsg "(9 space" or insysmsg ": 8 step" or insysmsg "(8 space" or insysmsg ": 7 step" or insysmsg "(7 space" or insysmsg ": 6 step" or insysmsg "(6 space" or insysmsg ": 5 step" or insysmsg "(5 space" or insysmsg ": 4 step" or insysmsg "(4 space" or insysmsg ": 3 step" or insysmsg "(3 space" or insysmsg ": 2 step" or insysmsg "(2 space" or insysmsg ": 1 step" or insysmsg "(1 space" or insysmsg ": 0 step" or insysmsg "(0 space"
                        hotkey 'Toggle War Only'
                        if EnableRedAlertOverhead = 1
                            overhead "[ !! RED ALERT !! ]" 37
                        endif
                        @setvar! RedTargetFound 1
                        @setvar! WarModeToggledWhileFighting 0
                        clearsysmsg
                        replay
                    endif
                elseif PKTrackingRange = 50
                    if insysmsg ": 50 step" or insysmsg "50 space" or insysmsg ": 49 step" or insysmsg "49 space" or insysmsg ": 48 step" or insysmsg "48 space" or insysmsg ": 47 step" or insysmsg "47 space" or insysmsg ": 46 step" or insysmsg "46 space" or insysmsg ": 45 step" or insysmsg "45 space" or insysmsg ": 44 step" or insysmsg "44 space" or insysmsg ": 43 step" or insysmsg "43 space" or insysmsg ": 42 step" or insysmsg "42 space" or insysmsg ": 41 step" or insysmsg "41 space" or insysmsg ": 40 step" or insysmsg "40 space" or insysmsg ": 39 step" or insysmsg "39 space" or insysmsg ": 38 step" or insysmsg "38 space" or insysmsg ": 37 step" or insysmsg "37 space" or insysmsg ": 36 step" or insysmsg "36 space" or insysmsg ": 35 step" or insysmsg "35 space" or insysmsg ": 34 step" or insysmsg "34 space" or insysmsg ": 33 step" or insysmsg "33 space" or insysmsg ": 32 step" or insysmsg "32 space" or insysmsg ": 31 step" or insysmsg "31 space" or insysmsg ": 30 step" or insysmsg "30 space" or insysmsg ": 29 step" or insysmsg "29 space" or insysmsg ": 28 step" or insysmsg "28 space" or insysmsg ": 27 step" or insysmsg "27 space" or insysmsg ": 26 step" or insysmsg "26 space" or insysmsg ": 25 step" or insysmsg "25 space" or insysmsg ": 24 step" or insysmsg "24 space" or insysmsg ": 23 step" or insysmsg "23 space" or insysmsg ": 22 step" or insysmsg "22 space" or insysmsg ": 21 step" or insysmsg "21 space" or insysmsg ": 20 step" or insysmsg "20 space" or insysmsg ": 19 step" or insysmsg "19 space" or insysmsg ": 18 step" or insysmsg "18 space" or insysmsg ": 17 step" or insysmsg "17 space" or insysmsg ": 16 step" or insysmsg "16 space" or insysmsg ": 15 step" or insysmsg "15 space" or insysmsg ": 14 step" or insysmsg "14 space" or insysmsg ": 13 step" or insysmsg "13 space" or insysmsg ": 12 step" or insysmsg "12 space" or insysmsg ": 11 step" or insysmsg "11 space" or insysmsg ": 10 step" or insysmsg "10 space" or insysmsg ": 9 step" or insysmsg "(9 space" or insysmsg ": 8 step" or insysmsg "(8 space" or insysmsg ": 7 step" or insysmsg "(7 space" or insysmsg ": 6 step" or insysmsg "(6 space" or insysmsg ": 5 step" or insysmsg "(5 space" or insysmsg ": 4 step" or insysmsg "(4 space" or insysmsg ": 3 step" or insysmsg "(3 space" or insysmsg ": 2 step" or insysmsg "(2 space" or insysmsg ": 1 step" or insysmsg "(1 space" or insysmsg ": 0 step" or insysmsg "(0 space"
                        hotkey 'Toggle War Only'
                        if EnableRedAlertOverhead = 1
                            overhead "[ !! RED ALERT !! ]" 37
                        endif
                        @setvar! RedTargetFound 1
                        @setvar! WarModeToggledWhileFighting 0
                        clearsysmsg
                        replay
                    endif
                elseif PKTrackingRange = 40
                    if insysmsg ": 40 step" or insysmsg "40 space" or insysmsg ": 39 step" or insysmsg "39 space" or insysmsg ": 38 step" or insysmsg "38 space" or insysmsg ": 37 step" or insysmsg "37 space" or insysmsg ": 36 step" or insysmsg "36 space" or insysmsg ": 35 step" or insysmsg "35 space" or insysmsg ": 34 step" or insysmsg "34 space" or insysmsg ": 33 step" or insysmsg "33 space" or insysmsg ": 32 step" or insysmsg "32 space" or insysmsg ": 31 step" or insysmsg "31 space" or insysmsg ": 30 step" or insysmsg "30 space" or insysmsg ": 29 step" or insysmsg "29 space" or insysmsg ": 28 step" or insysmsg "28 space" or insysmsg ": 27 step" or insysmsg "27 space" or insysmsg ": 26 step" or insysmsg "26 space" or insysmsg ": 25 step" or insysmsg "25 space" or insysmsg ": 24 step" or insysmsg "24 space" or insysmsg ": 23 step" or insysmsg "23 space" or insysmsg ": 22 step" or insysmsg "22 space" or insysmsg ": 21 step" or insysmsg "21 space" or insysmsg ": 20 step" or insysmsg "20 space" or insysmsg ": 19 step" or insysmsg "19 space" or insysmsg ": 18 step" or insysmsg "18 space" or insysmsg ": 17 step" or insysmsg "17 space" or insysmsg ": 16 step" or insysmsg "16 space" or insysmsg ": 15 step" or insysmsg "15 space" or insysmsg ": 14 step" or insysmsg "14 space" or insysmsg ": 13 step" or insysmsg "13 space" or insysmsg ": 12 step" or insysmsg "12 space" or insysmsg ": 11 step" or insysmsg "11 space" or insysmsg ": 10 step" or insysmsg "10 space" or insysmsg ": 9 step" or insysmsg "(9 space" or insysmsg ": 8 step" or insysmsg "(8 space" or insysmsg ": 7 step" or insysmsg "(7 space" or insysmsg ": 6 step" or insysmsg "(6 space" or insysmsg ": 5 step" or insysmsg "(5 space" or insysmsg ": 4 step" or insysmsg "(4 space" or insysmsg ": 3 step" or insysmsg "(3 space" or insysmsg ": 2 step" or insysmsg "(2 space" or insysmsg ": 1 step" or insysmsg "(1 space" or insysmsg ": 0 step" or insysmsg "(0 space"
                        hotkey 'Toggle War Only'
                        if EnableRedAlertOverhead = 1
                            overhead "[ !! RED ALERT !! ]" 37
                        endif
                        @setvar! RedTargetFound 1
                        @setvar! WarModeToggledWhileFighting 0
                        clearsysmsg
                        replay
                    endif
                elseif PKTrackingRange = 0
                    if insysmsg "Now tracking"
                        hotkey 'Toggle War Only'
                        if EnableRedAlertOverhead = 1
                            overhead "[ !! RED ALERT !! ]" 37
                        endif
                        @setvar! RedTargetFound 1
                        @setvar! WarModeToggledWhileFighting 0
                        clearsysmsg
                        replay
                    endif
                endif
            endif

            if EnablePKradar = 1
                if timer "PKRadar" > 1000
                    hotkey 'Next Murderer Player Target'
                    wait 250
                    if insysmsg "No one matching that was found"
                        settimer "PKRadar" 0
                        clearsysmsg
                    else
                        hotkey 'Toggle War Only'
                        @setvar! RedTargetFound 1
                        @setvar! WarModeToggledWhileFighting 0
                        @setvar! TimeToGo 1
                        @setvar! MurdererTarget lasttarget
                        replay
                    endif
                endif
            endif

            if EnableWeightWarningMessage = 1
                if diffweight < GreenWarningDiffWeight and diffweight > YellowWarningDiffWeight and timer "WeightTimer" > 6000
                    if EnableOverheadMessages = 1
                        overhead "[ WEIGHT WARNING... ]" 77
                        settimer "WeightTimer" 0
                    else
                        overhead "  " 77
                        settimer "WeightTimer" 0
                    endif
                elseif diffweight < YellowWarningDiffWeight and diffweight > RedWeightLimitDiffWeight and timer "WeightTimer" > 6000
                    if EnableOverheadMessages = 1
                        overhead "[ WEIGHT WARNING! ]" 153
                        settimer "WeightTimer" 0
                    else
                        overhead "  " 153
                        settimer "WeightTimer" 0
                    endif
                elseif diffweight < RedWeightLimitDiffWeight and timer "WeightTimer" > 6000
                    if EnableOverheadMessages = 1
                        overhead "[ WEIGHT LIMIT REACHED! ]" 37
                        settimer "WeightTimer" 0
                    else
                        overhead "  " 37
                        settimer "WeightTimer" 0
                    endif

                    if EnableAutoWeightRecall = 1 and not find ClosestTarget ground -1 -1 TargetAttackRange and WILDERNESSMODE = 1
                        wait 500
                        hotkey 'Toggle War Only'
                        @setvar! AutoWeightRecall 1
                        @setvar! WarModeToggledWhileFighting 0
                        replay
                    elseif EnableAutoWeightRecall = 1 and find ClosestTarget ground -1 -1 TargetAttackRange and WILDERNESSMODE = 1
                        if timer "RECALLDELAY" > 3500 and EnableAutoRecallOverheadMessages = 1
                            overhead "[ WAITING TO RECALL... ]" 149
                            settimer "RECALLDELAY" 0
                        endif
                        wait 500
                    elseif EnableAutoWeightDungeonGate = 1 and DUNGEONMODE = 1
                        wait 500
                        hotkey 'Toggle War Only'
                        @setvar! TimeToGo 1
                        replay
                    else
                        if EnableOverheadMessages = 1
                            overhead "[ OVERWEIGHT! ]" 337
                        else
                            overhead "  " 337
                        endif
                        wait 1500
                        overhead "[ STOPPING SCRIPT! ]" 88
                        stop
                    endif
                endif
            endif

            if EnableAutoTaunting = 1 and diffhits < ActivateAutoHealHPdiff
                if skill 'Parrying' >= 80 and find ClosestTarget ground -1 -1 TargetAttackRange and timer "TauntingTimer" > 15000
                    say "[Taunt"
                    wft 1000
                    target ClosestTarget
                    wait 250
                    if not targetexists
                        if insysmsg "Cannot be seen"
                            settimer "TauntingTimer" 10000
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ TAUNTING... ]" 0
                            endif
                            settimer "TauntingTimer" 0
                        endif
                    endif
                endif
            endif

            if timer "AttackingTimer" > 500 
                if find ClosestTarget ground -1 -1 TargetAttackRange 
                    attack ClosestTarget
                    settimer "AttackingTimer" 0
                else 
                    replay
                endif 
            endif


            //////////////////////
            //     POTIONS:     //
            //////////////////////

            if EnableHealPotion = 1 and diffhits >= HealPotionHPdiff
                if findtype "Yellow Potion" self as HealPot
                    getlabel HealPot HealPotlabel
                    if "next" in HealPotlabel
                        // Do nothing
                    else
                        @setvar! HealPotionCheck 0

                        if counttype 3852 self as HealPotCount
                            @setvar! HealPotionCheck HealPotCount
                        endif

                        clearsysmsg
                        dclicktype 3852
                        getlabel backpack backpackdesc
                        wait 250

                        if HealPotionCheck != counttype 3852 self or insysmsg "potion satchel used"
                            settimer 'HealPotionTimer' 0
                            cooldown "Healing Potion" HealingPotionCooldown
                            if EnableOverheadMessages = 1
                                if insysmsg "potion satchel used"
                                    overhead '[ FREE HEAL POTION ]' 253
                                else
                                    overhead "[ HEAL POTION ]" 253
                                endif
                            endif 
                            clearsysmsg
                        endif
                    endif
                else
                    if timer 'yellowMessageTimer' > 4500
                        overhead "[ NO HEAL POTS! ]" 337
                        settimer 'yellowMessageTimer' 0
                    endif
                endif
            endif

            if EnableStrengthPotion = 1 and diffhits < ActivateAutoHealHPdiff 
                if insysmsg "You may now use a strength" or not findbuff "Strength"
                    if findtype "White Potion" self
                        dclicktype "White Potion"
                        if EnableOverheadMessages = 1
                            overhead "[ STRENGTH POTION ]" 956
                        endif
                        wait 250
                        clearsysmsg
                    else
                        if timer whiteMessageTimer > 4500
                            overhead "[ NO STRENGTH POTS! ]" 337
                            settimer whiteMessageTimer 0
                        endif
                    endif
                endif
            endif 

            if EnableAgilityPotion = 1 and not findbuff "Agility" and diffhits < ActivateAutoHealHPdiff 
                if findtype "Blue Potion" self
                    dclicktype "Blue Potion"
                    if EnableOverheadMessages = 1
                        overhead "[ AGILITY POTION ]" 93
                    endif
                    wait 250
                else
                    if timer blueMessageTimer > 4500
                    overhead "[ NO AGILITY POTS! ]" 337
                        settimer blueMessageTimer 0
                    endif
                endif
            endif

            if EnableMagicResistPotion = 1 and not findbuff "Magic Resist" and diffhits < ActivateAutoHealHPdiff 
                if findtype "Black Potion" self
                    dclicktype "Black Potion"
                    if EnableOverheadMessages = 1
                        overhead "[ RESIST POTION ]" 1109
                    endif
                    wait 250
                else
                    if timer blackMessageTimer > 4500
                        overhead "[ NO RESIST POTS! ]" 337
                        settimer blackMessageTimer 0
                    endif
                endif
            endif

            if EnableRefreshPotion = 1 and diffstam > RefreshPotionSPdiff
                if findtype "Red Potion" self
                    dclicktype "Red Potion"
                    if EnableOverheadMessages = 1
                        overhead "[ REFRESH POTION ]" 37
                    endif
                    wait 250
                else
                    if timer redMessageTimer > 4500
                        overhead "[ NO REFRESH POTS! ]" 337
                        settimer redMessageTimer 0
                    endif
                endif
            endif

            if EnableUsePotionKegs = 1 and findtype 'empty bottle%s%' self and findtype 'keg' self
                @setvar! PotionStockCheck 0
                while PotionStockCheck < 7 and findtype 'empty bottle%s%' self and diffhits < ActivateAutoHealHPdiff 
                    if diffhits < ActivateAutoHealHPdiff 
                        break
                    endif
                    if PotionStockCheck = 0 and ExplosionPotionAmount != 0
                        @setvar! PotionType 3853
                        @setvar! KegColour 419
                        @setvar! PotionAmounttoFill ExplosionPotionAmount
                        @setvar! PotionStockCheck 1
                    elseif PotionStockCheck = 1 and HealingPotionAmount != 0
                        @setvar! PotionType 3852
                        @setvar! KegColour 253
                        @setvar! PotionAmounttoFill HealingPotionAmount
                        @setvar! PotionStockCheck 2
                    elseif PotionStockCheck = 2 and CurePotionAmount != 0
                        @setvar! PotionType 3847
                        @setvar! KegColour 44
                        @setvar! PotionAmounttoFill CurePotionAmount
                        @setvar! PotionStockCheck 3
                    elseif PotionStockCheck = 3 and RefreshPotionAmount != 0
                        @setvar! PotionType 3851
                        @setvar! KegColour 37
                        @setvar! PotionAmounttoFill RefreshPotionAmount
                        @setvar! PotionStockCheck 4
                    elseif PotionStockCheck = 4 and StrengthPotionAmount != 0
                        @setvar! PotionType 3849
                        @setvar! KegColour 956
                        @setvar! PotionAmounttoFill StrengthPotionAmount
                        @setvar! PotionStockCheck 5
                    elseif PotionStockCheck = 5 and AgilityPotionAmount != 0
                        @setvar! PotionType 3848
                        @setvar! KegColour 93
                        @setvar! PotionAmounttoFill AgilityPotionAmount
                        @setvar! PotionStockCheck 6
                    elseif PotionStockCheck = 6 and ResistPotionAmount != 0
                        @setvar! PotionType 3846
                        @setvar! KegColour 1109
                        @setvar! PotionAmounttoFill ResistPotionAmount
                        @setvar! PotionStockCheck 7
                    else
                        break
                    endif
                    
                    while counttype PotionType self < PotionAmounttoFill
                        if timer "AttackingTimer" > 500 and find ClosestTarget ground -1 -1 TargetAttackRange 
                            attack ClosestTarget
                            settimer "AttackingTimer" 0
                        endif
                        
                        if not findtype 'empty bottle%s%' self
                            if EnableOverheadMessages = 1 and timer 'PotionKegTimer' > 5000
                                overhead "[ NO EMPTY BOTTLES... ]" 337
                                settimer 'PotionKegTimer' 0 
                            endif
                            break
                        endif
                        
                        if findtype 'keg' self KegColour as myKeg
                            dclick myKeg
                            wait 250
                            if EnableOverheadMessages = 1
                                if timer 'PotionKegTimer' > 2000
                                    overhead '[ FILLING POTS... ]' KegColour
                                    settimer 'PotionKegTimer' 0
                                endif
                            endif
                        else 
                            if EnableOverheadMessages = 1 and timer 'PotionKegTimer' > 5000
                                overhead "[ NO KEG TO USE... ]" KegColour
                                settimer 'PotionKegTimer' 0 
                            endif
                            break
                        endif
                    endwhile
                
                    if counttype PotionType self < PotionAmounttoFill and not findtype 'empty bottle%s%' self
                        if EnableOverheadMessages = 1 and timer 'PotionKegTimer' > 5000
                            overhead "[ NO EMPTY BOTTLES... ]" 337
                            settimer 'PotionKegTimer' 0 
                        endif
                        break
                    endif
                endwhile
            endif

            if timer "AttackingTimer" > 500 
                if find ClosestTarget ground -1 -1 TargetAttackRange 
                    attack ClosestTarget
                    settimer "AttackingTimer" 0
                else 
                    replay
                endif 
            endif

            if EnableAutoExplosionPots = 1 and skill 'Alchemy' >= 80 and diffhits < ActivateAutoHealHPdiff
                if findtype 'purple potion' self as explotPot
                    getlabel explotPot potLabel
                    if "(" in potLabel
                        if timer PurplePotionTimer > PurplePotionCooldown
                            @setvar! PurplePotionReady 1
                        else
                            @setvar! PurplePotionReady 0
                        endif
                    else
                        @setvar! PurplePotionReady 1
                    endif
                else
                    if EnableOverheadMessages = 1 and timer purpleMessageTimer > 15000
                        overhead '[ NO PURPLE POTIONS ]' 337
                        settimer purpleMessageTimer 0
                    endif
                endif

                @setvar! SpellInterrupted 0

                if targetexists
                    hotkey 'cancel current target'
                endif

                if PurplePotionReady = 1 and not dead ClosestTarget and find ClosestTarget ground -1 -1 PurplePotionTargetRange
                    while not insysmsg "Where should i throw this potion?"
                        potion 'explosion'
                    endwhile

                    @setvar! PurplePotionReady 0
                    settimer PurplePotionTimer 0

                    while not targetexists
                        if dead ClosestTarget and not find ClosestTarget ground -1 -1 PurplePotionTargetRange
                            @setvar! SpellInterrupted 1
                            hotkey 'cancel current target'
                            @setvar! SwitchtoIncendiaryAmmo 0
                            break
                        endif
                    endwhile

                    if SpellInterrupted = 0
                        target ClosestTarget
                        if EnableOverheadMessages = 1
                            overhead '[ EXPLOSION POT... ]' 419
                        endif
                        cooldown "Purple Potion" 15000
                        getlabel backpack packdesc
                        wait 250
                    endif
                endif
            endif

            if EnableGoldVacuum = 1 and DisableVacuums != 1
                if findtype "gold coin" ground -1 -1 12 as droppedmoney and timer "GoldRadar" > 3500
                    overhead "  " 149 droppedmoney
                    settimer "GoldRadar" 0
                endif
                while findtype "gold coin" ground -1 -1 2 as droppedmoney and diffhits < ActivateAutoHealHPdiff
                    if diffhits < ActivateAutoHealHPdiff 
                        break
                    endif
                    overhead "  " 149
                    hotkey "Grab Item"
                    wft 2500
                    target droppedmoney
                    wait 250
                    if insysmsg "Invalid or inaccessible item"
                        wait 500
                        @ignore droppedmoney
                    endif
                    wait 250
                endwhile
            endif

            if EnableDungeonCleanup = 1 and DisableVacuums != 1
                while findtype "iron ingot%s|board%s|cut up leather|3972|3962|3963|3980|3976|3973|3974|3981" ground -1 -1 2 as item and diffhits < ActivateAutoHealHPdiff
                    if diffhits < ActivateAutoHealHPdiff 
                        break
                    endif
                    if EnableOverheadMessages = 1
                        if timer "DungeonCleanup" > 1500
                            overhead '[ CLEANUP... ]' 420
                            settimer "DungeonCleanup" 0
                        endif
                    else
                        if timer "DungeonCleanup" > 1500
                            overhead '  ' 420
                            settimer "DungeonCleanup" 0
                        endif
                    endif
                    hotkey "Grab Item"
                    wft 1000
                    target item
                    wait 250
                endwhile

                if findtype "iron ingot%s|board%s|cut up leather|3972|3962|3963|3980|3976|3973|3974|3981" ground -1 -1 15 as dungeonjunk and timer "DungeonCleanupRadar" > 3500
                    overhead "  " 420 dungeonjunk
                    settimer "DungeonCleanupRadar" 0
                endif
            endif

            if EnableArrowCleanup = 1 and skill 'Archery' > 50
                while findtype 7163|3903 ground -1 -1 2 as item and diffhits < ActivateAutoHealHPdiff 
                    if timer "ArrowCleanupTimer" > 3500
                        if EnableOverheadMessages = 1
                            overhead '[ CLEANUP... ]' 93
                            settimer "ArrowCleanupTimer" 0
                        else 
                            overhead '  ' 93
                            settimer "ArrowCleanupTimer" 0
                        endif 
                    endif
                    hotkey "Grab Item"
                    wft 1000
                    target item
                    wait 250
                endwhile

                if findtype "quiver" self as MyQuiver and timer "QuiverTimer" > 30000
                    while findtype "quiver" self as MyQuiver
                        getlabel MyQuiver MyQuiverdesc
                        wait 250
                        if 'decorative' in MyQuiverdesc
                            @ignore MyQuiver
                            wait 500
                        else
                            break
                        endif
                    endwhile
                    settimer "QuiverTimer" 0
                    menu MyQuiver 0
                    wait 250
                endif
                
                if findtype 7163 ground -1 -1 10 as bolt and timer "BoltCleanupRadar" > 3500
                    overhead "  " 93 bolt
                    settimer "BoltCleanupRadar" 0
                endif

                if findtype 3903 ground -1 -1 10 as arrow and timer "ArrowCleanupRadar" > 3500
                    overhead "  " 37 arrow
                    settimer "ArrowCleanupRadar" 0
                endif
            endif

            if dead ClosestTarget or not find ClosestTarget ground -1 -1 TargetAttackRange
                @setvar! SwitchtoIncendiaryAmmo 0
                replay
            endif

            if insysmsg "world is saving"
                settimer "WorldSaveTimer" 0
                if EnableOverheadMessages = 1
                    overhead "[ WORLD SAVING... ]" 253
                endif
                while timer "WorldSaveTimer" < 4500
                    if insysmsg "save complete"
                        break
                    endif
                    wait 100
                endwhile
                if EnableOverheadMessages = 1
                    overhead "[ SAVE COMPLETE! ]" 253
                endif
            endif

            if timer "AttackingTimer" > 500 
                if find ClosestTarget ground -1 -1 TargetAttackRange 
                    attack ClosestTarget
                    settimer "AttackingTimer" 0
                else 
                    replay
                endif 
            endif

            if diffhits > ActivateAutoHealHPdiff
                replay
            endif

            if EnableHealPotion = 1 and diffhits >= HealPotionHPdiff
                if findtype "Yellow Potion" self as HealPot
                    getlabel HealPot HealPotlabel
                    if "next" in HealPotlabel
                        // Do nothing
                    else
                        @setvar! HealPotionCheck 0

                        if counttype 3852 self as HealPotCount
                            @setvar! HealPotionCheck HealPotCount
                        endif

                        clearsysmsg
                        dclicktype 3852
                        getlabel backpack backpackdesc
                        wait 250

                        if HealPotionCheck != counttype 3852 self or insysmsg "potion satchel used"
                            settimer 'HealPotionTimer' 0
                            cooldown "Healing Potion" HealingPotionCooldown
                            if EnableOverheadMessages = 1
                                if insysmsg "potion satchel used"
                                    overhead '[ FREE HEAL POTION ]' 253
                                else
                                    overhead "[ HEAL POTION ]" 253
                                endif
                            endif 
                            clearsysmsg
                        endif
                    endif
                else
                    if timer 'yellowMessageTimer' > 4500
                        overhead "[ NO HEAL POTS! ]" 337
                        settimer 'yellowMessageTimer' 0
                    endif
                endif
            endif

            if diffhits > 0 and not bandaging
                if skill 'healing' >= 30
                    if findtype 'clean bandage%s%' self
                        if targetexists
                            hotkey 'cancel current target'
                        endif
                        hotkey 'Bandage Self'
                        if EnableOverheadMessages = 1 
                            if aidsMessageTimer > 5000
                                overhead "[ BANDAGING... ]" 88
                                settimer aidsMessageTimer 0
                                wait 500
                            endif
                        endif
                    else
                        if timer aidsMessageTimer > 5000 and EnableOverheadMessages = 1
                            overhead "[ OUT OF BANDAGES! ]" 337
                            settimer aidsMessageTimer 0
                        endif
                    endif
                endif
            endif

            if EnableCurePotion = 1
                while poisoned
                    if findtype "Orange Potion" self
                        dclicktype "Orange Potion"
                        if EnableOverheadMessages = 1 and timer 'orangeMessageTimer' > 3500
                            overhead "[ CURE POTION ]" 44
                            settimer 'orangeMessageTimer' 0
                        endif
                        wait 500
                    else
                        if timer 'orangeMessageTimer' > 5000
                            overhead "[ NO CURE POTS! ]" 337
                            settimer 'orangeMessageTimer' 0
                        endif

                        if diffhits >= ActivateAutoHealHPdiff or not findtype 3972 self or not findtype 3973 self
                            replay
                        endif
                    endif
                endwhile
            endif
                            
            if insysmsg "your target to bleed"
                @setvar! TargetisBleeding 1
                clearsysmsg
            endif

            if not gumpexists 3954121934 and EnableWeaponAbilityHotbar = 1
                say '[abilitieshotbar'
                waitforgump 3954121934 5000
            endif

            if EnableWeaponAbilities = 1 and diffhits < ActivateAutoHealHPdiff
                if skill 'Swordsmanship' >= 50 and find ClosestTarget ground -1 -1 TargetAttackRange
                    if timer 'WeaponAbilityTimer' > WeaponAbilityCooldown 
                        for 1
                        if UseRendAbility = 1 and timer "RendTimer" > 60000
                            if insysmsg "your target to bleed" or TargetisBleeding = 1 
                                clearsysmsg
                                yell "[WeaponAbility2"
                                wait 250
                                if insysmsg "You cannot"
                                    settimer "WeaponAbilityTimer" 0
                                    clearsysmsg
                                    break
                                else
                                    if EnableOverheadMessages = 1
                                        overhead "[ REND! ]" 37
                                    endif
                                    cooldown "Weapon Ability" WeaponAbilityCooldown
                                    cooldown "Rend Ability" 15000
                                    settimer "RendTimer" 0
                                    break
                                endif 
                            endif
                        endif                   

                        if UseSpinslashAbility = 1
                            clearsysmsg
                            yell "[WeaponAbility1"
                            wait 250
                            if insysmsg "You cannot"
                                settimer "WeaponAbilityTimer" 0
                                clearsysmsg
                                break
                            else
                                if EnableOverheadMessages = 1
                                    overhead "[ SPINSLASH! ]" 37
                                endif
                                cooldown "Weapon Ability" WeaponAbilityCooldown
                                cooldown "Spinslash Ability" 15000
                                break
                            endif
                        endif 

                        if UseChopAbility = 1
                            clearsysmsg
                            yell "[WeaponAbility3"
                            wait 250
                            if insysmsg "You cannot"
                                settimer "WeaponAbilityTimer" 0
                                clearsysmsg
                                break
                            else
                                if EnableOverheadMessages = 1
                                    overhead "[ CHOP! ]" 37
                                endif
                                cooldown "Weapon Ability" WeaponAbilityCooldown
                                cooldown "Chop Ability" 5000
                                break
                            endif
                        endif
                        endfor
                    endif
                elseif skill 'Mace Fighting' >= 50 and find ClosestTarget ground -1 -1 TargetAttackRange
                    if timer 'WeaponAbilityTimer' > WeaponAbilityCooldown and UsePummelAbility = 1
                        clearsysmsg
                        yell "[WeaponAbility1"
                        wait 250
                        if insysmsg "You cannot"
                            settimer "WeaponAbilityTimer" 0
                            clearsysmsg
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ PUMMEL! ]" 37
                            endif
                            cooldown "Weapon Ability" WeaponAbilityCooldown
                            cooldown "Pummel Ability" 15000
                        endif
                    elseif timer "WeaponAbilityTimer" > WeaponAbilityCooldown and UseStunAbility = 1
                        clearsysmsg
                        yell "[WeaponAbility2"
                        wait 250
                        if insysmsg "You cannot"
                            settimer "WeaponAbilityTimer" 0
                            clearsysmsg
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ STUN! ]" 37
                            endif
                            cooldown "Weapon Ability" WeaponAbilityCooldown
                            cooldown "Stun Ability" 15000
                        endif
                    elseif timer "WeaponAbilityTimer" > WeaponAbilityCooldown and UseSmashAbility = 1
                        clearsysmsg
                        yell "[WeaponAbility3"
                        wait 250
                        if insysmsg "You cannot"
                            settimer "WeaponAbilityTimer" 0
                            clearsysmsg
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ SMASH! ]" 37
                            endif
                            cooldown "Weapon Ability" WeaponAbilityCooldown
                            cooldown "Smash Ability" 5000
                        endif
                    endif
                elseif skill 'Fencing' >= 50 and find ClosestTarget ground -1 -1 TargetAttackRange
                    if timer "WeaponAbilityTimer" > WeaponAbilityCooldown and UseGambitAbility = 1
                        clearsysmsg
                        yell "[WeaponAbility1"
                        wait 250
                        if insysmsg "You cannot"
                            settimer "WeaponAbilityTimer" 0
                            clearsysmsg
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ GAMBIT! ]" 37
                            endif
                            cooldown "Weapon Ability" WeaponAbilityCooldown
                            cooldown "Gambit Ability" 15000
                        endif
                    elseif timer "WeaponAbilityTimer" > WeaponAbilityCooldown and UseSwiftstrikesAbility = 1
                        clearsysmsg
                        yell "[WeaponAbility2"
                        wait 250
                        if insysmsg "You cannot"
                            settimer "WeaponAbilitytimer" 0
                            clearsysmsg
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ SWIFTSTRIKES! ]" 37
                            endif
                            cooldown "Weapon Ability" WeaponAbilityCooldown
                            cooldown "Swiftstrikes Ability" 15000
                        endif
                    elseif timer "WeaponAbilitytimer" > WeaponAbilityCooldown and UseBaneAbility = 1
                        clearsysmsg
                        yell "[WeaponAbility3"
                        wait 250
                        if insysmsg "You cannot"
                            settimer "WeaponAbilityTimer" 0
                            clearsysmsg
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ BANE! ]" 37
                            endif
                            cooldown "Weapon Ability" WeaponAbilityCooldown
                            cooldown "Bane Ability" 5000
                        endif
                    endif
                elseif skill 'Archery' >= 50 and find ClosestTarget ground -1 -1 TargetAttackRange
                    if timer "WeaponAbilityTimer" > WeaponAbilityCooldown and UseSkirmishAbility = 1
                        clearsysmsg
                        yell "[WeaponAbility1"
                        wait 250
                        if insysmsg "You cannot"
                            settimer "WeaponAbilityTimer" 0
                            clearsysmsg
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ SKIRMISH! ]" 37
                            endif
                            cooldown "Weapon Ability" WeaponAbilityCooldown
                            cooldown "Skirmish Ability" 15000
                        endif
                    elseif timer "WeaponAbilityTimer" > WeaponAbilityCooldown and UseFullDrawAbility = 1
                        clearsysmsg
                        yell "[WeaponAbility2"
                        wait 250
                        if insysmsg "You cannot"
                            settimer "WeaponAbilityTimer" 0
                            clearsysmsg
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ FULL DRAW! ]" 37
                            endif
                            cooldown "Weapon Ability" WeaponAbilityCooldown
                            cooldown "Full Draw Ability" 15000
                        endif
                    elseif timer "WeaponAbilityTimer" > WeaponAbilityCooldown and UseRepeaterAbility = 1
                        clearsysmsg
                        yell "[WeaponAbility3"
                        wait 250
                        if insysmsg "You cannot"
                            settimer "WeaponAbilityTimer" 0
                            clearsysmsg
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ REPEATER! ]" 37
                            endif
                            cooldown "Weapon Ability" WeaponAbilityCooldown
                            cooldown "Repeater Ability" 5000
                        endif
                    endif
                elseif skill 'Wrestling' >= 50 and find ClosestTarget ground -1 -1 TargetAttackRange
                    if timer "WeaponAbilityTimer" > WeaponAbilityCooldown and UseBrawlAbility = 1
                        clearsysmsg
                        yell "[WeaponAbility1"
                        wait 250
                        if insysmsg "You cannot"
                            settimer "WeaponAbilityTimer" 0
                            clearsysmsg
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ BRAWL! ]" 37
                            endif
                            cooldown "Weapon Ability" WeaponAbilityCooldown
                            cooldown "Brawl Ability" 15000
                        endif
                    elseif timer "WeaponAbilityTimer" > WeaponAbilityCooldown and UseHaymakerAbility = 1
                        clearsysmsg
                        yell "[WeaponAbility2"
                        wait 250
                        if insysmsg "You cannot"
                            settimer "WeaponAbilityTimer" 0
                            clearsysmsg
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ HAYMAKER! ]" 37
                            endif
                            cooldown "Weapon Ability" WeaponAbilityCooldown
                            cooldown "Haymaker Ability" 15000
                        endif
                    elseif timer "WeaponAbilityTimer" > WeaponAbilityCooldown and UseTakedownAbility = 1
                        clearsysmsg
                        yell "[WeaponAbility3"
                        wait 250
                        if insysmsg "You cannot"
                            settimer "WeaponAbilityTimer" 0
                            clearsysmsg
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ TAKEDOWN! ]" 37
                            endif
                            cooldown "Weapon Ability" WeaponAbilityCooldown
                            cooldown "Takedown Ability" 5000
                        endif
                    endif
                endif
            endif

            if skill 'Peacemaking' >= 50 or skill 'Provocation' >= 50 or skill 'Discordance' >= 50 and diffhits < ActivateAutoHealHPdiff
                if EnablePeacemakingBuff = 1 and not findbuff "Song Of Peacemaking" and timer "Musicianship" > 5000 and timer "Peacemaking" > 5000 and timer "SongBuffDelay" > 10500
                    skill "Peacemaking"
                    wft 1500
                    if insysmsg "What instrument shall you play?"
                        if findtype "standing harp|sackbut|bamboo flute|tambourine|drum|lute|lap harp|gemshorn|hurdy gurdy|psaltery|shawm|vielle" as Instrument
                            target Instrument
                            wait 250
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ NO INSTRUMENT! ]" 337
                            endif
                        endif
                    endif
                    if not insysmsg "This is not a musical instrument"
                        wft 1500
                        target backpack
                        if EnableOverheadMessages = 1
                            overhead "[ j PEACEMAKING BUFF... j ]" 84
                        endif
                        settimer "Peacemaking" 0
                        cooldown "Peacemaking Buff" 900000
                        settimer "SongBuffDelay" 0
                    endif
                endif

                if EnableDiscordanceBuff = 1 and not findbuff "Song Of Discordance" and timer "Musicianship" > 5000 and timer "Discordance" > 5000 and timer "SongBuffDelay" > 10500
                    skill "Discordance"
                    wft 1500
                    if insysmsg "What instrument shall you play?"
                        if findtype "standing harp|sackbut|bamboo flute|tambourine|drum|lute|lap harp|gemshorn|hurdy gurdy|psaltery|shawm|vielle" as Instrument
                            target Instrument
                            wait 250
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ NO INSTRUMENT! ]" 337
                            endif
                        endif
                    endif
                    if not insysmsg "This is not a musical instrument"
                        wft 1500
                        target backpack
                        if EnableOverheadMessages = 1
                            overhead "[ j DISCORDANCE BUFF... j ]" 69
                        endif
                        settimer "Discordance" 0
                        cooldown "Discordance Buff" 900000
                        settimer "SongBuffDelay" 0
                    endif
                endif

                if EnableProvocationBuff = 1 and not findbuff "Song of Provocation" and timer "Musicianship" > 5000 and timer "Provocation" > 5000 and timer "SongBuffDelay" > 10500
                    skill "Provocation"
                    wft 1500
                    if insysmsg "What instrument shall you play?"
                        if findtype "standing harp|sackbut|bamboo flute|tambourine|drum|lute|lap harp|gemshorn|hurdy gurdy|psaltery|shawm|vielle" as Instrument
                            target Instrument
                            wait 250
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ NO INSTRUMENT! ]" 337
                            endif
                        endif
                    endif
                    if not insysmsg "This is not a musical instrument"
                        wft 1500
                        target backpack
                        if EnableOverheadMessages = 1
                            overhead "[ j PROVOCATION BUFF... j ]" 2117
                        endif
                        cooldown "Provocation Buff" 900000
                        settimer "Provocation" 0
                        settimer "SongBuffDelay" 0
                    endif
                endif
            endif

            if EnableAutoPoisonWeaponinHand = 1 and diffhits < ActivateAutoHealHPdiff
                if skill "Poisoning" >= 80 and skill "Taste Identification" >= 80
                    if find '30988|5049|3934|3937|5046|5119|5185|3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' hand as myweapon
                        @setvar! equippedweapon myweapon
                    endif
                        getlabel equippedweapon weapondesc
                    if "poison charges" in weapondesc
                        // Do nothing
                    else
                        if findtype "Green Potion" self
                            overhead "[ APPLYING POISON... ]" 84
                            menu equippedweapon 0
                        else
                            if timer "inventorytimer" > 15000
                                overhead "[ NO POISON POTIONS ]" 337
                                settimer "inventorytimer" 0
                            endif
                        endif
                    endif
                endif
            endif

            if targetexists
                if findtype "Elven Spellblade" self
                    targettype "Elven Spellblade"
                else
                    target backpack
                endif
            endif

            if EnableTrackingAutoRecall = 1
                if PKTrackingRange = 60
                    if insysmsg ": 60 step" or insysmsg "60 space" or insysmsg ": 59 step" or insysmsg "59 space" or insysmsg ": 58 step" or insysmsg "58 space" or insysmsg ": 57 step" or insysmsg "57 space" or insysmsg ": 56 step" or insysmsg "56 space" or insysmsg ": 55 step" or insysmsg "55 space" or insysmsg ": 54 step" or insysmsg "54 space" or insysmsg ": 53 step" or insysmsg "53 space" or insysmsg ": 52 step" or insysmsg "52 space" or insysmsg ": 51 step" or insysmsg "51 space" or insysmsg ": 50 step" or insysmsg "50 space" or insysmsg ": 49 step" or insysmsg "49 space" or insysmsg ": 48 step" or insysmsg "48 space" or insysmsg ": 47 step" or insysmsg "47 space" or insysmsg ": 46 step" or insysmsg "46 space" or insysmsg ": 45 step" or insysmsg "45 space" or insysmsg ": 44 step" or insysmsg "44 space" or insysmsg ": 43 step" or insysmsg "43 space" or insysmsg ": 42 step" or insysmsg "42 space" or insysmsg ": 41 step" or insysmsg "41 space" or insysmsg ": 40 step" or insysmsg "40 space" or insysmsg ": 39 step" or insysmsg "39 space" or insysmsg ": 38 step" or insysmsg "38 space" or insysmsg ": 37 step" or insysmsg "37 space" or insysmsg ": 36 step" or insysmsg "36 space" or insysmsg ": 35 step" or insysmsg "35 space" or insysmsg ": 34 step" or insysmsg "34 space" or insysmsg ": 33 step" or insysmsg "33 space" or insysmsg ": 32 step" or insysmsg "32 space" or insysmsg ": 31 step" or insysmsg "31 space" or insysmsg ": 30 step" or insysmsg "30 space" or insysmsg ": 29 step" or insysmsg "29 space" or insysmsg ": 28 step" or insysmsg "28 space" or insysmsg ": 27 step" or insysmsg "27 space" or insysmsg ": 26 step" or insysmsg "26 space" or insysmsg ": 25 step" or insysmsg "25 space" or insysmsg ": 24 step" or insysmsg "24 space" or insysmsg ": 23 step" or insysmsg "23 space" or insysmsg ": 22 step" or insysmsg "22 space" or insysmsg ": 21 step" or insysmsg "21 space" or insysmsg ": 20 step" or insysmsg "20 space" or insysmsg ": 19 step" or insysmsg "19 space" or insysmsg ": 18 step" or insysmsg "18 space" or insysmsg ": 17 step" or insysmsg "17 space" or insysmsg ": 16 step" or insysmsg "16 space" or insysmsg ": 15 step" or insysmsg "15 space" or insysmsg ": 14 step" or insysmsg "14 space" or insysmsg ": 13 step" or insysmsg "13 space" or insysmsg ": 12 step" or insysmsg "12 space" or insysmsg ": 11 step" or insysmsg "11 space" or insysmsg ": 10 step" or insysmsg "10 space" or insysmsg ": 9 step" or insysmsg "(9 space" or insysmsg ": 8 step" or insysmsg "(8 space" or insysmsg ": 7 step" or insysmsg "(7 space" or insysmsg ": 6 step" or insysmsg "(6 space" or insysmsg ": 5 step" or insysmsg "(5 space" or insysmsg ": 4 step" or insysmsg "(4 space" or insysmsg ": 3 step" or insysmsg "(3 space" or insysmsg ": 2 step" or insysmsg "(2 space" or insysmsg ": 1 step" or insysmsg "(1 space" or insysmsg ": 0 step" or insysmsg "(0 space"
                        hotkey 'Toggle War Only'
                        if EnableRedAlertOverhead = 1
                            overhead "[ !! RED ALERT !! ]" 37
                        endif
                        @setvar! RedTargetFound 1
                        @setvar! WarModeToggledWhileFighting 0
                        clearsysmsg
                        replay
                    endif
                elseif PKTrackingRange = 50
                    if insysmsg ": 50 step" or insysmsg "50 space" or insysmsg ": 49 step" or insysmsg "49 space" or insysmsg ": 48 step" or insysmsg "48 space" or insysmsg ": 47 step" or insysmsg "47 space" or insysmsg ": 46 step" or insysmsg "46 space" or insysmsg ": 45 step" or insysmsg "45 space" or insysmsg ": 44 step" or insysmsg "44 space" or insysmsg ": 43 step" or insysmsg "43 space" or insysmsg ": 42 step" or insysmsg "42 space" or insysmsg ": 41 step" or insysmsg "41 space" or insysmsg ": 40 step" or insysmsg "40 space" or insysmsg ": 39 step" or insysmsg "39 space" or insysmsg ": 38 step" or insysmsg "38 space" or insysmsg ": 37 step" or insysmsg "37 space" or insysmsg ": 36 step" or insysmsg "36 space" or insysmsg ": 35 step" or insysmsg "35 space" or insysmsg ": 34 step" or insysmsg "34 space" or insysmsg ": 33 step" or insysmsg "33 space" or insysmsg ": 32 step" or insysmsg "32 space" or insysmsg ": 31 step" or insysmsg "31 space" or insysmsg ": 30 step" or insysmsg "30 space" or insysmsg ": 29 step" or insysmsg "29 space" or insysmsg ": 28 step" or insysmsg "28 space" or insysmsg ": 27 step" or insysmsg "27 space" or insysmsg ": 26 step" or insysmsg "26 space" or insysmsg ": 25 step" or insysmsg "25 space" or insysmsg ": 24 step" or insysmsg "24 space" or insysmsg ": 23 step" or insysmsg "23 space" or insysmsg ": 22 step" or insysmsg "22 space" or insysmsg ": 21 step" or insysmsg "21 space" or insysmsg ": 20 step" or insysmsg "20 space" or insysmsg ": 19 step" or insysmsg "19 space" or insysmsg ": 18 step" or insysmsg "18 space" or insysmsg ": 17 step" or insysmsg "17 space" or insysmsg ": 16 step" or insysmsg "16 space" or insysmsg ": 15 step" or insysmsg "15 space" or insysmsg ": 14 step" or insysmsg "14 space" or insysmsg ": 13 step" or insysmsg "13 space" or insysmsg ": 12 step" or insysmsg "12 space" or insysmsg ": 11 step" or insysmsg "11 space" or insysmsg ": 10 step" or insysmsg "10 space" or insysmsg ": 9 step" or insysmsg "(9 space" or insysmsg ": 8 step" or insysmsg "(8 space" or insysmsg ": 7 step" or insysmsg "(7 space" or insysmsg ": 6 step" or insysmsg "(6 space" or insysmsg ": 5 step" or insysmsg "(5 space" or insysmsg ": 4 step" or insysmsg "(4 space" or insysmsg ": 3 step" or insysmsg "(3 space" or insysmsg ": 2 step" or insysmsg "(2 space" or insysmsg ": 1 step" or insysmsg "(1 space" or insysmsg ": 0 step" or insysmsg "(0 space"
                        hotkey 'Toggle War Only'
                        if EnableRedAlertOverhead = 1
                            overhead "[ !! RED ALERT !! ]" 37
                        endif
                        @setvar! RedTargetFound 1
                        @setvar! WarModeToggledWhileFighting 0                        
                        clearsysmsg
                        replay
                    endif
                elseif PKTrackingRange = 40
                    if insysmsg ": 40 step" or insysmsg "40 space" or insysmsg ": 39 step" or insysmsg "39 space" or insysmsg ": 38 step" or insysmsg "38 space" or insysmsg ": 37 step" or insysmsg "37 space" or insysmsg ": 36 step" or insysmsg "36 space" or insysmsg ": 35 step" or insysmsg "35 space" or insysmsg ": 34 step" or insysmsg "34 space" or insysmsg ": 33 step" or insysmsg "33 space" or insysmsg ": 32 step" or insysmsg "32 space" or insysmsg ": 31 step" or insysmsg "31 space" or insysmsg ": 30 step" or insysmsg "30 space" or insysmsg ": 29 step" or insysmsg "29 space" or insysmsg ": 28 step" or insysmsg "28 space" or insysmsg ": 27 step" or insysmsg "27 space" or insysmsg ": 26 step" or insysmsg "26 space" or insysmsg ": 25 step" or insysmsg "25 space" or insysmsg ": 24 step" or insysmsg "24 space" or insysmsg ": 23 step" or insysmsg "23 space" or insysmsg ": 22 step" or insysmsg "22 space" or insysmsg ": 21 step" or insysmsg "21 space" or insysmsg ": 20 step" or insysmsg "20 space" or insysmsg ": 19 step" or insysmsg "19 space" or insysmsg ": 18 step" or insysmsg "18 space" or insysmsg ": 17 step" or insysmsg "17 space" or insysmsg ": 16 step" or insysmsg "16 space" or insysmsg ": 15 step" or insysmsg "15 space" or insysmsg ": 14 step" or insysmsg "14 space" or insysmsg ": 13 step" or insysmsg "13 space" or insysmsg ": 12 step" or insysmsg "12 space" or insysmsg ": 11 step" or insysmsg "11 space" or insysmsg ": 10 step" or insysmsg "10 space" or insysmsg ": 9 step" or insysmsg "(9 space" or insysmsg ": 8 step" or insysmsg "(8 space" or insysmsg ": 7 step" or insysmsg "(7 space" or insysmsg ": 6 step" or insysmsg "(6 space" or insysmsg ": 5 step" or insysmsg "(5 space" or insysmsg ": 4 step" or insysmsg "(4 space" or insysmsg ": 3 step" or insysmsg "(3 space" or insysmsg ": 2 step" or insysmsg "(2 space" or insysmsg ": 1 step" or insysmsg "(1 space" or insysmsg ": 0 step" or insysmsg "(0 space"
                        hotkey 'Toggle War Only'
                        if EnableRedAlertOverhead = 1
                            overhead "[ !! RED ALERT !! ]" 37
                        endif
                        @setvar! RedTargetFound 1
                        @setvar! WarModeToggledWhileFighting 0
                        clearsysmsg
                        replay
                    endif
                elseif PKTrackingRange = 0
                    if insysmsg "Now tracking"
                        hotkey 'Toggle War Only'
                        if EnableRedAlertOverhead = 1
                            overhead "[ !! RED ALERT !! ]" 37
                        endif
                        @setvar! RedTargetFound 1
                        @setvar! WarModeToggledWhileFighting 0
                        clearsysmsg
                        replay
                    endif
                endif
            endif

            if EnableHealPotion = 1 and diffhits >= HealPotionHPdiff
                if findtype "Yellow Potion" self as HealPot
                    getlabel HealPot HealPotlabel
                    if "next" in HealPotlabel
                        // Do nothing
                    else
                        @setvar! HealPotionCheck 0
  
                        if counttype 3852 self as HealPotCount
                            @setvar! HealPotionCheck HealPotCount
                        endif

                        clearsysmsg
                        dclicktype 3852
                        getlabel backpack backpackdesc
                        wait 250

                        if HealPotionCheck != counttype 3852 self or insysmsg "potion satchel used"
                            settimer 'HealPotionTimer' 0
                            cooldown "Healing Potion" HealingPotionCooldown
                            if EnableOverheadMessages = 1
                                if insysmsg "potion satchel used"
                                    overhead '[ FREE HEAL POTION ]' 253
                                else
                                    overhead "[ HEAL POTION ]" 253
                                endif
                            endif 
                            clearsysmsg
                        endif
                    endif
                else
                    if timer 'yellowMessageTimer' > 4500
                        overhead "[ NO HEAL POTS! ]" 337
                        settimer 'yellowMessageTimer' 0
                    endif
                endif
            endif

            if diffhits > 0 and not bandaging
                if skill 'healing' >= 30
                    if findtype 'clean bandage%s%' self
                        if targetexists
                            hotkey 'cancel current target'
                        endif
                        hotkey 'Bandage Self'
                        if EnableOverheadMessages = 1 
                            if aidsMessageTimer > 5000
                                overhead "[ BANDAGING... ]" 88
                                settimer aidsMessageTimer 0
                                wait 500
                            endif
                        endif
                    else
                        if timer aidsMessageTimer > 5000 and EnableOverheadMessages = 1
                            overhead "[ OUT OF BANDAGES! ]" 337
                            settimer aidsMessageTimer 0
                        endif
                    endif
                endif
            endif

            if EnablePKradar = 1
                if timer "PKRadar" > 1000
                    hotkey 'Next Murderer Player Target'
                    wait 250
                    if insysmsg "No one matching that was found"
                        settimer "PKRadar" 0
                        clearsysmsg
                    else
                        hotkey 'Toggle War Only'
                        @setvar! RedTargetFound 1
                        @setvar! WarModeToggledWhileFighting 0
                        @setvar! TimeToGo 1
                        @setvar! MurdererTarget lasttarget
                        replay
                    endif
                endif
            endif

            if EnableWeaponAbilities = 1
                if insysmsg "your target to bleed"
                    @setvar! TargetisBleeding 1
                    clearsysmsg
                endif
            endif

            if EnableWeaponCodexSwitching = 1 and SetCodexStance != 0 
                if skill 'Swordsmanship' >= 80 and mana > SwitchCodexManaAmount
                    if EnableWeaponCodexSwitching = 1 and findtype "sword codex" self as MyCodex 
                        if not gumpexists 2016719803 and EnableCodexHotbar = 1
                            while not gumpexists 1066647553
                                say "[CodexHotBar"
                                wait 250
                                if gumpexists 2016719803
                                    break
                                endif
                            endwhile
                        endif

                        getlabel MyCodex MyCodexDesc
                        
                        if SetCodexStance = 6
                            if cooldown "Frost Shell Cooldown"
                                @setvar! SwitchToFlayingStance 0
                                @setvar! SwitchToDefensiveStance 1
                                @setvar! SwitchToWarriorStance 0
                                @setvar! SwitchToCleaveStance 0
                                @setvar! SwitchToAggressiveStance 0
                            elseif poisoned or findbuff "bleed" or findbuff "disease"
                                @setvar! SwitchToFlayingStance 0
                                @setvar! SwitchToDefensiveStance 1
                                @setvar! SwitchToWarriorStance 0
                                @setvar! SwitchToCleaveStance 0
                                @setvar! SwitchToAggressiveStance 0
                            elseif warmode
                                @setvar! SwitchToFlayingStance 0
                                @setvar! SwitchToDefensiveStance 0
                                @setvar! SwitchToWarriorStance 0
                                @setvar! SwitchToCleaveStance 0
                                @setvar! SwitchToAggressiveStance 1
                            else
                                @setvar! SwitchToFlayingStance 1
                                @setvar! SwitchToDefensiveStance 0
                                @setvar! SwitchToWarriorStance 0
                                @setvar! SwitchToCleaveStance 0
                                @setvar! SwitchToAggressiveStance 0
                            endif
                        elseif SetCodexStance = 5
                            @setvar! SwitchToFlayingStance 1
                            @setvar! SwitchToDefensiveStance 0
                            @setvar! SwitchToWarriorStance 0
                            @setvar! SwitchToCleaveStance 0
                            @setvar! SwitchToAggressiveStance 0
                        elseif SetCodexStance = 4
                            @setvar! SwitchToFlayingStance 0
                            @setvar! SwitchToDefensiveStance 0
                            @setvar! SwitchToWarriorStance 1
                            @setvar! SwitchToCleaveStance 0
                            @setvar! SwitchToAggressiveStance 0        
                        elseif SetCodexStance = 3
                            @setvar! SwitchToFlayingStance 0
                            @setvar! SwitchToDefensiveStance 0
                            @setvar! SwitchToWarriorStance 0
                            @setvar! SwitchToCleaveStance 1
                            @setvar! SwitchToAggressiveStance 0 
                        elseif SetCodexStance = 2
                            @setvar! SwitchToFlayingStance 0
                            @setvar! SwitchToDefensiveStance 1
                            @setvar! SwitchToWarriorStance 0
                            @setvar! SwitchToCleaveStance 0
                            @setvar! SwitchToAggressiveStance 0
                        elseif SetCodexStance = 1
                            @setvar! SwitchToFlayingStance 0
                            @setvar! SwitchToDefensiveStance 0
                            @setvar! SwitchToWarriorStance 0
                            @setvar! SwitchToCleaveStance 0
                            @setvar! SwitchToAggressiveStance 1
                        endif

                        if SwitchToFlayingStance = 1 and timer "WeaponCodexTimer" > SwitchWeaponCodexCooldown
                            if "Flaying" in MyCodexDesc
                                // Do nothing
                            else
                                yell [SwordsStance5
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 1
                                if "Bleed" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 2 and DisableWeaponFinisher != 1
                                    yell [SwordsFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 2
                                if "Execute" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    yell [SwordsFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        elseif SwitchToDefensiveStance = 1
                            if "Defensive" in MyCodexDesc
                                // Do nothing
                            else
                                yell [SwordsStance2
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 2
                                if "Execute" in MyCodexDesc
                                    // Do nothing
                                elseif DisableWeaponFinisher != 1
                                    yell [SwordsFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 1 or EnableWeaponFinisher = 3
                                if "Bleed" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    yell [SwordsFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        elseif SwitchToWarriorStance = 1 and timer "WeaponCodexTimer" > SwitchWeaponCodexCooldown
                            if "Warrior" in MyCodexDesc
                                // Do nothing
                            else
                                yell [SwordsStance4
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 2
                                if "Execute" in MyCodexDesc
                                    // Do nothing
                                elseif DisableWeaponFinisher != 1
                                    say [SwordsFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 1
                                if "Bleed" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [SwordsFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        elseif SwitchToCleaveStance = 1 and timer "WeaponCodexTimer" > SwitchWeaponCodexCooldown
                            if "Cleave" in MyCodexDesc
                                // Do nothing
                            else
                                yell [SwordsStance3
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 1
                                if "Bleed" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [SwordsFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 2 or EnableWeaponFinisher = 3
                                if "Execute" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    yell [SwordsFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        elseif SwitchToAggressiveStance = 1 and timer "WeaponCodexTimer" > SwitchWeaponCodexCooldown
                            if "Aggressive" in MyCodexDesc
                                // Do nothing
                            else
                                yell [SwordsStance1
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 2
                                if "Execute" in MyCodexDesc
                                    // Do nothing
                                elseif DisableWeaponFinisher != 1
                                    say [SwordsFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 1
                                if "Bleed" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [SwordsFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        endif
                    endif
                elseif skill 'Mace Fighting' >= 80 and mana > SwitchCodexManaAmount
                    if EnableWeaponCodexSwitching = 1 and findtype "macing codex" self as MyCodex
                        if not gumpexists 2016719803 and EnableCodexHotbar = 1
                            while not gumpexists 1066647553
                                say "[CodexHotBar"
                                wait 250
                                if gumpexists 2016719803
                                    break
                                endif
                            endwhile
                        endif

                        getlabel MyCodex MyCodexDesc
                        
                        if SetCodexStance = 6
                            if cooldown "Frost Shell Cooldown"
                                @setvar! SwitchToSunderStance 0
                                @setvar! SwitchToWildSwingStance 0
                                @setvar! SwitchToCleaveStance 0
                                @setvar! SwitchToDefensiveStance 1
                                @setvar! SwitchToAggressiveStance 0
                            elseif poisoned or findbuff "bleed" or findbuff "disease"
                                @setvar! SwitchToSunderStance 0
                                @setvar! SwitchToWildSwingStance 0
                                @setvar! SwitchToCleaveStance 0
                                @setvar! SwitchToDefensiveStance 1
                                @setvar! SwitchToAggressiveStance 0
                            elseif warmode
                                @setvar! SwitchToSunderStance 0
                                @setvar! SwitchToWildSwingStance 0
                                @setvar! SwitchToCleaveStance 0
                                @setvar! SwitchToDefensiveStance 0
                                @setvar! SwitchToAggressiveStance 1
                            else
                                @setvar! SwitchToSunderStance 0
                                @setvar! SwitchToWildSwingStance 1
                                @setvar! SwitchToCleaveStance 0
                                @setvar! SwitchToDefensiveStance 0
                                @setvar! SwitchToAggressiveStance 0
                            endif
                        elseif SetCodexStance = 5
                            @setvar! SwitchToSunderStance 1
                            @setvar! SwitchToWildSwingStance 0
                            @setvar! SwitchToCleaveStance 0
                            @setvar! SwitchToDefensiveStance 0
                            @setvar! SwitchToAggressiveStance 0
                        elseif SetCodexStance = 4
                            @setvar! SwitchToSunderStance 0
                            @setvar! SwitchToWildSwingStance 1
                            @setvar! SwitchToCleaveStance 0
                            @setvar! SwitchToDefensiveStance 0
                            @setvar! SwitchToAggressiveStance 0
                        elseif SetCodexStance = 3
                            @setvar! SwitchToSunderStance 0
                            @setvar! SwitchToWildSwingStance 0
                            @setvar! SwitchToCleaveStance 0
                            @setvar! SwitchToDefensiveStance 1
                            @setvar! SwitchToAggressiveStance 0
                        elseif SetCodexStance = 2
                            @setvar! SwitchToSunderStance 0
                            @setvar! SwitchToWildSwingStance 0
                            @setvar! SwitchToCleaveStance 0
                            @setvar! SwitchToDefensiveStance 1
                            @setvar! SwitchToAggressiveStance 0
                        elseif SetCodexStance = 1
                            @setvar! SwitchToSunderStance 0
                            @setvar! SwitchToWildSwingStance 0
                            @setvar! SwitchToCleaveStance 0
                            @setvar! SwitchToDefensiveStance 0
                            @setvar! SwitchToAggressiveStance 1
                        endif

                        if SwitchToAggressiveStance = 1 and timer "WeaponCodexTimer" > SwitchWeaponCodexCooldown
                            if "Aggressive" in MyCodexDesc
                                // Do nothing
                            else
                                yell [MacingStance1
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 2
                                if "Shatter" in MyCodexDesc
                                    // Do nothing
                                elseif DisableWeaponFinisher != 1
                                    say [MacingFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 1
                                if "Pulverize" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [MacingFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        elseif SwitchToDefensiveStance = 1
                            if "Defensive" in MyCodexDesc
                                // Do nothing
                            else
                                yell [MacingStance2
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 2
                                if "Shatter" in MyCodexDesc
                                    // Do nothing
                                elseif DisableWeaponFinisher != 1
                                    say [MacingFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 1
                                if "Pulverize" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [MacingFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        elseif SwitchToCleaveStance = 1 and timer "WeaponCodexTimer" > SwitchWeaponCodexCooldown
                            if "Cleave" in MyCodexDesc
                                // Do nothing
                            else
                                yell [MacingStance3
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 1
                                if "Pulverize" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 2 and DisableWeaponFinisher != 1
                                    say [MacingFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 2
                                if "Shatter" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    yell [MacingFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        elseif SwitchToWildSwingStance = 1 and timer "WeaponCodexTimer" > SwitchWeaponCodexCooldown
                            if "Wild Swing" in MyCodexDesc
                                // Do nothing
                            else
                                yell [MacingStance4
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 1
                                if "Shatter" in MyCodexDesc
                                    // Do nothing
                                elseif DisableWeaponFinisher != 1
                                    say [MacingFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 2
                                if "Pulverize" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [MacingFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        elseif SwitchToSunderStance = 1 and timer "WeaponCodexTimer" > SwitchWeaponCodexCooldown
                            if "Sunder" in MyCodexDesc
                                // Do nothing
                            else
                                yell [MacingStance5
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 1
                                if "Pulverize" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [MacingFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 2
                                if "Shatter" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    yell [MacingFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        endif
                    endif
                elseif skill 'Fencing' >= 80 and mana > SwitchCodexManaAmount
                    if EnableWeaponCodexSwitching = 1 and findtype "fencing codex" self as MyCodex
                        if not gumpexists 2016719803 and EnableCodexHotbar = 1
                            while not gumpexists 1066647553
                                say "[CodexHotBar"
                                wait 250
                                if gumpexists 2016719803
                                    break
                                endif
                            endwhile
                        endif

                        getlabel MyCodex MyCodexDesc
                        
                        if SetCodexStance = 6
                            if cooldown "Frost Shell Cooldown"
                                @setvar! SwitchToAggressiveStance 0
                                @setvar! SwitchToDefensiveStance 1
                                @setvar! SwitchToCleaveStance 0
                                @setvar! SwitchToBlackguardStance 0
                                @setvar! SwitchToFangStance 0
                            elseif poisoned or findbuff "bleed" or findbuff "disease"
                                @setvar! SwitchToAggressiveStance 0
                                @setvar! SwitchToDefensiveStance 1
                                @setvar! SwitchToCleaveStance 0
                                @setvar! SwitchToBlackguardStance 0
                                @setvar! SwitchToFangStance 0
                            elseif warmode
                                @setvar! SwitchToAggressiveStance 1
                                @setvar! SwitchToDefensiveStance 0
                                @setvar! SwitchToCleaveStance 0
                                @setvar! SwitchToBlackguardStance 0
                                @setvar! SwitchToFangStance 0
                            else
                                @setvar! SwitchToAggressiveStance 0
                                @setvar! SwitchToDefensiveStance 0
                                @setvar! SwitchToCleaveStance 0
                                @setvar! SwitchToBlackguardStance 1
                                @setvar! SwitchToFangStance 0
                            endif
                        elseif SetCodexStance = 5
                            @setvar! SwitchToAggressiveStance 0
                            @setvar! SwitchToDefensiveStance 0
                            @setvar! SwitchToCleaveStance 0
                            @setvar! SwitchToBlackguardStance 0
                            @setvar! SwitchToFangStance 1
                        elseif SetCodexStance = 4
                            @setvar! SwitchToAggressiveStance 0
                            @setvar! SwitchToDefensiveStance 0
                            @setvar! SwitchToCleaveStance 0
                            @setvar! SwitchToBlackguardStance 1
                            @setvar! SwitchToFangStance 0
                        elseif SetCodexStance = 3
                            @setvar! SwitchToAggressiveStance 0
                            @setvar! SwitchToDefensiveStance 0
                            @setvar! SwitchToCleaveStance 1
                            @setvar! SwitchToBlackguardStance 0
                            @setvar! SwitchToFangStance 0
                        elseif SetCodexStance = 2
                            @setvar! SwitchToAggressiveStance 0
                            @setvar! SwitchToDefensiveStance 1
                            @setvar! SwitchToCleaveStance 0
                            @setvar! SwitchToBlackguardStance 0
                            @setvar! SwitchToFangStance 0
                        elseif SetCodexStance = 1
                            @setvar! SwitchToAggressiveStance 1
                            @setvar! SwitchToDefensiveStance 0
                            @setvar! SwitchToCleaveStance 0
                            @setvar! SwitchToBlackguardStance 0
                            @setvar! SwitchToFangStance 0
                        endif

                        if SwitchToAggressiveStance = 1 and timer "WeaponCodexTimer" > SwitchWeaponCodexCooldown
                            if "Aggressive" in MyCodexDesc
                                // Do nothing
                            else
                                yell [FencingStance1
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 2
                                if "Flurry" in MyCodexDesc
                                    // Do nothing
                                elseif DisableWeaponFinisher != 1
                                    say [FencingFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 1
                                if "Assassinate" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [FencingFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        elseif SwitchToDefensiveStance = 1
                            if "Defensive" in MyCodexDesc
                                // Do nothing
                            else
                                yell [FencingStance2
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 2
                                if "Flurry" in MyCodexDesc
                                    // Do nothing
                                elseif DisableWeaponFinisher != 1
                                    say [FencingFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 1
                                if "Assassinate" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [FencingFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        elseif SwitchToCleaveStance = 1 and timer "WeaponCodexTimer" > SwitchWeaponCodexCooldown
                            if "Cleave" in MyCodexDesc
                                // Do nothing
                            else
                                yell [FencingStance3
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 1
                                if "Assassinate" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 2 and DisableWeaponFinisher != 1
                                    say [FencingFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 2
                                if "Flurry" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    yell [FencingFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        elseif SwitchToBlackguardStance = 1 and timer "WeaponCodexTimer" > SwitchWeaponCodexCooldown
                            if "Blackguard" in MyCodexDesc
                                // Do nothing
                            else
                                yell [FencingStance4
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 1
                                if "Flurry" in MyCodexDesc
                                    // Do nothing
                                elseif DisableWeaponFinisher != 1
                                    say [FencingFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 2
                                if "Assassinate" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [FencingFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        elseif SwitchToFangStance = 1 and timer "WeaponCodexTimer" > SwitchWeaponCodexCooldown
                            if "Fang" in MyCodexDesc
                                // Do nothing
                            else
                                yell [FencingStance5
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 1
                                if "Assassinate" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [FencingFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 2
                                if "Flurry" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    yell [FencingFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        endif
                    endif
                elseif skill 'Archery' >= 80 and mana > SwitchCodexManaAmount
                    if EnableWeaponCodexSwitching = 1 and findtype "archery codex" self as MyCodex
                        if not gumpexists 2016719803 and EnableCodexHotbar = 1
                            while not gumpexists 1066647553
                                say "[CodexHotBar"
                                wait 250
                                if gumpexists 2016719803
                                    break
                                endif
                            endwhile
                        endif

                        getlabel MyCodex MyCodexDesc
                        
                        if SetCodexStance = 6
                            if cooldown "Frost Shell Cooldown"
                                @setvar! SwitchToArcaneStance 0
                                @setvar! SwitchToFowlingStance 1
                                @setvar! SwitchToIncendiaryStance 0
                                @setvar! SwitchToLongshotStance 0
                                @setvar! SwitchToMaimingStance 0
                            elseif SwitchtoIncendiaryAmmo = 1
                                @setvar! SwitchToArcaneStance 0
                                @setvar! SwitchToFowlingStance 0
                                @setvar! SwitchToIncendiaryStance 1
                                @setvar! SwitchToLongshotStance 0
                                @setvar! SwitchToMaimingStance 0
                            elseif poisoned or findbuff "bleed" or findbuff "disease"
                                @setvar! SwitchToArcaneStance 0
                                @setvar! SwitchToFowlingStance 1
                                @setvar! SwitchToIncendiaryStance 0
                                @setvar! SwitchToLongshotStance 0
                                @setvar! SwitchToMaimingStance 0
                            elseif warmode
                                @setvar! SwitchToArcaneStance 0
                                @setvar! SwitchToFowlingStance 0
                                @setvar! SwitchToIncendiaryStance 1
                                @setvar! SwitchToLongshotStance 0
                                @setvar! SwitchToMaimingStance 0
                            else
                                @setvar! SwitchToArcaneStance 1
                                @setvar! SwitchToFowlingStance 0
                                @setvar! SwitchToIncendiaryStance 0
                                @setvar! SwitchToLongshotStance 0
                                @setvar! SwitchToMaimingStance 0
                            endif
                        elseif SetCodexStance = 5
                            @setvar! SwitchToArcaneStance 0
                            @setvar! SwitchToFowlingStance 0
                            @setvar! SwitchToIncendiaryStance 0
                            @setvar! SwitchToLongshotStance 0
                            @setvar! SwitchToMaimingStance 1
                        elseif SetCodexStance = 4
                            @setvar! SwitchToArcaneStance 0
                            @setvar! SwitchToFowlingStance 0
                            @setvar! SwitchToIncendiaryStance 0
                            @setvar! SwitchToLongshotStance 1
                            @setvar! SwitchToMaimingStance 0
                        elseif SetCodexStance = 3
                            @setvar! SwitchToArcaneStance 0
                            @setvar! SwitchToFowlingStance 0
                            @setvar! SwitchToIncendiaryStance 1
                            @setvar! SwitchToLongshotStance 0
                            @setvar! SwitchToMaimingStance 0
                        elseif SetCodexStance = 2
                            @setvar! SwitchToArcaneStance 0
                            @setvar! SwitchToFowlingStance 1
                            @setvar! SwitchToIncendiaryStance 0
                            @setvar! SwitchToLongshotStance 0
                            @setvar! SwitchToMaimingStance 0
                        elseif SetCodexStance = 1
                            @setvar! SwitchToArcaneStance 1
                            @setvar! SwitchToFowlingStance 0
                            @setvar! SwitchToIncendiaryStance 0
                            @setvar! SwitchToLongshotStance 0
                            @setvar! SwitchToMaimingStance 0
                        endif

                        if SwitchToArcaneStance = 1 and timer "WeaponCodexTimer" > SwitchWeaponCodexCooldown
                            if "Arcane" in MyCodexDesc
                                // Do nothing
                            else
                                yell "[ArcheryAmmunition1"
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 2
                                if "Pincushion" in MyCodexDesc
                                    // Do nothing
                                elseif DisableWeaponFinisher != 1
                                    say [ArcheryFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 1
                                if "Ricochet" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [ArcheryFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        elseif SwitchToFowlingStance = 1
                            if "Fowling" in MyCodexDesc
                                // Do nothing
                            else
                                yell "[ArcheryAmmunition2"
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 2
                                if "Pincushion" in MyCodexDesc
                                    // Do nothing
                                elseif DisableWeaponFinisher != 1
                                    say [ArcheryFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 1
                                if "Ricochet" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [ArcheryFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        elseif SwitchToIncendiaryStance = 1 and timer "WeaponCodexTimer" > SwitchWeaponCodexCooldown
                            if "Incendiary" in MyCodexDesc
                                // Do nothing
                            else
                                yell "[ArcheryAmmunition3"
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 1
                                if "Ricochet" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [ArcheryFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 2
                                if "Pincushion" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    yell [ArcheryFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        elseif SwitchToLongshotStance = 1 and timer "WeaponCodexTimer" > SwitchWeaponCodexCooldown
                            if "Longshot" in MyCodexDesc
                                // Do nothing
                            else
                                yell "[ArcheryAmmunition4"
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 1
                                if "Ricochet" in MyCodexDesc
                                    // Do nothing
                                elseif DisableWeaponFinisher != 1
                                    say [ArcheryFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 2
                                if "Pincushion" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [ArcheryFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        elseif SwitchToMaimingStance = 1 and timer "WeaponCodexTimer" > SwitchWeaponCodexCooldown
                            if "Maiming" in MyCodexDesc
                                // Do nothing
                            else
                                yell "[ArcheryAmmunition5"
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 1
                                if "Ricochet" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [ArcheryFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 2
                                if "Pincushion" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    yell [ArcheryFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        endif
                    endif
                elseif skill 'Wrestling' >= 80 and mana > SwitchCodexManaAmount
                    if EnableWeaponCodexSwitching = 1 and findtype "wrestling codex" self as MyCodex
                        if not gumpexists 2016719803 and EnableCodexHotbar = 1
                            while not gumpexists 1066647553
                                say "[CodexHotBar"
                                wait 250
                                if gumpexists 2016719803
                                    break
                                endif
                            endwhile
                        endif

                        getlabel MyCodex MyCodexDesc
                        
                        if SetCodexStance = 6
                            if cooldown "Frost Shell Cooldown"
                                @setvar! SwitchToDragonStance 0
                                @setvar! SwitchToCrabStance 1
                                @setvar! SwitchToSpiderStance 0
                                @setvar! SwitchToMonkeyStance 0
                                @setvar! SwitchToCraneStance 0
                            elseif poisoned or findbuff "bleed" or findbuff "disease"
                                @setvar! SwitchToDragonStance 0
                                @setvar! SwitchToCrabStance 1
                                @setvar! SwitchToSpiderStance 0
                                @setvar! SwitchToMonkeyStance 0
                                @setvar! SwitchToCraneStance 0
                            elseif warmode
                                @setvar! SwitchToDragonStance 0
                                @setvar! SwitchToCrabStance 0
                                @setvar! SwitchToSpiderStance 0
                                @setvar! SwitchToMonkeyStance 1
                                @setvar! SwitchToCraneStance 0
                            else
                                @setvar! SwitchToDragonStance 1
                                @setvar! SwitchToCrabStance 0
                                @setvar! SwitchToSpiderStance 0
                                @setvar! SwitchToMonkeyStance 0
                                @setvar! SwitchToCraneStance 0
                            endif
                        elseif SetCodexStance = 5
                            @setvar! SwitchToDragonStance 0
                            @setvar! SwitchToCrabStance 0
                            @setvar! SwitchToSpiderStance 0
                            @setvar! SwitchToMonkeyStance 0
                            @setvar! SwitchToCraneStance 1
                        elseif SetCodexStance = 4
                            @setvar! SwitchToDragonStance 0
                            @setvar! SwitchToCrabStance 0
                            @setvar! SwitchToSpiderStance 0
                            @setvar! SwitchToMonkeyStance 1
                            @setvar! SwitchToCraneStance 0
                        elseif SetCodexStance = 3
                            @setvar! SwitchToDragonStance 0
                            @setvar! SwitchToCrabStance 0
                            @setvar! SwitchToSpiderStance 1
                            @setvar! SwitchToMonkeyStance 0
                            @setvar! SwitchToCraneStance 0
                        elseif SetCodexStance = 2
                            @setvar! SwitchToDragonStance 0
                            @setvar! SwitchToCrabStance 1
                            @setvar! SwitchToSpiderStance 0
                            @setvar! SwitchToMonkeyStance 0
                            @setvar! SwitchToCraneStance 0
                        elseif SetCodexStance = 1
                            @setvar! SwitchToDragonStance 1
                            @setvar! SwitchToCrabStance 0
                            @setvar! SwitchToSpiderStance 0
                            @setvar! SwitchToMonkeyStance 0
                            @setvar! SwitchToCraneStance 0
                        endif

                        if SwitchToDragonStance = 1 and timer "WeaponCodexTimer" > SwitchWeaponCodexCooldown
                            if "Dragon" in MyCodexDesc
                                // Do nothing
                            else
                                yell [WrestlingStance1
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 2
                                if "Zen Strike" in MyCodexDesc
                                    // Do nothing
                                elseif DisableWeaponFinisher != 1
                                    say [WrestlingFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 1
                                if "Chi Thrust" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [WrestlingFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        elseif SwitchToCrabStance = 1
                            if "Crab" in MyCodexDesc
                                // Do nothing
                            else
                                yell [WrestlingStance2
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 2
                                if "Zen Strike" in MyCodexDesc
                                    // Do nothing
                                elseif DisableWeaponFinisher != 1
                                    say [WrestlingFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 1
                                if "Chi Thrust" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [WrestlingFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        elseif SwitchToSpiderStance = 1 and timer "WeaponCodexTimer" > SwitchWeaponCodexCooldown
                            if "Spider" in MyCodexDesc
                                // Do nothing
                            else
                                yell [WrestlingStance3
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 1
                                if "Chi Thrust" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [WrestlingFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 2
                                if "Zen Strike" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    yell [WrestlingFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        elseif SwitchToMonkeyStance = 1 and timer "WeaponCodexTimer" > SwitchWeaponCodexCooldown
                            if "Monkey" in MyCodexDesc
                                // Do nothing
                            else
                                yell [WrestlingStance4
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 1
                                if "Chi Thrust" in MyCodexDesc
                                    // Do nothing
                                elseif DisableWeaponFinisher != 1
                                    say [WrestlingFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 2
                                if "Zen Strike" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [WrestlingFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        elseif SwitchToCraneStance = 1 and timer "WeaponCodexTimer" > SwitchWeaponCodexCooldown
                            if "Crane" in MyCodexDesc
                                // Do nothing
                            else
                                yell [WrestlingStance5
                                settimer "WeaponCodexTimer" 0
                                wait 250
                            endif
                            if EnableWeaponFinisher = 3 or EnableWeaponFinisher = 1
                                if "Chi Thrust" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    say [WrestlingFinisher1
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            elseif EnableWeaponFinisher = 2
                                if "Zen Strike" in MyCodexDesc
                                    // Do nothing
                                elseif EnableWeaponFinisher = 1 and DisableWeaponFinisher != 1
                                    yell [WrestlingFinisher2
                                    @setvar! DisableWeaponFinisher 0
                                    wait 250
                                    if insysmsg "You must first reach rank 5"
                                        @setvar! DisableWeaponFinisher 1
                                    endif
                                endif
                            endif
                        endif
                    endif
                endif
            endif

            if timer "AttackingTimer" > 500 
                if find ClosestTarget ground -1 -1 TargetAttackRange 
                    attack ClosestTarget
                    settimer "AttackingTimer" 0
                else 
                    replay
                endif 
            endif

            if EnableShieldCodexSwitching = 1 and SetShieldCodexStance != 0
                if skill "Parrying" >= 80 and findtype "shield codex" self as ShieldCodex and mana > SwitchCodexManaAmount

                    if not varexist EnableShieldFinisher
                        @setvar! EnableShieldFinisher 1
                    endif

                    if not gumpexists 2016719803 and EnableCodexHotbar = 1
                        while not gumpexists 1066647553
                            say "[CodexHotBar"
                            wait 250
                            if gumpexists 2016719803
                                break
                            endif
                        endwhile
                    endif

                    getlabel ShieldCodex ShieldCodexDesc

                    if SetShieldCodexStance = 6
                        if cooldown "Frost Shell Cooldown"
                            @setvar! SwitchToBulwarkStance 0
                            @setvar! SwitchToWardingStance 1
                            @setvar! SwitchToMirrorStance 0
                            @setvar! SwitchToShieldBashStance 0
                            @setvar! SwitchToTestudoStance 0
                        elseif poisoned or findbuff "bleed" or findbuff "disease"
                            @setvar! SwitchToBulwarkStance 0
                            @setvar! SwitchToWardingStance 1
                            @setvar! SwitchToMirrorStance 0
                            @setvar! SwitchToShieldBashStance 0
                            @setvar! SwitchToTestudoStance 0
                        elseif warmode
                            @setvar! SwitchToBulwarkStance 1
                            @setvar! SwitchToWardingStance 0
                            @setvar! SwitchToMirrorStance 0
                            @setvar! SwitchToShieldBashStance 0
                            @setvar! SwitchToTestudoStance 0
                        else
                            @setvar! SwitchToBulwarkStance 0
                            @setvar! SwitchToShieldBashStance 1
                            @setvar! SwitchToMirrorStance 0
                            @setvar! SwitchToWardingStance 0
                            @setvar! SwitchToTestudoStance 0
                        endif
                    elseif SetShieldCodexStance = 5
                        @setvar! SwitchToBulwarkStance 1
                        @setvar! SwitchToShieldBashStance 0
                        @setvar! SwitchToMirrorStance 0
                        @setvar! SwitchToWardingStance 0
                        @setvar! SwitchToTestudoStance 0
                    elseif SetShieldCodexStance = 4
                        @setvar! SwitchToBulwarkStance 0
                        @setvar! SwitchToShieldBashStance 0
                        @setvar! SwitchToMirrorStance 1
                        @setvar! SwitchToWardingStance 0
                        @setvar! SwitchToTestudoStance 0
                    elseif SetShieldCodexStance = 3
                        @setvar! SwitchToBulwarkStance 0
                        @setvar! SwitchToShieldBashStance 0
                        @setvar! SwitchToMirrorStance 0
                        @setvar! SwitchToWardingStance 0
                        @setvar! SwitchToTestudoStance 1
                    elseif SetShieldCodexStance = 2
                        @setvar! SwitchToBulwarkStance 0
                        @setvar! SwitchToShieldBashStance 0
                        @setvar! SwitchToMirrorStance 0
                        @setvar! SwitchToWardingStance 1
                        @setvar! SwitchToTestudoStance 0
                    elseif SetShieldCodexStance = 1
                        @setvar! SwitchToBulwarkStance 0
                        @setvar! SwitchToShieldBashStance 1
                        @setvar! SwitchToMirrorStance 0
                        @setvar! SwitchToWardingStance 0
                        @setvar! SwitchToTestudoStance 0
                    endif

                    if SwitchToWardingStance = 1
                        if "Warding" in ShieldCodexDesc
                            // Do nothing
                        else
                            yell [ShieldsStance2
                            settimer "ShieldCodexTimer" 0
                            wait 250
                        endif
                        if EnableShieldFinisher = 2 or EnableShieldFinisher = 3 and DisableShieldFinisher != 1
                            if "Barrier" in ShieldCodexDesc
                                // Do nothing
                            else
                                say [ShieldsFinisher2
                                wait 250
                                if insysmsg "You must first reach rank 5"
                                    @setvar! DisableShieldFinisher 1
                                endif
                            endif
                        elseif EnableShieldFinisher = 1 and DisableShieldFinisher != 1
                            if "Last Stand" in ShieldCodexDesc
                                // Do nothing
                            else
                                yell [ShieldsFinisher1
                                wait 250
                                if insysmsg "You must first reach rank 5"
                                    @setvar! DisableShieldFinisher 1
                                endif
                            endif
                        endif
                    elseif SwitchToMirrorStance = 1 and timer "ShieldCodexTimer" > SwitchShieldCodexCooldown
                        if "Mirror" in ShieldCodexDesc
                            // Do nothing
                        else
                            yell [ShieldsStance4
                            settimer "ShieldCodexTimer" 0
                            wait 250
                        endif
                        if EnableShieldFinisher = 1 or EnableShieldFinisher = 3 and DisableShieldFinisher != 1
                            if "Last Stand" in ShieldCodexDesc
                                // Do nothing
                            else
                                yell [ShieldsFinisher1
                                wait 250
                                if insysmsg "You must first reach rank 5"
                                    @setvar! DisableShieldFinisher 1
                                endif
                            endif
                        elseif EnableShieldFinisher = 2 and DisableShieldFinisher != 1
                            if "Barrier" in ShieldCodexDesc
                                // Do nothing
                            else
                                say [ShieldsFinisher2
                                wait 250
                                if insysmsg "You must first reach rank 5"
                                    @setvar! DisableShieldFinisher 1
                                endif
                            endif
                        endif
                    elseif SwitchToBulwarkStance = 1 and timer "ShieldCodexTimer" > SwitchShieldCodexCooldown
                        if "Bulwark" in ShieldCodexDesc
                            // Do nothing
                        else
                            yell [ShieldsStance5
                            settimer "ShieldCodexTimer" 0
                            wait 250
                        endif
                        if EnableShieldFinisher = 1 or EnableShieldFinisher = 3 and DisableShieldFinisher != 1
                            if "Last Stand" in ShieldCodexDesc
                                // Do nothing
                            else
                                yell [ShieldsFinisher1
                                wait 250
                                if insysmsg "You must first reach rank 5"
                                    @setvar! DisableShieldFinisher 1
                                endif
                            endif
                        elseif EnableShieldFinisher = 2 and DisableShieldFinisher != 1
                            if "Barrier" in ShieldCodexDesc
                                // Do nothing
                            else
                                say [ShieldsFinisher2
                                wait 250
                                if insysmsg "You must first reach rank 5"
                                    @setvar! DisableShieldFinisher 1
                                endif
                            endif
                        endif
                    elseif SwitchToTestudoStance = 1 and timer "ShieldCodexTimer" > SwitchShieldCodexCooldown
                        if "Testudo" in ShieldCodexDesc
                            // Do nothing
                        else
                            yell [ShieldsStance3
                            settimer "ShieldCodexTimer" 0
                            wait 250
                        endif
                        if EnableShieldFinisher = 1 or EnableShieldFinisher = 3 and DisableShieldFinisher != 1
                            if "Last Stand" in ShieldCodexDesc
                                // Do nothing
                            else
                                yell [ShieldsFinisher1
                                wait 250
                                if insysmsg "You must first reach rank 5"
                                    @setvar! DisableShieldFinisher 1
                                endif
                            endif
                        elseif EnableShieldFinisher = 2 and DisableShieldFinisher != 1
                            if "Barrier" in ShieldCodexDesc
                                // Do nothing
                            else
                                say [ShieldsFinisher2
                                wait 250
                                if insysmsg "You must first reach rank 5"
                                    @setvar! DisableShieldFinisher 1
                                endif
                            endif
                        endif
                    elseif SwitchToShieldBashStance = 1 and timer "ShieldCodexTimer" > SwitchShieldCodexCooldown
                        if "Shield Bash" in ShieldCodexDesc
                            // Do nothing
                        else
                            yell [ShieldsStance1
                            settimer "ShieldCodexTimer" 0
                            wait 250
                        endif
                        if EnableShieldFinisher = 2 or EnableShieldFinisher = 3 and DisableShieldFinisher != 1
                            if "Barrier" in ShieldCodexDesc
                                // Do nothing
                            else
                                say [ShieldsFinisher2
                                wait 250
                                if insysmsg "You must first reach rank 5"
                                    @setvar! DisableShieldFinisher 1
                                endif
                            endif
                        elseif EnableShieldFinisher = 1 and DisableShieldFinisher != 1
                            if "Last Stand" in ShieldCodexDesc
                                // Do nothing
                            else
                                yell [ShieldsFinisher1
                                wait 250
                                if insysmsg "You must first reach rank 5"
                                    @setvar! DisableShieldFinisher 1
                                endif
                            endif
                        endif
                    endif
                endif
            endif

            if dead ClosestTarget
                @setvar! SwitchtoIncendiaryAmmo 0
                break
            endif
            
            if EnableOverheadMessages = 1
                if insysmsg "something invisible out of"
                    overhead " SOMEONE HIDING! " 6
                endif

                if insysmsg "additional mastery chain link"
                    overhead "[ CHAIN LINK UNLOCKED!! ]" 149
                endif

                if insysmsg "You have unlocked a codex upgrade point"
                    overhead "[ CODEX POINT UNLOCKED! ]" 2114
                endif

                if insysmsg "enough experience to upgrade"
                    overhead "[ ASPECT TIER UNLOCKED!! ]" 2234
                endif

                if insysmsg "causes you to bleed"
                    overhead "[ YOU ARE BLEEDING... ]" 2118
                endif

                if insysmsg "You feel chilled!"
                    overhead "[ YOU ARE CHILLED... ]" 2234
                endif

                if insysmsg "The creature pierces and bypasses your armor!"
                    overhead "[ YOU ARE PIERCED... ]" 337
                endif

                if insysmsg "You cause your target to bleed out."
                    overhead "[ BLEED OUT! ]" 2118 ClosestTarget
                endif

                if insysmsg "Your shot hinders" and not dead ClosestTarget
                    overhead "[ HINDERED! ]" 44 ClosestTarget
                endif

                if insysmsg "Your strike disarms your target!" and not dead ClosestTarget
                    overhead "[ DISARMED! ]" 253 ClosestTarget
                endif

                if insysmsg "Your attack hamstrings your target!" and not dead ClosestTarget
                    overhead "[ HAMSTRUNG! ]" 2117 ClosestTarget
                endif

                if insysmsg "Your target overpowers" and not dead ClosestTarget
                    overhead "[ VICIOUS WOUND! ]" 1664 ClosestTarget
                endif

                if insysmsg "Barding break avoided" and not dead ClosestTarget
                    overhead "[ BREAK AVOIDED! ]" 84 ClosestTarget
                endif

                if insysmsg "Frost Shell activated"
                    overhead "[ FROST SHELL! ]" 2234
                endif

                if insysmsg "Judgment activated"
                    overhead "[ JUDGMENT! ]" 2114
                endif

                if insysmsg "Cacophony activated"
                    overhead "[ j CACOPHONY! j ]" 2241
                endif
            else
                if insysmsg "additional mastery chain link"
                    overhead " CHAIN! " 149
                endif

                if insysmsg "You have unlocked a codex upgrade point"
                    overhead " CODEX " 2114
                endif

                if insysmsg "enough experience to upgrade"
                    overhead " ASPECT " 2234
                endif

                if insysmsg "Frost Shell activated"
                    overhead "  " 2234
                endif

                if insysmsg "Judgment activated"
                    overhead "  " 2114
                endif

                if insysmsg "Cacophony activated"
                    overhead " j j j " 2241
                endif

                if insysmsg "something invisible out of"
                    overhead "  " 6
                endif
            endif
            
            if warmode
                @setvar! WarModeToggledWhileFighting 1
            endif
            
            if timer "AttackingTimer" > 500 
                if find ClosestTarget ground -1 -1 TargetAttackRange 
                    attack ClosestTarget
                    settimer "AttackingTimer" 0
                else 
                    replay
                endif 
            endif

            if dead ClosestTarget
                @setvar! SwitchtoIncendiaryAmmo 0
                break
            endif

            if EnableWeaponCheck = 1 
                if skill 'Swordsmanship' >= 50
                    if not findtype '30988|5049|3909|3911|3915|3917|3934|3937|5046|5115|5119|5182|5185|5187|31128|31190' self
                        overhead "[ NO WEAPON! ]" 337
                        wait 2000
                        sysmsg "Please acquire a weapon before you start this script!" 0
                        stop
                    else
                        if not findtype '30988|5049|3909|3911|3915|3917|3934|3937|5046|5115|5119|5182|5185|5187|31128|31190' hand
                            if findtype '30988|5049|3909|3911|3915|3917|3934|3937|5046|5115|5119|5182|5185|5187|31128|31190' backpack as weapon
                                for 10
                                getlabel weapon WeaponLabel
                                wait 250
                                if "aspect" in WeaponLabel
                                    break
                                else
                                    @ignore weapon
                                    wait 150
                                    if findtype '30988|5049|3909|3911|3915|3917|3934|3937|5046|5115|5119|5182|5185|5187|31128|31190' backpack as weapon
                                        getlabel weapon WeaponLabel
                                    endif
                                endif
                                endfor
                                wait 150
                                dclick weapon
                                wait 250
                            endif
                        endif
                    endif
                elseif skill 'Mace Fighting' >= 50
                    if not findtype '31180|3568|3713|3721|3932|5040|5044|5112|5127|5177|5179|5181|30991|30999|31000|31001|31014|31178|31180|31182' self
                        overhead "[ NO WEAPON! ]" 337
                        wait 2000
                        sysmsg "Please acquire a weapon before you start this script!" 0
                        stop
                    else
                        if not findtype '31180|3568|3713|3721|3932|5040|5044|5112|5127|5177|5179|5181|30991|30999|31000|31001|31014|31178|31180|31182' hand
                            if findtype '31180|3568|3713|3721|3932|5040|5044|5112|5127|5177|5179|5181|30991|30999|31000|31001|31014|31178|31180|31182' backpack as weapon
                                for 10
                                getlabel weapon WeaponLabel
                                wait 250
                                if "aspect" in WeaponLabel
                                    break
                                else
                                    @ignore weapon
                                    wait 150
                                    if findtype '31180|3568|3713|3721|3932|5040|5044|5112|5127|5177|5179|5181|30991|30999|31000|31001|31014|31178|31180|31182' backpack as weapon
                                        getlabel weapon WeaponLabel
                                    endif
                                endif
                                endfor
                                wait 150
                                dclick weapon
                                wait 250
                            endif
                        endif
                    endif
                elseif skill 'Fencing' >= 50
                    if not findtype '3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' self
                        overhead "[ NO WEAPON! ]" 337
                        wait 2000
                        sysmsg "Please acquire a weapon before you start this script!" 0
                        stop
                    else
                        if not findtype '3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' hand
                            if findtype '3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' backpack as weapon
                                for 10
                                getlabel weapon WeaponLabel
                                wait 250
                                if "aspect" in WeaponLabel
                                    break
                                else
                                    @ignore weapon
                                    wait 150
                                    if findtype '3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' backpack as weapon
                                        getlabel weapon WeaponLabel
                                    endif
                                endif
                                endfor
                                wait 150
                                dclick weapon
                                wait 250
                            endif
                        endif
                    endif
                elseif skill 'Archery' >= 50
                    if not findtype '3920|5042|5117|30990|30993|30994|30995|31184|31186' self
                        overhead "[ NO WEAPON! ]" 337
                        wait 2000
                        sysmsg "Please acquire a weapon before you start this script!" 0
                        stop
                    else
                        if not findtype '3920|5042|5117|30990|30993|30994|30995|31184|31186' hand
                            if findtype '3920|5042|5117|30990|30993|30994|30995|31184|31186' backpack as weapon
                                for 10
                                getlabel weapon WeaponLabel
                                wait 250
                                if "aspect" in WeaponLabel
                                    break
                                else
                                    @ignore weapon
                                    wait 150
                                    if findtype '3920|5042|5117|30990|30993|30994|30995|31184|31186' backpack as weapon
                                        getlabel weapon WeaponLabel
                                    endif
                                endif
                                endfor
                                wait 150
                                dclick weapon
                                wait 250
                            endif
                        endif
                    endif
                elseif skill 'Wrestling' >= 50
                    if not findtype '22187|31141|31142' self
                        overhead "[ NO WEAPON! ]" 337
                        wait 2000
                        sysmsg "Please acquire a weapon before you start this script!" 0
                        stop
                    else
                        if not findtype '22187|31141|31142' hand
                            if findtype '22187|31141|31142' backpack as weapon
                                for 10
                                getlabel weapon WeaponLabel
                                wait 250
                                if "aspect" in WeaponLabel
                                    break
                                else
                                    @ignore weapon
                                    wait 150
                                    if findtype '22187|31141|31142' backpack as weapon
                                        getlabel weapon WeaponLabel
                                    endif
                                endif
                                endfor
                                wait 150
                                dclick weapon
                                wait 250
                            endif
                        endif
                    endif
                endif
            endif

            if EnableShieldCheck = 1 and skill 'Parrying' > 0
                if not findtype 'Order shield|buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|wooden shield|parrying gauche' lefthand
                    if findtype 'Order shield|buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|wooden shield|parrying gauche' backpack as shield
                        getlabel shield ShieldLabel
                        for 5
                        wait 250
                        if "unidentified" in ShieldLabel
                            @ignore shield
                            if findtype 'Order shield|buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|wooden shield|parrying gauche' backpack as shield
                                getlabel shield ShieldLabel
                            endif
                        endif
                        endfor
                        dclick shield
                        wait 250
                    endif
                endif
            endif
        endwhile
        
        if warmode
            @setvar! WarModeToggledWhileFighting 1
        endif

        @setvar! NeedtoSecureLoot 1
        @setvar! SwitchtoIncendiaryAmmo 0

    ///////////////////////
    //  END COMBAT LOOP  //
    ///////////////////////

        if insysmsg "world is saving"
            settimer "WorldSaveTimer" 0
            while timer "WorldSaveTimer" < 5000
                if insysmsg "save complete"
                    break
                endif
                wait 250
            endwhile
            if EnableOverheadMessages = 1
                overhead "[ SAVE COMPLETE! ]" 253
            endif
        endif

        if EnableWeightWarningMessage = 1
            if diffweight < GreenWarningDiffWeight and diffweight > YellowWarningDiffWeight and timer "WeightTimer" > 6000
                if EnableOverheadMessages = 1
                    overhead "[ WEIGHT WARNING... ]" 77
                    settimer "WeightTimer" 0
                else
                    overhead "  " 77
                    settimer "WeightTimer" 0
                endif
            elseif diffweight < YellowWarningDiffWeight and diffweight > RedWeightLimitDiffWeight and timer "WeightTimer" > 6000
                if EnableOverheadMessages = 1
                    overhead "[ WEIGHT WARNING! ]" 153
                    settimer "WeightTimer" 0
                else
                    overhead "  " 153
                    settimer "WeightTimer" 0
                endif
            elseif diffweight < RedWeightLimitDiffWeight and timer "WeightTimer" > 6000
                if EnableOverheadMessages = 1
                    overhead "[ WEIGHT LIMIT REACHED! ]" 37
                    settimer "WeightTimer" 0
                else
                    overhead "  " 37
                    settimer "WeightTimer" 0
                endif

                if EnableAutoWeightRecall = 1 and not find ClosestTarget ground -1 -1 8 and WILDERNESSMODE = 1
                    wait 1000
                    if EnableInfiniteLoop = 1
                        settimer "InfiniteLoop" 0
                    endif
                    hotkey 'Toggle War Only'
                    @setvar! AutoWeightRecall 1
                    @setvar! WarModeToggledWhileFighting 0
                    replay
                elseif EnableAutoWeightRecall = 1 and find ClosestTarget ground -1 -1 8 and WILDERNESSMODE = 1
                    if timer "RECALLDELAY" > 3500 and EnableAutoRecallOverheadMessages = 1
                        overhead "[ WAITING TO RECALL... ]" 149
                        settimer "RECALLDELAY" 0
                    endif
                    if EnableInfiniteLoop = 1
                        settimer "InfiniteLoop" 0
                    endif
                    wait 500
                elseif EnableAutoWeightDungeonGate = 1 and DUNGEONMODE = 1
                    wait 1000
                    if EnableInfiniteLoop = 1
                        settimer "InfiniteLoop" 0
                    endif
                    hotkey 'Toggle War Only'
                    @setvar! TimeToGo 1
                    replay
                else
                    if EnableOverheadMessages = 1
                        overhead "[ OVERWEIGHT! ]" 337
                    else
                        overhead "  " 337
                    endif
                    sysmsg "Time to head home and unload your loot!" 0
                    settimer "WeightTimer" 0
                endif
            endif
        endif

        if EnableArcheryWarningMessage = 1 and skill 'Archery' >= 50
            if findtype 'stubnose crossbow|tower guard crossbow|balestra|heavy crossbow|crossbow' hand
                # BOLTS
                @setvar! AMMO 1
            elseif findtype 'long bow|bow|recurve bow|composite bow' hand
                # ARROWS
                @setvar AMMO 2
            endif

            if counttype "crossbow bolt" self < ArcheryLowAmmoWarningAmount and timer "AmmunitionTimer" > 6000 and AMMO = 1
                overhead "[ AMMO LOW! ]" 37
                settimer "AmmunitionTimer" 0
            endif

            if counttype "arrow" self < ArcheryLowAmmoWarningAmount and timer "AmmunitionTimer" > 6000 and AMMO = 2
                overhead "[ AMMO LOW! ]" 37
                settimer "AmmunitionTimer" 0
            endif
        endif

        if EnableAutoCarving = 1
            while findtype "corpse" ground -1 -1 2 as deadbody and diffhits < ActivateAutoHealHPdiff 
                if findtype 11552 self
                    if targetexists
                        hotkey 'cancel current target'
                    endif
                    while not targetexists
                        skill 'forensicevaluation'
                    endwhile
                    if targetexists and find deadbody ground -1 -1 2
                        target 'self'
                        @ignore deadbody
                        wait 500
                    endif
                    if insysmsg "You dont see anything nearby"
                        clearsysmsg 
                        break
                    else
                        if EnableOverheadMessages = 1 and timer SkinningTimer > 3000 
                            overhead "[ SKINNING... ]" 333
                            settimer SkinningTimer 0
                        endif
                    endif 
                else 
                    if EnableOverheadMessages = 1 and timer SkinningTimer > 15000
                        overhead "[ NO SKINNING KNIFE ]" 337
                        settimer SkinningTimer 0
                        break
                    endif  
                endif 
            endwhile
        endif 
            
        if EnableGoldVacuum = 1 and DisableVacuums != 1
            if findtype "gold coin" ground -1 -1 12 as droppedmoney and timer "GoldRadar" > 3500
                overhead "  " 149 droppedmoney
                settimer "GoldRadar" 0
            endif
            while findtype "gold coin" ground -1 -1 2 as droppedmoney and diffhits < ActivateAutoHealHPdiff
                overhead "  " 149
                hotkey "Grab Item"
                wft 2500
                target droppedmoney
                wait 250
                if insysmsg "Invalid or inaccessible item"
                    wait 500
                    @ignore droppedmoney
                endif
                wait 250
            endwhile
        endif

        if EnableWeaponCheck = 1 and IHAVEDIED != 1
            if skill 'Swordsmanship' >= 50
                if not findtype '30988|5049|3909|3911|3915|3917|3934|3937|5046|5115|5119|5182|5185|5187|31128|31190' self
                    overhead "[ NO WEAPON! ]" 337
                    wait 2000
                    sysmsg "Please acquire a weapon before you start this script!" 0
                    stop
                else
                    if not findtype '30988|5049|3909|3911|3915|3917|3934|3937|5046|5115|5119|5182|5185|5187|31128|31190' hand
                        if findtype '30988|5049|3909|3911|3915|3917|3934|3937|5046|5115|5119|5182|5185|5187|31128|31190' backpack as weapon
                            for 10
                            getlabel weapon WeaponLabel
                            wait 250
                            if "aspect" in WeaponLabel
                                break
                            else
                                @ignore weapon
                                wait 150
                                if findtype '30988|5049|3909|3911|3915|3917|3934|3937|5046|5115|5119|5182|5185|5187|31128|31190' backpack as weapon
                                    getlabel weapon WeaponLabel
                                endif
                            endif
                            endfor
                            wait 150
                            dclick weapon
                            wait 250
                        endif
                    endif
                endif
            elseif skill 'Mace Fighting' >= 50
                if not findtype '31180|3568|3713|3721|3932|5040|5044|5112|5127|5177|5179|5181|30991|30999|31000|31001|31014|31178|31180|31182' self
                    overhead "[ NO WEAPON! ]" 337
                    wait 2000
                    sysmsg "Please acquire a weapon before you start this script!" 0
                    stop
                else
                    if not findtype '31180|3568|3713|3721|3932|5040|5044|5112|5127|5177|5179|5181|30991|30999|31000|31001|31014|31178|31180|31182' hand
                        if findtype '31180|3568|3713|3721|3932|5040|5044|5112|5127|5177|5179|5181|30991|30999|31000|31001|31014|31178|31180|31182' backpack as weapon
                            for 10
                            getlabel weapon WeaponLabel
                            wait 250
                            if "aspect" in WeaponLabel
                                break
                            else
                                @ignore weapon
                                wait 150
                                if findtype '31180|3568|3713|3721|3932|5040|5044|5112|5127|5177|5179|5181|30991|30999|31000|31001|31014|31178|31180|31182' backpack as weapon
                                    getlabel weapon WeaponLabel
                                endif
                            endif
                            endfor
                            wait 150
                            dclick weapon
                            wait 250
                        endif
                    endif
                endif
            elseif skill 'Fencing' >= 50
                if not findtype '3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' self
                    overhead "[ NO WEAPON! ]" 337
                    wait 2000
                    sysmsg "Please acquire a weapon before you start this script!" 0
                    stop
                else
                    if not findtype '3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' hand
                        if findtype '3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' backpack as weapon
                            for 10
                            getlabel weapon WeaponLabel
                            wait 250
                            if "aspect" in WeaponLabel
                                break
                            else
                                @ignore weapon
                                wait 150
                                if findtype '3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' backpack as weapon
                                    getlabel weapon WeaponLabel
                                endif
                            endif
                            endfor
                            wait 150
                            dclick weapon
                            wait 250
                        endif
                    endif
                endif
            elseif skill 'Archery' >= 50
                if not findtype '3920|5042|5117|30990|30993|30994|30995|31184|31186' self
                    overhead "[ NO WEAPON! ]" 337
                    wait 2000
                    sysmsg "Please acquire a weapon before you start this script!" 0
                    stop
                else
                    if not findtype '3920|5042|5117|30990|30993|30994|30995|31184|31186' hand
                        if findtype '3920|5042|5117|30990|30993|30994|30995|31184|31186' backpack as weapon
                            for 10
                            getlabel weapon WeaponLabel
                            wait 250
                            if "aspect" in WeaponLabel
                                break
                            else
                                @ignore weapon
                                wait 150
                                if findtype '3920|5042|5117|30990|30993|30994|30995|31184|31186' backpack as weapon
                                    getlabel weapon WeaponLabel
                                endif
                            endif
                            endfor
                            wait 150
                            dclick weapon
                            wait 250
                        endif
                    endif
                endif
            elseif skill 'Wrestling' >= 50
                if not findtype '22187|31141|31142' self
                    overhead "[ NO WEAPON! ]" 337
                    wait 2000
                    sysmsg "Please acquire a weapon before you start this script!" 0
                    stop
                else
                    if not findtype '22187|31141|31142' hand
                        if findtype '22187|31141|31142' backpack as weapon
                            for 10
                            getlabel weapon WeaponLabel
                            wait 250
                            if "aspect" in WeaponLabel
                                break
                            else
                                @ignore weapon
                                wait 150
                                if findtype '22187|31141|31142' backpack as weapon
                                    getlabel weapon WeaponLabel
                                endif
                            endif
                            endfor
                            wait 150
                            dclick weapon
                            wait 250
                        endif
                    endif
                endif
            endif
        endif

        if EnableShieldCheck = 1 and skill 'Parrying' > 0
            if not findtype 'Order shield|buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|wooden shield|parrying gauche' lefthand
                if findtype 'Order shield|buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|wooden shield|parrying gauche' backpack as shield
                    getlabel shield ShieldLabel
                        for 5
                            wait 250
                            if "unidentified" in ShieldLabel
                                @ignore shield
                            if findtype 'Order shield|buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|wooden shield|parrying gauche' backpack as shield
                                    getlabel shield ShieldLabel
                                endif
                            endif
                        endfor
                    dclick shield
                    wait 250
                endif
            endif
        endif


    ///////////////////////
    //    AFTER KILL:    //
    ///////////////////////

    cooldown "Pacified" 0
    cooldown "Provoked" 0
    cooldown "Discorded" 0
    @setvar! SwitchtoIncendiaryAmmo 0
    @setvar! TargetisBleeding 0
    settimer "LootTimer" 0
    settimer "AfterKill" 0

    if warmode
        @setvar! WarModeToggledWhileFighting 1
    endif

    if insysmsg "You have gained"
        if EnableOverheadMessages = 1
            overhead "[ TARGET ELIMINATED!! ]" 149
        endif
        @setvar! NeedtoSecureLoot 1
    else
        if EnableOverheadMessages = 1 and timer 'NoTargetTimer' > 8000
            overhead "[ TARGET LOST... ]" 339
            settimer 'NoTargetTimer' 0
        endif
        @setvar! NeedtoSecureLoot 1
    endif

    if EnableOverheadMessages = 1
        if insysmsg "additional mastery chain link!"
            overhead "[ NEW LINK UNLOCKED!! ]" 149
            wait 250
        endif

        if insysmsg "You have unlocked a codex upgrade point"
            overhead "[ CODEX POINT UNLOCKED! ]" 2114
            wait 250
        endif

        if insysmsg "enough experience to upgrade"
            overhead "[ ASPECT TIER UNLOCKED! ]" 2234
            wait 250
        endif
    else
        if insysmsg "additional mastery chain link!"
            overhead " CHAIN " 149
        endif

        if insysmsg "You have unlocked a codex upgrade point"
            overhead " CODEX " 2114
        endif

        if insysmsg "enough experience to upgrade"
            overhead " ASPECT " 2234
        endif
    endif

    while timer "AfterKill" < AfterKillTimer
        if EnableAutoCarving = 1
            while findtype "corpse" ground -1 -1 2 as deadbody and diffhits < ActivateAutoHealHPdiff 
                if findtype 11552 self
                    if targetexists
                        hotkey 'cancel current target'
                    endif
                    while not targetexists
                        skill 'forensicevaluation'
                    endwhile
                    if targetexists and find deadbody ground -1 -1 2
                        target 'self'
                        @ignore deadbody
                        wait 500
                    endif
                    if insysmsg "You dont see anything nearby"
                        clearsysmsg 
                        break
                    else
                        if EnableOverheadMessages = 1 and timer SkinningTimer > 3000 
                            overhead "[ SKINNING... ]" 333
                            settimer SkinningTimer 0
                        endif
                    endif 
                else 
                    if EnableOverheadMessages = 1 and timer SkinningTimer > 15000
                        overhead "[ NO SKINNING KNIFE ]" 337
                        settimer SkinningTimer 0
                        break
                    endif  
                endif 
            endwhile
        endif 

        if EnableAutoParalyzePouch = 1
            if paralyzed
                if findtype "pouch" self
                    yell "[pouch"
                    hotkey 'Toggle War Only'
                    replay
                else
                    if EnableOverheadMessages = 1
                        overhead "[ NO MORE POUCHES! ]" 337
                    endif
                endif
            endif
        endif

        if diffhits > 0 and not bandaging
            if skill 'healing' >= 30
                if findtype 'clean bandage%s%' self
                    if targetexists
                        hotkey 'cancel current target'
                    endif
                    hotkey 'Bandage Self'
                    if EnableOverheadMessages = 1 
                        if aidsMessageTimer > 5000
                            overhead "[ BANDAGING... ]" 88
                            settimer aidsMessageTimer 0
                            wait 500
                        endif
                    endif
                else
                    if timer aidsMessageTimer > 5000 and EnableOverheadMessages = 1
                        overhead "[ OUT OF BANDAGES! ]" 337
                        settimer aidsMessageTimer 0
                    endif
                endif
            endif
        endif

        if targetexists
            if findtype " Elven Spellblade" self
                targettype "Elven Spellblade"
            else
                target backpack
            endif
        endif
    endwhile
    clearsysmsg
    replay
endwhile


/////////////////////////
//  BEGIN DEATH LOOP:  //
/////////////////////////

if dead
    if EnableOverheadMessages = 1
        overhead "[ R.I.P. ]" 337
    endif
    wait 1500

    while dead
        if insysmsg "world is saving"
            settimer "WorldSaveTimer" 0
            if EnableOverheadMessages = 1
                overhead "[ WORLD SAVING... ]" 253
            endif
            while timer "WorldSaveTimer" < 4500
                if insysmsg "save complete"
                    break
                endif
                wait 100
            endwhile
            if EnableOverheadMessages = 1
                overhead "[ SAVE COMPLETE! ]" 253
            endif
        endif

        @setvar! IHAVEDIED 1
        wait 500
        if timer "HEALERSEARCH" > 4000
            overhead "[ FIND A HEALER! ]" 0
            settimer "HEALERSEARCH" 0
        endif

        if findtype "blue moongate|30528|moongate" ground -1 -1 12 as EscapeGate
            if timer "GATEHERE" > 2000
                overhead "  " 253 EscapeGate
                settimer "GATEHERE" 0
            endif
        endif

        while not gumpexists 3773199800 and findtype "blue moongate|30528|moongate" ground 0 1 2 as EscapeGate
            dclick EscapeGate
            wait 500
        endwhile

        while gumpexists 3773199800
            gumpresponse 16
            wait 500
            waitforgump 3773199800
            gumpresponse 2
            overhead "[ GATING TO TOWN... ]" 88
            break
        endwhile

        while gumpexists 2957810225
            overhead "[ HEALED! ]" 84
            gumpresponse 1
            wait 1000
            gumpclose 2957810225
            break
        endwhile

        if not dead
           break
        endif
    endwhile
endif

if not dead
    if EnableDressAfterResurrection = 1
        wait 500
        dress 'UltimateDexxer'
        wait 500
        while queued
            wait 100
        endwhile
        wait 1000
        dress 'UltimateDexxer'
        while queued
            wait 100
        endwhile
    endif

    wait 1000

    if EnableRecallAfterResurrection = 1
        hotkey 'Toggle War Only'
        @setvar! ResThenTimeToGo 1
        wait 1000
        replay
    else
        wait 2500
        overhead "[ STOPPING SCRIPT! ]" 88
        stop
    endif
endif 

replay

//////////////////////
//  END DEATH LOOP  //
//////////////////////



        ############################
       ###    SCRIPT ENDS HERE    ###
        ############################



