# This is an automated backup - check out https://outlands.uorazorscripts.com/script/dfd1dbf7-6d9f-433b-8543-830a3868a605 for latest
# Automation by Jaseowns
## Script: Flu Lumber
## Created by: flutschi#0
#############################################

# you NEED a rune that is called "Home" in your runebook or runetome. (otherwise it wont find it to recall)

# to create a cooldown, go ingame -> options -> cooldown.
# create the cooldown 'summons' for keeping up the elementals!
# create cooldown 'afk' and 'walk' (walk needs to be set to walk in the settings!)

# to be a miner instead of a lumberjacker -> change the variable "isMiner" on line 14~ to either 0 for lumber, or 1 for mining
    
hotkey 'cancel current target'

@setvar! enableRecall 1
@setvar! enableSummons 1
@setvar! enableAFK 0
@setvar! isMiner 0

@setvar! afkTime 120000
@setvar! allGuardMeTimer 5000

clearsysmsg 

# this is when u want to summon something
while casting 
    overhead 'casting..'
    pause 2000
endwhile

if isMiner = 1
    if lhandempty ?? 0 
        if findtype "pickaxe" backpack
            dclicktype 'pickaxe' backpack
            wait 500
        endif
    endif
                
    if rhandempty ?? 0 
        overhead "No more pickaxe!" 34
        wait 500
        replay
    endif
else 
    if lhandempty ?? 0 
        if findtype "hatchet" backpack
            dclicktype 'hatchet' backpack
            wait 500
        endif
    endif
                
    if lhandempty ?? 0 
        overhead "No more hatchet!" 34
        wait 500
        replay
    endif
endif

# Smelter Part

if isMiner = 1
    if findtype "forge" ground -1 -1 12 as forge
        overhead "Forge..." 88 forge
    endif
endif


if findtype 7133 backpack as log
    dclick log
endif


# check for summons
# casttime with summoners tome is 2500, else put 5000
@setvar! castTime 5200

if enableSummons = 1
    
    if followers < 1 or cooldown 'summons' < 60000 and mana > 50 and skill 'magery' > 99
        cooldown 'afk' afkTime
        cast 'Earth Elemental'
        pause castTime
        pause 500
        hotkey 'all guard me'
        cooldown 'allGuard' allGuardMeTimer
        cooldown 'summons' 600000
    endif
    
endif

#tracking!

if not findbuff 'tracking'
    overhead 'i should track..'

    while not gumpexists 4267467659
        useskill 'tracking'
        wait 250
    endwhile
    
    if gumpexists 4267467659
        while not insysmsg "You will now hunt all hostile players."
            gumpresponse 8 4267467659
            waitforgump 4267467659 5000
        endwhile
        gumpresponse 6 4267467659
        wait 1000
        clearsysmsg                     
    endif
    gumpclose 4267467659
endif

# protection!

if not findbuff 'Magic Reflection'
    cast 'Magic Reflection'
    pause 3000
endif

# start chopping
wait 500
hotkey 'Use item in hand'
if findtype 3908 lefthand
    pause 400
    target 'self'
endif

for 75
    wait 100

    if hp < maxhp and not cooldown 'allGuard'
        cooldown 'allGuard' allGuardMeTimer
        hotkey 'all guard me'
    endif

    
    if enableRecall = 1
        if insysmsg 'Now tracking' or insysmsg 'Distance'
            #use runebook
			say '[recall Home'
            stop
        endif
    endif
    
	if enableAFK = 1
		if cooldown 'walk'
			cooldown 'afk' afkTime
		endif

		if cooldown 'afk' < 18000
			overhead 'timer runs out..' 33
			dclicktype 3834 backpack
			pause 1500
		endif

		if cooldown 'afk' < 5000
			overhead 'afk too long..' 33
			if not cooldown 'afk'
				script 'recallHome'
				stop
			endif
		endif
	endif

    if insysmsg 'world is saving'
        for 30
            overhead 'Waiting for world save...'
            wait 1000
            if insysmsg 'save complete'
                overhead 'Save complete - continue on!' 88
                clearsysmsg 
                wait 250
                replay
            endif
        endfor
    elseif rhandempty ?? 0 and isMiner = 1
        overhead "Broke axe" 34
        replay
    elseif lhandempty ?? 0 and isMiner = 0
        overhead "Broke pick" 34
        replay
    elseif insysmsg 'You do not see any'
        overhead 'Move to next spot' 88
        wait 250
        replay
    elseif insysmsg "travel"
        overhead 'Waiting for travel...'
        wait 1000
        replay
    else
        if insysmsg "any harvestable"
            overhead 'Move to next spot' 88
            replay
        elseif insysmsg "skillgain" or insysmsg "harvesting is not allowed"
            replay
        elseif insysmsg "you loosen some"
            replay
        elseif insysmsg "You dig some"
            replay
        elseif insysmsg "skillgain" or insysmsg "harvesting is not allowed"
            replay
        elseif insysmsg "world is saving" or insysmsg 'World save complete'
            replay
        elseif insysmsg "You hack"
            replay
        elseif insysmsg "You chop"
            replay
        elseif insysmsg "You must wait"
            overhead 'You must wait..' 34
            wait 500
            replay
        endif
    endif
endfor

replay