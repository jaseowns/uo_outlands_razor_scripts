# This is an automated backup - check out https://outlands.uorazorscripts.com/script/5ca89fcd-a03c-410e-9e2c-075284071f56 for latest
# Automation by Jaseowns
## Script: DANSTOCK'S ULTIMATE HARVESTING AUTO PILOT SCRIPT
## Created by: danstock._98439#0
#############################################

/////// DANSTOCK'S ULTIMATE HARVESTING AUTO PILOT SCRIPT
/////   UO Outlands Razor script - Last updated July 17, 2024 (email any bug reports/tips to dan@danstockman.com) 
///     Created by DanStock.


# Required (or optional *) inventory items:
    
    # Hatchet or Pickaxe
    # A blessed escape runebook charged w/ recall scrolls
    # Trapped pouches 
    # Weapon of choice (Swords or Macing)
    # Bandages
    # Healing, Cure and Refresh potions (strength, agility and magic resist pots help too *)
    # Skinning knife *
    # Cheese (or fish steaks) *
    # Adventurers rope *
    # A blessed codex of Swords or Macing *
    # A blessed codex of Healing *
    # Harvest Aspect leather armour *

    
# Use the following organizer agents (or swap for your own):
    
    # Organizer Agent-01 hotbag   (for boards, logs, seeds, etc.)
    # Organizer Agent-02 hotbag   (for main LUMBER inventory items - I use a hidden stack of trapped pouches to deter theives and set this as the bottom one)
    # Organizer Agent-03 hotbag * (optional - for gold, grid loot, etc.)
    # Organizer Agent-04 hotbag   (for ingots, seeds, etc.)
    # Organizer Agent-06 hotbag * (optional - for unloading loot, ingots & boards at HOME or INN ROOM)
    # Organizer Agent-11 hotbag   (for main MINING inventory items - I use a hidden stack of trapped pouches to deter theives and set this as the bottom one)
    
    
# System messages to text filter in Razor for clean UI:

    // "What do you want to use this item on?" 
    // "You do not see any harvestable resources nearby"
    // "You cannot produce any wood from that"
    // "You hack at the tree"
    // "You chop some"
    // "You dig some"
    // "You loosen some"
    // "You smelt the ore"
    // "You must wait"
    // "You shape the logs into boards"
    // "You do not see any nearby forges"
    // "Mining skillgain"
    // "Lumberjacking skillgain"
    // "No one matching that"
    // "You will now hunt"
    // "Organize Agent"
    // "queue"
    // "Macro"
    // "Achievement"
    // "You have worn out your tool"
    // "You carve materials from the corpse"


# Please add the following COOLDOWNS (case sensitive) in UO client under Options -> Cooldowns:
    
    // Healing Potion
    // Cure Potion 
    // Refresh Potion
    // Forge Radar 
    // Magic Shield *
    // Spell Fail * (w/ overhead text trigger of "The spell fizzles" and a 2 second cooldown)
    

    
##### YOU CAN ENABLE AND/OR DISABLE EACH HALF OF THE SCRIPT HERE (if both skills on the same character): #####
        
@setvar! EnableMining 1
@setvar! EnableLumberjacking 1 

    
////// ANYTIME YOU NEED TO RESET OR CHANGE PERMANENT VARIABLES (ie. ESCAPE RUNEBOOKS, INGOT BAG AND BOARD BAG): ////// 
    # Run script once with this ALLVARIABLERESET set to 1 to clear ALL variables. 
    # Then reset ALLVARIABLERESET to 0 and restart script to prompt for new targets!
    
@setvar! ALLVARIABLERESET 0

    if ALLVARIABLERESET = 1
        unsetvar lumber_runebook
        unsetvar boardbag
        unsetvar mining_runebook
        unsetvar ingotbag
        overhead "All permanent variables reset!" 0
        wait 1000
        overhead "Restart script to prompt for new targets..." 0
        wait 1000
        overhead "Make sure to set ALLVARIABLERESET back to 0" 84
        wait 1000
        overhead "[ STOPPING SCRIPT! ]" 337
        stop    
    endif 

    
if insysmsg "Captcha successful."
    overhead "I guess you got the magic numbers right??" 2086
    wait 2500
    overhead "Alright, let's get to work..." 2086
    wait 1000
endif

    
#################################################
//         Mining Specific Variables           //
#################################################


if skill "Mining" > 49.9 and EnableMining = 1


// Increase this wait time if lag is causing error message: //
@setvar! MinerWaitTime 950


@setvar! EnableForgeRadar 1
@setvar! EnableAutoSmeltNaturalForge 1
@setvar! AutoNaturalForgeTime 8000

@setvar! EnableIngotAutoRecall 1
@setvar! IngotRecallAmount 2000

@setvar! EnableIngotBag 1
@setvar! OpenIngotBag 1


@setvar! EnableWeightWarningMessage 1
@setvar! GreenWarningWeight 550 
@setvar! YellowWarningWeight 570
@setvar! RedWeightLimit 590

endif



#################################################
//         Lumber Specific Variables           //
#################################################


if skill "Lumberjacking" > 49.9 and EnableLumberjacking = 1


// Increase this wait time if lag is causing error message: //
@setvar! LumberWaitTime 600


@setvar! EnableBoardAutoRecall 1
@setvar! BoardRecallAmount 3000

@setvar! EnableBoardBag 1
@setvar! OpenBoardBag 1


@setvar! EnableWeightWarningMessage 1
@setvar! GreenWarningWeight 350 
@setvar! YellowWarningWeight 370
@setvar! RedWeightLimit 390

endif



########################################
//         Shared Variables           //
########################################


@setvar! EnableRedAlertRecall 1

@setvar! EnableAutoAttackGreyMOB 1

@setvar! EnableParalyzePouch 1

@setvar! EnableMagicReflection 1

@setvar! EnableCheeseTimer 1

@setvar! EnableAutoCarving 1

@setvar! EnableToolCountdown 1

@setvar! EnableRecycleTool 1


@setvar! OwnerInnRecall 1
// or 
@setvar! CoOwnerInnRecall 0
// or
@setvar! HouseRecall 0

# Use ">info" to ID your house door:
@setvar! MyDoor 0x50F70A17


@setvar! EnableHealPotion 1
@setvar! HealPotHP 45

@setvar! EnableCurePotion 1
@setvar! CurePotHP 75

@setvar! EnableRefreshPotion 1
@setvar! RefreshPotSP 90


@setvar! AllInventoryMessage 1
// or
@setvar! RopeInventoryMessage 1
@setvar! YellowInventoryMessage 1
@setvar! OrangeInventoryMessage 1
@setvar! RedInventoryMessage 1
@setvar! WhiteInventoryMessage 1
@setvar! BlueInventoryMessage 1
@setvar! BlackInventoryMessage 1





############################################
#########    SCRIPT STARTS HERE    #########
############################################

if not dead and skill "Mining" > 49.9 and EnableMining = 1

clearsysmsg
hotkey 'Cancel Current Target'

if not varexist ingotbag and EnableIngotBag = 1
    wait 1000
    overhead "Please select your ingot storage bag..." 0
    wait 1000
    setvar ingotbag
    wait 2500
    sysmsg "Disable EnableIngotBag in script variables to turn off this feature!" 0
    replay
endif


if not varexist mining_runebook and EnableRedAlertRecall = 1
    wait 1000
    overhead "Please select your escape runebook..." 0
    wait 1000
    setvar mining_runebook
    wait 2500
    sysmsg "Disable EnableRedAlertRecall in script variables to turn off this feature!" 0
    replay
endif


if paralyzed and EnableParalyzePouch = 1
    overhead "[ !!POP!! ]" 2117
    say "[pouch" 
    wait 100
endif


if insysmsg 'world is saving' 
    overhead '[ WORLD SAVING... ]' 253 
    for 25
        if insysmsg 'world save complete' 
            wait 1000
            overhead '[ SAVE COMPLETE! ]' 253 
            clearsysmsg 
            replay
        endif  
        wait 100
    endfor 
    clearsysmsg 
    replay    
endif 
    

if insysmsg "As the owner" or insysmsg "Your house and its contents"
    wait 500
    overhead "*door slams!*" 0 MyDoor
    dclick MyDoor 
    wait 500
endif


if EnableForgeRadar = 1
    if findtype "forge" ground -1 -1 16 as forge or findtype 0x0FB1 ground -1 -1 16 as forge and findtype "iron ore" backpack and not cooldown "Forge Radar"
        overhead "[ FORGE HERE! ]" 44 forge
        overhead "¼" 2114 forge
        cooldown "Forge Radar" 3500
    endif 
endif
                    

if not listexists "mining_alert"
    createlist "mining_alert"  
endif


if insysmsg "Now tracking" or insysmsg "Distance to destination" and EnableRedAlertRecall = 1
    pushlist "mining_alert" "red_alert_recall" 
    wait 100
endif


if inlist "mining_alert" "red_alert_recall" and EnableRedAlertRecall = 1
    overhead "[ RED ALERT!! ]" 37
    wait 500
    overhead "Looks like trouble coming!" 2086
     
            if paralyzed 
                overhead "[ !!POP!! ]" 2117
                say "[pouch"
            endif
        
            if skill 'Healing' > 50 and not bandaging and hits < maxhits
                    hotkey "Bandage self"
                    overhead '*applying bandages...*' 88
                    wait 200
            endif 
                
            if hits < 70 and not cooldown "Healing Potion"
                if findtype "Yellow Potion" backpack as healpot
                    overhead '*drinking heal potion...*' 253
                    dclick healpot
                    wait 200
                    cooldown "Healing Potion" 10500
                else 
                    overhead '*Out of heal pots!*' 337
                endif
            endif 
            
            if poisoned and not cooldown "Cure Potion"
                if findtype "Orange Potion" backpack as curepot
                    overhead '*drinking cure potion...*' 44
                    dclick curepot
                    cooldown "Cure Potion" 10500
                    wait 200
                else
                    overhead "Out of cure pots!" 337
                endif
            endif
        
            if stam < 100 and not cooldown "Refresh Potion"
                if findtype "Red Potion" backpack as refreshpot
                    overhead '*drinking refresh potion...*' 34
                    dclick refreshpot
                    cooldown "Refresh Potion" 10500
                    wait 200
                else 
                    overhead 'Out of refresh pots!' 337
               endif
           endif

            while not targetexists 
            dclick mining_runebook
            waitforgump 1551740969 
            gumpresponse 2
            wait 500 
            
                for 5
                    wait 500
                    if insysmsg 'Your concentration is disturbed'
                        overhead 'Shit! Trying that again...' 337
                        while not targetexists 
                        dclick mining_runebook
                        waitforgump 1551740969 
                        gumpresponse 2
                        wait 500 
                        clearsysmsg 
                    endif
                endfor

                poplist "mining_alert" "red_alert_recall" 
        
                wait 2000

    if skill "Mace Fighting" > 50 and not findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" hand and findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" backpack as weapon
        dclick weapon      
        wait 100
    endif 

    if skill "Swordsmanship" > 50 and not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" hand and findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" backpack as weapon
        dclick weapon      
        wait 100
    endif 

    if HouseRecall = 1
    wait 500
    dclick MyDoor 
    overhead "*door slams!*" 0 MyDoor
    wait 1000
    endif 

    if OwnerInnRecall = 1
        wait 2000
        say "Innkeeper, I need a room!"
        waitforgump 2393832411
        gumpresponse 4
        wait 3000
    endif

    if CoOwnerInnRecall = 1
        wait 2000
        say "Innkeeper, I need a room!"
        waitforgump 2393832411
        gumpresponse 5
        wait 2000
        gumpresponse 100
        wait 2000
    endif

        overhead "Home Sweet Home!" 2086
        wait 2000
        useskill "Hiding"
        wait 100

    if OpenIngotBag = 1 
        dclick ingotbag
        wait 250
    endif

    for 10
    if findtype "iron ore" backpack as ore
        if findtype "forge" ground -1 -1 2 as forge or findtype 0x0FB1 ground -1 -1 2 as forge
            overhead "*smelting ore...*" 2114 forge
            dclick ore
            overhead "*forging ingots...*" 2117
            wait 1000
            hotkey 'Organizer Agent-11'  
            wait 250
        endif 
    endif
    endfor     

    if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
        overhead "*storing ingots...*" 37
        hotkey "Organizer Agent-06"
        wait 3000
        if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
            hotkey "Organizer Agent-06"
            wait 3000
        endif
       if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
            hotkey "Organizer Agent-06"
            wait 1000
        endif
    endif 

        hotkey "Organizer Agent-04"
        overhead "[ STOPPING SCRIPT! ]" 337
        stop     
endif 

if skill 'Healing' > 50 
    if not bandaging and hits < maxhits
    overhead '*applying bandages...*' 88
        hotkey "Bandage Self"
    endif
    
    if counttype 'clean bandage%s%' < 10
        overhead "[ RESTOCK BANDAGES! ]" 88
    endif 
endif 
            
if EnableCurePotion = 1
    if poisoned and not cooldown "Cure Potion" and hits < CurePotHP
        if findtype "Orange Potion" backpack as curepot
            overhead '*drinking cure potion...*' 44
            dclick curepot
            cooldown "Cure Potion" 10500
            wait 200
        else
            overhead "Out of cure pots!" 337
        endif
    endif
endif 

if EnableHealPotion = 1
    if hits < HealPotHP and not cooldown "Healing Potion"
        if findtype "Yellow Potion" backpack as healpot
            overhead '*drinking heal potion...*' 253
            dclick healpot
            cooldown "Healing Potion" 10500
            wait 200
        else 
            overhead 'Out of heal pots!' 337
        endif
    endif
endif 

if EnableRefreshPotion = 1
    if stam < RefreshPotSP and not cooldown "Refresh Potion"
        if findtype "Red Potion" backpack as refreshpot
            overhead '*drinking refresh potion...*' 34
            dclick refreshpot
            cooldown "Refresh Potion" 10500
            wait 200
        else 
            overhead 'Out of refresh pots!' 337
        endif
    endif
endif


if skill 'Magery' > 50 and not findbuff 'Magic Reflection' and not cooldown "Magic Shield" and EnableMagicReflection = 1 and mana > 14
    overhead 'I should protect myself...' 2086
    for 10
        cast 'Magic Reflection' 
        waitfortarget 1500
        hotkey 'Target Self'
        wait 1000
            if insysmsg "That spell will not adhere"
                cooldown "Magic Shield" 30000
            overhead "Too soon for a new shield.  Give me a sec..." 2086
                replay
            endif 
        if cooldown "Spell Fail"
            wait 1000
            overhead "Let me try that again..." 2086
            wait 1000
        else
            break
        endif 
    endfor 
    wait 500
    overhead "[ MAGIC SHEILD ACTIVATED! ]" 10
    wait 1000
    replay
endif  


if findtype 'Elven SpellBlade' backpack and EnableAutoCarving = 1
    if findtype "corpse" ground -1 -1 2 as deadbody
        wait 500
        dclicktype "Elven Spellblade"
        waitfortarget 2000
        target 'self'
        wait 250
        overhead "*skinning corpse...*" 337
        wait 500
        @ignore deadbody
    endif 
endif
    
if not findtype 'Elven SpellBlade' self and EnableAutoCarving = 1
    overhead "[ NO SKINNING KNIFE! ]" 339
    sysmsg "Disable EnableAutoCarving in script variables to turn off this overhead message!" 0
endif 
 

if skill "Mace Fighting" > 50 and not findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" backpack
    if not findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" hand
        overhead "[ NO WEAPON! ]" 339
    endif
endif 

if skill "Swordsmanship" > 50 and not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" backpack
    if not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" hand
        overhead "[ NO WEAPON! ]" 339
    endif
endif 

if AllInventoryMessage = 1
    if counttype "rope" backpack = 0 and RopeInventoryMessage = 1
        overhead "[ RESTOCK ROPE! ]" 2799
        sysmsg "Disable RopeInventoryMessage in script variables to turn off this overhead message!" 0
    endif 

    if counttype "Yellow Potion" backpack = 0 and YellowInventoryMessage = 1
        overhead "[ RESTOCK HEAL POTIONS! ]" 253
        sysmsg "Disable YellowInventoryMessage in script variables to turn off this overhead message!" 0
    endif 

    if counttype "Orange Potion" backpack = 0 and OrangeInventoryMessage = 1
        overhead "[ RESTOCK CURE POTIONS! ]" 44
        sysmsg "Disable OrangeInventoryMessage in script variables to turn off this overhead message!" 0
    endif 

    if counttype "Red Potion" backpack = 0 and RedInventoryMessage = 1
        overhead "[ RESTOCK REFRESH POTIONS! ]" 37
        sysmsg "Disable RedInventoryMessage in script variables to turn off this overhead message!" 0
    endif 

    if counttype "White Potion" backpack = 0 and WhiteInventoryMessage = 1 
        overhead "[ RESTOCK STRENGTH POTIONS! ]" 956
        sysmsg "Disable WhiteInventoryMessage in script variables to turn off this overhead message!" 0
    endif 

    if counttype "Blue Potion" backpack = 0 and BlueInventoryMessage = 1
        overhead "[ RESTOCK AGILITY POTIONS! ]" 93
        sysmsg "Disable BlueInventoryMessage in script variables to turn off this overhead message!" 0
    endif 

    if counttype "Black Potion" backpack = 0 and BlackInventoryMessage = 1
        overhead "[ RESTOCK MAGIC RESIST POTIONS! ]" 0
        sysmsg "Disable BlackInventoryMessage in script variables to turn off this overhead message!" 0
    endif 
endif


if counttype "iron ingot%s" > IngotRecallAmount and EnableIngotAutoRecall = 1
    overhead "I'd hate to lose all this hard work..." 2086
    wait 2500
    overhead "I'm going to go unload before it's too late!" 2086
    wait 2000
    
     while not targetexists 
            dclick  mining_runebook
            waitforgump 1551740969 
            gumpresponse 2
            wait 500 
            
                for 5
                    wait 500
                    if insysmsg 'Your concentration is disturbed'
                        overhead 'Shit! Trying again...' 2086
                        while not targetexists 
                        dclick mining_runebook
                        waitforgump 1551740969 
                        gumpresponse 2
                        wait 500
                    endif
                endfor

                wait 2000

    if skill "Mace Fighting" > 50 and not findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" hand and findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" backpack as weapon
        dclick weapon      
        wait 100
    endif 

    if skill "Swordsmanship" > 50 and not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" hand and findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" backpack as weapon
        dclick weapon      
        wait 100
    endif 

if HouseRecall = 1
    wait 500
    dclick MyDoor 
    overhead "*door slams!*" 0 MyDoor
    wait 1000
endif 

if OwnerInnRecall = 1
    wait 2000
    say "Innkeeper, I need a room!"
    waitforgump 2393832411
    gumpresponse 4
    wait 3000
endif

if CoOwnerInnRecall = 1
    wait 2000
    say "Innkeeper, I need a room!"
    waitforgump 2393832411
    gumpresponse 5
    wait 2000
    gumpresponse 100
    wait 2000
endif

    overhead "Home Sweet Home!" 2086
    wait 2000
    useskill "Hiding"
    wait 100

        if OpenIngotBag = 1 
            dclick ingotbag
            wait 250
        endif

    for 10
    if findtype "iron ore" backpack as ore
        if findtype "forge" ground -1 -1 2 as forge or findtype 0x0FB1 ground -1 -1 2 as forge
            overhead "*smelting ore...*" 2114 forge
            dclick ore
            overhead "*forging ingots...*" 2117
            wait 1000
            hotkey 'Organizer Agent-11'  
            wait 250
        endif 
    endif
    endfor     

    if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
            overhead "*storing ingots...*" 37
            hotkey "Organizer Agent-06"
            wait 3000
        if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
            hotkey "Organizer Agent-06"
            wait 3000
        endif
        if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
            hotkey "Organizer Agent-06"
            wait 1000
        endif
    endif 

    hotkey "Organizer Agent-04"
    stop
    overhead "[ STOPPING SCRIPT! ]" 337
endif 


if skill 'Tracking' > 50 and not findbuff 'tracking' and EnableRedAlertRecall = 1
    overhead 'I should keep an eye out for trouble...' 2086
        wait 1500
        while not gumpexists 4267467659
        useskill 'tracking'
            wait 250
        endwhile
            if gumpexists 4267467659
                while not insysmsg "You will now hunt all hostile players."
                gumpresponse 8 4267467659
                waitforgump 4267467659 5000
                endwhile
                gumpresponse 6 4267467659
                wait 500
                clearsysmsg 
            endif
        gumpclose 4267467659
        overhead "[ AUTO RECALL ACTIVATED! ]" 37
        wait 100
endif 


if not findbuff 'food satisfaction' and findtype "wedge%s% of cheese|fish steak%s%" self and EnableCheeseTimer = 1
    wait 1500
    overhead "Hold on, I shouldn't do this on an empty stomach..." 2086
    wait 500
        if findtype "wedge%s% of cheese|fish steak%s%" backpack as Food
            overhead "*eating food...*" 0
            dclick Food
            wait 1500
            overhead "Ok, I'm ready to get to work!" 2086
            wait 1500
        endif
endif 


if not findtype 'pickaxe' self
    overhead "I can't work with no pickaxes!" 2086
    wait 2500
    overhead '[ STOPPING SCRIPT... ]' 37
    stop  
endif 

if not findtype 'pickaxe' hand and findtype 'pickaxe' backpack
    dclicktype 'pickaxe' backpack
    wait 1500
endif


if findtype 'pickaxe' hand as MyAxe and EnableToolCountdown = 1
    getlabel MyAxe AxeLabel
    if '(5 uses' in AxeLabel or '(4 uses' in AxeLabel or '(3 uses' in AxeLabel or '(2 uses' in AxeLabel or '(1 use' in AxeLabel
        if EnableRecycleTool = 0
        sysmsg "YOUR TOOL IS ABOUT TO BREAK....." 153
        endif 
        if EnableRecycleTool = 1
        sysmsg "YOUR TOOL IS ABOUT TO BE RECYCLED....." 4
        endif 
        wait 100
    endif 
endif 


if findtype 'tool kit' self as ToolKit and EnableRecycleTool = 1
    if findtype 'pickaxe|hatchet' hand as MyAxe
        getlabel MyAxe AxeLabel
        if '(1 use' in AxeLabel
            overhead "[ RECYCLING TOOL! ]" 4
            clearhands both
            wait 1000
            if not gumpexists 949095101 
                dclick ToolKit
                waitforgump 949095101 2000
            endif 
        
            for 5
            gumpresponse 3 949095101
            wait 1000
                if insysmsg "Target an individual item"
                    wait 500
                    target MyAxe
                    wait 1000
                    gumpclose 949095101
                    wait 1000
                    overhead "Every little bit counts..." 2086
                    hotkey 'Organizer Agent-11' 
                    wait 1500
                    replay
                else
                    gumpresponse 2
                    wait 500
            endfor 
            endif 
        endif 
    endif 
endif

if not findtype 'tool kit' self and EnableRecycleTool = 1
    overhead "[ NO TOOL KIT! ]" 339
    sysmsg "Disable EnableRecycleTool in script variables to turn off this overhead message!" 0
endif


if warmode and EnableAutoAttackGreyMOB = 1

    overhead "It's time to fight!" 2086
    
    if skill "Mace Fighting" > 50 and not findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" hand and findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" backpack as weapon
        dclick weapon      
        wait 100
    endif 

    if skill "Swordsmanship" > 50 and not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" hand and findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" backpack as weapon
        dclick weapon      
        wait 100
    endif 
            
    hotkey 'Target Random Murderer Player'       
    wait 500  
            
        if insysmsg "No one matching that was found"    
            for 1000
                hotkey 'Target Closest Non-Friendly Monster'
                wait 500
                
                    if skill "Mace Fighting" > 50 and not findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" hand and findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" backpack as weapon
                        dclick weapon      
                        wait 100
                    endif 

                    if skill "Swordsmanship" > 50 and not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" hand and findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" backpack as weapon
                        dclick weapon      
                        wait 100
                    endif 
                            
                    if insysmsg "No one matching that was found" 
                        hotkey 'Cancel Current Target'      
                        @setvar CurrentTarget 0
                        wait 1000   
                        overhead "Is there no one else??" 2086
                        wait 2000
                        overhead "Alright then, I guess it's back to work..." 2086
                                                            
                            if findtype 'Elven SpellBlade' backpack and EnableAutoCarving = 1
                                if findtype "corpse" ground -1 -1 2 as body
                                    wait 1000
                                    dclicktype "Elven Spellblade"
                                    wft 1000
                                    target self
                                    wait 500
                                    overhead "*skinning corpse...*" 339
                                    wait 500
                                    @ignore body
                                endif 
                            endif
                        
                        hotkey 'Toggle Peace Only'
                        wait 100
                        hotkey 'Clear Target Queue'
                        clearsysmsg 
                        wait 1000 
                        replay                                    
                    endif 
                    
                        @setvar CurrentTarget lasttarget 
                        overhead "¼ TARGET ¼ " 253 CurrentTarget                     
                        attack CurrentTarget
                        getlabel CurrentTarget TargetDesc
                        wait 1000
                        
                            if insysmsg "You have gained"
                                overhead "Did you see that?? I just killed {{TargetDesc}}!" 2086
                                hotkey 'Cancel Current Target'
                                @setvar CurrentTarget 0
                                wait 1500
                            endif
                            
                            if findtype 'Elven SpellBlade' backpack and EnableAutoCarving = 1
                                if findtype "corpse" ground -1 -1 2 as corpse
                                    hotkey 'Cancel Current Target'
                                    wait 500
                                    overhead "I'd better carve this up quickly..." 2086
                                    wait 500
                                    dclicktype "Elven Spellblade"
                                    wft 1000
                                    target self
                                    wait 1000
                                    overhead "*skinning {{TargetDesc}}...*" 339
                                    @ignore corpse
                                    wait 500
                                endif 
                            endif
                            
                                if skill 'Healing' > 50 and not bandaging and hits < maxhits
                                    overhead '*applying bandages...*' 88
                                    hotkey "Bandage Self"
                                endif
    
                                if counttype 'clean bandage%s%' < 10
                                    overhead "[ RESTOCK BANDAGES! ]" 88
                                endif 
                             
                            if EnableCurePotion = 1
                                if poisoned and not cooldown "Cure Potion" and hits < CurePotHP
                                    if findtype "Orange Potion" backpack as curepot
                                        overhead '*drinking cure potion...*' 44
                                        dclick curepot
                                        cooldown "Cure Potion" 10500
                                        wait 200
                                    else
                                        overhead "Out of cure pots!" 337
                                    endif
                                endif
                            endif 

                            if EnableHealPotion = 1
                                if hits < HealPotHP and not cooldown "Healing Potion"
                                    if findtype "Yellow Potion" backpack as healpot
                                        overhead '*drinking heal potion...*' 253
                                        dclick healpot
                                        cooldown "Healing Potion" 10500
                                        wait 200
                                    else 
                                        overhead 'Out of heal pots!' 337
                                    endif
                                endif
                            endif 

                            if EnableRefreshPotion = 1
                                if stam < RefreshPotSP and not cooldown "Refresh Potion"
                                    if findtype "Red Potion" backpack as refreshpot
                                        overhead '*drinking refresh potion...*' 34
                                        dclick refreshpot
                                        cooldown "Refresh Potion" 10500
                                        wait 200
                                    else 
                                        overhead 'Out of refresh pots!' 337
                                    endif
                                endif
                            endif
                            
                            if paralyzed and EnableParalyzePouch = 1
                                overhead "[ !!POP!! ]" 2117
                                say "[pouch" 
                                wait 200
                            endif
                    endfor
                    
            overhead "[ RED ALERT!! ]" 37
            hotkey 'Cancel Current Target'
            wait 100
            while not targetexists 
            dclick  mining_runebook
            waitforgump 1551740969 
            gumpresponse 2
            wait 500 
            
                for 5
                    if insysmsg 'Your concentration is disturbed'
                        overhead 'Shit! Trying again...' 337
                        while not targetexists 
                        dclick mining_runebook
                        waitforgump 1551740969 
                        gumpresponse 2
                        wait 500
                    endif
                endfor
                
                    wait 2000

                if skill "Mace Fighting" > 50 and not findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" hand and findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" backpack as weapon
                    dclick weapon      
                    wait 100
                endif 

                if skill "Swordsmanship" > 50 and not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" hand and findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" backpack as weapon
                    dclick weapon      
                    wait 100
                endif 

    if HouseRecall = 1
        wait 500
        dclick MyDoor 
        overhead "*door slams!*" 0 MyDoor
        wait 1000
    endif 

    if OwnerInnRecall = 1
        wait 2000
        say "Innkeeper, I need a room!"
        waitforgump 2393832411
        gumpresponse 4
        wait 3000
    endif

    if CoOwnerInnRecall = 1
        wait 2000
        say "Innkeeper, I need a room!"
        waitforgump 2393832411
        gumpresponse 5
        wait 2000
        gumpresponse 100
        wait 2000
    endif

        overhead "Home Sweet Home!" 2086
        wait 2000
        useskill "Hiding"
        wait 100

        if OpenIngotBag = 1 
            dclick ingotbag
            wait 250
        endif
            
    for 10
    if findtype "iron ore" backpack as ore
            if findtype "forge" ground -1 -1 2 as forge or findtype 0x0FB1 ground -1 -1 2 as forge
            overhead "*smelting ore...*" 2114 forge
            dclick ore
            overhead "*forging ingots...*" 2117
            wait 1000
            hotkey 'Organizer Agent-11'  
            wait 250
        endif 
    endif
    endfor     

    if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
            overhead "*storing ingots...*" 37
            hotkey "Organizer Agent-06"
            wait 3000
        if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
            hotkey "Organizer Agent-06"
            wait 3000
        endif
        if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
            hotkey "Organizer Agent-06"
            wait 1000
        endif
    endif 

        hotkey "Organizer Agent-04"
        overhead "[ STOPPING SCRIPT! ]" 337
        stop
    endif    

if skill "Mace Fighting" > 50 and not findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" self or if skill "Swordsmanship" > 50 and not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" self
        overhead "I can't fight without a weapon!"  2086
        wait 1500 
        overhead "I'd better RUN!!" 37
        hotkey 'Toggle Peace Only'  
                            
            hotkey 'Cancel Current Target'
            wait 100
            while not targetexists 
            dclick mining_runebook
            waitforgump 1551740969 
            gumpresponse 2
            wait 500 
            
                for 5
                    if insysmsg 'Your concentration is disturbed'
                        overhead 'Shit! Trying that again...' 2086
                        while not targetexists 
                        dclick mining_runebook
                        waitforgump 1551740969 
                        gumpresponse 2
                        wait 500
                        clearsysmsg 
                    endif
                endfor
                
                wait 2000

    if HouseRecall = 1
        wait 500
        dclick MyDoor 
        overhead "*door slams!*" 0 MyDoor
        wait 1000    
    endif 

    if OwnerInnRecall = 1
                wait 2000
                say "Innkeeper, I need a room!"
                waitforgump 2393832411
                gumpresponse 4
                wait 3000
    endif

    if CoOwnerInnRecall = 1
                wait 2000
                say "Innkeeper, I need a room!"
                waitforgump 2393832411
                gumpresponse 5
                wait 2000
                gumpresponse 100
                wait 2000
    endif

            overhead "Home Sweet Home!" 2086
            wait 2000
            useskill "Hiding"
            wait 100

            if OpenIngotBag = 1 
                dclick ingotbag
                wait 250
            endif

    for 10
    if findtype "iron ore" backpack as ore
        if findtype "forge" ground -1 -1 2 as forge or findtype 0x0FB1 ground -1 -1 2 as forge
        overhead "*smelting ore...*" 2114 forge
        dclick ore
        overhead "*forging ingots...*" 2117
        wait 1000
        hotkey 'Organizer Agent-11'  
        wait 250
        endif 
    endif
    endfor        

    if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
        overhead "*storing ingots...*" 37
        hotkey "Organizer Agent-06"
        wait 3000
        if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
            hotkey "Organizer Agent-06"
            wait 3000
        endif
        if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
            hotkey "Organizer Agent-06"
            wait 1000
        endif
    endif 

        hotkey "Organizer Agent-04"
        overhead "[ STOPPING SCRIPT! ]" 337
        stop
    endif
endif 


if EnableAutoSmeltNaturalForge = 1 and findtype "iron ore" backpack as ore
   
@setvar! ForgeFound 0
    
    if not timerexists AutoSmeltNaturalForgeTimer
        settimer AutoSmeltNaturalForgeTimer AutoNaturalForgeTime
    endif

    if timer AutoSmeltNaturalForgeTimer >= AutoNaturalForgeTime
        dclick ore
        wait 600
        if insysmsg "You do not see any nearby forges"
            settimer AutoSmeltNaturalForgeTimer 0
        else
            @setvar! ForgeFound 1
        endif
    endif

for 10
    if findtype "forge" ground -1 -1 2 as forge or findtype 0x0FB1 ground -1 -1 2 as forge or ForgeFound = 1 and findtype "iron ore" backpack as ore
        overhead "*smelting ore...*" 2114 forge
        dclick ore
        overhead "*forging ingots...*" 2117
        wait 1000
        if insysmsg "You do not see any nearby forges"
            settimer AutoSmeltNaturalForgeTimer 0
            @setvar! ForgeFound 0
            replay
        endif
        hotkey 'Organizer Agent-11'  
        wait 500
    endif
endfor 
endif


if EnableWeightWarningMessage = 1
    if weight > GreenWarningWeight and weight < YellowWarningWeight
        overhead "[ WEIGHT WARNING! ]" 1267
    endif

    if weight > YellowWarningWeight and weight < RedWeightLimit
        overhead "[ TIME TO FORGE! ]" 149
    endif 

    if weight > RedWeightLimit
        overhead "[ WEIGHT LIMIT REACHED!!! ]" 37
        wait 2000
        overhead "Find a forge in order to continue..." 0
        wait 2500
        replay
    endif
endif 

hotkey 'Use item in hand' 
waitfortarget 250
hotkey 'Target Self' 

  wait MinerWaitTime

if insysmsg "Achievement: Miner"  
    overhead '*mining ore...*' 2128
endif


if insysmsg "Now tracking" or insysmsg "Distance to destination"
    pushlist "mining_alert" "red_alert_recall" 
    replay 
        
                elseif insysmsg 'world is saving' 
                    overhead '[ WORLD SAVING... ]' 253 
                        for 25
                        if insysmsg 'world save complete' 
                            wait 1000
                            overhead '[ SAVE COMPLETE! ]' 253 
                            clearsysmsg 
                            replay
                        endif 
                        wait 100
                        endfor 
                    clearsysmsg 
                    replay 
        
                elseif insysmsg 'Harvesting is not allowed' 
                    overhead 'You need to leave town...' 84
                    clearsysmsg 
                    wait 5000 
                    replay 
            
                elseif insysmsg 'You have worn out your tool' 
                    overhead "My pickaxe broke!" 2086
                    clearsysmsg 
                    wait 500 
                    replay
                    
                elseif insysmsg 'You do not see any' or insysmsg 'You cannot produce any'
                    if MOVE = 1
                        overhead "[ KEEP MOVING... ]" 68
                
                        if insysmsg "Being perfectly rested" 
                            overhead "Outta my way!  I've got a pickaxe and know how to use it..." 2086
                        endif
                
                        if insysmsg "Now tracking" or insysmsg "Distance to destination" and EnableRedAlertRecall = 1
                            pushlist "mining_alert" "red_alert_recall" 
                            replay
                        endif

                        if paralyzed and EnableParalyzePouch = 1
                            overhead "[ !!POP!! ]" 2117
                            say "[pouch" 
                            wait 100
                        endif
                
                        if insysmsg "As the owner" or insysmsg "Your house and its contents"
                            wait 500
                            overhead "*door slams!*" 0 MyDoor
                            dclick MyDoor 
                            wait 1000
                        endif
                        
                        if findtype 'iron ore|iron ingots' backpack 
                            hotkey 'Organizer Agent-11'
                        endif
                            hotkey 'Organizer Agent-03'
                            wait 100                        
                            hotkey 'Organizer Agent-04'
                            @setvar! MOVE 0
                            replay
                        endif 
                    
                    if MOVE = 0
                        overhead "[ KEEP MOVING... ]" 53
                    
                        if insysmsg "Being perfectly rested" 
                            overhead "Move it!  I've got work to do..." 2086
                        endif
                
                        if insysmsg "Now tracking" or insysmsg "Distance to destination" and EnableRedAlertRecall = 1
                            pushlist "mining_alert" "red_alert_recall" 
                            replay
                        endif

                        if paralyzed and EnableParalyzePouch = 1
                            overhead "[ !!POP!! ]" 2117
                            say "[pouch" 
                            wait 100
                        endif
                
 
                        if insysmsg "As the owner" or insysmsg "Your house and its contents"
                            wait 500
                            overhead "*door slams!*" 0 MyDoor
                            dclick MyDoor 
                            wait 1000
                        endif
                        
                        if findtype 'iron ore|iron ingots' backpack 
                            hotkey 'Organizer Agent-11'
                        endif
                            hotkey 'Organizer Agent-03'
                            wait 100                        
                            hotkey 'Organizer Agent-04'
                            @setvar! MOVE 1
                            replay
                    endif
                    clearsysmsg 
                    @setvar! MOVE 1
                    replay 
  
                elseif insysmsg "travel" 
                    overhead "I'm tired from travelling." 2086
                    wait 2500 
                    overhead "Just give me a minute to recover..." 2086
                    wait 12000
                    clearsysmsg 
                    replay 
            
                elseif insysmsg "You loosen some rocks"
                    overhead '*fail!*' 337
                    wait 100
                    clearsysmsg 
                    replay

else
   
    if insysmsg "Mining skillgain" 
        if skill 'Mining' > 100.0 and skill 'Mining' < 119.9
        sysmsg "Hmm... there is something special about these stones..." 84
         
        elseif skill 'Mining' = 119.9
            overhead "THIS COULD BE IT......" 2086
            sysmsg "Hmm... there is something special about these stones..." 84
            
        elseif skill 'Mining' = 120.0
            overhead "FINALLY!!!" 2086
            wait 2000
            overhead "We made it!" 2086
            wait 1500
            clearsysmsg 
            overhead "[ TIME FOR A BREAK! ]" 337
            stop
        endif
    endif
    

if insysmsg "Now tracking" or insysmsg "Distance to destination"
        pushlist "mining_alert" "red_alert_recall"
        clearsysmsg 
        replay
        
            elseif insysmsg 'world is saving' 
                overhead '[ WORLD SAVING... ]' 253 
                    for 25
                        if insysmsg 'world save complete' 
                            wait 1000
                            overhead '[ SAVE COMPLETE! ]' 253 
                            clearsysmsg 
                            replay
                        endif 
                    wait 100
                    endfor 
                clearsysmsg 
                replay 
            
            elseif insysmsg 'Harvesting is not allowed' 
                overhead 'You need to leave town...' 84
                wait 5000 
                clearsysmsg 
                replay 
            
            elseif insysmsg 'You have worn out your tool' 
                overhead "My pickaxe broke!" 2086
                clearsysmsg 
                replay 
                    
            elseif insysmsg 'You do not see any' or insysmsg 'You cannot produce any'
                    if MOVE = 1
                    overhead "[ KEEP MOVING... ]" 68
            
                        if insysmsg "Being perfectly rested" 
                            overhead "Move it!  I'm behind schedule..." 2086
                        endif
                
                        if insysmsg "Now tracking" or insysmsg "Distance to destination" and EnableRedAlertRecall = 1
                            pushlist "mining_alert" "red_alert_recall" 
                            replay
                        endif

                        if paralyzed and EnableParalyzePouch = 1
                            overhead "[ !!POP!! ]" 2117
                            say "[pouch" 
                            wait 100
                        endif
                
                        if insysmsg "As the owner" or insysmsg "Your house and its contents"
                            wait 500
                            overhead "*door slams!*" 0 MyDoor
                            dclick MyDoor 
                            wait 1000
                        endif
                        
                        if findtype 'iron ore|iron ingots' backpack 
                            hotkey 'Organizer Agent-11'
                        endif
                            hotkey 'Organizer Agent-03'
                            wait 100                        
                            hotkey 'Organizer Agent-04'
                            @setvar! MOVE 0
                            replay
                    endif 
                    
                    if MOVE = 0
                        overhead "[ KEEP MOVING... ]" 53
                    
                        if insysmsg "Being perfectly rested" 
                            overhead "Outta the way!  I've got work to do..." 2086
                        endif
                
                        if insysmsg "Now tracking" or insysmsg "Distance to destination" and EnableRedAlertRecall = 1
                            pushlist "mining_alert" "red_alert_recall" 
                            replay
                        endif

                        if paralyzed and EnableParalyzePouch = 1
                            overhead "[ !!POP!! ]" 2117
                            say "[pouch" 
                            wait 100
                        endif
                
                        if insysmsg "As the owner" or insysmsg "Your house and its contents"
                            wait 500
                            overhead "*door slams!*" 0 MyDoor
                            dclick MyDoor 
                            wait 1000
                        endif
                        
                        if findtype 'iron ore|iron ingots' backpack 
                            hotkey 'Organizer Agent-11'
                        endif
                            hotkey 'Organizer Agent-03'
                            wait 100                        
                            hotkey 'Organizer Agent-04'
                            @setvar! MOVE 1
                            replay
                    endif 
                    clearsysmsg 
                    @setvar! MOVE 1
                    replay
        
            elseif insysmsg "travel" 
                overhead "I'm tired from travelling." 2086
                wait 2500
                overhead "Just give me a minute to recover..." 2086
                wait 12000
                clearsysmsg 
                replay 
            
            elseif insysmsg "You loosen some rocks"
                overhead '*fail!*' 337
                replay              
              
            elseif insysmsg "You dig some iron ore and put it in your backpack." 
                overhead '*you harvest iron ore*' 1900
                replay    
        
            elseif insysmsg "You dig some dull copper ore and put it in your backpack." 
                overhead '*you harvest dull copper ore*' 2419
                replay     
  
            elseif insysmsg "You dig some shadow iron ore and put it in your backpack." 
                overhead '*you harvest shadow iron ore*' 2406
                replay     

            elseif insysmsg "You dig some copper ore and put it in your backpack." 
                overhead '*you harvest copper ore*' 2413
                replay  

            elseif insysmsg "You dig some bronze ore and put it in your backpack." 
                overhead '*you harvest bronze ore*' 2418
                replay  

                elseif insysmsg "You dig some golden ore and put it in your backpack." 
                overhead '*you harvest gold ore!*' 2213
                replay  

            elseif insysmsg "You dig some agapite ore and put it in your backpack." 
                overhead '*you harvest agapite ore!*' 2425
                replay  

            elseif insysmsg "You dig some verite ore and put it in your backpack." 
                overhead '*you harvest verite ore!!*' 2207
                replay  

            elseif insysmsg "You dig some valorite ore and put it in your backpack." 
                overhead '*you harvest valorite ore!!*' 2219
                replay  

            elseif insysmsg "You dig some avarite ore" 
                overhead '*you harvest avarite ore!!!*' 1763
                replay      
    
            elseif insysmsg "You must wait"
                overhead 'You must wait...' 337
                wait 100
                clearsysmsg 
                replay  
endif 
    
    sysmsg "LAG! If this error message appears repeatedly:  INCREASE WAIT TIME VALUE ON LINE 113 OF SCRIPT!" 149
    replay
    endif
    
endif




if not dead and skill "Lumberjacking" > 49.9 and EnableLumberjacking = 1

clearsysmsg
hotkey 'Cancel Current Target'

if not varexist boardbag and EnableBoardBag = 1
    wait 1000
    overhead "Please select your lumber storage bag..." 0
    wait 1000
    setvar boardbag
    wait 2500
    sysmsg "Disable EnableBoardBag in script variables to turn off this feature!" 0
    replay
endif


if not varexist lumber_runebook and EnableRedAlertRecall = 1
    wait 1000
    overhead "Please select your escape runebook..." 0
    wait 1000
    setvar lumber_runebook
    wait 2500
    sysmsg "Disable EnableRedAlertRecall in script variables to turn off this feature!" 0
    replay
endif


if paralyzed and EnableParalyzePouch = 1
    overhead "[ !!POP!! ]" 2117
    say "[pouch" 
    wait 100
endif


if insysmsg 'world is saving' 
    overhead '[ WORLD SAVING... ]' 253 
    for 25
        if insysmsg 'world save complete' 
            wait 1000
            overhead '[ SAVE COMPLETE! ]' 253 
            clearsysmsg 
            replay
        endif  
        wait 100
    endfor 
    clearsysmsg 
    replay    
endif 
    

if insysmsg "As the owner" or insysmsg "Your house and its contents"
    wait 500
    overhead "*door slams!*" 0 MyDoor
    dclick MyDoor 
    wait 500
endif
      

if not listexists "lumber_alert"
    createlist "lumber_alert"  
endif

if insysmsg "Now tracking" or insysmsg "Distance to destination" and EnableRedAlertRecall = 1
    pushlist "lumber_alert" "red_alert_recall" 
    replay
endif

if inlist "lumber_alert" "red_alert_recall" and EnableRedAlertRecall = 1
    overhead "[ RED ALERT!! ]" 37
    wait 500
    overhead "Looks like trouble coming!" 2086
     
            if paralyzed 
                overhead "[ !!POP!! ]" 2117
                say "[pouch"
            endif
        
            if not bandaging and hits < maxhits
                hotkey "Bandage self"
                overhead '*applying bandages...*' 88
                wait 200
            endif 
                
            if EnableCurePotion = 1
                if poisoned and not cooldown "Cure Potion"
                    if findtype "Orange Potion" backpack as curepot
                        overhead '*drinking cure potion...*' 44
                        dclick curepot
                        cooldown "Cure Potion" 10500
                        wait 200
                    else
                        overhead "Out of cure pots!" 337
                    endif
                endif
            endif

            if EnableHealPotion = 1
                if hits < 70 and not cooldown "Healing Potion"
                    if findtype "Yellow Potion" backpack as healpot
                        overhead '*drinking heal potion...*' 253
                        dclick healpot
                        cooldown "Healing Potion" 10500
                        wait 200
                    else 
                        overhead 'Out of heal pots!' 337
                    endif
                endif
            endif

            if EnableRefreshPotion = 1
                if stam < 100 and not cooldown "Refresh Potion"
                    if findtype "Red Potion" backpack as refreshpot
                        overhead '*drinking refresh potion...*' 34
                        dclick refreshpot
                        cooldown "Refresh Potion" 10500
                        wait 200
                    else 
                        overhead 'Out of refresh pots!' 337
                    endif
                endif
            endif

            while not targetexists 
            dclick lumber_runebook
            waitforgump 1551740969 
            gumpresponse 2
            wait 500 
            
                for 5
                    if insysmsg 'Your concentration is disturbed'
                        overhead 'Shit! Trying that again...' 2086
                        while not targetexists 
                        dclick lumber_runebook
                        waitforgump 1551740969 
                        gumpresponse 2
                        wait 500 
                        clearsysmsg 
                    endif
                endfor
 
        poplist "lumber_alert" "red_alert_recall" 
        
            wait 2000

                if skill "Mace Fighting" > 50 and not findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" hand and findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" backpack as weapon
                    dclick weapon      
                    wait 100
                endif 

                if skill "Swordsmanship" > 50 and not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" hand and findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" backpack as weapon
                    dclick weapon      
                    wait 100
                endif 

if HouseRecall = 1
    wait 500
    dclick MyDoor 
    overhead "*door slams!*" 0 MyDoor
    wait 1000
endif 

if OwnerInnRecall = 1
                wait 2000
                say "Innkeeper, I need a room!"
                waitforgump 2393832411
                gumpresponse 4
                wait 3000
endif

if CoOwnerInnRecall = 1
                wait 2000
                say "Innkeeper, I need a room!"
                waitforgump 2393832411
                gumpresponse 5
                wait 2000
                gumpresponse 100
                wait 2000
endif

            overhead "Home Sweet Home!" 2086
            wait 2000
            useskill "Hiding"
            wait 100

            if OpenBoardBag = 1 
                dclick boardbag
                wait 250
            endif

                for 10
                    if findtype 'log%s' backpack 
                            wait 500
                            overhead '*making boards...*' 0
                            dclicktype 'log%s' 
                            wait 250
                            hotkey 'Organizer Agent-01'
                            wait 1500
                    endif
                endfor

    if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
                overhead "*storing boards...*" 37
                hotkey "Organizer Agent-06"
                wait 3000
            if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
                hotkey "Organizer Agent-06"
                wait 3000
            endif
            if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
                hotkey "Organizer Agent-06"
                wait 1000
            endif
    endif 
    overhead "[ STOPPING SCRIPT! ]" 337
    stop        
endif 

if skill 'Healing' > 50 
    if not bandaging and hits < maxhits
    overhead '*applying bandages...*' 88
        hotkey "Bandage Self"
    endif
    
    if counttype 'clean bandage%s%' < 10
        overhead "[ RESTOCK BANDAGES! ]" 88
    endif 
   
endif 

if EnableCurePotion = 1
    if poisoned and not cooldown "Cure Potion" and hits < CurePotHP
        if findtype "Orange Potion" backpack as curepot
            overhead '*drinking cure potion...*' 44
            dclick curepot
            cooldown "Cure Potion" 10500
            wait 200
        else
            overhead "Out of cure pots!" 337
        endif
    endif
endif 

if EnableHealPotion = 1
    if hits < HealPotHP and not cooldown "Healing Potion"
        if findtype "Yellow Potion" backpack as healpot
            overhead '*drinking heal potion...*' 253
            dclick healpot
            cooldown "Healing Potion" 10500
            wait 200
        else 
            overhead 'Out of heal pots!' 337
        endif
    endif
endif 

if EnableRefreshPotion = 1
    if stam < RefreshPotSP and not cooldown "Refresh Potion"
        if findtype "Red Potion" backpack as refreshpot
            overhead '*drinking refresh potion...*' 34
            dclick refreshpot
            cooldown "Refresh Potion" 10500
            wait 200
        else 
            overhead 'Out of refresh pots!' 337
        endif
    endif
endif


if skill 'Magery' > 50 and not findbuff 'Magic Reflection' and not cooldown "Magic Shield" and EnableMagicReflection = 1 and mana > 14
    overhead 'I should protect myself...' 2086
    for 10
        cast 'Magic Reflection' 
        waitfortarget 1500
        hotkey 'Target Self'
        wait 1000
            if insysmsg "That spell will not adhere"
                cooldown "Magic Shield" 30000
            overhead "Too soon for a new shield.  Give me a sec..." 2086
                replay
            endif 
        if cooldown "Spell Fail"
            wait 1000
            overhead "Let me try that again..." 2086
            wait 1000
        else
            break
        endif 
    endfor 
    wait 500
    overhead "[ MAGIC SHEILD ACTIVATED! ]" 10
    wait 1000
    replay
endif  


if findtype 'Elven SpellBlade' backpack and EnableAutoCarving = 1
    if findtype "corpse" ground -1 -1 2 as goner
        wait 500
        dclicktype "Elven Spellblade"
        waitfortarget 2000
        target 'self'
        wait 250
        overhead "*skinning corpse...*" 337
        wait 500
        @ignore goner
    endif 
endif
    
if not findtype 'Elven SpellBlade' self and EnableAutoCarving = 1
    overhead "[ NO SKINNING KNIFE! ]" 339
    sysmsg "Disable EnableAutoCarving in script variables to turn off this overhead message!" 0
endif 


if skill "Swordsmanship" > 50 and not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" backpack
    if not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" hand
        overhead "[ NO WEAPON! ]" 339
    endif
endif 

if skill "Mace Fighting" > 50 and not findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" backpack
    if not findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" hand
        overhead "[ NO WEAPON! ]" 339
    endif
endif 

if AllInventoryMessage = 1
    if counttype "rope" backpack = 0 and RopeInventoryMessage = 1
        overhead "[ RESTOCK ROPE! ]" 2799
        sysmsg "Disable RopeInventoryMessage in script variables to turn off this overhead message!" 0
    endif 

    if counttype "Yellow Potion" backpack = 0 and YellowInventoryMessage = 1
        overhead "[ RESTOCK HEAL POTIONS! ]" 253
        sysmsg "Disable YellowInventoryMessage in script variables to turn off this overhead message!" 0
    endif 

    if counttype "Orange Potion" backpack = 0 and OrangeInventoryMessage = 1
        overhead "[ RESTOCK CURE POTIONS! ]" 44
        sysmsg "Disable OrangeInventoryMessage in script variables to turn off this overhead message!" 0
    endif 

    if counttype "Red Potion" backpack = 0 and RedInventoryMessage = 1
        overhead "[ RESTOCK REFRESH POTIONS! ]" 37
        sysmsg "Disable RedInventoryMessage in script variables to turn off this overhead message!" 0
    endif 

    if counttype "White Potion" backpack = 0 and WhiteInventoryMessage = 1 
        overhead "[ RESTOCK STRENGTH POTIONS! ]" 956
        sysmsg "Disable WhiteInventoryMessage in script variables to turn off this overhead message!" 0
    endif 

    if counttype "Blue Potion" backpack = 0 and BlueInventoryMessage = 1
        overhead "[ RESTOCK AGILITY POTIONS! ]" 93
        sysmsg "Disable BlueInventoryMessage in script variables to turn off this overhead message!" 0
    endif 

    if counttype "Black Potion" backpack = 0 and BlackInventoryMessage = 1
        overhead "[ RESTOCK MAGIC RESIST POTIONS! ]" 0
        sysmsg "Disable BlackInventoryMessage in script variables to turn off this overhead message!" 0
    endif 
endif


if counttype "board%s" > BoardRecallAmount and EnableBoardAutoRecall = 1
    overhead "I'd hate to lose all this hard work..." 2086
    wait 2500
    overhead "I'm going to go unload before it's too late!" 2086
    wait 1000
    
            while not targetexists 
            dclick lumber_runebook
            waitforgump 1551740969 
            gumpresponse 2
            # Change gumpresponse to '2' to select first rune in book.
            wait 500 
            
                for 5
                    if insysmsg 'Your concentration is disturbed'
                        overhead 'Shit! Trying again...' 2086
                        while not targetexists 
                        dclick lumber_runebook
                        waitforgump 1551740969 
                        gumpresponse 2
                        # Change gumpresponse to '2' to select first rune in book.
                        wait 500
                    endif
                endfor
                    wait 2000

                if skill "Mace Fighting" > 50 and not findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" hand and findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" backpack as weapon
                    dclick weapon      
                    wait 100
                endif 

                if skill "Swordsmanship" > 50 and not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" hand and findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" backpack as weapon
                    dclick weapon      
                    wait 100
                endif 

if HouseRecall = 1
        wait 500
        dclick MyDoor 
        overhead "*door slams!*" 0 MyDoor
        wait 1000
endif 

if OwnerInnRecall = 1      
    wait 2000
    say "Innkeeper, I need a room!"
    waitforgump 2393832411
    gumpresponse 4
    wait 3000
endif

if CoOwnerInnRecall = 1
    wait 2000
    say "Innkeeper, I need a room!"
    waitforgump 2393832411
    gumpresponse 5
    wait 2000
    gumpresponse 100
    wait 2000
endif

        overhead "Home Sweet Home!" 2086
        wait 2000
        useskill "Hiding"
        wait 100

            if OpenBoardBag = 1 
                dclick boardbag
                wait 250
            endif

                for 10
                    if findtype 'log%s' backpack 
                            wait 500
                            overhead '*making boards...*' 0
                            dclicktype 'log%s' 
                            wait 250
                            hotkey 'Organizer Agent-01'
                            wait 1500
                    endif
                endfor     

    if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
                overhead "*storing boards...*" 37
                hotkey "Organizer Agent-06"
                wait 3000
            if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
                hotkey "Organizer Agent-06"
                wait 3000
            endif
            if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
                hotkey "Organizer Agent-06"
                wait 1000
            endif
    endif 
    overhead "[ STOPPING SCRIPT! ]" 337
    stop
endif
        

if skill 'Tracking' > 50 and not findbuff 'tracking' and EnableRedAlertRecall = 1
    overhead 'I should keep an eye out for trouble...' 2086
        wait 1500
        while not gumpexists 4267467659
        useskill 'tracking'
            wait 250
        endwhile
            if gumpexists 4267467659
                while not insysmsg "You will now hunt all hostile players."
                gumpresponse 8 4267467659
                waitforgump 4267467659 5000
                endwhile
                gumpresponse 6 4267467659
                wait 500
                clearsysmsg 
            endif
        gumpclose 4267467659
        overhead "[ AUTO RECALL ACTIVATED! ]" 37
        wait 1500
        overhead "These woods are a dangerous place!" 2086
        wait 500
endif 


if not findbuff 'food satisfaction' and findtype "wedge%s% of cheese|fish steak%s%" self and EnableCheeseTimer = 1
    wait 1500
    overhead "Hold on, I shouldn't do this on an empty stomach..." 2086
    wait 500
        if findtype "wedge%s% of cheese|fish steak%s%" backpack as Food
            overhead "*eating food...*" 0
            dclick Food
            wait 1500
            overhead "Ok, I'm ready to get to work!" 2086
            wait 1500
        endif
endif 


if not findtype 'hatchet' self
        overhead "I can't work with no hatchet!" 2086
        wait 2500
        overhead '[ STOPPING SCRIPT... ]' 37
        stop
endif
 
if not findtype 'hatchet' hand and findtype 'hatchet' backpack
        dclicktype 'hatchet' backpack
        wait 1500
endif


if findtype 'pickaxe' hand as MyAxe and EnableToolCountdown = 1
    getlabel MyAxe AxeLabel
    if '(5 uses' in AxeLabel or '(4 uses' in AxeLabel or '(3 uses' in AxeLabel or '(2 uses' in AxeLabel or '(1 use' in AxeLabel
        if EnableRecycleTool = 0
        sysmsg "YOUR TOOL IS ABOUT TO BREAK....." 153
        endif 
        if EnableRecycleTool = 1
        sysmsg "YOUR TOOL IS ABOUT TO BE RECYCLED....." 4
        endif 
        wait 100
    endif 
endif 


if findtype 'tool kit' self as ToolKit and EnableRecycleTool = 1
    if findtype 'pickaxe|hatchet' hand as MyAxe
        getlabel MyAxe AxeLabel
        if '(1 use' in AxeLabel
            overhead "[ RECYCLING TOOL! ]" 4
            clearhands both
            wait 1000
            if not gumpexists 949095101 
                dclick ToolKit
                waitforgump 949095101 2000
            endif 
        
            for 5
            gumpresponse 3 949095101
            wait 1000
                if insysmsg "Target an individual item"
                    wait 500
                    target MyAxe
                    wait 1000
                    gumpclose 949095101
                    wait 1000
                    overhead "Every little bit counts!" 2086
                    hotkey 'Organizer Agent-01'  
                    wait 1500
                    replay
                else
                    gumpresponse 2
                    wait 500
            endfor 
            endif 
        endif 
    endif 
endif

if not findtype 'tool kit' self and EnableRecycleTool = 1
    overhead "[ NO TOOL KIT! ]" 339
    sysmsg "Disable EnableRecycleTool in script variables to turn off this overhead message!" 0
endif


if EnableWeightWarningMessage = 1
    if weight > GreenWarningWeight and weight < YellowWarningWeight
        overhead "[ WEIGHT WARNING! ]" 1267
    endif

    if weight > YellowWarningWeight and weight < RedWeightLimit
        overhead "[ TIME TO UNLOAD! ]" 149
    endif 

    if weight > RedWeightLimit
        overhead "[ WEIGHT LIMIT REACHED!!! ]" 37
        wait 2000
       overhead "Please reduce weight in order to continue..." 0
        wait 2500
        replay
    endif
endif


if warmode and EnableAutoAttackGreyMOB = 1

    overhead "It's time to fight!" 2086
    
    if skill "Mace Fighting" > 50 and not findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" hand and findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" backpack as weapon
        dclick weapon      
        wait 100
    endif 

    if skill "Swordsmanship" > 50 and not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" hand and findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" backpack as weapon
        dclick weapon      
        wait 100
    endif 
            
    hotkey 'Target Random Murderer Player'       
    wait 500  
            
        if insysmsg "No one matching that was found"    
            for 1000
                hotkey 'Target Closest Non-Friendly Monster'
                wait 500
                
                    if skill "Mace Fighting" > 50 and not findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" hand and findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" backpack as weapon
                        dclick weapon      
                        wait 100
                    endif 

                    if skill "Swordsmanship" > 50 and not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" hand and findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" backpack as weapon
                        dclick weapon      
                        wait 100
                    endif 
                            
                    if insysmsg "No one matching that was found" 
                        hotkey 'Cancel Current Target'      
                        @setvar CurrentTarget 0
                        wait 1000   
                        overhead "Is there no one else??" 2086
                        wait 2000
                        overhead "Alright then, I guess it's back to work..." 2086
                                                            
                            if findtype 'Elven SpellBlade' backpack and EnableAutoCarving = 1
                                if findtype "corpse" ground -1 -1 2 as body
                                    wait 1000
                                    dclicktype "Elven Spellblade"
                                    wft 1000
                                    target self
                                    wait 500
                                    overhead "*skinning corpse...*" 339
                                    wait 500
                                    @ignore body
                                endif 
                            endif
                        
                        hotkey 'Toggle Peace Only'
                        wait 100
                        hotkey 'Clear Target Queue'
                        clearsysmsg 
                        wait 1000 
                        replay                                    
                    endif 
                    
                        @setvar CurrentTarget lasttarget 
                        overhead "¼ TARGET ¼ " 253 CurrentTarget                     
                        attack CurrentTarget
                        getlabel CurrentTarget TargetDesc
                        wait 1000
                        
                            if insysmsg "You have gained"
                                overhead "Did you see that?? I just killed {{TargetDesc}}!" 2086
                                hotkey 'Cancel Current Target'
                                @setvar CurrentTarget 0
                                wait 1500
                            endif
                            
                            if findtype 'Elven SpellBlade' backpack and EnableAutoCarving = 1
                                if findtype "corpse" ground -1 -1 2 as corpse
                                    hotkey 'Cancel Current Target'
                                    wait 500
                                    overhead "I'd better carve this up quickly..." 2086
                                    wait 500
                                    dclicktype "Elven Spellblade"
                                    wft 1000
                                    target self
                                    wait 1000
                                    overhead "*skinning {{TargetDesc}}...*" 339
                                    @ignore corpse
                                    wait 500
                                endif 
                            endif
                            
                                if skill 'Healing' > 50 and not bandaging and hits < maxhits
                                    overhead '*applying bandages...*' 88
                                    hotkey "Bandage Self"
                                endif
    
                                if counttype 'clean bandage%s%' < 10
                                    overhead "[ RESTOCK BANDAGES! ]" 88
                                endif 
                             
                            if EnableCurePotion = 1
                                if poisoned and not cooldown "Cure Potion" and hits < CurePotHP
                                    if findtype "Orange Potion" backpack as curepot
                                        overhead '*drinking cure potion...*' 44
                                        dclick curepot
                                        cooldown "Cure Potion" 10500
                                        wait 200
                                    else
                                        overhead "Out of cure pots!" 337
                                    endif
                                endif
                            endif 

                            if EnableHealPotion = 1
                                if hits < HealPotHP and not cooldown "Healing Potion"
                                    if findtype "Yellow Potion" backpack as healpot
                                        overhead '*drinking heal potion...*' 253
                                        dclick healpot
                                        cooldown "Healing Potion" 10500
                                        wait 200
                                    else 
                                        overhead 'Out of heal pots!' 337
                                    endif
                                endif
                            endif 

                            if EnableRefreshPotion = 1
                                if stam < RefreshPotSP and not cooldown "Refresh Potion"
                                    if findtype "Red Potion" backpack as refreshpot
                                        overhead '*drinking refresh potion...*' 34
                                        dclick refreshpot
                                        cooldown "Refresh Potion" 10500
                                        wait 200
                                    else 
                                        overhead 'Out of refresh pots!' 337
                                    endif
                                endif
                            endif
                            
                            if paralyzed and EnableParalyzePouch = 1
                                overhead "[ !!POP!! ]" 2117
                                say "[pouch" 
                                wait 200
                            endif
                    endfor
                    
            overhead "[ RED ALERT!! ]" 37
            hotkey 'Cancel Current Target'
            wait 100
            while not targetexists 
            dclick  lumber_runebook
            waitforgump 1551740969 
            gumpresponse 2
            wait 500 
            
                for 5
                    if insysmsg 'Your concentration is disturbed'
                        overhead 'Shit! Trying again...' 337
                        while not targetexists 
                        dclick lumber_runebook
                        waitforgump 1551740969 
                        gumpresponse 2
                        wait 500
                    endif
                endfor
                
                wait 2000

                if skill "Mace Fighting" > 50 and not findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" hand and findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" backpack as weapon
                    dclick weapon      
                    wait 100
                endif 

                if skill "Swordsmanship" > 50 and not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" hand and findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" backpack as weapon
                    dclick weapon      
                    wait 100
                endif 

    if HouseRecall = 1
        wait 500
        dclick MyDoor 
        overhead "*door slams!*" 0 MyDoor
        wait 1000
    endif 

    if OwnerInnRecall = 1
        wait 2000
        say "Innkeeper, I need a room!"
        waitforgump 2393832411
        gumpresponse 4
        wait 3000
    endif

    if CoOwnerInnRecall = 1
        wait 2000
        say "Innkeeper, I need a room!"
        waitforgump 2393832411
        gumpresponse 5
        wait 2000
        gumpresponse 100
        wait 2000
    endif

        overhead "Home Sweet Home!" 2086
        wait 2000
        useskill "Hiding"
        wait 100

        if OpenBoardBag = 1 
            dclick boardbag
            wait 250
        endif
            
        for 10
            if findtype 'log%s' backpack 
                wait 500
                overhead '*making boards...*' 0
                dclicktype 'log%s' 
                wait 250
                hotkey 'Organizer Agent-01'
                wait 1500
            endif
        endfor

    if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
            overhead "*storing boards...* 37
            hotkey "Organizer Agent-06"
            wait 3000
        if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
            hotkey "Organizer Agent-06"
            wait 3000
        endif
        if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
            hotkey "Organizer Agent-06"
            wait 1000
        endif
    endif 

        hotkey "Organizer Agent-04"
        overhead "[ STOPPING SCRIPT! ]" 337
        stop
    endif    

if skill "Mace Fighting" > 50 and not findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" self or if skill "Swordsmanship" > 50 and not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" self
        overhead "I can't fight without a weapon!"  2086
        wait 1500 
        overhead "I'd better RUN!!" 37
        hotkey 'Toggle Peace Only'  
                            
            hotkey 'Cancel Current Target'
            wait 100
            while not targetexists 
            dclick lumber_runebook
            waitforgump 1551740969 
            gumpresponse 2
            wait 500 
            
                for 5
                    if insysmsg 'Your concentration is disturbed'
                        overhead 'Shit! Trying that again...' 2086
                        while not targetexists 
                        dclick lumber_runebook
                        waitforgump 1551740969 
                        gumpresponse 2
                        wait 500
                        clearsysmsg 
                    endif
                endfor
                
                wait 2000

                if skill "Mace Fighting" > 50 and not findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" hand and findtype "giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick|club" backpack as weapon
                    dclick weapon      
                    wait 100
                endif 

                if skill "Swordsmanship" > 50 and not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" hand and findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" backpack as weapon
                    dclick weapon      
                    wait 100
                endif 

    if HouseRecall = 1
        wait 500
        dclick MyDoor 
        overhead "*door slams!*" 0 MyDoor
        wait 1000
    endif 

    if OwnerInnRecall = 1
                wait 2000
                say "Innkeeper, I need a room!"
                waitforgump 2393832411
                gumpresponse 4
                wait 3000
    endif

    if CoOwnerInnRecall = 1
                wait 2000
                say "Innkeeper, I need a room!"
                waitforgump 2393832411
                gumpresponse 5
                wait 2000
                gumpresponse 100
                wait 2000
    endif

            overhead "Home Sweet Home!" 2086
            wait 2000
            useskill "Hiding"
            wait 100

        if OpenBoardBag = 1 
            dclick boardbag
            wait 250
        endif
            
        for 10
            if findtype 'log%s' backpack 
                wait 500
                overhead '*making boards...*' 0
                dclicktype 'log%s' 
                wait 250
                hotkey 'Organizer Agent-01'
                wait 1500
            endif
        endfor    

    if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
        overhead "*storing boards...*" 37
        hotkey "Organizer Agent-06"
        wait 3000
        if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
            hotkey "Organizer Agent-06"
            wait 3000
        endif
        if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
            hotkey "Organizer Agent-06"
            wait 1000
        endif
    endif 

        hotkey "Organizer Agent-04"
        overhead "[ STOPPING SCRIPT! ]" 337
        stop
    endif
endif


hotkey 'Use item in hand' 
waitfortarget 1500
hotkey 'Target Self' 

  wait LumberWaitTime

if insysmsg "Now tracking" 
        pushlist "lumber_alert" "red_alert_recall" 
        replay 
        
                elseif insysmsg 'world is saving' 
                    overhead '[ WORLD SAVING... ]' 253 
                        for 25
                        if insysmsg 'world save complete' 
                            wait 1000
                            overhead '[ SAVE COMPLETE! ]' 253 
                            clearsysmsg 
                            replay
                        endif 
                        wait 100
                        endfor 
                    clearsysmsg 
                    replay 
                    
        
                elseif insysmsg 'Harvesting is not allowed' 
                    overhead 'You need to leave town...' 0 
                    wait 5000 
                    replay 
            
                elseif insysmsg 'You broke your axe' 
                    overhead "My axe broke!" 37
                    wait 250
                    overhead "I'll grab a new one..." 2086
                    wait 500 
                    replay 
                    
                elseif insysmsg 'You do not see any' or insysmsg 'You cannot produce any'
                        if MOVE = 1
                        overhead "[ KEEP MOVING... ]" 69
                        wait 500
                
                        if insysmsg "Now tracking" or insysmsg "Distance to destination" and EnableRedAlertRecall = 1
                            pushlist "mining_alert" "red_alert_recall" 
                            replay
                        endif

                        if paralyzed and EnableParalyzePouch = 1
                            overhead "[ !!POP!! ]" 2117
                            say "[pouch" 
                            wait 100
                        endif
                
                        if insysmsg "As the owner" or insysmsg "Your house and its contents"
                            wait 500
                            overhead "*door slams!*" 0 MyDoor
                            dclick MyDoor 
                            wait 1000
                        endif
                        for 10
                        if findtype 'log%s' backpack 
                            overhead '*making boards...*' 0
                            dclicktype 'log%s' 
                            wait 500
                        endif
                        endfor
                    hotkey 'Organizer Agent-01'
                    wait 200 
                    hotkey 'Organizer Agent-02'

                            @setvar! MOVE 0
                        replay
                        endif 
                    
                    if MOVE = 0
                        overhead "[ KEEP MOVING... ]" 1196
                        wait 500
                
                        if insysmsg "Now tracking" or insysmsg "Distance to destination" and EnableRedAlertRecall = 1
                            pushlist "mining_alert" "red_alert_recall" 
                            replay
                        endif

                        if paralyzed and EnableParalyzePouch = 1
                            overhead "[ !!POP!! ]" 2117
                            say "[pouch" 
                            wait 100
                        endif
                
                        if insysmsg "As the owner" or insysmsg "Your house and its contents"
                            wait 500
                            overhead "*door slams!*" 0 MyDoor
                            dclick MyDoor 
                            wait 1000
                        endif
                        for 10
                        if findtype 'log%s' backpack 
                            overhead '*making boards...*' 0
                            dclicktype 'log%s' 
                            wait 500
                        endif
                        endfor
                    hotkey 'Organizer Agent-01'
                    wait 200 
                    hotkey 'Organizer Agent-02'

                            @setvar! MOVE 1
                        replay
                        endif 
                    clearsysmsg 
                    @setvar! MOVE 1
                    replay
        
                elseif insysmsg "travel" 
                    overhead "I'm tired from travelling." 2086 
                    wait 1500
                    overhead "Just give me a minute to recover..." 2086
                        
                        if findtype 'log%s' backpack 
                            overhead '*making boards...*' 0
                                dclicktype 'log%s' 
                                wait 500
                                hotkey 'Organizer Agent-01'
                                wait 500
                        endif

                        clearsysmsg  
                        hotkey 'Organizer Agent-02'  
                        wait 1500  
                        hotkey 'Organizer Agent-03'
                        wait 12000
                        replay
 
endif 

    overhead '*chopping wood...*' 2128
    wait 4000
    
    if insysmsg "Lumberjacking skillgain" 
        if skill 'Lumberjacking' > 100.0 and skill 'Lumberjacking' < 119.9
            sysmsg "Hmm... there is something special about this tree..." 84
         
        elseif skill 'Lumberjacking' = 119.9
            overhead "THIS COULD BE IT......" 2086
            sysmsg "Hmm... there is something special about this tree..." 84
            
        elseif skill 'Lumberjacking' = 120.0
            overhead "FINALLY!!!" 2086
            wait 2000
            overhead "We made it!" 2086
            wait 1500
            clearsysmsg 
            overhead "[ TIME FOR A BREAK! ]" 337
            stop
        endif
    endif

if insysmsg "Now tracking"
            pushlist "lumber_alert" "red_alert_recall"
            replay
     
            elseif insysmsg 'world is saving' 
                overhead '[ WORLD SAVING... ]' 253 
                    for 25
                        if insysmsg 'world save complete' 
                            wait 1000
                            overhead '[ SAVE COMPLETE! ]' 253 
                            clearsysmsg 
                            replay
                        endif 
                    wait 100
                    endfor 
                clearsysmsg 
                replay 
            
            elseif insysmsg 'Harvesting is not allowed'
                overhead 'You need to leave town...' 0
                wait 5000 
                replay
            
            elseif insysmsg 'You broke your axe'
                overhead "My axe broke!" 37
                wait 1500
                overhead "I'll grab a new one..." 2086
                wait 100
                replay
        
            elseif insysmsg "You hack"
                overhead '*fail *' 337
                replay          
           
            elseif insysmsg "You chop some logs and put them in your backpack." 
                overhead '*you harvest logs*' 349
                replay
            
            elseif insysmsg "You chop some dullwood logs and put them in your backpack." 
                overhead '*you harvest dullwood*' 2419
                replay
             
            elseif insysmsg "You chop some shadowwood logs and put them in your backpack." 
                overhead '*you harvest shadowwood*' 2406
                replay
            
            elseif insysmsg "You chop some copperwood logs and put them in your backpack." 
                overhead '*you harvest copperwood*' 2413
                replay
            
            elseif insysmsg "You chop some bronzewood logs and put them in your backpack." 
                overhead '*you harvest bronzewood*' 2418
                replay
            
            elseif insysmsg "You chop some goldenwood logs and put them in your backpack." 
                overhead '*you harvest goldenwood!*' 2213
                replay
            
            elseif insysmsg "You chop some rosewood logs and put them in your backpack." 
                overhead '*you harvest rosewood!*' 2425
                replay
            
            elseif insysmsg "You chop some verewood logs and put them in your backpack." 
                overhead '*you harvest verewood!!*' 2207
                replay
            
            elseif insysmsg "You chop some valewood logs and put them in your backpack." 
                overhead '*you harvest valewood!!*' 2219
                replay
            
            elseif insysmsg "You chop some avarwood logs and put them in your backpack." 
                overhead '*you harvest avarwood!!!*' 1763
                replay
            
            elseif insysmsg "You must wait"
                overhead 'You must wait...' 337
                wait 100
                clearsysmsg 
                replay

endif 

    sysmsg "LAG! If this error message appears repeatedly:  INCREASE WAIT TIME VALUE ON LINE 145 OF SCRIPT!" 149
    replay
    endif
    
endif


if dead 
    wait 3000
    overhead "Well... shit." 2086
    wait 2500
    overhead '[ STOPPING SCRIPT... ]' 37
    stop
endif
    

    wait 500
    overhead "Train skill to 50.0 at NPC and then restart script!" 0
    wait 2500
    overhead '[ STOPPING SCRIPT... ]' 37
    stop
    
    
//////// REACH OUT AND LET ME KNOW IF THERE'S ANY ISSUES:  DAN@DANSTOCKMAN.COM ////////