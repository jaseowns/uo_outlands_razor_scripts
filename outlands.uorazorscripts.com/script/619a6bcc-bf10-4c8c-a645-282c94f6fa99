# This is an automated backup - check out https://outlands.uorazorscripts.com/script/619a6bcc-bf10-4c8c-a645-282c94f6fa99 for latest
# Automation by Jaseowns
## Script: Bapeths Object Drag & Dropper
## Created by: barryroser#0
#############################################

# Bapeth's Object Drag & Dropper
#
# Open the party menu to clear the object and set anew
# Use the adventure rope near a moongate, target within 2 tiles of the gate and the script will gate your pouch out
# Be aware the script will drop the pouch at your feet right after you use the moongate
#
# Script starts here

if not find "groundobject" ground
    hotkey "Set last target"
    wft 500
    overhead "Select an object to drag" 88
    while targetexists 
        //donothing
    endwhile
    @setvar "groundobject" lasttarget 
    overhead "Object set" 87
endif

if not targetexists and find "groundobject" ground -1 -1 2
    clearsysmsg 
    drop backpack
    lift "groundobject" 6000
    drop 0
    while queued
        //donothing
    endwhile
endif
if insysmsg "Where do you wish to traverse to?"
    wft 500
    while targetexists 
        //donothing
    endwhile
    drop backpack
    lift "groundobject" 6000
    pause 2000
    if findtype 3948 ground -1 -1 2
        say "[moongate"
        waitforgump 3773199800 1200
        gumpresponse 2
    endif
    pause 1000
    drop 0
    stop
endif

if gumpexists 3527489586
    gumpclose 3527489586
    overhead "Ground Object Cleared" 45
    @unsetvar "groundobject"
endif
loop