# This is an automated backup - check out https://outlands.uorazorscripts.com/script/6535aac0-adc2-4135-94ef-ded481fe71aa for latest
# Automation by Jaseowns
## Script: DANSTOCK'S ULTIMATE TRI-BARD/CHIVARLY/ARCHER AUTO PILOT SCRIPT
## Created by: danstock._98439#0
#############################################

//////  UO Outlands Razor script - Last updated Nov 22, 2024 (email any bug reports/tips to dan@danstockman.com) 
/////   Compiled by DanStock.
////    ULTIMATE TRI-BARD/CHIVARLY/ARCHER AUTO PILOT SCRIPT
///


// Recommended skill template:
#     120  Peacemaking
#     120  Discordance 
#     120  Provocation
#     120  Chivalry
#     100  Tactics
#  80-100  Archery 
#   39-59  Focus (or utility skill of choice)
#       1  Alchemy *


// TIPS:
# IMPT: Make sure [ShowBardingDurations is set to "Display All Barding Durations" in UO client under Commands -> Text Displays
# VERY IMPT: This script depends heavily on COOLDOWNS. Please make sure to add them all in UO client under Options -> Cooldowns (see list below)
# The COOLDOWNS just need to exist - you don't need to set any triggers or anything (but they are very important!)
# Recommend using LYRIC ASPECT ARMOUR and DAMAGE TO BARDED CREATURES and/or EFFECTIVE BARDING SKILL links 
# BARD CODEX: Must have 6 pts in "Self Taught" in order to drop musicianship skill
# If using 1H archery weapon, add a shield for extra AR (and enable variable below)
# Toggle WAR MODE manually while in COMBAT to throw PURPLE POTIONS (otherwise WAR MODE will reset barding cooldowns and retarget)
# Script will auto TARGET and ATTACK nearby REDS - could also be used to trigger recall or escape scripts!
# Recommend using Razor FILTERS to cancel instrument sounds and redundant system messages (if using overhead messages variable in script) 
# Having 1 point in Alchemy gives a 2m 5s potion duration w/ a 2m cooldown - allowing new strength pot to take effect before old one wears off *


// VERY IMPT:  MUST add the following COOLDOWNS (case sensitive - no triggers necessary):
# Musicianship
# Peacemaking
# Provocation
# Discordance
# Pacified
# Provoked
# Discorded
# Peace Check
# Disco Check
# Provo Check
# Peacemaking Buff
# Provocation Buff
# Discordance Buff
# Song Buff Delay
# Healing Potion
# Cure Potion
# Refresh Potion
# Purple Potion
# Holy Light
# Noble Sacrifice
# Cleanse By Fire
# Close Wounds
# Divine Fury
# Enemy Of One
# Chivalry
# Prevented 
# Codex
# Weapon Ability
# Skirmish
# Full Draw 
# Repeater
# Target Timer 
# Target Check
# Next Target Timer 
# No Target Timer
# Satchel Timer
# Inventory Timer
# Weight Warning
# Cleanup
# Radar
# Ammunition
# PK Radar

// The COOLDOWNS just need to exist... no further configuration or triggers necessary to run the script! //
        // (though some are very helpful to add to your UI screen and/or colour code, etc.) //
        
        
        # SET THIS TO 1 AND RUN SCRIPT TO RETARGET RUNEBOOK OR LOOTCHEST #

        @setvar! ResetScriptPermanentVariable 0
        
        if ResetScriptPermanentVariable = 1
            unsetvar LootChest
            unsetvar escape_runebook
            unsetvar BardAutoPilot
            overhead "[ SCRIPT VARIABLES RESET... ]" 333
            sysmsg "Please return 'ResetScriptPermanentVariable' to 0 in order to continue!" 153
            stop
        endif
        
        # RETURN ResetScriptPermanentVariable TO 0 IN ORDER TO CONTINUE! #
        
        
    #############################################
    #######        USER VARIABLES:        #######
    #############################################

    
//////////////////////////
//        BARDING:      //
//////////////////////////

@setvar! EnablePeacemaking 1
@setvar! EnableDiscordance 1
@setvar! EnableProvocation 1

@setvar! EnablePeacemakingBuff 1
@setvar! EnableDiscordanceBuff 1
@setvar! EnableProvocationBuff 1 

@setvar! PeacemakingReapply 30000
@setvar! DiscordanceReapply 30000
@setvar! ProvocationReapply 30000


//////////////////////////
//      DEFENSIVE:      //
//////////////////////////

@setvar! EnableHealPotion 1
@setvar! EnableCurePotion 1
@setvar! EnableRefreshPotion 1
@setvar! EnableStrengthPotion 1
@setvar! EnableAgilityPotion 0
@setvar! EnableMagicResistPotion 1

@setvar! EnableHolyLight 1
@setvar! EnableNobleSacrifice 1
@setvar! EnableCleanseByFire 0
@setvar! EnableCloseWounds 1

@setvar! HealPotHPdiff 30
@setvar! HolyLightHPdiff 50
@setvar! NobleSacrificeHPdiff  70
@setvar! CleanseByFireHPdiff 25
@setvar! RefreshPotSPdiff 10

@setvar! EnableShield 1

@setvar! EnableParalyzePouch 1

@setvar! EnablePKradar 1


@setvar! EnableAutoRedRecall 1 
# or 
@setvar! EnableStandYourGround 0


//////////////////////////
//      OFFENSIVE:      //
//////////////////////////

@setvar! EnableDivineFury 1
@setvar! EnableEnemyOfOne 1
@setvar! EnableConsecrateWeapon 0

@setvar! EnableExplosionPots 1

@setvar! EnableWeaponAbility 1 
@setvar! EnableSkirmish 0
# or
@setvar! EnableFullDraw 0
# or
@setvar! EnableRepeater 1


//////////////////////////
//       UTILITY:       //
//////////////////////////

@setvar! EnableLootChest 1
@setvar! EnableAutoCarving 1
@setvar! EnableArrowCleanup 1

@setvar! EnableOverheadMessages 1

@setvar! EnableAmmoWarningMessage 1
@setvar! LowAmmoWarningAmount 15

@setvar! EnableWeightWarningMessage 1
@setvar! GreenWarningDiffWeight 50
@setvar! YellowWarningDiffWeight 20
@setvar! RedWeightLimitDiffWeight 5

# Won't work in dungeons:
@setvar! EnableAutoWeightRecall 1



####  EDIT BELOW THIS LINE AT YOUR OWN RISK!  ####  EDIT BELOW THIS LINE AT YOUR OWN RISK!  ####  EDIT BELOW THIS LINE AT YOUR OWN RISK!  ####  EDIT BELOW THIS LINE AT YOUR OWN RISK!  ####



    #############################################
    #########    SCRIPT STARTS HERE:    #########
    #############################################

if not varexist BardAutoPilot
    overhead "DanStock's Ultimate Bard Auto Pilot Script" 77
    overhead "Last updated Nov 22, 2024" 84
    wait 2500
    overhead "Thank you for trying my barding script!  It appears this may be your first time running it..." 0
    wait 4000
    overhead "IMPT: Please make sure to setup all the required COOLDOWNS and adjust any VARIABLES!" 153
    wait 4500
    overhead "Read the TIPS section at the beginning of the script"
    wait 4000
    overhead "Email any questions/bugs to: dan@danstockman.com" 0
    wait 4000
    setvar BardAutoPilot 1
    sysmsg "Beginning DanStock's Ultimate Bard Auto Pilot script...... " 0
    wait 500
endif 

if not varexist StartFarming
    if EnableOverheadMessages = 1  
        overhead "[ TIME TO FARM! ]" 77
        wait 1000
    endif 
    @setvar! StartFarming 1
endif 

if EnableAutoRedRecall = 1 or EnableAutoRedRecall = 1 and not varexist escape_runebook
    overhead "Please select your escape runebook..." 253
    wait 2000
    overhead "You have enabled Auto Recall (PK or Weight) and must select a charged runebook to continue..." 0 
    setvar escape_runebook
    sysmsg "Does not work with casting (Recall Scrolls in Runebook only - to default location) uness you modify the script." 153
endif

if EnableAutoRedRecall = 1 or EnableAutoRedRecall = 1 and EnableLootChest = 1 and not varexist LootChest
    overhead "Please select a secure container to store your Loot..." 253
    sysmsg "Can be disabled under script variables section." 0
    wait 2000
    overhead "Anything that won't go into a Resource Stockpile, Storage Shelf or Magic Recycler" 0 
    overhead "(ie. Skill Orbs, Treasure Maps, Paragon chest, etc.)"
    setvar LootChest
    sysmsg "Use Razor Organizer Agents 06 - 09 for the Loot Chest and it's contents - organize to your own liking!" 0
endif

while not dead 


        ##########################
        ###   WEAPON CHECKS:   ###
        ##########################

    if not findtype "standing harp|sackbut|bamboo flute|tambourine|drum|lute|lap harp|gemshorn|hurdy gurdy|psaltery|shawm|vielle" self       
        overhead "[ NO INSTRUMENT! ]" 337
        sysmsg "Please acquire a musical instrument before you start this script!" 0
        wait 2000
        stop
    endif 

    if not findtype 'stubnose crossbow|tower guard crossbow|balestra|long bow|bow|recurve bow|composite bow|heavy crossbow|crossbow' self    
        overhead "[ NO WEAPON! ]" 337
        wait 2000
        sysmsg "Please acquire an archery weapon before you start this script!" 0
        stop
    endif

    if not findtype 'stubnose crossbow|tower guard crossbow|balestra|long bow|bow|recurve bow|composite bow|heavy crossbow|crossbow' hand 
        if findtype 'long bow|bow|recurve bow|composite bow|stubnose crossbow|tower guard crossbow|balestra|heavy crossbow|crossbow' backpack as weapon
            for 10
                getlabel weapon WeaponLabel
                wait 500
                if "unidentified" in WeaponLabel
                    @ignore weapon
                    wait 150
                    if findtype 'stubnose crossbow|tower guard crossbow|balestra|long bow|bow|recurve bow|composite bow|heavy crossbow|crossbow' backpack as weapon
                        getlabel weapon WeaponLabel
                    endif
                else 
                    break
                endif 
            endfor            
            dclick weapon
            wait 500
        endif 
    endif

    if EnableShield = 1
        if not findtype 'buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|Order shield|wooden shield|parrying gauche' lefthand
            if findtype 'buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|Order shield|wooden shield|parrying gauche' backpack as shield
                getlabel shield ShieldLabel
                    for 5
                        wait 500
                        if "unidentified" in ShieldLabel
                            @ignore shield
                            wait 150 
                            if findtype 'buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|Order shield|wooden shield|parrying gauche' backpack as shield
                                getlabel shield ShieldLabel
                            endif
                        endif 
                    endfor            
                dclick shield
                wait 500
            endif 
        endif
    endif
    
    @setvar! PreviousTarget lasttarget 
    @setvar! SwitchStance 0 
    @setvar! NeedtoProvoke 1
    @setvar! NeedtoDiscord 1
    @setvar! NeedtoPacify 1
    @setvar! ClosestTarget 0
    @setvar! NextClosestTarget 0
    @setvar! SongReapply 900000
    
        if insysmsg "Captcha successful" and EnableOverheadMessages = 1
            wait 500
            overhead "[ CAPTCHA SUCCESSFUL! ]" 84
        endif

            clearsysmsg            

                if skill 'Tracking' > 50 and not findbuff 'tracking'
                        while not gumpexists 4267467659
                            useskill 'tracking'
                            wait 250
                        endwhile
                            if gumpexists 4267467659
                                while not insysmsg "You will now hunt all hostile players."
                                    gumpresponse 8 4267467659
                                    waitforgump 4267467659 5000
                                endwhile
                                gumpresponse 6 4267467659
                                wait 1000
                                clearsysmsg                     
                            endif
                    gumpclose 4267467659
                    if EnableOverheadMessages = 1      
                        overhead "[ TRACKING ENABLED! ]" 149
                    endif
                    wait 1000
                endif 
                
                if warmode
                    cooldown "Target Timer" 0
                    hotkey 'Next Murderer Player Target'
                    wait 500
                        if insysmsg "No one matching that was found"   
                            cooldown "Pacified" 0
                            cooldown "Discorded" 0
                            cooldown "Provoked" 0
                            if EnableOverheadMessages = 1 
                                overhead "[ NO NEARBY REDS... ]" 37
                            endif
                            wait 500
                            hotkey 'Toggle Peace Only'
                            replay
                        elseif EnableStandYourGround = 1
                            @setvar! MurdererTarget lasttarget
                            wait 500
                            cooldown "Target Timer" 0

                            while not dead MurdererTarget                        
                                if noto MurdererTarget = "Murderer" and find MurdererTarget ground -1 -1 12
                                
                                    if not cooldown "Target Timer"
                                        overhead "[ STANDING GROUND!! ]" 2114
                                        cooldown "Target Timer" 3500 
                                    endif  
                                    
                                    if paralyzed and EnableParalyzePouch = 1
                                        if findtype "pouch" self
                                            yell "[pouch"
                                        else
                                            if EnableOverheadMessages = 1 
                                                overhead "[ NO MORE POUCHES! ]" 337
                                            endif
                                        endif           
                                    endif

                                    if skill 'Healing' > 38
                                        if not bandaging 
                                            if hp < maxhp or poisoned or findbuff "bleed" or findbuff "disease" 
                                                hotkey "Bandage Self"                                       
                                            endif 
                                        endif
                                    endif          
                                    
                                    if not cooldown "Weapon Ability" and not cooldown "Skirmish"
                                        yell "[WeaponAbility1" 
                                        wait 250
                                        if insysmsg "You cannot"
                                            cooldown "Weapon Ability" 5000
                                        else     
                                            overhead "[ SKIRMISH! ]" 6
                                            cooldown "Weapon Ability" 61000
                                            cooldown "Skirmish" 15000
                                        endif   
                                    endif 
                                    
                                    attack MurdererTarget
                                    wait 500
                                     
                                    if not findtype 'stubnose crossbow|balestra|crossbow' hand
                                        if findtype 'stubnose crossbow|balestra|crossbow' backpack as fastweapon
                                            dclick fast weapon
                                            wait 500
                                        endif 
                                    endif          

                                    if not findtype 'heater shield|metal shield|Chaos shield|bone shield|bronze shield|buckler |kite shield|Order shield|wooden shield|parrying gauche' lefthand
                                        if findtype 'heater shield|metal shield|Chaos shield|heater shield|bone shield|bronze shield|buckler |kite shield|Order shield|wooden shield|parrying gauche' backpack as shield
                                            dclick shield
                                            wait 500
                                        endif
                                    endif 
                                    
                                    if not cooldown "Provocation" and not cooldown "Musicianship" and not dead ClosestTarget and find ClosestTarget ground -1 -1 10
                                        skill "Provocation"
                                        wft 1000
                                        target ClosestTarget
                                        wft 1000                        
                                        target MurdererTarget
                                        wait 500 
                                            if insysmsg 'You play successfully, provoking'
                                                cooldown "Musicianship" 5500
                                                cooldown "Provocation" 11000
                                                say " :) " 
                                            elseif insysmsg 'You fail to incite'
                                                overhead '[ PROVO FAIL! ]' 153
                                                cooldown "Provocation" 5000
                                            elseif insysmsg 'Target cannot be seen'
                                                overhead "[ TARGET CANNOT BE SEEN... ]" 337
                                                cooldown "Provocation" 1000
                                            elseif insysmsg 'That is too far away.'
                                                overhead '[ TOO FAR AWAY! ]' 43
                                                cooldown "Provocation" 1000 
                                            elseif insysmsg 'The creatures you are trying to provoke are too far away from each other for your music to have an effect.'
                                                overhead '[ TOO FAR APART! ]' 153 ClosestTarget
                                                overhead '[ TOO FAR APART! ]' 153 MurdererTarget
                                                cooldown "Provocation" 1000
                                            elseif insysmsg 'tell someone to attack themselves!'
                                                overhead '[ SELF TARGETING FAIL... ]' 337
                                            else
                                                say " :( " 
                                            endif 
                                    endif 

                                    if diffhits > 35 and not cooldown "Healing Potion"
                                        if findtype "Yellow Potion" self as healpot
                                            dclick healpot
                                            wait 500
                                            cooldown "Healing Potion" 11000
                                                if insysmsg "Potion satchel used"
                                                    if EnableOverheadMessages = 1 
                                                        overhead "[ FREE HEAL POTION! ]" 253
                                                    endif
                                                    clearsysmsg
                                                else 
                                                    if EnableOverheadMessages = 1 
                                                        overhead '[ HEAL POTION... ]' 253
                                                    endif
                                                    clearsysmsg
                                                endif
                                        else 
                                            if not cooldown "Inventory Timer" 
                                                if EnableOverheadMessages = 1 
                                                    overhead '[ NO HEAL POTS! ]' 337
                                                endif
                                                cooldown "Healing Potion" 30000
                                            endif
                                        endif
                                        wait 500 
                                    endif

                                    if poisoned and not cooldown "Cure Potion"
                                        if findtype "Orange Potion" self as curepot
                                            dclick curepot
                                            wait 500
                                            cooldown "Cure Potion" 11000
                                                if insysmsg "Potion satchel used"
                                                    if EnableOverheadMessages = 1 
                                                        overhead "[ FREE CURE POTION! ]" 44
                                                    endif
                                                    clearsysmsg
                                                else 
                                                    if EnableOverheadMessages = 1 
                                                        overhead '[ CURE POTION... ]' 44
                                                    endif
                                                    clearsysmsg
                                                endif
                                        else
                                            if not cooldown "Inventory Timer" 
                                                if EnableOverheadMessages = 1 
                                                    overhead '[ NO CURE POTS! ]' 337
                                                endif
                                                cooldown "Cure Potion" 30000
                                            endif
                                        endif
                                        wait 500 
                                    endif

                                    if stam < maxstam and not cooldown "Refresh Potion"
                                        if findtype "Red Potion" self as refreshpot
                                            dclick refreshpot
                                            cooldown "Refresh Potion" 11000
                                            wait 500
                                                if insysmsg "Potion satchel used"
                                                    if EnableOverheadMessages = 1 
                                                        overhead "[ FREE REFRESH POTION! ]" 34
                                                    endif
                                                    clearsysmsg
                                                else 
                                                    if EnableOverheadMessages = 1 
                                                        overhead '[ REFRESH POTION... ]' 34
                                                    endif
                                                    clearsysmsg
                                                endif
                                        else 
                                            if not cooldown "Inventory Timer" 
                                                if EnableOverheadMessages = 1 
                                                    overhead '[ NO REFRESH POTS! ]' 337
                                                endif
                                                cooldown "Refresh Potion" 30000
                                            endif
                                        endif
                                        wait 500 
                                    endif  
                                    
                                    wait 1500
                                    
                                    if findtype "Purple Potion" self as Molotov
                                        getlabel Molotov descMolotov
                                        if "next usable in 15" in desc
                                            @setvar! purplePotionCD 15000 
                                        elseif "next usable in 14" in descMolotov
                                            @setvar! purplePotionCD 14000
                                        elseif "next usable in 13" in descMolotov
                                            @setvar! purplePotionCD 13000
                                        elseif "next usable in 12" in descMolotov
                                            @setvar! purplePotionCD 12000
                                        elseif "next usable in 11" in descMolotov
                                            @setvar! purplePotionCD 11000
                                        elseif "next usable in 10" in descMolotov
                                            @setvar! purplePotionCD 10000
                                        elseif "next usable in 9" in descMolotov
                                            @setvar! purplePotionCD 9000
                                        elseif "next usable in 8" in descMolotov
                                            @setvar! purplePotionCD 8000
                                        elseif "next usable in 7" in descMolotov
                                            @setvar! purplePotionCD 7000
                                        elseif "next usable in 6" in descMolotov
                                            @setvar! purplePotionCD 6000
                                        elseif "next usable in 5" in descMolotov
                                            @setvar! purplePotionCD 5000
                                        elseif "next usable in 4" in descMolotov
                                            @setvar! purplePotionCD 4000
                                        elseif "next usable in 3" in descMolotov
                                            @setvar! purplePotionCD 3000
                                        elseif "next usable in 2" in descMolotov
                                            @setvar! purplePotionCD 2000
                                        elseif "next usable in 1" in descMolotov
                                            @setvar! purplePotionCD 1000
                                        else 
                                            @setvar! purplePotionCD 0
                                        endif
                                       
                                        cooldown "Purple Potion" purplePotionCD

                                        if find MurdererTarget ground -1 -1 10 and not cooldown "Purple Potion"
                                            dclick Molotov
                                            cooldown "Ammunition" 4500
                                            while cooldown "Ammunition"
                                   
                                                attack MurdererTarget
                                                
                                                if not cooldown "Provocation" and not cooldown "Musicianship" and not dead ClosestTarget and find ClosestTarget ground -1 -1 10
                                                    skill "Provocation"
                                                    wft 500
                                                    target ClosestTarget
                                                    wft 500                        
                                                    target MurdererTarget
                                                    wait 150 
                                                        if insysmsg 'You play successfully, provoking'
                                                            cooldown "Musicianship" 5500
                                                            cooldown "Provocation" 11000
                                                            say " :) " 
                                                        elseif insysmsg 'You fail to incite'
                                                            overhead '[ PROVO FAIL! ]' 153
                                                            cooldown "Provocation" 5000
                                                        elseif insysmsg 'Target cannot be seen'
                                                            overhead "[ TARGET CANNOT BE SEEN... ]" 337
                                                            cooldown "Provocation" 1000
                                                        elseif insysmsg 'That is too far away.'
                                                            overhead '[ TOO FAR AWAY! ]' 43
                                                            cooldown "Provocation" 1000 
                                                        elseif insysmsg 'The creatures you are trying to provoke are too far away from each other for your music to have an effect.'
                                                            overhead '[ TOO FAR APART! ]' 153 ClosestTarget
                                                            overhead '[ TOO FAR APART! ]' 153 MurdererTarget
                                                            cooldown "Provocation" 1000
                                                        elseif insysmsg 'tell someone to attack themselves!'
                                                            overhead '[ SELF TARGETING FAIL... ]' 337
                                                        else
                                                            say " :( " 
                                                        endif 
                                                endif  

                                                if diffhits > 35 and not cooldown "Healing Potion"
                                                    if findtype "Yellow Potion" self as healpot
                                                        dclick healpot
                                                        cooldown "Healing Potion" 11500
                                                            if insysmsg "Potion satchel used"
                                                                if EnableOverheadMessages = 1 
                                                                    overhead "[ FREE HEAL POTION! ]" 253
                                                                endif
                                                                clearsysmsg
                                                            else 
                                                                if EnableOverheadMessages = 1 
                                                                    overhead '[ HEAL POTION... ]' 253
                                                                endif
                                                                clearsysmsg
                                                            endif
                                                    else 
                                                        if not cooldown "Inventory Timer" 
                                                            if EnableOverheadMessages = 1 
                                                                overhead '[ NO HEAL POTS! ]' 337
                                                            endif
                                                            cooldown "Healing Potion" 30000
                                                        endif
                                                    endif
                                                endif

                                                if poisoned and not cooldown "Cure Potion"
                                                    if findtype "Orange Potion" self as curepot
                                                    dclick curepot
                                                cooldown "Cure Potion" 11500
                                                            if insysmsg "Potion satchel used"
                                                                if EnableOverheadMessages = 1 
                                                                    overhead "[ FREE CURE POTION! ]" 44
                                                                endif
                                                                clearsysmsg
                                                            else 
                                                                if EnableOverheadMessages = 1 
                                                                    overhead '[ CURE POTION... ]' 44
                                                                endif
                                                                clearsysmsg
                                                            endif
                                                    else
                                                        if not cooldown "Inventory Timer" 
                                                            if EnableOverheadMessages = 1 
                                                                overhead '[ NO CURE POTS! ]' 337
                                                            endif
                                                            cooldown "Cure Potion" 30000
                                                        endif
                                                    endif
                                                endif

                                                if stam < maxstam and not cooldown "Refresh Potion"
                                                    if findtype "Red Potion" self as refreshpot
                                                        dclick refreshpot
                                                        cooldown "Refresh Potion" 11500
                                                            if insysmsg "Potion satchel used"
                                                                if EnableOverheadMessages = 1 
                                                                    overhead "[ FREE REFRESH POTION! ]" 34
                                                                endif
                                                                clearsysmsg
                                                            else 
                                                                if EnableOverheadMessages = 1 
                                                                    overhead '[ REFRESH POTION... ]' 34
                                                                endif
                                                                clearsysmsg
                                                            endif
                                                    else 
                                                        if not cooldown "Inventory Timer" 
                                                            if EnableOverheadMessages = 1 
                                                                overhead '[ NO REFRESH POTS! ]' 337
                                                            endif
                                                            cooldown "Refresh Potion" 30000
                                                        endif
                                                    endif
                                                endif
                                            endwhile
                                            target MurdererTarget
                                            wait 250  
                                                if insysmsg "Potion satchel used"
                                                    overhead "[ FREE EXPLOSION POT! ]" 419
                                                    clearsysmsg
                                                else 
                                                    overhead '[ EXPLOSION POT! ]' 419
                                                endif
                                                    clearsysmsg    
                                                    cooldown "Purple Potion" 15000 
                                        endif
                                    else
                                        if EnableOverheadMessages = 1 
                                            overhead "[ NO EXPLOSION POTS! ]" 337
                                        endif
                                        cooldown "Purple Potion" 30000
                                    endif    
                                endif
                            endwhile
                            

                            if EnableOverheadMessages = 1 
                                overhead "[ RED TARGET LOST... ]" 37
                            endif
                            
                        elseif EnableAutoRedRecall = 1
                                                    
                            if targetexists 
                                hotkey 'Cancel Current Target'
                            endif

                            clearsysmsg 

                            if not varexist escape_runebook
                                overhead "Select your escape runebook..." 253
                                setvar escape_runebook
                                wait 2000
                                replay
                            endif
    
                                overhead "[ AUTO RED RECALL! ]" 37
                                wait 150
                                dclick escape_runebook
                                waitforgump 1551740969
                                gumpresponse 2
                                wait 500
                                
                                    if insysmsg 'Your concentration is disturbed'
                                        wait 1000
                                        for 5
                                            clearsysmsg
                                            overhead '[ INTERUPTED! ]' 153
                                            wait 500
                                            dclick escape_runebook
                                            waitforgump 1551740969 
                                            gumpresponse 2
                                            wait 500
                                            if insysmsg 'Your concentration is disturbed'
                                                overhead 'Fuck off!' 6
                                                wait 250
                                            else 
                                                break
                                            endif 
                                        endfor
                                    endif

                                    wait 2000
                                    
                                    if not findtype 'stubnose crossbow|tower guard crossbow|balestra|long bow|bow|recurve bow|composite bow|heavy crossbow|crossbow' hand 
                                        if findtype 'long bow|bow|recurve bow|composite bow|stubnose crossbow|tower guard crossbow|balestra|heavy crossbow|crossbow' backpack as weapon
                                        for 5
                                                getlabel weapon WeaponLabel
                                                wait 500
                                                if "unidentified" in WeaponLabel
                                                    @ignore weapon
                                                    wait 150
                                                    if findtype 'stubnose crossbow|tower guard crossbow|balestra|long bow|bow|recurve bow|composite bow|heavy crossbow|crossbow' backpack as weapon
                                                        getlabel weapon WeaponLabel
                                                    endif
                                                else 
                                                    break
                                                endif 
                                            endfor            
                                            dclick weapon
                                            wait 500
                                        endif 
                                    endif

                                    if EnableShield = 1
                                        if not findtype 'buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|Order shield|wooden shield|parrying gauche' lefthand
                                            if findtype 'buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|Order shield|wooden shield|parrying gauche' backpack as shield
                                                for 5
                                                    getlabel shield ShieldLabel
                                                    wait 500
                                                    if "unidentified" in ShieldLabel
                                                        @ignore shield
                                                        wait 150 
                                                        if findtype 'buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|Order shield|wooden shield|parrying gauche' backpack as shield
                                                            getlabel shield ShieldLabel
                                                        endif
                                                    else 
                                                        break
                                                    endif 
                                                endfor            
                                                dclick shield
                                                wait 500
                                            endif 
                                        endif
                                    endif

                                        wait 500
                                        useskill "Hiding"
                                        
                                        
                                    if findtype "bank deposit safe" ground -1 -1 2 as safe
                                        while findtype "gold coin" backpack as gold
                                            lift gold 60000
                                            overhead "[ DEPOSIT GOLD... ]" 149
                                            drop safe -1 -1 -1
                                            wait 1500
                                        endwhile
                                        while findtype 2539 backpack as dubs
                                            lift dubs 60000
                                            drop safe -1 -1 -1
                                            overhead "[ DEPOSIT DUBS... ]" 149
                                            wait 1500
                                        endwhile
                                    else
                                        overhead "[ NO BANK SAFE FOUND ]" 337
                                    endif
                                    wait 500

                                    if findtype "black market goods|seed of renewal|dirt patch|bag of seeds|void orb|rune|scroll of calling|bottle|dye bottle|map|research materials" self
                                        dclick LootChest
                                        wait 1000
                                        overhead "[ STASHING LOOT... ]" 69
                                        hotkey "Organizer Agent-06"
                                        wait 250
                                        hotkey "Organizer Agent-07"
                                        wait 250
                                        hotkey "Organizer Agent-08"
                                        wait 250
                                        hotkey "Organizer Agent-09"
                                        wait 1500
                                    endif 

                                    if findtype "resource container" ground -1 -1 2 as resource
                                        menu resource 0
                                        wft 500
                                        target self
                                        overhead "[ PILING RESOURCES... ]" 84
                                        wait 1500
                                    else
                                        overhead "[ NO RESOURCE STOCKPILE FOUND ]" 337
                                    endif
                                    wait 500

                                    if findtype "storage shelf" ground -1 -1 2 as shelf
                                        menu shelf 0
                                        wft 500
                                        target self
                                        overhead "[ UNLOADING... ]" 2114
                                        wait 1500
                                        gumpclose 3232825965
                                    else
                                        overhead "[ NO STORAGE SHELF FOUND ]" 337
                                    endif       
                                    
                                    if findtype "storage shelf" ground -1 -1 2 as shelf
                                        menu shelf 1
                                        wft 500
                                        target self   
                                        overhead "[ RESUPPLYING... ]" 93
                                        wait 1500
                                    endif
                                    
                                    wait 500
                                    
                                    if findtype "repair bench" ground -1 -1 3 as RepairBench
                                        clearsysmsg 
                                        dclick RepairBench
                                        wait 1000
                                        if insysmsg "You do not have any items equipped or in your backpack in need of repairs."
                                            overhead "[ NOTHING TO REPAIR! ]" 0
                                        else
                                            settimer RepairTimer 0
                                        while timer RepairTimer <= 5000 
                                            if insysmsg "Repair"
                                                break
                                            endif
                                        endwhile
                                        overhead "[ ITEMS REPAIRED! ]" 0
                                        overhead "Repair took: {{RepairTimer}}ms" 149
                                        removetimer RepairTimer
                                        endif
                                    else
                                        overhead "[ NO REPAIR BENCH FOUND ]" 337
                                    endif

                                    if findtype "ornate elven chest|magic item recycler" ground -1 -1 2 as recycler
                                        menu recycler 1
                                        wait 1000
                                        if insysmsg "0 recyclable"
                                            overhead "[ NO MAGIC LOOT! ]" 6
                                        else
                                            overhead "[ RECYCLING MAGIC LOOT... ]" 6
                                            wait 200
                                        endif
                                    else
                                        overhead "[ NO MAGIC ITEM RECYCLER FOUND ]" 337
                                    endif

                                    wait 1000
                                    hotkey "Organizer Agent-04"
                                    overhead "[ SCRIPT COMPLETE! ]" 69
                                stop                     
                        endif
                endif        
                
                if paralyzed and EnableParalyzePouch = 1
                    if findtype "pouch" self
                        yell "[pouch"
                        hotkey 'Toggle War Only'
                        replay
                    else
                        if EnableOverheadMessages = 1   
                            overhead "[ NO MORE POUCHES! ]" 337
                        endif
                    endif           
                endif

                if EnablePKradar = 1 and not cooldown "PK Radar" 
                    hotkey 'Next Murderer Player Target'
                    wait 500
                        if insysmsg "No one matching that was found"   
                            cooldown "PK Radar" 2000
                        else
                            overhead "[ !! RED ALERT !! ]" 37
                            hotkey 'Toggle War Only'
                            replay
                        endif 
                endif 
                
                if EnableHolyLight = 1            
                    if diffhits > HolyLightHPdiff and skill "Chivalry" >= 95 and not cooldown "Holy Light" and not cooldown "Prevented" and not cooldown "Chivalry"
                        clearsysmsg
                        yell "[HolyLight"
                        wait 250
                        if insysmsg "You do not have enough holy"
                            cooldown "Prevented" 5000
                            clearsysmsg                    
                        else   
                            if EnableOverheadMessages = 1   
                                overhead "[ HOLY LIGHT! ]" 254
                            endif
                            cooldown "Holy Light" 31000
                            cooldown "Chivalry" 500
                        endif
                        wait 500 
                    endif            
                endif
                
                if EnableHealPotion = 1
                    if diffhits > HealPotHPdiff and not cooldown "Healing Potion"
                        if findtype "Yellow Potion" self as healpot
                            dclick healpot
                            wait 500
                            cooldown "Healing Potion" 11000
                                if insysmsg "Potion satchel used"
                                    if EnableOverheadMessages = 1   
                                        overhead "[ FREE HEAL POTION! ]" 253
                                    endif
                                    clearsysmsg
                                else 
                                    if EnableOverheadMessages = 1   
                                        overhead '[ HEAL POTION... ]' 253
                                    endif
                                    clearsysmsg
                                endif
                        else 
                            if not cooldown "Inventory Timer" 
                                if EnableOverheadMessages = 1   
                                    overhead '[ NO HEAL POTS! ]' 337
                                endif
                                cooldown "Inventory Timer" 6000
                            endif
                        endif
                    endif
                endif 

                if EnableNobleSacrifice = 1            
                    if diffhits > NobleSacrificeHPdiff and skill "Chivalry" >= 80 and not cooldown "Noble Sacrifice" and not cooldown "Prevented" and not cooldown "Chivalry" 
                        clearsysmsg 
                        yell "[NobleSacrifice"
                        wait 250
                        if insysmsg "You do not have enough holy"
                            cooldown "Prevented" 5000
                            clearsysmsg                    
                        else
                            wft 1000
                            target 'self'
                            if EnableOverheadMessages = 1   
                                overhead "[ NOBLE SACRIFICE! ]" 155
                            endif
                            cooldown "Noble Sacrifice" 31000
                            cooldown "Chivalry" 500
                        endif
                        wait 500 
                    endif            
                endif
                
                if skill 'Healing' > 38
                    if not bandaging 
                        if hp < maxhp or poisoned or findbuff "bleed" or findbuff "disease" 
                            if EnableOverheadMessages = 1   
                                overhead '[ BANDAGING...]' 88
                            endif
                            hotkey "Bandage Self"                                     
                        elseif counttype 'clean bandage%s%' < 10 and not cooldown "Inventory Timer"
                            if EnableOverheadMessages = 1   
                                overhead "[ BANDAGES LOW! ]" 339
                            endif
                            cooldown "Inventory Timer" 6000
                        elseif counttype 'clean bandage%s%' = 0 and not cooldown "Inventory Timer"
                            if EnableOverheadMessages = 1   
                                overhead "[ NO BANDAGES! ]" 337
                            endif
                            cooldown "Inventory Timer" 6000
                        endif 
                    endif
                endif

                if EnableCloseWounds = 1            
                    if findbuff "bleed" or findbuff "disease"
                        if skill "chivalry" >= 70 and not cooldown "Close Wounds" and not cooldown "Chivalry" and not cooldown "Prevented"
                            clearsysmsg 
                            yell "[CloseWounds"
                            wait 250
                            if insysmsg "You do not have enough holy"
                                cooldown "Prevented" 5000
                                clearsysmsg      
                            else
                                cooldown "Close Wounds" 31000
                                cooldown "Chivalry" 500
                                if EnableOverheadMessages = 1  
                                    overhead "[ CLOSE WOUNDS! ]" 48 
                                endif                 
                            endif
                            wait 500 
                        endif
                    endif            
                endif

                if EnableCurePotion = 1
                    if poisoned and not cooldown "Cure Potion"
                        if findtype "Orange Potion" self as curepot
                            dclick curepot                        
                            wait 500
                            cooldown "Cure Potion" 11000
                                if insysmsg "Potion satchel used"
                                    if EnableOverheadMessages = 1  
                                        overhead "[ FREE CURE POTION! ]" 44
                                    endif
                                    clearsysmsg
                                else 
                                    if EnableOverheadMessages = 1  
                                        overhead '[ CURE POTION... ]' 44
                                    endif
                                    clearsysmsg
                                endif
                        else
                            if not cooldown "Inventory Timer" 
                                if EnableOverheadMessages = 1  
                                    overhead '[ NO CURE POTS! ]' 337
                                endif
                                cooldown "Inventory Timer" 6000
                            endif
                        endif
                        wait 500 
                    endif
                endif 
                         
                if EnableCleanseByFire = 1
                    if diffhits > CleanseByFireHPdiff and poisoned and not cooldown "Cleanse By Fire" and not cooldown "Chivalry" and not cooldown "Prevented"
                        clearsysmsg 
                        yell "[CleanseByFire"
                        wait 250
                        if insysmsg "You do not have enough holy"
                            cooldown "Prevented" 5000
                            clearsysmsg      
                        else
                            cooldown "Cleanse By Fire" 31000
                            cooldown "Chivalry" 500
                            if EnableOverheadMessages = 1  
                                overhead "[ CLEANSE BY FIRE! ]" 43      
                            endif        
                        endif
                        wait 250 
                    endif            
                endif

                if EnableRefreshPotion = 1
                    if diffstam >= RefreshPotSPdiff and not cooldown "Refresh Potion"
                        if findtype "Red Potion" self as refreshpot
                            dclick refreshpot
                            cooldown "Refresh Potion" 11000
                            wait 250
                                if insysmsg "Potion satchel used"
                                    if EnableOverheadMessages = 1  
                                        overhead "[ FREE REFRESH POTION! ]" 34
                                    endif 
                                    clearsysmsg
                                else 
                                    if EnableOverheadMessages = 1  
                                        overhead '[ REFRESH POTION... ]' 34
                                    endif
                                    clearsysmsg
                                endif
                        else 
                            if not cooldown "Inventory Timer" 
                                if EnableOverheadMessages = 1  
                                    overhead '[ NO REFRESH POTS! ]' 337
                                endif 
                                cooldown "Inventory Timer" 6000
                            endif
                        endif
                        wait 250 
                    endif
                endif 

    hotkey 'Target Closest Grey Monster'
    wait 500


        #########################
        ###  NO TARGET LOOP:  ###
        #########################

            if insysmsg "No one matching that was found on your screen"      
            
                if not cooldown "No Target Timer"
                    overhead "[ NO TARGET... ]" 6
                    cooldown "No Target Timer" 3500                
                endif     
             
                if findtype "Ginseng|Garlic|Blood Moss|Sulfurous Ash|Mandrake Root%s%|Nightshade|Black Pearl%s%|Spider's Silk" backpack
                    if not cooldown "Satchel Timer" and findtype "reagent satchel" self as MyWizardBag
                        menu MyWizardBag 0
                        wait 500
                        cooldown "Satchel Timer" 15000
                    endif
                endif
         
                if findtype "arrow|crossbow bolt" backpack
                    if not cooldown "Satchel Timer" and findtype "quiver" self as MyQuiver
                        menu MyQuiver 0
                        wait 500
                        cooldown "Satchel Timer" 15000
                    endif
                endif 

                if findtype "Yellow Potion|Orange Potion|Red Potion|White Potion|Blue Potion|Black Potion|" backpack
                    if not cooldown "Satchel Timer" and findtype 31262 self as MyPotBag
                        menu MyPotBag 0
                        wait 500
                        cooldown "Satchel Timer" 15000
                    endif
                endif 

                if findtype 'Elven SpellBlade' backpack and EnableAutoCarving = 1
                    if findtype "corpse" ground -1 -1 2 as deadbody
                        wait 500
                        dclicktype "Elven Spellblade"
                        wft 1000
                        target 'self'
                        if EnableOverheadMessages = 1  
                            overhead "[ SKINNING... ]" 339
                        endif
                        wait 500
                        @ignore deadbody
                    endif
                else
                    if not cooldown "Inventory Timer"
                        if EnableOverheadMessages = 1  
                            overhead "[ NO SKINNING KNIFE! ]" 337
                        endif
                        cooldown "Inventory Timer" 6000
                    endif
                endif
                           
                if not findbuff 'food satisfaction' and findtype "tray" self
                    if findtype "tray" backpack as Food
                        if EnableOverheadMessages = 1  
                            overhead "[ EATING FOOD... ]" 88
                        endif
                        dclick Food
                        wait 1000
                    endif
                endif 
                
                if EnablePKradar = 1 and not cooldown "PK Radar" 
                    hotkey 'Next Murderer Player Target'
                    wait 500
                        if insysmsg "No one matching that was found"   
                            cooldown "PK Radar" 2000
                        else
                            overhead "[ !! RED ALERT !! ]" 37
                            hotkey 'Toggle War Only'
                            replay 
                        endif 
                endif 

                if warmode 
                    hotkey 'Next Murderer Player Target'
                    wait 500
                    if insysmsg "No one matching that was found"   
                        overhead "[ NO NEARBY REDS... ]" 37
                        hotkey 'Toggle Peace Only" 
                        wait 500 
                    else
                        overhead "[ !! RED ALERT !! ]" 37
                        replay 
                    endif 
                endif 
                
                if paralyzed and EnableParalyzePouch = 1
                    if findtype "pouch" self
                        yell "[pouch"
                        hotkey 'Toggle War Only'
                        replay
                    else
                        if EnableOverheadMessages = 1  
                            overhead "[ NO MORE POUCHES! ]" 337
                        endif
                    endif           
                endif

                if EnableWeightWarningMessage = 1
                    if diffweight < GreenWarningDiffWeight and diffweight > YellowWarningDiffWeight and not cooldown "Weight Warning"
                        overhead "[ WEIGHT WARNING... ]" 77
                        cooldown "Weight Warning" 6000
                        elseif diffweight < YellowWarningDiffWeight and diffweight > RedWeightLimitDiffWeight and not cooldown "Weight Warning"
                        overhead "[ WEIGHT WARNING! ]" 153
                        cooldown "Weight Warning" 6000
                    elseif diffweight < RedWeightLimitDiffWeight and not cooldown "Weight Warning"
                        overhead "-[ WEIGHT LIMIT REACHED!! ]-" 37
                        if EnableAutoWeightRecall = 1 and not find ClosestTarget ground -1 -1 6
                            
                            if targetexists 
                                hotkey 'Cancel Current Target'
                            endif

                            clearsysmsg 

                            if not varexist escape_runebook
                                overhead "Select your escape runebook..." 253
                                setvar escape_runebook
                                wait 2000
                                replay
                            endif
    
                                overhead "[ AUTO RECALL! ]" 84
                                wait 150
                                dclick escape_runebook
                                waitforgump 1551740969
                                gumpresponse 2
                                wait 500
                                
                                    if insysmsg 'Your concentration is disturbed'
                                        wait 1000
                                        for 5
                                            clearsysmsg
                                            overhead '[ INTERUPTED! ]' 153
                                            wait 500
                                            dclick escape_runebook
                                            waitforgump 1551740969 
                                            gumpresponse 2
                                            wait 500
                                            if insysmsg 'Your concentration is disturbed'
                                                overhead 'Fuck off!' 6
                                                wait 250
                                            else 
                                                break
                                            endif 
                                        endfor
                                    endif

                                    wait 2000
                                    
                                    if not findtype 'stubnose crossbow|tower guard crossbow|balestra|long bow|bow|recurve bow|composite bow|heavy crossbow|crossbow' hand 
                                        if findtype 'long bow|bow|recurve bow|composite bow|stubnose crossbow|tower guard crossbow|balestra|heavy crossbow|crossbow' backpack as weapon
                                        for 5
                                                getlabel weapon WeaponLabel
                                                wait 500
                                                if "unidentified" in WeaponLabel
                                                    @ignore weapon
                                                    wait 150
                                                    if findtype 'stubnose crossbow|tower guard crossbow|balestra|long bow|bow|recurve bow|composite bow|heavy crossbow|crossbow' backpack as weapon
                                                        getlabel weapon WeaponLabel
                                                    endif
                                                else 
                                                    break
                                                endif 
                                            endfor            
                                            dclick weapon
                                            wait 500
                                        endif 
                                    endif

                                    if EnableShield = 1
                                        if not findtype 'buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|Order shield|wooden shield|parrying gauche' lefthand
                                            if findtype 'buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|Order shield|wooden shield|parrying gauche' backpack as shield
                                                for 5
                                                    getlabel shield ShieldLabel
                                                    wait 500
                                                    if "unidentified" in ShieldLabel
                                                        @ignore shield
                                                        wait 150 
                                                        if findtype 'buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|Order shield|wooden shield|parrying gauche' backpack as shield
                                                            getlabel shield ShieldLabel
                                                        endif
                                                    else 
                                                        break
                                                    endif 
                                                endfor            
                                                dclick shield
                                                wait 500
                                            endif 
                                        endif
                                    endif

                                        wait 500
                                        useskill "Hiding"
                                        
                                        
                                    if findtype "bank deposit safe" ground -1 -1 2 as safe
                                        while findtype "gold coin" backpack as gold
                                            lift gold 60000
                                            overhead "[ DEPOSIT GOLD... ]" 149
                                            drop safe -1 -1 -1
                                            wait 1500
                                        endwhile
                                        while findtype 2539 backpack as dubs
                                            lift dubs 60000
                                            drop safe -1 -1 -1
                                            overhead "[ DEPOSIT DUBS... ]" 149
                                            wait 1500
                                        endwhile
                                    else
                                        overhead "[ NO BANK SAFE FOUND ]" 337
                                    endif
                                    wait 500

                                    if findtype "black market goods|seed of renewal|dirt patch|bag of seeds|void orb|rune|scroll of calling|bottle|dye bottle|map|research materials" self
                                        dclick 0x4F7A8106
                                        wait 1000
                                        overhead "[ STASHING LOOT... ]*" 69
                                        hotkey "Organizer Agent-06"
                                        wait 250
                                        hotkey "Organizer Agent-07"
                                        wait 250
                                        hotkey "Organizer Agent-08"
                                        wait 250
                                        hotkey "Organizer Agent-09"
                                        wait 1500
                                    endif 

                                    if findtype "resource container" ground -1 -1 2 as resource
                                        menu resource 0
                                        wft 500
                                        target self
                                        overhead "[ PILING RESOURCES... ]" 84
                                        wait 1500
                                    else
                                        overhead "[ NO RESOURCE STOCKPILE FOUND ]" 337
                                    endif
                                    wait 500

                                    if findtype "storage shelf" ground -1 -1 2 as shelf
                                        menu shelf 0
                                        wft 500
                                        target self
                                        overhead "[ UNLOADING... ]" 2114
                                        wait 1500
                                        gumpclose 3232825965
                                    else
                                        overhead "[ NO STORAGE SHELF FOUND ]" 337
                                    endif       
                                    
                                    if findtype "storage shelf" ground -1 -1 2 as shelf
                                        menu shelf 1
                                        wft 500
                                        target self   
                                        overhead "[ RESUPPLYING... ]" 93
                                        wait 1500
                                    endif
                                    
                                    wait 500
                                    
                                    if findtype "repair bench" ground -1 -1 3 as RepairBench
                                        clearsysmsg 
                                        dclick RepairBench
                                        wait 1000
                                        if insysmsg "You do not have any items equipped or in your backpack in need of repairs."
                                            overhead "[ NOTHING TO REPAIR! ]" 0
                                        else
                                            settimer RepairTimer 0
                                        while timer RepairTimer <= 5000 
                                            if insysmsg "Repair"
                                                break
                                            endif
                                        endwhile
                                        overhead "[ ITEMS REPAIRED! ]" 0
                                        overhead "Repair took: {{RepairTimer}}ms" 149
                                        removetimer RepairTimer
                                        endif
                                    else
                                        overhead "[ NO REPAIR BENCH FOUND ]" 337
                                    endif

                                    if findtype "ornate elven chest|magic item recycler" ground -1 -1 2 as recycler
                                        menu recycler 1
                                        wait 1000
                                        if insysmsg "0 recyclable"
                                            overhead "[ NO MAGIC LOOT! ]" 6
                                        else
                                            overhead "[ RECYCLING MAGIC LOOT... ]" 6
                                            wait 200
                                        endif
                                    else
                                        overhead "[ NO MAGIC ITEM RECYCLER FOUND ]" 337
                                    endif

                                    wait 1000
                                    hotkey "Organizer Agent-04"
                                    overhead "[ SCRIPT COMPLETE! ]" 69
                                stop    
                        elseif EnableAutoWeightRecall = 1 and find ClosestTarget ground -1 -1 6
                            if not cooldown "Cleanup"
                                overhead "[ WAITING TO RECALL... ]" 149
                                cooldown "Cleanup" 3500
                            endif 
                            wait 500
                        else 
                            overhead "[ OVERWEIGHT! ]" 
                            sysmsg "Time to head home and unload our loot!" 0   
                            cooldown "Weight Timer" 5000
                        endif 
                    endif
                endif  

                if EnableAmmoWarningMessage = 1
                    if findtype 'stubnose crossbow|tower guard crossbow|balestra|heavy crossbow|crossbow' hand
                        # BOLTS
                        @setvar! AMMO 1

                    elseif findtype 'long bow|bow|recurve bow|composite bow' hand
                        # ARROWS
                        @setvar AMMO 2
                    endif

                    if counttype "crossbow bolt" self < LowAmmoWarningAmount and not cooldown "Ammunition" and AMMO = 1
                        overhead "[ AMMO LOW! ]" 37
                        cooldown "Ammunition" 6000
                    endif 

                    if counttype "arrow" self < LowAmmoWarningAmount and not cooldown "Ammunition" and AMMO = 2
                        overhead "[ AMMO LOW! ]" 37
                        cooldown "Ammunition" 6000    
                    endif
                endif 
                        
                if EnableArrowCleanup = 1
                    if findtype 7163|3903 ground -1 -1 2 as item and not cooldown "Cleanup" 
                        if EnableOverheadMessages = 1  
                            overhead '[ CLEANUP... ]' 93
                        endif
                        hotkey "Grab Item"
                        wft 1000
                        target item
                        wait 500
                        if findtype "quiver" self as MyQuiver
                            menu MyQuiver 0
                            wait 250
                        else
                            hotkey 'Organizer Agent-03'
                            wait 250  
                        endif
                        cooldown "Cleanup" 750
                    endif

                    if findtype 7163 ground -1 -1 10 as bolt and not cooldown "Radar"                    
                        overhead "" 93 bolt
                        cooldown "Radar" 3500
                    endif

                    if findtype 3903 ground -1 -1 10 as arrow and not cooldown "Radar"
                        overhead "" 37 arrow
                        cooldown "Radar" 3500
                    endif
                endif 
                
                if insysmsg "something invisible out of" and EnableOverheadMessages = 1  
                    overhead " SOMEONE HIDING! " 6  
                    wait 500              
                endif

                if insysmsg "world is saving"        
                    if not timerexists "WorldSaveTimer"
                        createtimer "WorldSaveTimer"
                    endif             
                        settimer "WorldSaveTimer" 0
                    while timer "WorldSaveTimer" < 4000
                        if insysmsg "save complete"
                            break
                        endif
                        wait 250 
                    endwhile  
                    if EnableOverheadMessages = 1            
                        overhead "[ SAVE COMPLETE! ]" 253
                    endif
                endif 

                if skill 'Healing' > 38
                    if not bandaging 
                        if hp < maxhp or poisoned or findbuff "bleed" or findbuff "disease" 
                            if EnableOverheadMessages = 1   
                                overhead '[ BANDAGING...]' 88
                            endif
                            hotkey "Bandage Self"                                     
                        elseif counttype 'clean bandage%s%' < 10 and not cooldown "Inventory Timer"
                            if EnableOverheadMessages = 1   
                                overhead "[ BANDAGES LOW! ]" 339
                            endif
                            cooldown "Inventory Timer" 6000
                        elseif counttype 'clean bandage%s%' = 0 and not cooldown "Inventory Timer"
                            if EnableOverheadMessages = 1   
                                overhead "[ NO BANDAGES! ]" 337
                            endif
                            cooldown "Inventory Timer" 6000
                        endif 
                    endif
                endif

                if EnableHealPotion = 1
                    if diffhits > HealPotHPdiff and not cooldown "Healing Potion"
                        if findtype "Yellow Potion" self as healpot
                            dclick healpot
                            wait 500
                            cooldown "Healing Potion" 11000
                                if insysmsg "Potion satchel used"
                                    if EnableOverheadMessages = 1 
                                        overhead "[ FREE HEAL POTION! ]" 253
                                    endif
                                    clearsysmsg
                                else 
                                    if EnableOverheadMessages = 1 
                                        overhead '[ HEAL POTION... ]' 253
                                    endif
                                    clearsysmsg
                                endif
                        else 
                            if not cooldown "Inventory Timer" 
                                if EnableOverheadMessages = 1 
                                    overhead '[ NO HEAL POTS! ]' 337
                                endif
                                cooldown "Inventory Timer" 6000
                            endif
                        endif
                        wait 500 
                    endif
                endif 

                if EnableHolyLight = 1            
                    if diffhits > HolyLightHPdiff and skill "Chivalry" >= 95 and not cooldown "Holy Light" and not cooldown "Prevented" and not cooldown "Chivalry"
                        clearsysmsg
                        yell "[HolyLight"
                        wait 250
                        if insysmsg "You do not have enough holy"
                            cooldown "Prevented" 5000
                            clearsysmsg                    
                        else   
                            if EnableOverheadMessages = 1 
                                overhead "[ HOLY LIGHT! ]" 254
                            endif
                            cooldown "Holy Light" 31000
                            cooldown "Chivalry" 1000
                        endif 
                        wait 500 
                    endif
                endif
                       
                if EnableNobleSacrifice = 1            
                    if diffhits > NobleSacrificeHPdiff and skill "Chivalry" >= 80 and not cooldown "Noble Sacrifice" and not cooldown "Prevented" and not cooldown "Chivalry" 
                        clearsysmsg 
                        yell "[NobleSacrifice"
                        wait 250
                        if insysmsg "You do not have enough holy"
                            cooldown "Prevented" 5000
                            clearsysmsg                    
                        else
                            wft 1000
                            target 'self'
                            if EnableOverheadMessages = 1 
                                overhead "[ NOBLE SACRIFICE! ]" 155
                            endif
                            cooldown "Noble Sacrifice" 31000
                            cooldown "Chivalry" 1000
                        endif
                        wait 500 
                    endif       
                endif    

                if EnableCurePotion = 1
                    if poisoned and not cooldown "Cure Potion"
                        if findtype "Orange Potion" self as curepot
                            dclick curepot
                            wait 500
                            cooldown "Cure Potion" 11000
                                if insysmsg "Potion satchel used"
                                    if EnableOverheadMessages = 1 
                                        overhead "[ FREE CURE POTION! ]" 44
                                    endif
                                    clearsysmsg
                                else 
                                    if EnableOverheadMessages = 1 
                                        overhead '[ CURE POTION... ]' 44
                                    endif
                                    clearsysmsg
                                endif
                        else
                            if not cooldown "Inventory Timer" 
                                if EnableOverheadMessages = 1 
                                    overhead '[ NO CURE POTS! ]' 337
                                endif
                                cooldown "Inventory Timer" 6000
                            endif
                        endif
                        wait 500 
                    endif
                endif 
               
                if EnableCleanseByFire = 1
                    if diffhits > CleanseByFireHPdiff and poisoned and not cooldown "Cleanse By Fire" and not cooldown "Chivalry" and not cooldown "Prevented"
                        clearsysmsg 
                        yell "[CleanseByFire"
                        wait 250
                        if not insysmsg "You do not have enough holy"
                            cooldown "Cleanse By Fire" 31000
                            if EnableOverheadMessages = 1 
                                overhead "[ CLEANSE BY FIRE! ]" 44
                            endif
                            cooldown "Chivalry" 1000
                        else
                            cooldown "Prevented" 5000
                            clearsysmsg                    
                        endif
                        wait 500 
                    endif          
                endif                

                if EnableCloseWounds = 1            
                    if findbuff "bleed" or findbuff "disease"
                        if skill "chivalry" >= 70 and not cooldown "Close Wounds" and not cooldown "Chivalry" and not cooldown "Prevented"
                            clearsysmsg 
                            yell "[CloseWounds"
                            wait 250
                            if not insysmsg "You do not have enough holy"
                                cooldown "Close Wounds" 31000
                                if EnableOverheadMessages = 1 
                                    overhead "[ CLOSE WOUNDS! ]" 2117
                                endif
                                cooldown "Chivalry" 1000
                            else 
                                cooldown "Prevented" 5000
                                clearsysmsg                    
                            endif
                            wait 500
                        endif
                    endif            
                endif

                if EnableRefreshPotion = 1
                    if diffstam >= RefreshPotSPdiff and not cooldown "Refresh Potion"
                        if findtype "Red Potion" self as refreshpot
                            dclick refreshpot
                            wait 500
                            cooldown "Refresh Potion" 11000
                                if insysmsg "Potion satchel used"
                                    if EnableOverheadMessages = 1 
                                        overhead "[ FREE REFRESH POTION! ]" 34
                                    endif
                                    clearsysmsg
                                else 
                                    if EnableOverheadMessages = 1 
                                        overhead '[ REFRESH POTION... ]' 34
                                    endif
                                    clearsysmsg
                                endif
                        else 
                            if not cooldown "Inventory Timer" 
                                if EnableOverheadMessages = 1 
                                    overhead '[ NO REFRESH POTS! ]' 337
                                endif
                                cooldown "Inventory Timer" 6000
                            endif
                        endif
                        wait 500 
                    endif
                endif 

                if EnablePeacemakingBuff = 1 and not findbuff "Song Of Peacemaking" and not cooldown "Musicianship" and not cooldown "Peacemaking" and not cooldown "Song Buff Delay"
                       
                    skill "Peacemaking"
                    wait 500
                        
                    if insysmsg "What instrument shall you play?"
                        if findtype "standing harp|sackbut|bamboo flute|tambourine|drum|lute|lap harp|gemshorn|hurdy gurdy|psaltery|shawm|vielle" as Instrument
                            target Instrument
                        else             
                            if EnableOverheadMessages = 1                     
                                overhead "[ NO INSTRUMENT! ]" 337   
                            endif                     
                        endif
                    endif
                            
                    if not insysmsg "This is not a musical instrument"
                        wft 1000
                        target backpack 
                        if EnableOverheadMessages = 1 
                            overhead "[ PEACEMAKING BUFF... ]" 84
                        endif
                        cooldown "Peacemaking Buff" SongReapply
                        cooldown "Song Buff Delay" 11000
                    else 
                        target self
                    endif 
                endif

                if EnableDiscordanceBuff = 1 and not findbuff "Song Of Discordance" and not cooldown "Musicianship" and not cooldown "Discordance" and not cooldown "Song Buff Delay"
                        
                    skill "Discordance"
                    wait 250
                        
                    if insysmsg "What instrument shall you play?"
                        if findtype "standing harp|sackbut|bamboo flute|tambourine|drum|lute|lap harp|gemshorn|hurdy gurdy|psaltery|shawm|vielle" as Instrument
                            target Instrument
                        else   
                            if EnableOverheadMessages = 1                               
                                overhead "[ NO INSTRUMENT! ]" 337       
                            endif                 
                        endif
                    endif
                        
                    if not insysmsg "This is not a musical instrument"
                        wft 1000
                        target backpack 
                        if EnableOverheadMessages = 1 
                            overhead "[ DISCORDANCE BUFF... ]" 69
                        endif
                        cooldown "Discordance Buff" SongReapply
                        cooldown "Song Buff Delay" 11000
                    else 
                        target self
                    endif    
                endif

                if EnableProvocationBuff = 1 and not findbuff "Song of Provocation" and not cooldown "Musicianship" and not cooldown "Provocation" and not cooldown "Song Buff Delay"
                        
                    skill "Provocation"
                    wait 250
                        
                    if insysmsg "What instrument shall you play?"
                        if findtype "standing harp|sackbut|bamboo flute|tambourine|drum|lute|lap harp|gemshorn|hurdy gurdy|psaltery|shawm|vielle" as Instrument
                            target Instrument
                        else               
                            if EnableOverheadMessages = 1                   
                                overhead "[ NO INSTRUMENT! ]" 337   
                            endif                     
                        endif
                    endif
                    
                    if not insysmsg "This is not a musical instrument"
                        wft 1000
                        target backpack 
                        if EnableOverheadMessages = 1 
                            overhead "[ PROVOCATION BUFF... ]" 334
                        endif
                        cooldown "Provocation Buff" SongReapply
                        cooldown "Song Buff Delay" 11000
                    else 
                        target self
                    endif     
                endif

                if not cooldown "Inventory Timer" 
                    hotkey 'Organizer Agent-04'
                    cooldown "Inventory Timer" 5000
                endif
               
                clearsysmsg 
            replay

        else


        ########################
        ####   TARGET ID:   ####
        ########################
        
        @setvar! ClosestTarget lasttarget
        getlabel ClosestTarget descTarget
        
        if not cooldown "No Target Timer" 
            overhead "  " 253 ClosestTarget 
            cooldown "No Target Timer" 3000
        endif 
        
            if find ClosestTarget ground -1 -1 6
                hotkey 'Next Grey Monster Target' 
                wait 100
                @setvar! NextClosestTarget lasttarget 
                getlabel NextClosestTarget descNextTarget
                for 4
                    if find NextClosestTarget ground -1 -1 6 and ClosestTarget != NextClosestTarget
                        if not cooldown "Next Target Timer" 
                            overhead "  " 2117 NextClosestTarget 
                            cooldown "Next Target Timer" 3000
                        endif 
                        break
                    else 
                        hotkey 'Next Grey Monster Target' 
                        wait 100
                        @setvar! NextClosestTarget lasttarget 
                        getlabel NextClosestTarget descNextTarget
                    endif 
                endfor 
            else 
                if not cooldown "Target Timer"
                    overhead "[ GET CLOSER! ]" 69
                    cooldown "Target Timer" 3500
                endif 
                replay    
            endif 

            if NextClosestTarget != ClosestTarget and find NextClosestTarget ground -1 -1 6
                @setvar! NeedtoProvoke 1
                @setvar! NeedtoPacify 0
                @setvar! NeedtoDiscord 0
                cooldown "Peace Check" 5000
                cooldown "Provo Check" 5000
                cooldown "Disco Check" 5000
                cooldown "Discordance" 5000
                cooldown "Peacemaking" 2500
                cooldown "Target Check" 5000
            else 
                @setvar! NeedtoProvoke 0
                @setvar! NeedtoPacify 1
            endif            

            if PreviousTarget != ClosestTarget
                cooldown "Pacified" 0
                cooldown "Discorded" 0
                cooldown "Provoked" 0
            endif
            
            hotkey 'Target Closest Grey Monster'
            wait 100
            @setvar! ClosestTarget lasttarget
            getlabel ClosestTarget descTarget 
            cooldown "Target Check" 5000     


        #############################
        ####     COMBAT LOOP:    ####
        #############################   
    
        while not dead ClosestTarget
        
                if not timerexists "FindTarget"
                    createtimer "FindTarget"
                    settimer "FindTarget" 3000
                endif
                    
                if timer "FindTarget" >= 3000
                    getlabel ClosestTarget descTarget
                        if not cooldown "Target Timer"
                            if "Paragon" in descTarget
                                if EnableOverheadMessages = 1 
                                    overhead "  PARAGON!  " 12 ClosestTarget
                                else 
                                    overhead "  " 12 ClosestTarget
                                endif
                                cooldown "Target Timer" 3500
                                attack ClosestTarget
                            else 
                                if EnableOverheadMessages = 1 
                                    overhead "  TARGET  " 253 ClosestTarget 
                                else 
                                    overhead "  " 253 ClosestTarget
                                endif                            
                                cooldown "Target Timer" 3500
                                attack ClosestTarget
                            endif   
                        endif                          
                    settimer "FindTarget" 0
                endif 
       
                if not timerexists "FindNextTarget"
                    createtimer "FindNextTarget"
                    settimer "FindNextTarget" 3000
                endif

                if timer "FindNextTarget" >= 3000 and find NextClosestTarget ground -1 -1 6 and NextClosestTarget != ClosestTarget and NextClosestTarget != 0
                    getlabel NextClosestTarget descNextTarget
                        if not cooldown " Next Target Timer"
                            if "Paragon" in descNextTarget
                                if EnableOverheadMessages = 1 
                                    overhead "  PARAGON!  " 12 NextClosestTarget
                                else 
                                    overhead "  " 12 NextClosestTarget
                                endif 
                                cooldown "Next Target Timer" 3500
                                    
                            else 
                                if EnableOverheadMessages = 1 
                                    overhead "  TARGET  " 2117 NextClosestTarget 
                                else 
                                    overhead "  " 2117 NextClosestTarget
                                endif                             
                                cooldown "Next Target Timer" 3500
                            endif   
                        endif
                    settimer "FindNextTarget" 0
                    @setvar! NeedToProvoke 1
                endif   
                    
                if not cooldown "Target Check"
                    hotkey 'Next Grey Monster Target' 
                    wait 100
                    @setvar! NextClosestTarget lasttarget 
                    getlabel NextClosestTarget descNextTarget
                    if NextClosestTarget != ClosestTarget 
                        for 4
                        if find NextClosestTarget ground -1 -1 6 and ClosestTarget != NextClosestTarget
                            if not cooldown "Next Target Timer" 
                                if EnableOverheadMessages = 1 
                                    overhead "  TARGET  " 2117 NextClosestTarget 
                                else 
                                    overhead "  " 2117 NextClosestTarget
                                endif 
                                cooldown "Next Target Timer" 3500
                            endif 
                            break
                            else
                            hotkey 'Next Grey Monster Target' 
                            wait 100
                            @setvar! NextClosestTarget lasttarget 
                            getlabel NextClosestTarget descNextTarget
                        endif 
                        endfor 
                    endif

                    if NextClosestTarget != ClosestTarget and find NextClosestTarget ground -1 -1 6
                        @setvar! NeedtoProvoke 1
                        @setvar! NeedtoPacify 0
                        @setvar! NeedtoDiscord 0
                    else 
                        @setvar! NeedtoProvoke 0
                        @setvar! NeedtoPacify 1
                    endif              
                    
                    hotkey 'Target Closest Grey Monster'
                    wait 100
                    @setvar! ClosestTarget lasttarget
                    getlabel ClosestTarget descTarget              
                    cooldown "Target Check" 5000
                endif 

                if not find ClosestTarget ground -1 -1 6 or dead ClosestTarget
                    break
                endif

                if paralyzed and EnableParalyzePouch = 1
                    if findtype "pouch" self
                        yell "[pouch"
                        hotkey 'Toggle War Only'
                        replay
                    else
                        if EnableOverheadMessages = 1 
                            overhead "[ NO MORE POUCHES! ]" 337
                        endif
                    endif           
                endif 
                
                if warmode
                    if EnableExplosionPots = 1 
                        hotkey 'Next Murderer Player Target'
                        wait 500
                            if insysmsg "No one matching that was found"   
                                hotkey 'Toggle Peace Only'
                                if findtype "Purple Potion" self as Molotov
                                    getlabel Molotov descMolotov
                                    if "next usable in 15" in desc
                                        @setvar! purplePotionCD 15000 
                                    elseif "next usable in 14" in descMolotov
                                        @setvar! purplePotionCD 14000
                                    elseif "next usable in 13" in descMolotov
                                        @setvar! purplePotionCD 13000
                                    elseif "next usable in 12" in descMolotov
                                        @setvar! purplePotionCD 12000
                                    elseif "next usable in 11" in descMolotov
                                        @setvar! purplePotionCD 11000
                                    elseif "next usable in 10" in descMolotov
                                        @setvar! purplePotionCD 10000
                                    elseif "next usable in 9" in descMolotov
                                        @setvar! purplePotionCD 9000
                                    elseif "next usable in 8" in descMolotov
                                        @setvar! purplePotionCD 8000
                                    elseif "next usable in 7" in descMolotov
                                        @setvar! purplePotionCD 7000
                                    elseif "next usable in 6" in descMolotov
                                        @setvar! purplePotionCD 6000
                                    elseif "next usable in 5" in descMolotov
                                        @setvar! purplePotionCD 5000
                                    elseif "next usable in 4" in descMolotov
                                        @setvar! purplePotionCD 4000
                                    elseif "next usable in 3" in descMolotov
                                        @setvar! purplePotionCD 3000
                                    elseif "next usable in 2" in descMolotov
                                        @setvar! purplePotionCD 2000
                                    elseif "next usable in 1" in descMolotov
                                        @setvar! purplePotionCD 1000
                                    else 
                                        @setvar! purplePotionCD 0
                                    endif
                                    
                                    cooldown "Purple Potion" purplePotionCD

                                    if not cooldown "Purple Potion"
                                        dclick Molotov
                                        wft 1000
                                        target ClosestTarget
                                        wait 250
                                            if insysmsg "Potion satchel used"
                                                if EnableOverheadMessages = 1  
                                                    overhead "[ FREE EXPLOSION POT! ]" 419
                                                endif
                                                clearsysmsg
                                            else 
                                                if EnableOverheadMessages = 1  
                                                    overhead '[ EXPLOSION POT! ]' 419
                                                endif 
                                                clearsysmsg
                                            endif
                                        cooldown "Purple Potion" 15000 
                                    else
                                        if EnableOverheadMessages = 1  
                                        overhead "[ COOLDOWN... ]" 419
                                        endif 
                                    endif
                                else 
                                    if EnableOverheadMessages = 1  
                                        overhead "[ NO EXPLOSION POTS... ]" 337
                                    endif                                 
                                endif     
                            else
                                @setvar! MurdererTarget lasttarget
                                hotkey 'Toggle War Only'
                                replay
                            endif
                    else
                        hotkey 'Cancel Current Target'
                        wait 150 
                        hotkey 'Next Murderer Player Target'
                        wait 500
                        if insysmsg "No one matching that was found"   
                            cooldown "Pacified" 0
                            cooldown "Discorded" 0
                            cooldown "Provoked" 0
                            if EnableOverheadMessages = 1  
                                overhead "[ RESETTING... ]" 337
                            endif 
                            hotkey 'Toggle Peace Only'
                            replay   
                        endif                 
                    endif 
                endif
                
                if EnablePKradar = 1 and not cooldown "PK Radar" 
                    hotkey 'Next Murderer Player Target'
                    wait 500
                        if insysmsg "No one matching that was found"   
                            cooldown "PK Radar" 2000
                        else
                            overhead "[ !! RED ALERT !! ]" 37
                            hotkey 'Toggle War Only'
                            replay
                        endif 
                endif 

                if EnableOverheadMessages = 1
                    if insysmsg "Barding break avoided"
                        overhead "[ BREAK AVOIDED! ]" 84 ClosestTarget
                    endif
                    
                    if insysmsg "something invisible out of" 
                        overhead " SOMEONE HIDING! " 6
                        wait 500
                    endif

                    if insysmsg "mastery chain"
                        overhead "[ NEW LINK UNLOCKED!! ]" 149
                    endif 
                    
                    if insysmsg "You have unlocked a codex upgrade point"
                        overhead "[ CODEX POINT UNLOCKED! ]" 2114
                    endif             

                    if insysmsg "enough experience to upgrade"
                        overhead "[ ASPECT TIER UNLOCKED!! ]" 2241
                    endif 

                    if insysmsg "Cacophony activated"
                        overhead "[ CACOPHONY!!! ]" 2241 
                    endif  

                    if insysmsg "causes you to bleed"
                        overhead "[ BLEEDING... ]" 2118
                    endif

                    if insysmsg "Your shot hinders"
                        overhead "[ HINDERED! ]" 44 ClosestTarget   
                    endif    

                    if insysmsg "Your target overpowers"
                        overhead "[ VICIOUS WOUND! ]" 1664 ClosestTarget  
                    endif 
               
                    if insysmsg "Your shot turns the target into"
                        overhead "[ PIN CUSHION!! ]" 2115
                    endif 
          
                    if insysmsg  "Your shot ricochets"
                        overhead "[ RICOCHET!! ]" 2115
                    endif
                else 
                    if insysmsg "Your shot hinders"
                        overhead "  " 44 ClosestTarget   
                    endif

                    if insysmsg "something invisible out of" 
                        overhead "  " 6
                        wait 500
                    endif

                endif
            
                if not find ClosestTarget ground -1 -1 6 or dead ClosestTarget
                    break
                endif      
                 
                
            #################################
            ####    DEFENSIVE CHECKS:    ####
            #################################
            
                if paralyzed and EnableParalyzePouch = 1
                    if findtype "pouch" self
                        yell "[pouch"
                        hotkey 'Toggle War Only'
                        replay
                    else
                        if EnableOverheadMessages = 1 
                            overhead "[ NO MORE POUCHES! ]" 337
                        endif
                    endif           
                endif

                if EnableNobleSacrifice = 1            
                    if diffhits > NobleSacrificeHPdiff and skill "Chivalry" >= 80 and not cooldown "Noble Sacrifice" and not cooldown "Prevented" and not cooldown "Chivalry" 
                        clearsysmsg 
                        yell "[NobleSacrifice"
                        wait 250
                        if insysmsg "You do not have enough holy"
                            cooldown "Prevented" 5000
                            clearsysmsg                    
                        else
                            wft 1000
                            target 'self'
                            if EnableOverheadMessages = 1 
                                overhead "[ NOBLE SACRIFICE! ]" 155
                            endif
                            cooldown "Noble Sacrifice" 31000
                            cooldown "Chivalry" 500
                        endif
                        wait 500 
                    endif            
                endif
                
                if EnableHolyLight = 1            
                    if diffhits > HolyLightHPdiff and skill "Chivalry" >= 95 and not cooldown "Holy Light" and not cooldown "Prevented" and not cooldown "Chivalry"
                        clearsysmsg
                        yell "[HolyLight"
                        wait 250
                        if insysmsg "You do not have enough holy"
                            cooldown "Prevented" 5000
                            clearsysmsg                    
                        else   
                            if EnableOverheadMessages = 1 
                                overhead "[ HOLY LIGHT! ]" 254
                            endif
                            cooldown "Holy Light" 31000
                            cooldown "Chivalry" 500
                        endif
                        wait 500 
                    endif            
                endif
                
                if EnableHealPotion = 1
                    if diffhits > HealPotHPdiff and not cooldown "Healing Potion"
                        if findtype "Yellow Potion" self as healpot
                            dclick healpot
                            wait 500
                            cooldown "Healing Potion" 11000
                                if insysmsg "Potion satchel used"
                                    if EnableOverheadMessages = 1 
                                        overhead "[ FREE HEAL POTION! ]" 253
                                    endif
                                    clearsysmsg
                                else 
                                    if EnableOverheadMessages = 1 
                                        overhead '[ HEAL POTION... ]' 253
                                    endif
                                    clearsysmsg
                                endif
                        else 
                            if not cooldown "Inventory Timer" 
                                if EnableOverheadMessages = 1 
                                    overhead '[ NO HEAL POTS! ]' 337
                                endif
                                cooldown "Inventory Timer" 6000
                            endif
                        endif
                        wait 500 
                    endif
                endif 
                
                if skill 'Healing' > 38
                    if not bandaging and hp < maxhp
                        if poisoned or findbuff "bleed" or findbuff "disease" 
                            if EnableOverheadMessages = 1   
                                overhead '[ BANDAGING...]' 88
                            endif
                                hotkey "Bandage Self"
                                wait 500                                   
                        elseif counttype 'clean bandage%s%' < 10
                            if EnableOverheadMessages = 1   
                                if not cooldown "Inventory Timer"
                                    overhead "[ BANDAGES LOW! ]" 339
                                endif
                            endif
                                hotkey "Bandage Self"   
                                wait 500                            
                                cooldown "Inventory Timer" 6000
                        elseif counttype 'clean bandage%s%' = 0 and not cooldown "Inventory Timer"
                            if EnableOverheadMessages = 1   
                                overhead "[ NO BANDAGES! ]" 337
                            endif
                                cooldown "Inventory Timer" 6000
                        else 
                            if EnableOverheadMessages = 1   
                                overhead '[ BANDAGING...]' 88
                            endif
                                hotkey "Bandage Self"    
                                wait 500 
                        endif 
                    endif
                endif

                if EnableCloseWounds = 1            
                    if findbuff "bleed" or findbuff "disease"
                        if skill "chivalry" >= 70 and not cooldown "Close Wounds" and not cooldown "Chivalry" and not cooldown "Prevented"
                            clearsysmsg 
                            yell "[CloseWounds"
                            wait 250
                            if insysmsg "You do not have enough holy"
                                cooldown "Prevented" 5000
                                clearsysmsg      
                            else
                                cooldown "Close Wounds" 31000
                                cooldown "Chivalry" 500
                                if EnableOverheadMessages = 1
                                    overhead "[ CLOSE WOUNDS! ]" 48 
                                endif                 
                            endif
                            wait 500 
                        endif
                    endif            
                endif

                if EnableCurePotion = 1
                    if poisoned and not cooldown "Cure Potion"
                        if findtype "Orange Potion" self as curepot
                            dclick curepot                        
                            wait 500
                            cooldown "Cure Potion" 11000
                                if insysmsg "Potion satchel used"
                                    if EnableOverheadMessages = 1
                                        overhead "[ FREE CURE POTION! ]" 44
                                    endif
                                    clearsysmsg
                                else 
                                    if EnableOverheadMessages = 1
                                        overhead '[ CURE POTION... ]' 44
                                    endif
                                    clearsysmsg
                                endif
                        else
                            if not cooldown "Inventory Timer" 
                                if EnableOverheadMessages = 1
                                    overhead '[ NO CURE POTS! ]' 337
                                endif
                                cooldown "Inventory Timer" 6000
                            endif
                        endif
                        wait 500 
                    endif
                endif 
                         
                if EnableCleanseByFire = 1
                    if diffhits > CleanseByFireHPdiff and poisoned and not cooldown "Cleanse By Fire" and not cooldown "Chivalry" and not cooldown "Prevented"
                        clearsysmsg 
                        yell "[CleanseByFire"
                        wait 250
                        if insysmsg "You do not have enough holy"
                            cooldown "Prevented" 5000
                            clearsysmsg      
                        else
                            cooldown "Cleanse By Fire" 31000
                            cooldown "Chivalry" 500
                            if EnableOverheadMessages = 1
                                overhead "[ CLEANSE BY FIRE! ]" 43  
                            endif            
                        endif
                        wait 500 
                    endif            
                endif

                if EnableRefreshPotion = 1
                    if diffstam >= RefreshPotSPdiff and not cooldown "Refresh Potion"
                        if findtype "Red Potion" self as refreshpot
                            dclick refreshpot
                            wait 500
                            cooldown "Refresh Potion" 11000
                                if insysmsg "Potion satchel used"
                                    if EnableOverheadMessages = 1
                                        overhead "[ FREE REFRESH POTION! ]" 34
                                    endif
                                    clearsysmsg
                                else 
                                    if EnableOverheadMessages = 1
                                        overhead '[ REFRESH POTION... ]' 34
                                    endif
                                    clearsysmsg
                                endif
                        else 
                            if not cooldown "Inventory Timer" 
                                if EnableOverheadMessages = 1
                                    overhead '[ NO REFRESH POTS! ]' 337
                                endif
                                cooldown "Inventory Timer" 6000
                            endif
                        endif
                        wait 500 
                    endif
                endif 

            
            ###############################
            ####    BARDING SKILLS:    ####
            ###############################       
          
                    if not cooldown "Provo Check" and EnableProvocation = 1 
                        if find ClosestTarget gound -1 -1 6 and find NextClosestTarget ground -1 -1 8 and ClosestTarget != NextClosestTarget
                            getlabel ClosestTarget descTarget
                            getlabel NextClosestTarget descNextTarget
                            wait 150
                                
                            if "provoked" in descTarget
                                if not cooldown "Provoked"
                                    cooldown "Provoked" 30000
                                endif 
                                @setvar! NeedtoProvoke 0
                                cooldown "Provo Check" 2000
                            else 
                                cooldown "Provoked" 0
                                @setvar! NeedtoProvoke 1
                                @setvar! NeedtoPacify 0
                                cooldown "Provo Check" 2000
                                cooldown "Peace Check" 4000
                                cooldown "Disco Check" 4000
                                wait 250
                            endif
                        else 
                            @setvar! NeedtoProvoke 0
                            cooldown "Provo Check" 2000
                        endif 
                    endif
                    
                    if not cooldown "Peace Check" and EnablePeacemaking = 1
                        if find ClosestTarget gound -1 -1 6
                            getlabel ClosestTarget descTarget
                            wait 150
                                    
                            if "pacified" in descTarget
                                if not cooldown "Pacified"
                                    cooldown "Pacified" 30000
                                endif 
                                @setvar! NeedtoPacify 0
                                cooldown "Peace Check" 2000
                            elseif "provoked" in descTarget or "provoked" in descNextTarget
                                @setvar! NeedtoPacify 0
                                cooldown "Peace Check" 2000
                            else
                                cooldown "Pacified" 0
                                @setvar! NeedtoPacify 1
                                cooldown "Peace Check" 2000
                                wait 250
                            endif
                        else 
                            break 
                        endif 
                    endif
                    
                    if not cooldown "Disco Check" and EnableDiscordance = 1
                        if find ClosestTarget gound -1 -1 6
                            getlabel ClosestTarget descTarget
                            wait 150
                            if "discord" in descTarget
                                if find NextClosestTarget ground -1 -1 6 and ClosestTarget != NextClosestTarget and NextClosestTarget != 0
                                    getlabel NextClosestTarget descNextTarget
                                    wait 150

                                    if "discord" in descNextTarget
                                        @setvar! NeedtoDiscord 0
                                        cooldown "Disco Check" 2000
                                    else
                                        @setvar! NeedtoDiscord 2
                                        cooldown "Disco Check" 2000                                        
                                        wait 250
                                    endif
                                else 
                                    if not cooldown "Discorded"
                                        cooldown "Discorded" 30000
                                    endif
                                    @setvar! NeedtoDiscord 0 
                                    cooldown "Disco Check" 2000
                                endif 
                            else
                                cooldown "Discorded" 0
                                @setvar! NeedtoDiscord 1
                                cooldown "Disco Check" 2000
                                wait 250                                
                            endif
                        endif 
                    endif 
            
                    if NeedtoProvoke = 1 and find ClosestTarget ground -1 -1 6 and find NextClosestTarget ground -1 -1 8 and ClosestTarget != NextClosestTarget and NextClosestTarget != 0
                        if not cooldown "Provoked" and not cooldown "Provocation" and not cooldown "Musicianship" and EnableProvocation = 1 
                            skill "Provocation"
                            wft 1000
                            target NextClosestTarget
                            wft 1000

                            if insysmsg 'Target cannot be seen'
                                if EnableOverheadMessages = 1 
                                    overhead "[ CANNOT BE SEEN... ]" 339 NextClosestTarget
                                endif
                                cooldown "Provocation" 4000
                            elseif insysmsg "You must wait"
                                if EnableOverheadMessages = 1 
                                    overhead "[ WAITING... ]" 2117
                                endif
                                cooldown "Peacemaking" 5000
                                cooldown "Discordance" 5000
                                clearsysmsg 
                            elseif insysmsg 'That is too far away.'
                                if EnableOverheadMessages = 1 
                                    overhead '[ TOO FAR AWAY! ]' 339 NextClosestTarget
                                endif
                                cooldown "Provocation" 5000
                            else 
                                if EnableOverheadMessages = 1                        
                                    overhead "[ PROVOKING... ]" 2117
                                endif
                                target ClosestTarget
                                wait 250
                            endif

                                if insysmsg 'You play successfully, provoking'
                                    if EnableOverheadMessages = 1 
                                        overhead '[ PROVOKED! ]' 2117 ClosestTarget
                                        overhead '[ PROVOKED! ]' 2117 NextClosestTarget
                                    else 
                                        overhead '' 2117 ClosestTarget
                                        overhead '' 2117 NextClosestTarget
                                    endif
                                    sysmsg "You play successfully, provoking {{descTarget}} and {{descNextTarget}}!" 2117
                                    cooldown "Musicianship" 5500
                                    cooldown "Provocation" 11000
                                    cooldown "Provoked" ProvocationReapply
                                    @setvar! SwitchStance 1
                                    wait 250                                            
                                        if mana > 10 and SwitchStance = 1
                                            yell "[ArcheryAmmunition3"
                                            wait 150
                                            yell "[ArcheryFinisher1"
                                            cooldown "Codex" 5000
                                            wait 250
                                            if insysmsg "You deactivate" 
                                                yell "[ArcheryAmmunition3"
                                                wait 150
                                                yell "[ArcheryFinisher1"
                                                cooldown "Codex" 5000
                                            endif  
                                            if EnableOverheadMessages = 1 
                                                overhead "[ FIRE AMMO! ]" 44   
                                                wait 500  
                                            endif    
                                        endif                        
                                elseif insysmsg 'You fail to incite'
                                    if EnableOverheadMessages = 1 
                                    overhead '[ PROVO FAIL! ]' 37
                                    endif
                                    sysmsg "You fail to provoke {{descTarget}} and {{descNextTarget}}!" 339
                                    cooldown "Provocation" 5500
                                    wait 250
                                elseif insysmsg 'Target cannot be seen'
                                    if EnableOverheadMessages = 1 
                                        overhead "[ CANNOT BE SEEN... ]" 337
                                    endif
                                    cooldown "Provocation" 5000
                                elseif insysmsg 'That is too far away.'
                                    if EnableOverheadMessages = 1 
                                        overhead '[ TOO FAR AWAY! ]' 43 ClosestTarget
                                    endif
                                    cooldown "Provocation" 5000 
                                elseif insysmsg 'The creatures you are trying to provoke are too far away from each other for your music to have an effect.'
                                    if EnableOverheadMessages = 1 
                                        overhead '[ TOO FAR APART! ]' 153 ClosestTarget
                                        overhead '[ TOO FAR APART! ]' 153 NextClosestTarget
                                    endif
                                    cooldown "Provocation" 5000
                                elseif insysmsg 'tell someone to attack themselves!'
                                    if EnableOverheadMessages = 1 
                                        overhead '[ SELF TARGET FAIL... ]' 337
                                    endif
                                else
                                    wft 250  
                                endif
                                @setvar! NeedtoProvoke 0
                        endif 
                    endif 
                        
                    if NeedtoPacify = 1
                        if not cooldown "Pacified" and not cooldown "Peacemaking" and not cooldown "Musicianship" and EnablePeacemaking = 1         
                            skill "Peacemaking"
                            wft 1000

                            if insysmsg "What instrument shall you play?"
                                if findtype "standing harp|sackbut|bamboo flute|tambourine|drum|lute|lap harp|gemshorn|hurdy gurdy|psaltery|shawm|vielle" as Instrument
                                    target Instrument
                                    wait 250
                                else     
                                    if EnableOverheadMessages = 1                             
                                        overhead "[ NO INSTRUMENT! ]" 337  
                                    endif                 
                                endif
                            endif
                            
                            if not insysmsg "This is not a musical instrument"
                                target ClosestTarget
                                wait 250
                            endif
                                          
                            if insysmsg "Target cannot be seen"
                                if EnableOverheadMessages = 1 
                                    overhead "[ CANNOT BE SEEN... ]" 337 
                                endif
                                cooldown "Peacemaking" 4000
                                replay                          
                            elseif insysmsg 'That is too far away.'
                                if EnableOverheadMessages = 1 
                                    overhead '[ TOO FAR AWAY! ]' 43 ClosestTarget  
                                endif
                                replay
                            elseif insysmsg "You must wait" 
                                if EnableOverheadMessages = 1 
                                    overhead "[ WAITING... ]" 84
                                endif
                                cooldown "Discordance" 5000
                                cooldown "Provocation" 5000
                                wait 250     
                            elseif insysmsg "You play successfully, pacifying your"
                                if EnableOverheadMessages = 1 
                                    overhead "[ PACIFYING... ]" 84
                                endif
                                cooldown "Pacified" PeacemakingReapply
                                cooldown "Musicianship" 5500
                                cooldown "Peacemaking" 11000
                                if EnableOverheadMessages = 1 
                                    wait 250
                                    overhead "[ PACIFIED! ]" 84 ClosestTarget
                                else 
                                    overhead '' 84 ClosestTarget
                                endif
                                sysmsg "You play successfully, pacifying your target!" 84                                           
                                    wait 150
                                    @setvar! SwitchStance 0
                                    yell "[ArcheryAmmunition1"
                                    wait 150
                                    yell "[ArcheryFinisher2"
                                    cooldown "Codex" 5000
                                    @setvar! SwitchStance 0
                                    wait 250
                                        if insysmsg "You deactivate" 
                                            yell "[ArcheryAmmunition1"
                                            wait 150
                                            yell "[ArcheryFinisher2"
                                            cooldown "Codex" 5000
                                        endif
                                    if EnableOverheadMessages = 1 
                                        overhead "[ ARCANE AMMO! ]" 12
                                        wait 500   
                                    endif                              
                            elseif insysmsg "you fail to pacify your opponent"
                                if EnableOverheadMessages = 1 
                                overhead "[ PACIFY FAIL! ]" 37
                                endif
                                sysmsg "You fail to pacify your target!" 337
                                cooldown "Peacemaking" 5500
                                wait 250                                        
                            else   
                                if not find ClosestTarget ground -1 -1 6 or dead ClosestTarget
                                    break 
                                endif
                            endif                        
                        endif                                   
                    endif
                
                    if NeedtoDiscord = 1
                        if not cooldown "Discorded" and not cooldown "Discordance" and not cooldown "Musicianship" and EnableDiscordance = 1
                            skill "Discordance"
                            wft 1000
                        
                            if insysmsg "What instrument shall you play?"
                                if findtype "standing harp|sackbut|bamboo flute|tambourine|drum|lute|lap harp|gemshorn|hurdy gurdy|psaltery|shawm|vielle" as Instrument
                                    target Instrument
                                    wait 250
                                else       
                                    if EnableOverheadMessages = 1                           
                                        overhead "[ NO INSTRUMENT! ]" 337      
                                    endif                  
                                endif   
                            elseif not insysmsg "This is not a musical instrument"
                                target ClosestTarget
                                wait 250   
                                if insysmsg "Target cannot be seen."
                                    if EnableOverheadMessages = 1 
                                        overhead "[ CANNOT BE SEEN... ]" 337  
                                    endif
                                    cooldown "Discordance" 4000
                                    replay
                                elseif insysmsg "You must wait" 
                                    if EnableOverheadMessages = 1 
                                        overhead "[ WAITING... ]" 69
                                    endif
                                    cooldown "Peacemaking" 5000
                                    wait 250  
                                elseif insysmsg "You play successfully, disrupting your opponent"
                                    if EnableOverheadMessages = 1 
                                        overhead "[ DISCORDING... ]" 69                                            
                                        wait 250
                                    endif
                                    cooldown "Discorded" DiscordanceReapply
                                    cooldown "Musicianship" 5500
                                    cooldown "Discordance" 11000
                                    if EnableOverheadMessages = 1 
                                        overhead "[ DISCORDED! ]" 69 ClosestTarget
                                    else 
                                        overhead '' 69 ClosestTarget
                                    endif
                                    sysmsg "You play successfully, disrupting your target!" 69
                                elseif insysmsg "fail to discord"
                                    cooldown "Discordance" 5500
                                    if EnableOverheadMessages = 1 
                                        overhead "[ DISCORD FAIL! ]" 37
                                    endif
                                    sysmsg "You fail to discord your target!" 337
                                    wait 250     
                                else   
                                    if not find ClosestTarget ground -1 -1 6 or dead ClosestTarget
                                        break
                                    endif  
                                endif    
                            else   
                                if not find ClosestTarget ground -1 -1 6 or dead ClosestTarget
                                    break
                                endif  
                            endif     
                        endif
               
                    elseif NeedtoDiscord = 2
                        if not cooldown "Discorded" and not cooldown "Discordance" and not cooldown "Musicianship" and EnableDiscordance = 1
                            skill "Discordance"
                            wft 1000
                        
                            if insysmsg "What instrument shall you play?"
                                if findtype "standing harp|sackbut|bamboo flute|tambourine|drum|lute|lap harp|gemshorn|hurdy gurdy|psaltery|shawm|vielle" as Instrument
                                    target Instrument
                                    wait 250
                                else       
                                    if EnableOverheadMessages = 1                           
                                        overhead "[ NO INSTRUMENT! ]" 337      
                                    endif                  
                                endif   
                            elseif not insysmsg "This is not a musical instrument"
                                target NextClosestTarget
                                wait 250   
                                if insysmsg "Target cannot be seen."
                                    if EnableOverheadMessages = 1 
                                        overhead "[ CANNOT BE SEEN... ]" 337  
                                    endif
                                    cooldown "Discordance" 4000
                                    replay
                                elseif insysmsg "You must wait" 
                                    if EnableOverheadMessages = 1 
                                        overhead "[ WAITING... ]" 69
                                    endif
                                    cooldown "Peacemaking" 5000
                                    wait 250  
                                elseif insysmsg "You play successfully, disrupting your opponent"
                                    if EnableOverheadMessages = 1 
                                        overhead "[ DISCORDING... ]" 69                                            
                                        wait 250
                                    endif
                                    cooldown "Discorded" DiscordanceReapply
                                    cooldown "Musicianship" 5500
                                    cooldown "Discordance" 11000
                                    if EnableOverheadMessages = 1 
                                        overhead "[ DISCORDED! ]" 69 NextClosestTarget
                                    else 
                                        overhead '' 69 NextClosestTarget
                                    endif
                                    sysmsg "You play successfully, disrupting your target!" 69
                                elseif insysmsg "fail to discord"
                                    cooldown "Discordance" 5500
                                    if EnableOverheadMessages = 1 
                                        overhead "[ DISCORD FAIL! ]" 37
                                    endif
                                    sysmsg "You fail to discord your target!" 337
                                    wait 250     
                                else   
                                    if not find ClosestTarget ground -1 -1 6 or dead ClosestTarget
                                        break
                                    endif  
                                endif    
                            else   
                                if not find ClosestTarget ground -1 -1 6 or dead ClosestTarget
                                    break
                                endif  
                            endif     
                        endif
                    endif  
                    
                    if EnableHolyLight = 1            
                        if diffhits > HolyLightHPdiff and skill "Chivalry" >= 95 and not cooldown "Holy Light" and not cooldown "Prevented" and not cooldown "Chivalry"
                            clearsysmsg
                            yell "[HolyLight"
                            wait 250
                            if insysmsg "You do not have enough holy"
                                cooldown "Prevented" 5000
                                clearsysmsg                    
                            else   
                                if EnableOverheadMessages = 1 
                                    overhead "[ HOLY LIGHT! ]" 254
                                endif
                                cooldown "Holy Light" 31000
                                cooldown "Chivalry" 500
                            endif
                            wait 500 
                        endif            
                    endif
                    
                    if EnableHealPotion = 1
                        if diffhits > HealPotHPdiff and not cooldown "Healing Potion"
                            if findtype "Yellow Potion" self as healpot
                                dclick healpot
                                wait 500
                                cooldown "Healing Potion" 11000
                                    if insysmsg "Potion satchel used"
                                        if EnableOverheadMessages = 1 
                                            overhead "[ FREE HEAL POTION! ]" 253
                                        endif
                                        clearsysmsg
                                    else 
                                        if EnableOverheadMessages = 1 
                                            overhead '[ HEAL POTION... ]' 253
                                        endif
                                        clearsysmsg
                                    endif
                            else 
                                if not cooldown "Inventory Timer" 
                                    if EnableOverheadMessages = 1 
                                        overhead '[ NO HEAL POTS! ]' 337
                                    endif
                                    cooldown "Inventory Timer" 6000
                                endif
                            endif
                            wait 500 
                        endif
                    endif 

                    if EnableNobleSacrifice = 1            
                        if diffhits > NobleSacrificeHPdiff and skill "Chivalry" >= 80 and not cooldown "Noble Sacrifice" and not cooldown "Prevented" and not cooldown "Chivalry" 
                            clearsysmsg 
                            yell "[NobleSacrifice"
                            wait 250
                            if insysmsg "You do not have enough holy"
                                cooldown "Prevented" 5000
                                clearsysmsg                    
                            else
                                wft 1000
                                target 'self'
                                if EnableOverheadMessages = 1 
                                    overhead "[ NOBLE SACRIFICE! ]" 155
                                endif
                                cooldown "Noble Sacrifice" 31000
                                cooldown "Chivalry" 500
                            endif
                            wait 500 
                        endif            
                    endif
                    
                    if skill 'Healing' > 38
                        if not bandaging and hp < maxhp
                            if poisoned or findbuff "bleed" or findbuff "disease" 
                                if EnableOverheadMessages = 1   
                                    overhead '[ BANDAGING...]' 88
                                endif
                                hotkey "Bandage Self"                                    
                            elseif counttype 'clean bandage%s%' < 10
                                if EnableOverheadMessages = 1 and not cooldown "Inventory Timer" 
                                    overhead "[ BANDAGES LOW! ]" 339
                                endif
                                    overhead '[ BANDAGING...]' 88
                                    hotkey "Bandage Self"
                                    cooldown "Inventory Timer" 6000
                            elseif counttype 'clean bandage%s%' = 0 and not cooldown "Inventory Timer"
                                if EnableOverheadMessages = 1   
                                    overhead "[ NO BANDAGES! ]" 337
                                endif
                                cooldown "Inventory Timer" 6000
                            else 
                                if EnableOverheadMessages = 1   
                                    overhead '[ BANDAGING...]' 88
                                endif
                                hotkey "Bandage Self"     
                            endif 
                        endif
                    endif


        #################################
        ####    BUFFS & ABILITIES:   ####
        #################################

                if EnableStrengthPotion = 1
                    if insysmsg "You may now use a strength" or not findbuff 'Strength'
                        if findtype "White Potion" self as strengthpot                        
                            dclick strengthpot
                            wait 500
                                if insysmsg "Potion satchel used"
                                    if EnableOverheadMessages = 1
                                        overhead "[ FREE STRENGTH POTION! ]" 956
                                    endif
                                    clearsysmsg
                                else 
                                    if EnableOverheadMessages = 1
                                        overhead '[ STRENGTH POTION... ]' 956
                                    endif
                                    clearsysmsg
                                endif
                        else 
                            if not cooldown "Inventory Timer" 
                                if EnableOverheadMessages = 1
                                    overhead '[ NO STRENGTH POTS! ]' 337
                                endif 
                                cooldown "Inventory Timer" 15000
                            endif
                        endif
                        wait 500
                    endif
                endif

                if EnableAgilityPotion = 1
                    if insysmsg "You may now use an agility"  or not findbuff 'Agility'
                        if findtype "Blue Potion" self as agilitypot
                            dclick agilitypot
                            wait 500
                                if insysmsg "Potion satchel used"
                                    if EnableOverheadMessages = 1
                                        overhead "[ FREE AGILITY POTION! ]" 93
                                    endif
                                    clearsysmsg
                                else 
                                    if EnableOverheadMessages = 1
                                        overhead '[ AGILITY POTION... ]' 93
                                    endif
                                    clearsysmsg
                                endif                            
                        else 
                            if not cooldown "Inventory Timer" 
                                if EnableOverheadMessages = 1
                                    overhead '[ NO AGILITY POTS! ]' 337
                                endif 
                                cooldown "Inventory Timer" 15000
                            endif
                        endif
                        wait 500
                    endif
                endif

                if EnableMagicResistPotion = 1
                    if not findbuff 'Magic Resist Potion'
                        wait 500
                        if findtype "Black Potion" self as resistpot
                            dclick resistpot
                            wait 250
                                if insysmsg "Potion satchel used"
                                    if EnableOverheadMessages = 1
                                        overhead "[ FREE RESIST POTION! ]" 808
                                    endif 
                                    clearsysmsg
                                else 
                                    if EnableOverheadMessages = 1
                                        overhead '[ RESIST POTION... ]' 808
                                    endif 
                                    clearsysmsg
                                endif  
                        else 
                            if not cooldown "Inventory Timer" 
                                if EnableOverheadMessages = 1
                                    overhead '[ NO RESIST POTS! ]' 337 
                                endif 
                                cooldown "Inventory Timer" 6000
                            endif
                        endif
                        wait 500
                    endif
                endif
                
                if EnableWeaponAbility = 1 
                    if cooldown "Discorded" 
                        if cooldown "Pacified" or cooldown "Provoked"
                            if EnableSkirmish = 1 and not cooldown "Weapon Ability" and not cooldown "Skirmish"
                                yell "[WeaponAbility1" 
                                wait 250
                                if insysmsg "You cannot"
                                    cooldown "Weapon Ability" 5000
                                else 
                                    if EnableOverheadMessages = 1
                                        overhead "[ SKIRMISH! ]" 337
                                    endif 
                                    cooldown "Weapon Ability" 61000
                                    cooldown "Skirmish" 15000
                                endif 

                            elseif EnableFullDraw = 1 and not cooldown "Weapon Ability" and not cooldown "Full Draw"
                                yell "[WeaponAbility2" 
                                wait 250
                                if insysmsg "You cannot"
                                    cooldown "Weapon Ability" 5000
                                else 
                                    if EnableOverheadMessages = 1
                                        overhead "[ FULL DRAW! ]" 2117
                                    endif 
                                    cooldown "Weapon Ability" 61000
                                    cooldown "Full Draw" 15000
                                endif 

                            elseif EnableRepeater = 1 and not cooldown "Weapon Ability" and not cooldown "Repeater"
                                yell "[WeaponAbility3" 
                                wait 250
                                if insysmsg "You cannot"
                                    cooldown "Weapon Ability" 5000
                                else 
                                    if EnableOverheadMessages = 1
                                        overhead "[ REPEATER LOADED... ]" 2114
                                    endif 
                                    cooldown "Weapon Ability" 65000
                                    cooldown "Repeater" 15000
                                    cooldown "Target Timer" 2500
                                    if EnableOverheadMessages = 1
                                        wait 500
                                        overhead "Uh oh..." 339 ClosestTarget 
                                    endif 
                                endif 
                            else
                                wait 250 
                            endif
                        endif
                    endif
                endif
                         
                if EnableDivineFury = 1 
                    if not cooldown "Divine Fury" and not cooldown "Chivalry" and not cooldown "Prevented" and diffhits < HealPotHPdiff 
                        clearsysmsg 
                        yell "[DivineFury"
                        wait 250
                    
                        if not insysmsg "You do not have enough holy" and not insysmsg "You must wait a moment"
                            cooldown "Divine Fury" 31000
                            cooldown "Chivalry" 10000
                            if EnableOverheadMessages = 1
                                overhead "[ DIVINE FURY! ]" 2117
                            endif 
                        else 
                            cooldown "Prevented" 5000
                        endif
                        wait 500
                    endif
                endif        

                if EnableEnemyOfOne = 1 
                    if not cooldown "Enemy Of One" and not cooldown "Chivalry" and not cooldown "Prevented" and diffhits < HealPotHPdiff 
                        yell "[EnemyOfOne"
                        wait 250
                    
                        if not insysmsg "You do not have enough holy" and not insysmsg "You must wait a moment"
                            cooldown "Enemy Of One" 31000
                            cooldown "Chivalry" 10000
                            if EnableOverheadMessages = 1
                                overhead "[ ENEMY OF ONE! ]" 332
                            endif 
                        else 
                            cooldown "Prevented" 5000
                        endif
                        wait 500
                    endif
                endif

                if EnableConsecrateWeapon = 1 
                    if cooldown "Discorded"
                        wait 150
                        if cooldown "Pacified" or cooldown "Provoked"
                            wait 150
                            if not cooldown "Consecrate Weapon" and not cooldown "Chivalry" and not cooldown "Prevented" and diffhits < HealPotHPdiff 
                                yell "[ConsecrateWeapon"
                                wait 250
                            
                                if not insysmsg "You do not have enough holy" and not insysmsg "You must wait a moment"
                                    cooldown "Consecrate Weapon" 31000
                                    cooldown "Chivalry" 10000
                                    if EnableOverheadMessages = 1
                                        overhead "[ CONSECRATE WEAPON! ]" 2206
                                    endif 
                                else 
                                    cooldown "Prevented" 5000
                                endif
                                wait 500
                            endif
                        endif
                    endif
                endif

                if EnablePeacemakingBuff = 1 and not findbuff "Song Of Peacemaking" and not cooldown "Provocation Buff" and not cooldown "Musicianship" and not cooldown "Peacemaking" and not cooldown "Song Buff Delay"
               
                    skill "Peacemaking"
                    wft 500
                
                    if insysmsg "What instrument shall you play?"
                        if findtype "standing harp|sackbut|bamboo flute|tambourine|drum|lute|lap harp|gemshorn|hurdy gurdy|psaltery|shawm|vielle" as Instrument
                            target Instrument
                            wait 250 
                        else               
                            if EnableOverheadMessages = 1                  
                                overhead "[ NO INSTRUMENT! ]" 337    
                            endif                     
                        endif
                    endif
                    
                    if not insysmsg "This is not a musical instrument"
                        wft 1000
                        target backpack 
                        if EnableOverheadMessages = 1
                            overhead "[ PEACEMAKING BUFF... ]" 84
                        endif 
                        cooldown "Peacemaking Buff" SongReapply
                        cooldown "Song Buff Delay" 11000
                    endif    

                    if not find ClosestTarget ground -1 -1 6 or dead ClosestTarget
                        break
                    endif   
                endif        
            
                if EnableDiscordanceBuff = 1 and not findbuff "Song Of Discordance" and not cooldown "Discordance Buff" and not cooldown "Musicianship" and not cooldown "Discordance" and not cooldown "Song Buff Delay"
                
                    skill "Discordance"
                    wft 500
                
                    if insysmsg "What instrument shall you play?"
                        if findtype "standing harp|sackbut|bamboo flute|tambourine|drum|lute|lap harp|gemshorn|hurdy gurdy|psaltery|shawm|vielle" as Instrument
                            target Instrument
                            wait 250
                        else         
                            if EnableOverheadMessages = 1                        
                                overhead "[ NO INSTRUMENT! ]" 337 
                            endif                        
                        endif
                    endif
                
                    if not insysmsg "This is not a musical instrument"
                        wft 1000
                        target backpack 
                        if EnableOverheadMessages = 1
                            overhead "[ DISCORDANCE BUFF... ]" 69
                        endif 
                        cooldown "Discordance Buff" SongReapply
                        cooldown "Song Buff Delay" 11000
                    endif      

                    if not find ClosestTarget ground -1 -1 6 or dead ClosestTarget
                        break
                    endif                   
                endif        

                if EnableProvocationBuff = 1 and not findbuff "Song of Provocation" and not cooldown "Provocation Buff" and not cooldown "Musicianship" and not cooldown "Provocation" and not cooldown "Song Buff Delay"
                
                    skill "Provocation"
                    wft 500
                
                    if insysmsg "What instrument shall you play?"
                        if findtype "standing harp|sackbut|bamboo flute|tambourine|drum|lute|lap harp|gemshorn|hurdy gurdy|psaltery|shawm|vielle" as Instrument
                            target Instrument
                            wait 250 
                        else                
                            if EnableOverheadMessages = 1                 
                                overhead "[ NO INSTRUMENT! ]" 337    
                            endif                     
                        endif
                    endif
            
                    if not insysmsg "This is not a musical instrument"
                        wft 1000
                        target backpack 
                        if EnableOverheadMessages = 1
                            overhead "[ PROVOCATION BUFF... ]" 2117
                        endif 
                        cooldown "Provocation Buff" SongReapply
                        cooldown "Song Buff Delay" 11000
                    endif   

                    if not find ClosestTarget ground -1 -1 6 or dead ClosestTarget
                        break
                    endif        
                endif                   

                if not find ClosestTarget ground -1 -1 6 or dead ClosestTarget
                    break 
                endif 
            
                
        #################################
        ####    CLEANUP & UTILITY:   ####
        #################################
                                
                    if insysmsg "world is saving"        
                        if not timerexists "WorldSaveTimer"
                            createtimer "WorldSaveTimer"
                        endif             
                            settimer "WorldSaveTimer" 0
                        while timer "WorldSaveTimer" < 4000
                            if insysmsg "save complete"
                                break
                            endif
                            wait 250 
                        endwhile   
                        if EnableOverheadMessages = 1         
                            overhead "[ SAVE COMPLETE! ]" 253
                        endif 
                    endif    
                    
                    if EnableWeightWarningMessage = 1
                        if diffweight < GreenWarningDiffWeight and diffweight > YellowWarningDiffWeight and not cooldown "Weight Warning"
                            overhead "[ WEIGHT WARNING... ]" 77
                            cooldown "Weight Warning" 6000
                            elseif diffweight < YellowWarningDiffWeight and diffweight > RedWeightLimitDiffWeight and not cooldown "Weight Warning"
                            overhead "[ WEIGHT WARNING! ]" 153
                            cooldown "Weight Warning" 6000
                        elseif diffweight < RedWeightLimitDiffWeight and not cooldown "Weight Warning"
                            overhead "-[ WEIGHT LIMIT REACHED!! ]-" 37
                            if EnableAutoWeightRecall = 1 and not find ClosestTarget ground -1 -1 6
                                
                                if targetexists 
                                    hotkey 'Cancel Current Target'
                                endif

                                clearsysmsg 

                                if not varexist escape_runebook
                                    overhead "Select your escape runebook..." 253
                                    setvar escape_runebook
                                    wait 2000
                                    replay
                                endif
        
                                    overhead "[ AUTO RECALL! ]" 84
                                    wait 150
                                    dclick escape_runebook
                                    waitforgump 1551740969
                                    gumpresponse 2
                                    wait 500
                                    
                                        if insysmsg 'Your concentration is disturbed'
                                            wait 1000
                                            for 5
                                                clearsysmsg
                                                overhead '[ INTERUPTED! ]' 153
                                                wait 500
                                                dclick escape_runebook
                                                waitforgump 1551740969 
                                                gumpresponse 2
                                                wait 500
                                                if insysmsg 'Your concentration is disturbed'
                                                    overhead 'Fuck off!' 6
                                                    wait 250
                                                else 
                                                    break
                                                endif 
                                            endfor
                                        endif

                                        wait 2000
                                        
                                        if not findtype 'stubnose crossbow|tower guard crossbow|balestra|long bow|bow|recurve bow|composite bow|heavy crossbow|crossbow' hand 
                                            if findtype 'long bow|bow|recurve bow|composite bow|stubnose crossbow|tower guard crossbow|balestra|heavy crossbow|crossbow' backpack as weapon
                                            for 5
                                                    getlabel weapon WeaponLabel
                                                    wait 500
                                                    if "unidentified" in WeaponLabel
                                                        @ignore weapon
                                                        wait 150
                                                        if findtype 'stubnose crossbow|tower guard crossbow|balestra|long bow|bow|recurve bow|composite bow|heavy crossbow|crossbow' backpack as weapon
                                                            getlabel weapon WeaponLabel
                                                        endif
                                                    else 
                                                        break
                                                    endif 
                                                endfor            
                                                dclick weapon
                                                wait 500
                                            endif 
                                        endif

                                        if EnableShield = 1
                                            if not findtype 'buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|Order shield|wooden shield|parrying gauche' lefthand
                                                if findtype 'buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|Order shield|wooden shield|parrying gauche' backpack as shield
                                                    for 5
                                                        getlabel shield ShieldLabel
                                                        wait 500
                                                        if "unidentified" in ShieldLabel
                                                            @ignore shield
                                                            wait 150 
                                                            if findtype 'buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|Order shield|wooden shield|parrying gauche' backpack as shield
                                                                getlabel shield ShieldLabel
                                                            endif
                                                        else 
                                                            break
                                                        endif 
                                                    endfor            
                                                    dclick shield
                                                    wait 500
                                                endif 
                                            endif
                                        endif

                                            wait 500
                                            useskill "Hiding"
                                            
                                            
                                        if findtype "bank deposit safe" ground -1 -1 2 as safe
                                            while findtype "gold coin" backpack as gold
                                                lift gold 60000
                                                overhead "[ DEPOSIT GOLD... ]" 149
                                                drop safe -1 -1 -1
                                                wait 1500
                                            endwhile
                                            while findtype 2539 backpack as dubs
                                                lift dubs 60000
                                                drop safe -1 -1 -1
                                                overhead "[ DEPOSIT DUBS... ]" 149
                                                wait 1500
                                            endwhile
                                        else
                                            overhead "[ NO BANK SAFE FOUND ]" 337
                                        endif
                                        wait 500

                                        if findtype "black market goods|seed of renewal|dirt patch|bag of seeds|void orb|rune|scroll of calling|bottle|dye bottle|map|research materials" self
                                            dclick 0x4F7A8106
                                            wait 1000
                                            overhead "[ STASHING LOOT... ]" 69
                                            hotkey "Organizer Agent-06"
                                            wait 250
                                            hotkey "Organizer Agent-07"
                                            wait 250
                                            hotkey "Organizer Agent-08"
                                            wait 250
                                            hotkey "Organizer Agent-09"
                                            wait 1500
                                        endif 

                                        if findtype "resource container" ground -1 -1 2 as resource
                                            menu resource 0
                                            wft 500
                                            target self
                                            overhead "[ PILING RESOURCES... ]" 84
                                            wait 1500
                                        else
                                            overhead "[ NO RESOURCE STOCKPILE FOUND ]" 337
                                        endif
                                        wait 500

                                        if findtype "storage shelf" ground -1 -1 2 as shelf
                                            menu shelf 0
                                            wft 500
                                            target self
                                            overhead "[ UNLOADING LOOT... ]" 2114
                                            wait 1500
                                            gumpclose 3232825965
                                        else
                                            overhead "[ NO STORAGE SHELF FOUND ]" 337
                                        endif       
                                        
                                        if findtype "storage shelf" ground -1 -1 2 as shelf
                                            menu shelf 1
                                            wft 500
                                            target self   
                                            overhead "[ RESUPPLYING... ]" 93
                                            wait 1500
                                        endif
                                        
                                        wait 500
                                        
                                        if findtype "repair bench" ground -1 -1 3 as RepairBench
                                            clearsysmsg 
                                            dclick RepairBench
                                            wait 1000
                                            if insysmsg "You do not have any items equipped or in your backpack in need of repairs."
                                                overhead "[ NOTHING TO REPAIR! ]" 0
                                            else
                                                settimer RepairTimer 0
                                            while timer RepairTimer <= 5000 
                                                if insysmsg "Repair"
                                                    break
                                                endif
                                            endwhile
                                            overhead "[ ITEMS REPAIRED! ]" 0
                                            overhead "Repair took: {{RepairTimer}}ms" 149
                                            removetimer RepairTimer
                                            endif
                                        else
                                            overhead "[ NO REPAIR BENCH FOUND ]" 337
                                        endif

                                        if findtype "ornate elven chest|magic item recycler" ground -1 -1 2 as recycler
                                            menu recycler 1
                                            wait 1000
                                            if insysmsg "0 recyclable"
                                                overhead "[ NO MAGIC LOOT! ]" 6
                                            else
                                                overhead "[ RECYCLING MAGIC LOOT... ]" 6
                                                wait 200
                                            endif
                                        else
                                            overhead "[ NO MAGIC ITEM RECYCLER FOUND ]" 337
                                        endif

                                        wait 1000
                                        hotkey "Organizer Agent-04"
                                        overhead "[ SCRIPT COMPLETE! ]" 69
                                    stop    
                            elseif EnableAutoWeightRecall = 1 and find ClosestTarget ground -1 -1 6
                                if not cooldown "Cleanup"
                                    overhead "[ WAITING TO RECALL... ]" 149
                                    cooldown "Cleanup" 3500
                                endif 
                                wait 500
                            else 
                                overhead "[ OVERWEIGHT! ]" 
                                sysmsg "Time to head home and unload our loot!" 0   
                                cooldown "Weight Timer" 5000
                            endif 
                        endif
                    endif  
              
                    if EnableAmmoWarningMessage = 1
                        if findtype 'stubnose crossbow|tower guard crossbow|balestra|heavy crossbow|crossbow' hand
                            # BOLTS
                            @setvar! AMMO 1

                        elseif findtype 'long bow|bow|recurve bow|composite bow' hand
                            # ARROWS
                            @setvar AMMO 2
                        endif

                        if counttype "crossbow bolt" self < LowAmmoWarningAmount and not cooldown "Ammunition" and AMMO = 1
                            overhead "[ AMMO LOW! ]" 37
                            cooldown "Ammunition" 6000
                        endif 

                        if counttype "arrow" self < LowAmmoWarningAmount and not cooldown "Ammunition" and AMMO = 2
                            overhead "[ AMMO LOW! ]" 37
                            cooldown "Ammunition" 6000    
                        endif
                    endif 
            
                    if findtype "arrow|crossbow bolt" backpack
                        if not cooldown "Satchel Timer" and findtype "quiver" self as MyQuiver
                            menu MyQuiver 0
                            wait 250
                            cooldown "Satchel Timer" 5000
                        endif
                    endif 
                    
                    if findtype 'Elven SpellBlade' backpack and EnableAutoCarving = 1
                        if findtype "corpse" ground -1 -1 2 as corpse
                            wait 500
                            dclicktype "Elven Spellblade"
                            wft 1000
                            if EnableOverheadMessages = 1
                                overhead "[ SKINNING... ]" 338
                            endif 
                            target 'self'
                            wait 500
                            @ignore corpse
                        endif
                    else
                        if not cooldown "Inventory Timer" 
                            if EnableOverheadMessages = 1
                                overhead "[ NO SKINNING KNIFE! ]" 337
                            endif 
                            cooldown "Inventory Timer" 6000
                        endif 
                    endif
              
                    if EnableArrowCleanup = 1
                        if findtype 7163|3903 ground -1 -1 2 as item and not cooldown "Cleanup"
                            if EnableOverheadMessages = 1
                                overhead '[ CLEANUP... ]' 93
                            endif 
                            hotkey "Grab Item"
                            wft 1000
                            target item
                            wait 250
                            if findtype "quiver" self as MyQuiver
                                menu MyQuiver 0
                                wait 250
                            else
                                hotkey 'Organizer Agent-03'
                                wait 150  
                            endif
                            cooldown "Cleanup" 1000
                        endif

                        if findtype 7163 ground -1 -1 10 as bolt and not cooldown "Radar"                    
                            overhead "" 93 bolt
                            cooldown "Radar" 3500
                        endif

                        if findtype 3903 ground -1 -1 10 as arrow and not cooldown "Radar"
                            overhead "" 37 arrow
                            cooldown "Radar" 3500
                        endif
                    endif  
                    
                    if not findtype "standing harp|sackbut|bamboo flute|tambourine|drum|lute|lap harp|gemshorn|hurdy gurdy|psaltery|shawm|vielle" self
                        if EnableOverheadMessages = 1
                            overhead "[ NO INSTRUMENT! ]" 333
                        endif 
                        replay
                    endif 

                    if not findtype 'stubnose crossbow|tower guard crossbow|balestra|long bow|bow|recurve bow|composite bow|heavy crossbow|crossbow' hand 
                        if findtype 'stubnose crossbow|tower guard crossbow|balestra|long bow|bow|recurve bow|composite bow|heavy crossbow|crossbow' backpack as weapon
                            for 5
                                getlabel weapon WeaponLabel
                                wait 500
                                    if "unidentified" in WeaponLabel
                                        @ignore weapon
                                        if findtype 'stubnose crossbow|tower guard crossbow|balestra|long bow|bow|recurve bow|composite bow|heavy crossbow|crossbow' backpack as weapon
                                            getlabel weapon WeaponLabel
                                        endif
                                    else 
                                        break
                                    endif 
                            endfor            
                        dclick weapon
                        wait 250
                        endif 
                    endif

                    if EnableShield = 1
                        if not findtype 'buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|Order shield|wooden shield|parrying gauche' lefthand
                            if findtype 'buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|Order shield|wooden shield|parrying gauche' backpack as shield
                                getlabel shield ShieldLabel
                                    for 5
                                        wait 500
                                        if "unidentified" in ShieldLabel
                                            @ignore shield
                                        if findtype 'buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|Order shield|wooden shield|parrying gauche' backpack as shield
                                                getlabel shield ShieldLabel
                                            endif
                                        endif 
                                    endfor            
                                dclick shield
                                wait 250
                            endif 
                        endif
                    endif
                    
                    if not find ClosestTarget ground -1 -1 6 or dead ClosestTarget
                        break
                    endif 
        endwhile   
        
    
        #################################
        ####       AFTER KILL:       ####
        #################################

            wait 500 

            if insysmsg "You have gained"    
                if EnableOverheadMessages = 1
                    overhead "[ TARGET ELIMINATED!! ]" 149
                endif 
                sysmsg "You have killed {{descTarget}}!" 6
                cooldown "Pacified" 0
                cooldown "Discorded" 0
                cooldown "Provoked" 0   
            else    
                if EnableOverheadMessages = 1
                    overhead "[ TARGET LOST... ]" 339
                endif 
                cooldown "Pacified" 0
                cooldown "Discorded" 0
                cooldown "Provoked" 0 
            endif       

            if EnableOverheadMessages = 1    
                if insysmsg "mastery chain"
                    overhead "[ NEW LINK UNLOCKED!! ]" 149
                    wait 250
                endif 

                if insysmsg "You have unlocked a codex upgrade point"
                    overhead "[ CODEX POINT UNLOCKED! ]" 2114  
                    wait 250
                endif 

                if insysmsg "enough experience to upgrade"
                    overhead "[ ASPECT TIER UNLOCKED! ]" 2241
                    wait 250
                endif 
            endif 

            cooldown "Cleanup" 5000
            cooldown "Satchel Timer" 6000
            cooldown "Target Check" 0

                while cooldown "Cleanup"
                                
                    if findtype 'Elven SpellBlade' backpack and EnableAutoCarving = 1
                        if findtype "corpse" ground -1 -1 2 as mykill  
                            wait 500
                            if EnableOverheadMessages = 1           
                                overhead "[ SKINNING... ]" 338
                            endif 
                            dclicktype "Elven Spellblade"
                            wft 3500
                            target 'self'
                            wait 500
                            @ignore mykill
                        endif
                    else
                        if not cooldown "Inventory Timer"
                            if EnableOverheadMessages = 1
                                overhead "[ NO SKINNING KNIFE! ]" 337
                            endif 
                            cooldown "Inventory Timer" 4000
                        endif
                    endif 
                    
                    wait 500

                   if not cooldown "Target Check"
                        hotkey 'Target Closest Grey Monster'
                        wait 250 
                        if insysmsg "No one matching that was found"  
                            // Do Nothing
                        else 
                            break
                        endif         
                        cooldown "Target Check" 1000
                    endif 
                    
                    if paralyzed and EnableParalyzePouch = 1
                        if findtype "pouch" self
                            yell "[pouch"
                            hotkey 'Toggle War Only'
                            replay
                        else
                            if EnableOverheadMessages = 1 
                                overhead "[ NO MORE POUCHES! ]" 337
                            endif
                        endif           
                    endif 
                    
                    if EnablePKradar = 1 and not cooldown "PK Radar" 
                        hotkey 'Next Murderer Player Target'
                        wait 500
                        if insysmsg "No one matching that was found"   
                            cooldown "PK Radar" 2000
                        else
                            overhead "[ !! RED ALERT !! ]" 37
                            hotkey 'Toggle War Only'
                            replay
                        endif 
                    endif 

                    if insysmsg "world is saving"        
                        if not timerexists "WorldSaveTimer"
                            createtimer "WorldSaveTimer"
                        endif             
                            settimer "WorldSaveTimer" 0
                        while timer "WorldSaveTimer" < 4000
                            if insysmsg "save complete"
                                break
                            endif
                            wait 250 
                        endwhile   
                        if EnableOverheadMessages = 1         
                            overhead "[ SAVE COMPLETE! ]" 253
                        endif 
                    endif     

                    if EnableWeightWarningMessage = 1
                        if diffweight < GreenWarningDiffWeight and diffweight > YellowWarningDiffWeight and not cooldown "Weight Warning"
                            overhead "[ WEIGHT WARNING... ]" 77
                            cooldown "Weight Warning" 6000
                            elseif diffweight < YellowWarningDiffWeight and diffweight > RedWeightLimitDiffWeight and not cooldown "Weight Warning"
                            overhead "[ WEIGHT WARNING! ]" 153
                            cooldown "Weight Warning" 6000
                        elseif diffweight < RedWeightLimitDiffWeight and not cooldown "Weight Warning"
                            overhead "-[ WEIGHT LIMIT REACHED!! ]-" 37
                            if EnableAutoWeightRecall = 1 and not find ClosestTarget ground -1 -1 6
                                
                                if targetexists 
                                    hotkey 'Cancel Current Target'
                                endif

                                clearsysmsg 

                                if not varexist escape_runebook
                                    overhead "Select your escape runebook..." 253
                                    setvar escape_runebook
                                    wait 2000
                                    replay
                                endif
        
                                    overhead "[ AUTO RECALL! ]" 84
                                    wait 150
                                    dclick escape_runebook
                                    waitforgump 1551740969
                                    gumpresponse 2
                                    wait 500
                                    
                                        if insysmsg 'Your concentration is disturbed'
                                            wait 1000
                                            for 5
                                                clearsysmsg
                                                overhead '[ INTERUPTED! ]' 153
                                                wait 500
                                                dclick escape_runebook
                                                waitforgump 1551740969 
                                                gumpresponse 2
                                                wait 500
                                                if insysmsg 'Your concentration is disturbed'
                                                    overhead 'Fuck off!' 6
                                                    wait 250
                                                else 
                                                    break
                                                endif 
                                            endfor
                                        endif

                                        wait 2000
                                        
                                        if not findtype 'stubnose crossbow|tower guard crossbow|balestra|long bow|bow|recurve bow|composite bow|heavy crossbow|crossbow' hand 
                                            if findtype 'long bow|bow|recurve bow|composite bow|stubnose crossbow|tower guard crossbow|balestra|heavy crossbow|crossbow' backpack as weapon
                                            for 5
                                                    getlabel weapon WeaponLabel
                                                    wait 500
                                                    if "unidentified" in WeaponLabel
                                                        @ignore weapon
                                                        wait 150
                                                        if findtype 'stubnose crossbow|tower guard crossbow|balestra|long bow|bow|recurve bow|composite bow|heavy crossbow|crossbow' backpack as weapon
                                                            getlabel weapon WeaponLabel
                                                        endif
                                                    else 
                                                        break
                                                    endif 
                                                endfor            
                                                dclick weapon
                                                wait 500
                                            endif 
                                        endif

                                        if EnableShield = 1
                                            if not findtype 'buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|Order shield|wooden shield|parrying gauche' lefthand
                                                if findtype 'buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|Order shield|wooden shield|parrying gauche' backpack as shield
                                                    for 5
                                                        getlabel shield ShieldLabel
                                                        wait 500
                                                        if "unidentified" in ShieldLabel
                                                            @ignore shield
                                                            wait 150 
                                                            if findtype 'buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|Order shield|wooden shield|parrying gauche' backpack as shield
                                                                getlabel shield ShieldLabel
                                                            endif
                                                        else 
                                                            break
                                                        endif 
                                                    endfor            
                                                    dclick shield
                                                    wait 500
                                                endif 
                                            endif
                                        endif

                                            wait 500
                                            useskill "Hiding"
                                            
                                            
                                        if findtype "bank deposit safe" ground -1 -1 2 as safe
                                            while findtype "gold coin" backpack as gold
                                                lift gold 60000
                                                overhead "[ DEPOSIT GOLD... ]" 149
                                                drop safe -1 -1 -1
                                                wait 1500
                                            endwhile
                                            while findtype 2539 backpack as dubs
                                                lift dubs 60000
                                                drop safe -1 -1 -1
                                                overhead "[ DEPOSIT DUBS... ]" 149
                                                wait 1500
                                            endwhile
                                        else
                                            overhead "[ NO BANK SAFE FOUND ]" 337
                                        endif
                                        wait 500

                                        if findtype "black market goods|seed of renewal|dirt patch|bag of seeds|void orb|rune|scroll of calling|bottle|dye bottle|map|research materials" self
                                            dclick 0x4F7A8106
                                            wait 1000
                                            overhead "[ STASHING LOOT... ]" 69
                                            hotkey "Organizer Agent-06"
                                            wait 250
                                            hotkey "Organizer Agent-07"
                                            wait 250
                                            hotkey "Organizer Agent-08"
                                            wait 250
                                            hotkey "Organizer Agent-09"
                                            wait 1500
                                        endif 

                                        if findtype "resource container" ground -1 -1 2 as resource
                                            menu resource 0
                                            wft 500
                                            target self
                                            overhead "[ PILING RESOURCES... ]" 84
                                            wait 1500
                                        else
                                            overhead "[ NO RESOURCE STOCKPILE FOUND ]" 337
                                        endif
                                        wait 500

                                        if findtype "storage shelf" ground -1 -1 2 as shelf
                                            menu shelf 0
                                            wft 500
                                            target self
                                            overhead "[ UNLOADING... ]" 2114
                                            wait 1500
                                            gumpclose 3232825965
                                        else
                                            overhead "[ NO STORAGE SHELF FOUND ]" 337
                                        endif       
                                        
                                        if findtype "storage shelf" ground -1 -1 2 as shelf
                                            menu shelf 1
                                            wft 500
                                            target self   
                                            overhead "[ RESUPPLYING... ]" 93
                                            wait 1500
                                        endif
                                        
                                        wait 500
                                        
                                        if findtype "repair bench" ground -1 -1 3 as RepairBench
                                            clearsysmsg 
                                            dclick RepairBench
                                            wait 1000
                                            if insysmsg "You do not have any items equipped or in your backpack in need of repairs."
                                                overhead "[ NOTHING TO REPAIR! ]" 0
                                            else
                                                settimer RepairTimer 0
                                            while timer RepairTimer <= 5000 
                                                if insysmsg "Repair"
                                                    break
                                                endif
                                            endwhile
                                            overhead "[ ITEMS REPAIRED! ]" 0
                                            overhead "Repair took: {{RepairTimer}}ms" 149
                                            removetimer RepairTimer
                                            endif
                                        else
                                            overhead "[ NO REPAIR BENCH FOUND ]" 337
                                        endif

                                        if findtype "ornate elven chest|magic item recycler" ground -1 -1 2 as recycler
                                            menu recycler 1
                                            wait 1000
                                            if insysmsg "0 recyclable"
                                                overhead "[ NO MAGIC LOOT! ]" 6
                                            else
                                                overhead "[ RECYCLING MAGIC LOOT... ]" 6
                                                wait 200
                                            endif
                                        else
                                            overhead "[ NO MAGIC ITEM RECYCLER FOUND ]" 337
                                        endif

                                        wait 1000
                                        hotkey "Organizer Agent-04"
                                        overhead "[ SCRIPT COMPLETE! ]" 69
                                    stop    
                            elseif EnableAutoWeightRecall = 1 and find ClosestTarget ground -1 -1 6
                                if not cooldown "Cleanup"
                                    overhead "[ WAITING TO RECALL... ]" 149
                                    cooldown "Cleanup" 3500
                                endif 
                                wait 500
                            else 
                                overhead "[ OVERWEIGHT! ]" 
                                sysmsg "Time to head home and unload our loot!" 0   
                                cooldown "Weight Timer" 5000
                            endif 
                        endif
                    endif  
              
                    if EnableAmmoWarningMessage = 1
                        if findtype 'stubnose crossbow|tower guard crossbow|balestra|heavy crossbow|crossbow' hand
                            # BOLTS
                            @setvar! AMMO 1

                        elseif findtype 'long bow|bow|recurve bow|composite bow' hand
                            # ARROWS
                            @setvar AMMO 2
                        endif

                        if counttype "crossbow bolt" self < LowAmmoWarningAmount and not cooldown "Ammunition" and AMMO = 1
                            overhead "[ AMMO LOW! ]" 37
                            cooldown "Ammunition" 6000
                        endif 

                        if counttype "arrow" self < LowAmmoWarningAmount and not cooldown "Ammunition" and AMMO = 2
                            overhead "[ AMMO LOW! ]" 37
                            cooldown "Ammunition" 6000    
                        endif
                    endif 
            
                    if findtype "arrow|crossbow bolt" backpack
                        if not cooldown "Satchel Timer" and findtype "quiver" self as MyQuiver
                            menu MyQuiver 0
                            wait 500
                            cooldown "Satchel Timer" 5000
                        endif
                    endif 
                    
                endwhile
            replay 
        endif 
endwhile

wait 1000

if dead 
    if EnableOverheadMessages = 1
        wait 1500
        overhead "Well... shit..." 6
        wait 2000
        overhead '[ STOPPING SCRIPT... ]' 37
    endif 
    sysmsg "Stopping Ultimate Bard Auto Pilot script..." 0
    stop
else 
    replay
endif

replay


    //////////////
    // THE END! //
    //////////////