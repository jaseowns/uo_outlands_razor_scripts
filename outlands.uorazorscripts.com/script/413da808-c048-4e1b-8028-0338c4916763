# This is an automated backup - check out https://outlands.uorazorscripts.com/script/413da808-c048-4e1b-8028-0338c4916763 for latest
# Automation by Jaseowns
## Script: copyTome
## Created by: flutschi#0
#############################################

# Make sure you stay next to a ress stockpile (to check if recall home worked) and next to a shelf to restock 
# make sure you have a rune that is called "House" to recall back

# then if you also have a tank it will all guard you when u copy witcher for example, sometimes there are mobs
# and if you have vet supplies it heals
# and if you can cast mushrooms for mana, it will do that too..

# to create the pushlist section, use any AI to copy the original content, it can read it and create the list

clearignore
@setvar! recallTimer 2500
@setvar! normalPause 650

@setvar! originalTome 0x44BE3B00
@setvar! copyTome 0x4C7F19B6

@setvar! tomeBag 0x4D97A3F7

@removelist runeList
createlist runeList
pushlist runeList 'Mage [Anchors Rest]'
pushlist runeList 'Mage [Andaria 1]'
pushlist runeList 'Mage [Andaria 2]'
pushlist runeList 'Mage [Cambria 1]'
pushlist runeList 'Mage [Cambria 2]'
pushlist runeList 'Mage [Horseshoe Bay]'
pushlist runeList 'Mage [Outpost]'
pushlist runeList 'Mage [Prevalia 1]'
pushlist runeList 'Mage [Prevalia 2]'
pushlist runeList 'Mage [Prevalia 3]'
pushlist runeList 'Mage [Saltshore Docks]'
pushlist runeList 'Mage [Terran]'
pushlist runeList 'Mage [Totem]'
pushlist runeList 'Scribe [Anchors Rest]'
pushlist runeList 'Scribe [Andaria 1]'
pushlist runeList 'Scribe [Andaria 2]'
pushlist runeList 'Scribe [Cambria 1]'
pushlist runeList 'Scribe [Cambria 2]'
pushlist runeList 'Scribe [Haven]'
pushlist runeList 'Scribe [Horseshoe Bay]'
pushlist runeList 'Scribe [Outpost]'
pushlist runeList 'Scribe [Prevalia 1]'
pushlist runeList 'Scribe [Prevalia 2]'
pushlist runeList 'Scribe [Terran]'
pushlist runeList 'Scribe [Totem]'

if counttype 7956 backpack 2882 < 30
    overhead 'more runes needed'
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

hotkey 'all follow me'
pause 400
    
dclick tomeBag
pause 1000

if atlist runeName 1 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 201
    waitforgump 167090027 1000
    gumpresponse 20
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 2 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 202
    waitforgump 167090027 1000
    gumpresponse 10
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 3 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 203
    waitforgump 167090027 1000
    gumpresponse 20
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 4 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 204
    waitforgump 167090027 1000
    gumpresponse 10
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 5 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 205
    waitforgump 167090027 1000
    gumpresponse 20
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 6 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 206
    waitforgump 167090027 1000
    gumpresponse 10
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 7 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 207
    waitforgump 167090027 1000
    gumpresponse 20
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 8 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 208
    waitforgump 167090027 1000
    gumpresponse 10
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 9 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 209
    waitforgump 167090027 1000
    gumpresponse 20
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 10 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 210
    waitforgump 167090027 1000
    gumpresponse 10
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 11 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 211
    waitforgump 167090027 1000
    gumpresponse 20
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 12 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 212
    waitforgump 167090027 1000
    gumpresponse 10
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 13 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 213
    waitforgump 167090027 1000
    gumpresponse 20
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 14 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 214
    waitforgump 167090027 1000
    gumpresponse 10
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 15 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 215
    waitforgump 167090027 1000
    gumpresponse 20
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 16 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 216
    waitforgump 167090027 1000
    gumpresponse 10
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 17 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 217
    waitforgump 167090027 1000
    gumpresponse 20
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 18 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 218
    waitforgump 167090027 1000
    gumpresponse 10
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 19 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 219
    waitforgump 167090027 1000
    gumpresponse 20
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 20 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 220
    waitforgump 167090027 1000
    gumpresponse 10
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 21 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 221
    waitforgump 167090027 1000
    gumpresponse 20
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 22 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 222
    waitforgump 167090027 1000
    gumpresponse 10
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 23 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 223
    waitforgump 167090027 1000
    gumpresponse 20
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

    

dclick tomeBag
pause 1000

if atlist runeName 24 as listName
    @setvar! runeName listName
else
    @setvar! runeName "no name"
endif

overhead 'Copying Rune - {{runeName}}'
    
if cooldown 'worldSave'
    overhead 'Waiting for world save...'
    pause 30000
endif

while hp < 100
    if findtype 25750 backpack as bandages
        dclick bandages
        pause 1000
    endif
endwhile

if findtype 7956 backpack 2882 as emptyRune

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    pause 400
    dclick originalTome
    waitforgump 167090027 1000
    gumpresponse 224
    waitforgump 167090027 1000
    gumpresponse 10
    pause recallTimer
    hotkey 'all guard me'
    pause normalPause

    if find ressStockpile

        overhead 'home.. dont mark!'
    
    else

        cast 'Mark'
        waitfortarget 2500
        target emptyRune
        pause normalPause
        while not findtype 23034 ground -1 -1 2
            for 10
                overhead 'recall Home'
                say '[recall House'
                pause 200
                while casting
                endwhile
                pause 400
                if findtype 23034 ground -1 -1 2
                    break
                else
                    hotkey 'cancel current target'
                    overhead 'not at house yet..'
                    if dead
                        stop
                    endif
                endif
            endfor
        endwhile
                
        dclick tomeBag
        pause 1000

        if findtype 7956 backpack 0 as rune
            overhead 'using this tome' 6 copyTome
            overhead 'renaming rune to name' 6 rune
            dclick rune
            pause normalPause
            promptresponse runeName
            pause normalPause
            @drop backpack
            lift rune 1
            drop copyTome
            pause normalPause
        endif

        if insysmsg 'world is saving'
            for 30
                overhead 'Waiting for world save...'
                wait 1000
                if insysmsg 'save complete'
                    overhead 'Save complete - continue on!' 88
                    clearsysmsg 
                    wait 250
                    break
                endif
            endfor
        endif

        if findtype 7956 backpack 0 as rune
            overhead 'something went wrong..'
            while findtype 7956 backpack 0 as rune
                lift rune
                drop 0x41B742BD 75 85 0
            endif
        endif

        while dead
            overhead 'Copying Rune - {{runeName}}'
            pause 1000
        endwhile
    
    endif
    
endif

if findtype 44997 ground -1 -1 2 as shelf
    menu shelf 1
endif

if skill 'meditation' >= 80
    cast 'Create Food'
    pause 1100
endif


while mana < 60

    if not cooldown 'mushroom'
        if findtype 29012 backpack as mushroom
            dclick mushroom
            pause 400
            cooldown 'mushroom' 60000
        endif
    endif

    if findtype 25750 backpack as bandages
        dclick bandages
    endif

    skill 'meditation'
    pause 1000

endwhile

overhead 'Finished!!'
overhead 'Finished!!'
overhead 'Finished!!'