# This is an automated backup - check out https://outlands.uorazorscripts.com/script/2340455f-c500-44e2-a0b3-64e357225ea5 for latest
# Automation by Jaseowns
## Script: Dress Suite - Spellbook
## Created by: thisideasucks#0
#############################################

// Dress Suite - Spellbook
// Original credit for the concept to Demlar

// Waits and timeouts - Adjust if you have issues with aspect applying, etc.
@setvar! gumpWait 300
@setvar! globalTimeout 300

// Whether to activate aspect and whether script is chatty
@setvar! activateAspect 1
@setvar! chattyScript 0

// Find equipped glove item
if findlayer self gloves as item
    getlabel item glovesLabel
    if chattyScript = 1
        overhead "Gloves: {{glovesLabel}}"
    endif
    @setvar! glovesItem item
// Equip previous glove item if needed
else 
    if varexist glovesItem
        getlabel glovesItem glovesLabel
        if chattyScript = 1
            overhead "Wearing: {{glovesLabel}}"
        endif
        lift glovesItem
        drop self gloves
    endif
endif

// Find equipped inner torso item
if findlayer self innertorso as item
    getlabel item innerTorsoLabel
    if chattyScript = 1
        overhead "Inner Torso: {{innerTorsoLabel}}"
    endif
    @setvar! innerTorsoItem item
// Equip previous inner torso item if needed
else 
    if varexist innerTorsoItem
        getlabel innerTorsoItem innerTorsoLabel
        if chattyScript = 1
            overhead "Wearing: {{innerTorsoLabel}}"
        endif
        lift innerTorsoItem
        drop self innertorso
    endif
endif

// Find equipped outer torso item
if findlayer self outertorso as item
    getlabel item outerTorsoLabel
    if chattyScript = 1
        overhead "Outer Torso: {{outerTorsoLabel}}"
    endif
    @setvar! outerTorsoItem item
// Equip previous outer torso item if needed
else 
    if varexist outerTorsoItem
        getlabel outerTorsoItem outerTorsoLabel
        if chattyScript = 1
            overhead "Wearing: {{outerTorsoLabel}}"
        endif
        lift outerTorsoItem
        drop self outertorso
    endif
endif

// Find equipped head item
if findlayer self head as item
    getlabel item headLabel
    if chattyScript = 1
        overhead "Set: {{headLabel}}"
    endif
    @setvar! headItem item
// Equip previous head item if needed
else 
    if varexist headItem
        getlabel headItem headLabel
        if chattyScript = 1
            overhead "Wearing: {{headLabel}}"
        endif
        lift headItem
        drop self head
    endif
endif

// Find equipped neck item
if findlayer self neck as item
    getlabel item neckLabel
    if chattyScript = 1
        overhead "Set: {{neckLabel}}"
    endif
    @setvar! neckItem item
// Equip previous neck item if needed
else 
    if varexist neckItem
        getlabel neckItem neckLabel
        if chattyScript = 1
            overhead "Wearing: {{neckLabel}}"
        endif
        lift neckItem
        drop self neck
    endif
endif

// Find equipped innerLegs item
if findlayer self innerLegs as item
    getlabel item innerLegsLabel
    if chattyScript = 1
        overhead "Set: {{innerLegsLabel}}"
    endif
    @setvar! innerLegsItem item
// Equip previous innerLegs item if needed
else 
    if varexist innerLegsItem
        getlabel innerLegsItem innerLegsLabel
        if chattyScript = 1
            overhead "Wearing: {{innerLegsLabel}}"
        endif
        lift innerLegsItem
        drop self innerLegs
    endif
endif

// Find equipped outerLegs item
if findlayer self outerLegs as item
    getlabel item outerLegsLabel
    if chattyScript = 1
        overhead "Set: {{outerLegsLabel}}"
    endif
    @setvar! outerLegsItem item
// Equip previous outerLegs item if needed
else 
    if varexist outerLegsItem
        getlabel outerLegsItem outerLegsLabel
        if chattyScript = 1
            overhead "Wearing: {{outerLegsLabel}}"
        endif
        lift outerLegsItem
        drop self outerLegs
    endif
endif

// Find equipped arms item
if findlayer self arms as item
    getlabel item armsLabel
    if chattyScript = 1
        overhead "Set: {{armsLabel}}"
    endif
    @setvar! armsItem item
// Equip previous arms item if needed
else 
    if varexist armsItem
        getlabel armsItem armsLabel
        if chattyScript = 1
            overhead "Wearing: {{armsLabel}}"
        endif
        lift armsItem
        drop self arms
    endif
endif

// Find equipped rightHand item
if findlayer self rightHand as item
    getlabel item rightHandLabel
    if chattyScript = 1
        overhead "Set: {{rightHandLabel}}"
    endif
    @setvar! rightHandItem item
// Equip previous rightHand item if needed
else 
    if varexist rightHandItem
        getlabel rightHandItem rightHandLabel
        if chattyScript = 1
            overhead "Wearing: {{rightHandLabel}}"
        endif
        lift rightHandItem
        drop self rightHand
    endif
endif

// Find equipped shoes item
if findlayer self leftHand as item
    getlabel item leftHandLabel
    if chattyScript = 1
        overhead "Set: {{leftHandLabel}}"
    endif
    @setvar! leftHandItem item
// Equip previous leftHand item if needed
else 
    if varexist leftHandItem
        getlabel leftHandItem leftHandLabel
        if chattyScript = 1
            overhead "Wearing: {{leftHandLabel}}"
        endif
        lift leftHandItem
        drop self leftHand
    endif
endif

// Find equipped shoes item
if findlayer self shoes as item
    getlabel item shoesLabel
    if chattyScript = 1
        overhead "Set: {{shoesLabel}}"
    endif
    @setvar! shoesItem item
// Equip previous shoes item if needed
else 
    if varexist shoesItem
        getlabel shoesItem shoesLabel
        if chattyScript = 1
            overhead "Wearing: {{shoesLabel}}"
        endif
        lift shoesItem
        drop self shoes
    endif
endif

// Find equipped pants item
if findlayer self pants as item
    getlabel item pantsLabel
    if chattyScript = 1
        overhead "Set: {{pantsLabel}}"
    endif
    @setvar! pantsItem item
// Equip previous pants item if needed
else 
    if varexist pantsItem
        getlabel pantsItem pantsLabel
        if chattyScript = 1
            overhead "Wearing: {{pantsLabel}}"
        endif
        lift pantsItem
        drop self pants
    endif
endif

// Find equipped cloak item
if findlayer self cloak as item
    getlabel item cloakLabel
    if chattyScript = 1
        overhead "Set: {{cloakLabel}}"
    endif
    @setvar! cloakItem item
// Equip previous cloak item if needed
else 
    if varexist cloakItem
        getlabel cloakItem cloakLabel
        if chattyScript = 1
            overhead "Wearing: {{cloakLabel}}"
        endif
        lift cloakItem
        drop self cloak
    endif
endif

// Find equipped talisman item
if findlayer self talisman as item
    getlabel item talismanLabel
    if chattyScript = 1
        overhead "Set: {{talismanLabel}}"
    endif
    @setvar! talismanItem item
// Equip previous talisman item if needed
else 
    if varexist talismanItem
        getlabel talismanItem talismanLabel
        if chattyScript = 1
            overhead "Wearing: {{talismanLabel}}"
        endif
        lift talismanItem
        drop self talisman
    endif
endif

if findtype 2597 backpack as lantern
    dclick lantern
    wait globalTimeout
endif

// Activate aspect
if activateAspect > 0
    if ingump "Show Only Unlocked"
        gumpresponse 102
        waitforgump 2424293173 gumpWait
    endif
    say '[aspect'
    waitforgump 2424293173 gumpWait
    gumpresponse 17
    wait gumpWait
    waitforgump 2424293173 gumpWait
    gumpresponse 17
    wait gumpWait
    gumpresponse 13
    waitforgump 2424293173 gumpWait
    wait gumpWait
    gumpresponse 13
    waitforgump 2424293173 gumpWait
    gumpclose
    overhead "Dress - Spellbook Completed" 88
endif