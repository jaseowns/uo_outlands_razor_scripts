# This is an automated backup - check out https://outlands.uorazorscripts.com/script/a1cd2d08-b307-48d5-ad4e-131354f4e1cf for latest
# Automation by Jaseowns
## Script: Bapeth's Ship Deck Poisoner
## Created by: barryroser#0
#############################################

# Bapeths Ship Deck Poisoner
#
# This script will search for enemy crewmembers
# And will poison them if they are not poisoned
#
# Script starts here
if not timerexists disruptspell
    createtimer disruptspell
    settimer disruptspell 25000
endif

if timer disruptspell >= 25000
    hotkey '> Interrupt'
    hotkey 'Cancel Current Target'
    settimer disruptspell 0
endif

if mana >= 9
    for 75
        hotkey 'Cancel Current Target'
        hotkey "Next Monster Target"
        @setvar enemycrew lasttarget
        if find enemycrew ground -1 -1 12
            //donothing
        else 
            replay
        endif
        if noto "enemycrew" = "hostile"
            getlabel enemycrew desc
            if "Ticks" in desc
                //do nothing
            elseif "Poison" in desc
                //do nothing
            elseif find enemycrew ground -1 -1 12
                cast "Poison"
                wft 2000
                target enemycrew
                hotkey "Cancel Current Target"
                pause 250
                replay
            endif
            break
        elseif noto "enemycrew" = "criminal"
            getlabel enemycrew desc
            if "Ticks" in desc
                //do nothing
            elseif "Poison" in desc
                //do nothing
            elseif find enemycrew ground -1 -1 12
                cast "Poison"
                wft 2000
                target enemycrew
                hotkey "Cancel Current Target"
                pause 250
                replay
            endif
            break
        elseif noto "enemycrew" = "murderer"
            getlabel enemycrew desc
            if "Ticks" in desc
                //do nothing
            elseif "Poison" in desc
                //do nothing
            elseif find enemycrew ground -1 -1 12
                cast "Poison"
                wft 2000
                target enemycrew
                hotkey "Cancel Current Target"
                pause 250
                replay
            endif
            break
        elseif noto "enemycrew" = "enemy"
            getlabel enemycrew desc
            if "Ticks" in desc
                //do nothing
            elseif "Poison" in desc
                //do nothing
            elseif find enemycrew ground -1 -1 12
                cast "Poison"
                wft 2000
                target enemycrew
                hotkey "Cancel Current Target"
                pause 250
                replay
            endif
            break
        endif
    endfor
else 
    overhead "Not enough mana..." 38
endif
script 'Master Background'