# This is an automated backup - check out https://outlands.uorazorscripts.com/script/eb531d83-26e4-4d50-ba15-d7e72ac483cc for latest
# Automation by Jaseowns
## Script: Lord Glacier's Chill RECALL/RESET/RELOAD  - UO OUTLANDS RAZOR SCRIPT - v1.0.0
## Created by: danstock._98439#0
#############################################

/////////
////////                                          Lord Glaciers Chill RECALL/RESET/RELOAD  - UO OUTLANDS RAZOR SCRIPT - version 1.0.0
///////
//////                                                 UO Outlands Razor script - Released January 4, 2026
/////                                                     Compiled by DanStock. (aka. Lord Glacier)
////
///





    ///////////////////////
    //    CHANGE LOG:    //
    ///////////////////////

    #         Jan 4 2026 - version 1.0.0:  Public script release!



    /////////////////
    //    TIPS:    //
    /////////////////

    //    Disclaimer:  I AM NOT AN EXPERT!  I have only played Outlands for 2 years now (with 90% of the first year spent harvesting - main PVM account is only at 16 links) 
    //    This is also the first and only MMO I have played since I last logged out of my OSI accounts on Great Lakes shard back in 2003.  
    //    So take any of my advice with that in mind - I am still a noob. If you have 30+ links and millions of gold, there is probably a better way to do things, but this works for me at my stage!
    //    I have zero prior experience scripting and I have made these primarily for my own benefit!!  I am learning as I go...
    //    Mostly, I make these scripts in order to play on my Asus ROG Ally handheld - but I have come to enjoy the challenge of making them work for as many builds as possible.
    //    I do not really use Discord (I only installed it to join Outlands - then discovered I had an older account already).  Lots of people message me there, but I rarely check it (sorry).
    //    That being said, I do my best to fix reported bugs (dan@danstockman.com) but usually do not have time to respond to requests for custom stuff (but appreciate any ideas, for sure!)
    //    Since I do not personally use all aspects of the script (and do all my editing in Notepad on my PC at work lol) some bugs take longer for me to find - but I am always adjusting and updating!  Thanks for being patient!
    //    If you see me out in Avadon, my apologies if I dont respond (its a pain to type on the ROG Ally), but to do enjoy hearing that people use my scripts.  Appreciate the support!  GOOD LUCK OUT THERE :)

        
      
#     I have taken a realtively basic process and over-complicated it once again... but I think it turned out well! Nice to work on a short script for a change.
#     This should all look pretty familiar if you use any of my other scripts (the auto recall functions, specifically)
#     I decided to finally release a stand-alone Recall/Reset script that you can use independantly of my other Auto Pilot scripts.  
#     A lot of the stuff will be seamless if you are using it in other scripts - otherwise you will be prompted to select runebook, loot bag, loot chest, tomes, etc. upon first use.  
#     Script can cast recall (if reagents and skill available) or it can use charged scrolls in runebooks.  Casts to the "DEFAULT" rune or uses scrolls to "FIRST LOCATION" in book
#     After recalling it will smelt ore/make boards (if harvesting), dispel summons, deposit gold and loot, repair items, reset loadouts, reset inventory... basically anything you need!
#     If there is anything missing that this script could do, just let me know by email (dan@danstockman.com) and I will see what I can do


        

     ###############################
    ###      USER VARIABLES:      ###
     ###############################
     
@setvar! EnableOverheadMessages 1
    # Will display overhead messages that match my other scripts (or not)
    
@setvar! EnableCastRecall 1
    # '0' for 'Scrolls in charged Runebook to "first" rune'
    # '1' for 'Cast Recall to Runebook/Runetome using "default" rune'


    //  AUTO RECALL DESTINATION (choose only one):
        @setvar! BankRecall 0
        @setvar! OwnerInnRecall 0
        @setvar! CoOwnerInnRecall 0
        @setvar! InsideHouseRecall 0
        @setvar! OutsideHouseRecall 0
        
            if OutsideHouseRecall = 1
                @setvar! EnableCloseMyDoor 0
                @setvar! MyDoor 0x0000000
                # Use '>info' to ID your own house door (to quickly close it behind you)
            endif      
            
            @setvar! HideAtHomeorInn 0
                # Will use hiding skill after recalling

            @setvar! EnableEquipWeapon 0
                # Will check for an Aspected weapon and equip it after recalling
                
            @setvar! EnableEquipShield 0
                # Will check for a shield and equip it after recalling (ignores unidentified)
                
            @setvar! EnableDispelSummonsAfterRecall 0
                # Will dispel all of your active summons after recalling
                
            @setvar! MyBlessedSpellbook 0x00000000
            @setvar! MyBlessedSpellbook2 0x00000000
            @setvar! MyBlessedSpellbook3 0x00000000
            @setvar! MyBlessedSpellbook4 0x00000000
            @setvar! MyBlessedSpellbook5 0x00000000
                # Use '>info' to ID your [blessed] spellbooks and add them above
                # This will prevent the script from trying to equip them

        
    //  LOADOUT RESET (after RECALL): 
            #  Safe, Repair Bench, Resource Stockpile, Storage Shelf, Magic Recycler, Storage Tome Container and/or Loot Chest must be found within 2 tiles!
            #  Storage Tomes can be locked down (within 2 tiles) or located inside Loot Chest or Storage Tome Container

            @setvar! EnableLootBag 0
                # Will open selected bag after recalling (usually whatever you have set as your 'Grab Bag')
            @setvar! EnableLootChest 0
                # Will open selected chest to store non-shelf/stockpile/tome items in your HOME/INN/BANK (uses Razor organizer agents 06-09)
            @setvar! EnableSafeDeposit 0
                # Will deposit all gold and doubloons found in inventory
            @setvar! EnableResourceStockpile 0
                # Will deposit all resources (ingots, boards, gems, etc.)
            @setvar! EnableRepairBench 0
                # Will repair all equipment (Repair Bench must have charges available)
            @setvar! EnableStorageShelf 0
                # Will restock shelf and then resupply a fresh loadout
            @setvar! EnableMagicRecycler 0
                # Will add all unidentified magic items to your Recycler 
                @setvar! EnableRecycleItemsWhenFull 0
                    # If Recycler is full, it will attempt to ID, Recycle and deposit resources (if stockpile nearby) before adding items
            @setvar! EnableStorageTomes 0
                # Will add items to any nearby storage tomes (skill scrolls, dyes, runes, maps, cards, etc)
                    @setvar! EnableStorageTomeContainer 0
                        # Script checks on ground (2 tiles) or in LOOT CHEST (enable below) by default
                        # Otherwise you can designate a TOME CONTAINER to check for your books
            @setvar! EnableReagentSplitter 0
                # Will split reagents into smaller stacks after shelf resupply     
            @setvar! EnableUsePotionKegs 0
                # Will automatically fill your potions from kegs after resetting loadout
                # Set your required potion amounts below 
                # Loadout requires empty kegs and empty bottles (pack extra bottles for explosion pots) 
                if EnableUsePotionKegs = 1
                    @setvar! HealingPotionAmount 5
                    @setvar! CurePotionAmount 5
                    @setvar! RefreshPotionAmount 5
                    @setvar! StrengthPotionAmount 1
                    @setvar! AgilityPotionAmount 1
                    @setvar! ResistPotionAmount 1
                    @setvar! ExplosionPotionAmount 5
                    @setvar! PoisonPotionAmount 0
                endif


    //  LOADOUT RESET (after DEATH): 
            # This variable will reorganize your backpack after death (see instructions below)
            # Your pack will be setup with anti-theft measures and all aspects will be reactivated, etc. 

            @setvar! EnableResetInventoryAfterDeath 0
                # Will detect if you just died and triggers inventory reset (intructions below)
                @setvar! EnableSetMainPouchOrganizer01 0
                    # Will set your main pouch as Razor Organizer Agent-01 during inventory reset
                    
                //  Requires an equal amount of TRAPPED POUCHES (in shelf loadout) and SCISSORS [blessed] (in backpack)
                //  Loadout also requires 1 UNTRAPPED POUCH (for main inventory - optionally set as Organizer Agent-01 above) and 1 BAG (for loot, etc.)
                //  Script will put scissors in each trapped pouch (to keep them from being grabbed during future shelf loading)
                //  Script then STACKS any trapped pouches on top of your main inventory pouch
                //  Loot bag will be moved into main inventory pouch and automatically set as your Grab Bag for Gridloot, etc.
                //  Script will then hide the stack underneath an ATLAS and put a DECOY TRAPPED POUCH out in the open
                //  ASPECT WEAPON and ARMOR will be re-activated automatically and HP restored to MAX
                //  Loadout reset finishes by opening backpack, main pouch, loot bag and any satchels
                
            
/////////////////////////
//  END OF VARIABLES!  //
/////////////////////////




################  EDIT BELOW THIS LINE AT YOUR OWN RISK!  #####  EDIT BELOW THIS LINE AT YOUR OWN RISK!  #####  EDIT BELOW THIS LINE AT YOUR OWN RISK!  #####  EDIT BELOW THIS LINE AT YOUR OWN RISK!  ################




///////////////////////
//   TIMER SETUPS:   //
///////////////////////

if not timerexists "PackySmeltTimer"
    createtimer "PackySmeltTimer"
    settimer "PackySmeltTimer" 3500
endif 

if not timerexists "TomeOverheadTimer"
    createtimer "TomeOverheadTimer"
    settimer "TomeOverheadTimer" 3500
endif 

if not timerexists "PotionKegTimer"
    createtimer "PotionKegTimer"
    settimer "PotionKegTimer" 2000
endif

if not timerexists "OverheadManaMessageTimer"
    createtimer "OverheadManaMessageTimer"
    settimer "OverheadManaMessageTimer" 3500
endif


//////////////////////
//  INITIAL SETUP:  //
//////////////////////

if not varexist escape_runebook_glaciers_chill_autorecall or not find escape_runebook_glaciers_chill_autorecall self
    overhead "Please select your runebook..." 253
    setvar escape_runebook_glaciers_chill_autorecall
    wait 500
    while targetexists
        sysmsg 'Script: Waiting for runebook selection...' 0
        wait 2500
    endwhile 
    wait 2000
    sysmsg 'Script: Runebook set successfully! One moment...' 0
    wait 2000
endif

if not varexist maininventorybag or not find maininventorybag self
    overhead "Please select your main inventory bag..." 253
    setvar maininventorybag
    wait 500
    while targetexists
        sysmsg 'Script: Waiting for main bag selection...' 0
        wait 2500
    endwhile 
    wait 2000
    sysmsg 'Script: Main inventory bag set successfully! One moment...' 0
    wait 2000
endif

if EnableLootBag = 1
    if not varexist LootBag
        wait 500
        overhead "Please select your loot bag..." 253
        wait 1000
        overhead "This should be whatever is set as your 'Grab Bag' and will be opened when unloading loot after recalling..." 0
        @setvar! LootBag
        wait 500
        while targetexists
            sysmsg 'Script: Waiting for Loot Bag selection...' 0
            wait 2500
        endwhile 
        wait 1500
    endif
endif

if EnableLootChest = 1
    if not varexist LootChest
        wait 500
        overhead "Select a secure container to store your Loot..." 253
        wait 1000
        overhead "Anything that will not go into a Resource Stockpile, Storage Shelf or Magic Recycler" 0
        overhead "(ie. Skill Orbs, Treasure Maps, Paragon chests, etc.)"
        setvar LootChest
        wait 500
        while targetexists
            sysmsg 'Script: Waiting for Loot Chest selection...' 0
            wait 2500
        endwhile 
        sysmsg "Use Razor Organizer Agents 06 - 09 for the Loot Chest and its contents - organize to your own liking!" 0
        wait 1500
    endif
endif

if EnableStorageTomeContainer = 1
    if not varexist TomeContainer
        wait 500
        overhead "Please select a secure container to store your Tomes..." 253
        wait 1000
        overhead "This will cause script to look in this container for any Storage Tomes when unloading loot..." 0
        setvar TomeContainer
        wait 500
        while targetexists
            sysmsg 'Script: Waiting for Tome Container selection...' 0
            wait 2500
        endwhile 
        sysmsg "Turn this variable off if your tomes are stored on the ground in your home/inn room" 0
        wait 1500
    endif
endif


////////////////////////
//   SCRIPT START:    //
////////////////////////

while not dead     
    if targetexists 
        hotkey 'Cancel Current Target'
    endif

    if paralyzed 
        say "[pouch"
        wait 500
    endif
        
    if skill 'Healing' > 0 and not bandaging and hits < maxhits
        if counttype 'clean bandage%s%' self > 0 
            hotkey "Bandage self"
            if EnableOverheadMessages = 1
                overhead '[ BANDAGING... ]' 88
            endif 
            wait 500
        endif 
    endif 
                
    if diffhits > 30 and not cooldown "Healing Potion"
        if findtype "Yellow Potion" self as healpot
            if EnableOverheadMessages = 1
                overhead '[ HEAL POTION... ]' 253
            endif
            dclick healpot
            cooldown "Healing Potion" 10000
            wait 500
        endif
    endif 
            
    while poisoned
        if findtype "Orange Potion" self as curepot
            if EnableOverheadMessages = 1
                overhead '[ CURE POTION... ]' 44
            endif
            dclick curepot
            wait 500
        else 
            break
        endif
    endwhile        

    while mana < 11
        wait 100
    if timer "OverheadManaMessageTimer" > 3500 and EnableOverheadMessages = 1
            overhead "[ WAITING FOR MANA... ]" 12
            settimer "OverheadManaMessageTimer" 0
        endif 
    endwhile            
    
    if EnableCastRecall = 1 
        if counttype 3962 self = 0 or counttype 3963 self = 0 or counttype 3974 self = 0
            @setvar! EnableCastRecall 0
            if EnableOverheadMessages = 1
                overhead "[ MISSING REGS! ]" 337
            endif
            wait 500
            sysmsg 'Script: Missing reagents for recall... attempting scrolls instead!' 0
        endif
    endif
    
    if EnableCastRecall = 1 and skill "Magery" >= 60 and counttype 3962 self > 0 and counttype 3963 self > 0 and counttype 3974 self > 0
        cast "Recall"
        wait 500
        
        while not targetexists 
            wait 100
        endwhile 
        
        target escape_runebook_glaciers_chill_autorecall
        wait 1000
        
        for 2
        wait 500
        if insysmsg 'Your concentration is disturbed'
            if EnableOverheadMessages = 1
                overhead '[ INTURRUPTED! ]' 333
            endif
            clearsysmsg
            wait 2000
            cast "Recall"
            wait 500
            while not targetexists 
                wait 100
            endwhile 
            target escape_runebook_glaciers_chill_autorecall 
            wait 1000
        endif
        endfor
    else
        dclick escape_runebook_glaciers_chill_autorecall
        waitforgump 1551740969 
        gumpresponse 2
        wait 1000   
        
        for 2
        wait 500
        if insysmsg 'Your concentration is disturbed'
            if EnableOverheadMessages = 1
                overhead '[ INTERRUPTED! ]' 333
            endif
            clearsysmsg 
            wait 2000
            dclick escape_runebook_glacier
            waitforgump 1551740969 
            gumpresponse 2
            wait 1000 
        endif
        endfor
    endif
    
    if EnableEquipWeapon = 1
        if skill 'Swordsmanship' >= 50
            if not findtype '30988|5049|3909|3911|3915|3917|3934|3937|5046|5115|5119|5182|5185|5187|31128|31190' self
                overhead "[ NO WEAPON! ]" 337
            else
                if not findtype '30988|5049|3909|3911|3915|3917|3934|3937|5046|5115|5119|5182|5185|5187|31128|31190' hand
                    if findtype '30988|5049|3909|3911|3915|3917|3934|3937|5046|5115|5119|5182|5185|5187|31128|31190' backpack as weapon
                        for 10
                        getlabel weapon WeaponLabel
                        wait 500
                        if "aspect" in WeaponLabel
                            break
                        else
                            @ignore weapon
                            wait 150
                            if findtype '30988|5049|3909|3911|3915|3917|3934|3937|5046|5115|5119|5182|5185|5187|31128|31190' backpack as weapon
                                getlabel weapon WeaponLabel
                            endif
                        endif
                        endfor
                        wait 150
                        dclick weapon
                        wait 500
                    endif
                endif
            endif
        elseif skill 'Mace Fighting' >= 50
            if not findtype '3568|3713|3721|3932|5040|5044|5112|5127|5177|5179|5181|30991|30999|31000|31001|31014|31178|31180|31182' self
                overhead "[ NO WEAPON! ]" 337
            else
                if not findtype '3568|3713|3721|3932|5040|5044|5112|5127|5177|5179|5181|30991|30999|31000|31001|31014|31178|31180|31182' hand
                    if findtype '3568|3713|3721|3932|5040|5044|5112|5127|5177|5179|5181|30991|30999|31000|31001|31014|31178|31180|31182' backpack as weapon
                        for 10
                        getlabel weapon WeaponLabel
                        wait 500
                        if "aspect" in WeaponLabel
                            break
                        else
                            @ignore weapon
                            wait 150
                            if findtype '3568|3713|3721|3932|5040|5044|5112|5127|5177|5179|5181|30991|30999|31000|31001|31014|31178|31180|31182' backpack as weapon
                                getlabel weapon WeaponLabel
                            endif
                        endif
                        endfor
                        wait 150
                        dclick weapon
                        wait 500
                    endif
                endif
            endif
        elseif skill 'Fencing' >= 50
            if not findtype '3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' self
                overhead "[ NO WEAPON! ]" 337
            else
                if not findtype '3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' hand
                    if findtype '3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' backpack as weapon
                        for 10
                        getlabel weapon WeaponLabel
                        wait 500
                        if "aspect" in WeaponLabel
                            break
                        else
                            @ignore weapon
                            wait 150
                            if findtype '3719|3922|3938|5121|5123|5125|30989|30992|30996|30997|30998|31176|31188' backpack as weapon
                                getlabel weapon WeaponLabel
                            endif
                        endif
                        endfor
                        wait 150
                        dclick weapon
                        wait 500
                    endif
                endif
            endif
        elseif skill 'Archery' >= 50
            if not findtype '3920|5042|5117|30990|30993|30994|30995|31184|31186' self
                overhead "[ NO WEAPON! ]" 337
            else
                if not findtype '3920|5042|5117|30990|30993|30994|30995|31184|31186' hand
                    if findtype '3920|5042|5117|30990|30993|30994|30995|31184|31186' backpack as weapon
                        for 10
                        getlabel weapon WeaponLabel
                        wait 500
                        if "aspect" in WeaponLabel
                            break
                        else
                            @ignore weapon
                            wait 150
                            if findtype '3920|5042|5117|30990|30993|30994|30995|31184|31186' backpack as weapon
                                getlabel weapon WeaponLabel
                            endif
                        endif
                        endfor
                        wait 150
                        dclick weapon
                        wait 500
                    endif
                endif
            endif
        elseif skill 'Wrestling' >= 50
            if not findtype '22187|31141|31142' self
                overhead "[ NO WEAPON! ]" 337
            else
                if not findtype '22187|31141|31142' hand
                    if findtype '22187|31141|31142' backpack as weapon
                        for 4
                            getlabel weapon WeaponLabel
                            wait 500
                            if "aspect" in WeaponLabel
                                break
                            else
                                @ignore weapon
                                wait 150
                                if findtype '22187|31141|31142' backpack as weapon
                                    getlabel weapon WeaponLabel
                                endif
                            endif
                        endfor
                        dclick weapon
                        wait 750
                    endif
                endif
            endif
        elseif skill 'Arcane' >= 50 and not findtype "31043|31017|31019|31021|31023|31025|31027|31029|31031|31033|31035|31037|31038|31041|31045|31047|31049|31051|31053|31055" hand
                if findtype "31043|31017|31019|31021|31023|31025|31027|31029|31031|31033|31035|31037|31038|31041|31045|31047|31049|31051|31053|31055" self as myArcaneStaff
                    for 4
                    getlabel myArcaneStaff myArcaneStaffLabel
                    wait 500
                    if "aspect" in myArcaneStaffLabel
                        break
                    else
                        @ignore weapon
                        wait 150
                        if findtype '31043|31017|31019|31021|31023|31025|31027|31029|31031|31033|31035|31037|31038|31041|31045|31047|31049|31051|31053|31055' backpack as myArcaneStaff
                            getlabel myArcaneStaff myArcaneStaffLabel
                        endif
                    endif
                    endfor
                    dclick myArcaneStaff
                    wait 500
                endif
            endif
        endif
    endif
    
    if EnableEquipShield = 1
        if not findtype 'Order shield|buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|wooden shield|parrying gauche' lefthand
            if findtype 'Order shield|buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|wooden shield|parrying gauche' backpack as shield
                for 4
                    getlabel shield ShieldLabel
                    wait 250
                    if "unidentified" in ShieldLabel
                        @ignore shield
                        wait 150
                        if findtype 'Order shield|buckler |metal shield|Chaos shield|heater shield|bone shield|bronze shield|kite shield|wooden shield|parrying gauche' backpack as shield
                            getlabel shield ShieldLabel
                        endif
                    else
                        break
                    endif
                endfor
                dclick shield
                wait 500
            endif
        endif
    endif

    @ignore MyBlessedSpellbook
    @ignore MyBlessedSpellbook2
    @ignore MyBlessedSpellbook3
    @ignore MyBlessedSpellbook4
    @ignore MyBlessedSpellbook5
    
    if skill "Magery" >= 80 and not findtype "spellbook" hand and findtype "spellbook" backpack as myspellbook
        getlabel myspellbook SpellbookLabel
        wait 250
        for 5
        wait 250
        if "aspect" in SpellbookLabel
            break
        elseif "unidentified" in SpellbookLabel or "[blessed" in SpellbookLabel
            @ignore myspellbook 
            wait 250
            if not findtype "spellbook" hand and findtype "spellbook" self as myspellbook
                getlabel myspellbook SpellbookLabel
            elseif EnableOverheadMessages = 1
                overhead "[ NO SPELLBOOK! ]" 337
                break
            else 
                break 
            endif
        endif 
        endfor
        dclick myspellbook
        wait 500
    endif 
    
    if OutsideHouseRecall = 1
        wait 2500
        if find MyDoor ground -1 -1 2 and EnableCloseMyDoor = 1
            dclick MyDoor
            overhead "*door slams!*" 0 MyDoor
            wait 1000
        endif
        wait 3000
    elseif OwnerInnRecall = 1
        wait 500
        say "Innkeeper, I need a room!" 2234
        waitforgump 2393832411
        gumpresponse 4
        wait 1500
    elseif CoOwnerInnRecall = 1
        wait 500
        say "Innkeeper, I need a room!" 2234
        waitforgump 2393832411
        gumpresponse 5
        wait 500
        gumpresponse 100
        wait 1500
    elseif InsideHouseRecall = 1
        wait 500
    elseif BankRecall = 1
        say "Open my bank!" 2234
        wait 1000
    else
        wait 500
    endif    
    
    if HideAtHomeorInn = 1
        useskill "Hiding"
        wait 500
    endif   
    
    if EnableOverheadMessages = 1
        if hp > 50 and find maininventorybag self 
            wait 500
            overhead "Home Sweet Home!" 2338
            @setvar! ResetLoadout 0
            wait 500
        elseif hp < 25 and not find maininventorybag self
            wait 500
            overhead "Well... that sucked." 2338
            @setvar! ResetLoadout 1
            wait 1000
        elseif hp < 50 and find maininventorybag self 
            wait 500
            overhead "Whew! That was a close one..." 2338
            @setvar! ResetLoadout 0
            wait 1000
        else 
            wait 500
            overhead "Ah, Home Sweet Home!" 2338
            @setvar! ResetLoadout 0
            wait 1000
        endif
    else 
        if hp > 50 and find maininventorybag self 
            @setvar! ResetLoadout 0
            wait 500
        elseif hp < 25 and not find maininventorybag self
            @setvar! ResetLoadout 1
            wait 500
        elseif hp < 50 and find maininventorybag self 
            @setvar! ResetLoadout 0
            wait 500
        else 
            @setvar! ResetLoadout 0
            wait 500
        endif
    endif 

    clearignore 
        
    if skill 'Mining' > 50 
        if find IngotBag self 
            dclick IngotBag
            wait 500
        endif
        while queued 
            wait 100
        endwhile
    endif
    
    if skill 'Lumberjacking' > 50 
        if find BoardBag self  
            dclick BoardBag
            wait 500
        endif
        while queued
            wait 100
        endwhile
    endif

    if skill 'Mining' > 50 
        while findtype "iron ore" backpack as ore
            if findtype "forge" ground -1 -1 2 as forge or findtype 0x0FB1 ground -1 -1 2 as forge
                if EnableOverheadMessages = 1
                    overhead "[ SMELTING ORE... ]" 2114 forge
                endif
                dclick ore
                wait 1000
            else 
                if EnableOverheadMessages = 1
                    overhead "[ NO FORGE NEARBY ]" 337
                    wait 1000
                endif
                break
            endif 
        endwhile  
   
        wait 500
        
        if find myMainPackAnimal ground -1 -1 2
            getlabel myMainPackAnimal PackyLabel
            if "[0/2000" in PackyLabel
                // Do nothing
            elseif "[0/4000" in PackyLabel
                // Do nothing
            else
                dclick myMainPackAnimal 
                wait 500
                while findtype "iron ore" myMainPackAnimal as packyoretosmelt
                    dclick packyoretosmelt
                    if timer "PackySmeltTimer" > 3500 and EnableOverheadMessages = 1
                        overhead "[ SMELTING FROM PACKY... ]" 2114 myMainPackAnimal 
                        settimer "PackySmeltTimer" 0
                    endif 
                    wait 650
                endwhile
                @setvar! NeedtoSecureIngots 1
            endif
        endif 
        
        wait 500
        
        if find mySecondPackAnimal ground -1 -1 2
            getlabel mySecondPackAnimal TwoPackyLabel
            if "[0/2000" in TwoPackyLabel
                // Do nothing
            elseif "[0/4000" in TwoPackyLabel
                // Do nothing
            else
                dclick mySecondPackAnimal 
                wait 500
                while findtype "iron ore" myMainPackAnimal as twopackyoretosmelt
                    dclick twopackyoretosmelt
                    if timer "PackySmeltTimer" > 3500 and EnableOverheadMessages = 1
                        overhead "[ SMELTING FROM PACKY... ]" 2114 mySecondPackAnimal 
                        settimer "PackySmeltTimer" 0
                    endif 
                    wait 650
                endwhile
                @setvar! NeedtoSecureIngots 1
            endif
        endif 
    endif 

    if skill 'Lumberjacking' > 50 
        while findtype 'log%s' backpack as mylogs
            if counttype "hatchet" self = 0 
                if EnableOverheadMessages = 1              
                    overhead "[ NO HATCHET! ]" 337
                    wait 1000
                endif
                break
            else 
                wait 500
                if EnableOverheadMessages = 1
                    overhead '[ MAKING BOARDS... ]' 0
                endif
                dclick mylogs 
                wait 1000
            endif 
        endwhile
    endif 

    if EnableDispelSummonsAfterRecall = 1 
        if skill "Magery" >= 70 and mana >= 40 and findtype '3962' self and findtype '3972' self and findtype '3974' self and findtype '3980' self and followers > 0
            wait 500
            cast "Mass Dispel"
            while not targetexists
                wait 100
            endwhile
            if EnableOverheadMessages = 1
                overhead "[ RELEASING SUMMONS... ]" 22
            endif
            target self
            wait 500
        endif
    endif

    if EnableLootChest = 1
        dclick LootChest
        wait 500
    endif

    while queued 
        wait 100
    endwhile

    if EnableStorageTomeContainer = 1
        dclick TomeContainer
        wait 500
    endif

    while queued 
        wait 100
    endwhile
    
    if EnableResetInventoryAfterDeath = 1 and ResetLoadout = 1
        if EnableOverheadMessages = 1
            overhead "[ RESETTING LOADOUT... ]" 77
            wait 1500
        endif
    endif

    if ResetLoadout != 1
        if EnableLootBag = 1
            if find LootBag self
                dclick LootBag
                wait 500
            else 
                if EnableOverheadMessages = 1
                    overhead "[ NO LOOT BAG! ]" 337
                endif
            endif
        endif

        while queued 
            wait 100
        endwhile

        if findtype "wooden box" self as lockbox
            if findtype "copper key" self as key
                clearignore
                getlabel lockbox lockboxlabel
                wait 250
                if "items" in lockboxlabel
                    dclick lockbox
                    wait 500
                else
                    dclick key
                    wft 1500
                    target lockbox
                    if EnableOverheadMessages = 1
                        overhead "[loot box unlocked]" 84
                    endif
                    wait 500
                    dclick lockbox
                    wait 250
                    if insysmsg "It appears to be locked."
                        dclick key
                        wft 1500
                        target lockbox
                        wait 500
                        dclick lockbox
                        wait 500
                    endif
                endif
            elseif EnableOverheadMessages = 1
                overhead "[ NO LOCKBOX KEY! ]" 337
            endif
        endif
        
        while queued 
            wait 100
        endwhile

        if EnableSafeDeposit = 1
            if findtype "bank deposit safe" ground -1 -1 2 as safe
                clearignore
                while findtype "gold coin" self as gold
                    if findtype "wooden box" self as lockbox
                        if findtype "copper key" self as key
                            getlabel lockbox lockboxlabel
                            if "items" in lockboxlabel
                                wait 500
                            else
                                dclick key
                                wft 1500
                                target lockbox
                                wait 250
                                if insysmsg "It appears to be locked."
                                    dclick key
                                    wft 1500
                                    target lockbox
                                    wait 250
                                endif
                            endif
                        elseif EnableOverheadMessages = 1
                            overhead "[ NO LOCKBOX KEY! ]" 337
                        endif
                    endif

                    if EnableOverheadMessages = 1
                        overhead "[ DEPOSITING GOLD... ]" 149
                    else
                        overhead " ¼ " 149
                    endif

                    menu safe 0
                    wait 500
                endwhile
                while findtype 2539 self as dubs
                    if EnableOverheadMessages = 1
                        overhead "[ DEPOSITING DUBS... ]" 149
                    else
                        overhead " ¼ " 149
                    endif

                    menu safe 0
                    wait 500
                endwhile
            elseif EnableOverheadMessages = 1
                overhead "[ NO BANK SAFE FOUND ]" 337
                wait 1500
            endif
        endif

        if EnableResourceStockpile = 1
            if findtype "resource container" ground -1 -1 2 as resource
                menu resource 0
                wft 500
                target self
                    if EnableOverheadMessages = 1
                        overhead "[ PILING RESOURCES... ]" 84
                    else
                        overhead " ¼ " 84
                    endif
                wait 1500
            elseif EnableOverheadMessages = 1
                overhead "[ NO RESOURCE STOCKPILE FOUND ]" 337
                wait 1500
            endif
        endif

        if EnableRepairBench = 1
            if findtype "repair bench" ground -1 -1 3 as RepairBench
                clearsysmsg
                dclick RepairBench
                wait 500
                if insysmsg "You do not have any items equipped or in your backpack in need of repairs."
                    if EnableOverheadMessages = 1
                        overhead "[ NOTHING TO REPAIR! ]" 0
                    endif
                    wait 1500
                else
                    if EnableOverheadMessages = 1
                        overhead "[ REPAIRING EQUIPMENT... ]" 339
                    else
                        overhead " Ï " 339
                    endif
                    settimer RepairTimer 0
                while timer RepairTimer <= 5000
                    if insysmsg "Repair"
                        break
                    endif
                endwhile
                    if EnableOverheadMessages = 1
                        overhead "[ ITEMS REPAIRED! ]" 0
                        wait 500
                        overhead "Repair took: {{RepairTimer}}ms" 77
                    else
                        overhead " Ï " 0
                    endif
                    removetimer RepairTimer
                    wait 500
                endif
            elseif EnableOverheadMessages = 1
                overhead "[ NO REPAIR BENCH FOUND ]" 337
                wait 1500
            endif
        endif

        if EnableMagicRecycler = 1
            if findtype "ornate elven chest|magic item recycler" ground -1 -1 2 as recycler
                for 2
                getlabel recycler recyclerdesc

                if EnableRecycleItemsWhenFull = 1
                    if "(125 items" in recyclerdesc
                        dclick recycler
                        waitforgump 4045111101
                        gumpresponse 7
                        waitforgump 4045111101
                        gumpresponse 6
                        waitforgump 4045111101
                        gumpresponse 6

                        if EnableOverheadMessages = 1
                            overhead "[ RECYCLING JUNK... ]" 66
                        else
                            overhead " Ï " 66
                        endif

                        wait 500
                        gumpclose 4045111101

                        if EnableResourceStockpile = 1
                            if findtype "resource container" ground -1 -1 2 as resource
                                menu resource 0
                                wft 1500
                                target recycler
                                wait 500
                                if EnableOverheadMessages = 1
                                    overhead "[ PILING RESOURCES... ]" 84
                                else
                                    overhead " ¼ " 84
                                endif
                                wait 500
                            elseif EnableOverheadMessages = 1
                                overhead "[ NO RESOURCE STOCKPILE FOUND ]" 337
                            endif
                        endif

                        menu recycler 1
                        getlabel backpack backpacklabel

                        if insysmsg "0 recyclable"
                            break
                        else
                            if EnableOverheadMessages = 1
                                overhead "[ ADDING TO RECYCLER... ]" 6
                            else
                                overhead " ¼ " 6
                            endif
                            wait 1500
                        endif
                    endif
                endif
                menu recycler 1
                wait 500
                if insysmsg "0 recyclable"
                    if EnableOverheadMessages = 1 and timer "TomeOverheadTimer" > 5000
                        overhead "[ NO MAGIC LOOT! ]" 6
                    elseif timer "TomeOverheadTimer" > 5000
                        overhead " Ï " 6
                    endif
                    break
                else
                    if EnableOverheadMessages = 1
                        overhead "[ ADDING TO RECYCLER... ]" 6
                    else
                        overhead " ¼ " 6
                    endif
                    settimer "TomeOverheadTimer" 0
                    wait 1500
                endif
                wait 500
                endfor
            elseif EnableOverheadMessages = 1
                overhead "[ NO MAGIC ITEM RECYCLER FOUND ]" 337
            endif
        endif

        if EnableLootChest = 1
            dclick LootChest
            if EnableOverheadMessages = 1
                overhead "[ STASHING LOOT... ]" 69
            else
                overhead " ¼ " 69
            endif
            wait 500
            for 2
            hotkey "Organizer Agent-06"
            wait 250
            hotkey "Organizer Agent-07"
            wait 250
            hotkey "Organizer Agent-08"
            wait 250
            hotkey "Organizer Agent-09"
            wait 250
            endfor
            while queued
                wait 100
            endwhile
        endif

        if EnableStorageTomes = 1
            if EnableStorageTomeContainer = 1
                dclick TomeContainer
                wait 500
            endif
            if findtype "book" ground -1 -1 2 as StorageTome or findtype "book" LootChest as StorageTome or findtype "book" TomeContainer as StorageTome
                while findtype "book" ground -1 -1 2 as StorageTome
                    menu StorageTome 0
                    if EnableOverheadMessages = 1 and timer "TomeOverheadTimer" > 3500
                        overhead "[ STORING TOME ITEMS... ]" 2117
                        settimer "TomeOverheadTimer" 0
                    elseif EnableOverheadMessages = 0 and timer "TomeOverheadTimer" > 3500
                        overhead " ¼ " 2117
                        settimer "TomeOverheadTimer" 0
                    endif
                    wait 250
                    @ignore StorageTome
                endwhile
                while findtype "book" LootChest as StorageTome or findtype "book" TomeContainer as StorageTome
                    menu StorageTome 0
                    if EnableOverheadMessages = 1 and timer "TomeOverheadTimer" > 3500
                        overhead "[ STORING TOME ITEMS... ]" 2117
                        settimer "TomeOverheadTimer" 0
                    elseif EnableOverheadMessages = 0 and timer "TomeOverheadTimer" > 3500
                        overhead " ¼ " 2117
                        settimer "TomeOverheadTimer" 0
                    endif
                    wait 250
                    @ignore StorageTome
                endwhile
                @clearignore
            elseif EnableOverheadMessages = 1
                overhead "[ NO STORAGE TOMES FOUND ]" 337
                wait 1500
            endif
        endif
    endif

    wait 500

    if EnableStorageShelf = 1
        if findtype "storage shelf" ground -1 -1 2 as shelf
            if ResetLoadout != 1
                menu shelf 0
                wft 500
                target self
                if EnableOverheadMessages = 1
                    overhead "[ STORING GOODS... ]" 2114
                else
                    overhead " ¼ " 2114
                endif
                wait 500
                gumpclose 3232825965
                wait 1000
            endif
            menu shelf 1
            if EnableOverheadMessages = 1
                overhead "[ RESUPPLYING... ]" 93
                wait 500
            else
                overhead " ² " 93
            endif
            wait 1000
        elseif EnableOverheadMessages = 1
            overhead "[ NO STORAGE SHELF FOUND ]" 337
            wait 1500
        endif
    endif

    if EnableResetInventoryAfterDeath = 1 and ResetLoadout = 1
        clearignore

        if not varexist maininventorybag or not find maininventorybag self
            overhead "[ SELECT MAIN POUCH... ]" 253
            @setvar! maininventorybag
            wft 500
            while targetexists
                wait 100
            endwhile
            overhead "[ MAIN POUCH SET! ]" 93
            wait 500
        endif

        lift maininventorybag
        wait 500
        drop backpack 69 69 0
        wait 500

        if EnableSetMainPouchOrganizer01 = 1
            hotkey 'Set Organizer Hotbag-01'
            wft 1000
            target maininventorybag
            if EnableOverheadMessages = 1
                overhead "[ POUCH SET TO AGENT-01! ]" 84
            endif
            wait 500
        endif

        dclick maininventorybag
        wait 1000
        sysmsg "Auto-selecting your loot/grab bag..." 0
        hotkey 'Set Grab Item Hotbag'
        wft 1500

        while targetexists
            if findtype 'bag' self as grabbag
                target grabbag
                wait 500
            else
                wait 1000
                sysmsg "Auto-select failed!  Please manually target your loot/grab bag!" 0
                wait 1000
                overhead "[ SELECT GRAB BAG... ]" 253
                wait 3500
            endif
            wait 500
        endwhile
        overhead "[ GRAB BAG SET! ]" 93
        wait 500

        if EnableLootBag = 1
            if not find LootBag self
                wait 500
                overhead "Select your new loot bag..." 253
                wait 500
                @setvar! LootBag
                wait 500
                while targetexists
                    wait 100
                endwhile
            endif
        endif

        if find grabbag self
            lift grabbag
            wait 500
            drop maininventorybag -1 -1 -1
            wait 500
        endif

        while findtype 'scissors' self
            if skill 'healing' > 0 and hp < maxhp and not bandaging
                if findtype 'clean bandage%s%' self
                    hotkey 'Bandage Self'
                    if EnableOverheadMessages = 1
                        overhead "[ BANDAGING... ]" 88
                    endif
                else
                    if EnableOverheadMessages = 1
                        overhead "[ NO BANDAGES! ]" 337
                    endif
                endif
            endif

            if findtype 'scissors' backpack as myscissors
                if findtype 'pouch' self as trappedpouch
                    lift myscissors
                    wait 250
                    drop trappedpouch
                    wait 750
                    lift trappedpouch
                    wait 250
                    drop backpack 69 69 0
                    @ignore trappedpouch
                    @ignore myscissors
                endif
            endif

            wait 500
            while queued
                wait 100
            endwhile
        endwhile

        clearignore

        while findtype 'pouch' backpack as decoypouch
            getlabel decoypouch decoypouchlabel
            wait 250
            if '(1 items' in decoypouchlabel
                lift decoypouch
                drop backpack 97 97 0
                break
            else
                @ignore decoypouch
            endif
        endwhile

        if findtype 'atlas' backpack as hidemypouchstack
            lift hidemypouchstack
            drop backpack 72 66 0
            wait 500
        else
            say "[atlas"
            wait 500
            if findtype 'atlas' backpack as hidemypouchstack
                lift hidemypouchstack
                drop backpack 72 66 0
                wait 500
            endif
        endif

        if EnableOverheadMessages = 1
            overhead "[ ACTIVATING ASPECT... ]" 2234
            wait 500
        endif

        say "[aspect"
        waitforgump 2424293173
        gumpresponse 13
        wait 500
        gumpresponse 13
        wait 250
        gumpresponse 17
        wait 500
        gumpresponse 17
        wait 250
        gumpclose 2424293173
        wait 500

        if skill 'magery' >= 60 and hp < maxhp and mana >= 11 and not casting
            while hp < maxhp
                cast 'greater heal'
                while not casting
                    if targetexists
                        hotkey 'cancel current target'
                    endif
                    cast 'greater heal'
                endwhile
                while not targetexists
                    wait 100
                endwhile
                target 'self'
                wait 500
            endwhile
        endif
        
        if skill 'healing' > 0 and hp < maxhp and not bandaging
            if findtype 'clean bandage%s%' self
                hotkey 'Bandage Self'
                if EnableOverheadMessages = 1
                    overhead "[ BANDAGING... ]" 88
                endif
            else
                if EnableOverheadMessages = 1
                    overhead "[ NO BANDAGES! ]" 337
                endif
            endif
        endif

        if findtype "storage shelf" ground -1 -1 2 as shelf
            menu shelf 1
            wait 500
        endif

        if find maininventorybag self
            dclick maininventorybag
            wait 500
        endif

        if findtype 'alchemists satchel' self as BagofPot
            dclick BagofPot
            wait 500
        endif

        if findtype 'reagent satchel' self as WizardBag
            dclick WizardBag
            wait 500
        endif

        if find grabbag self
            dclick grabbag
            wait 500
        endif

        clearignore
        @setvar! ResetLoadout 0
        overhead "[ RESET COMPLETE! ]" 69
        wait 500
    endif

    if EnableUsePotionKegs = 1 and findtype 'empty bottle%s%' self and findtype 'keg' self
        if not timerexists PotionKegTimer
            createtimer PotionKegTimer
            settimer PotionKegTimer 5000
        endif
        
        if findtype 'alchemists satchel' self as BagofPot
            dclick BagofPot
            wait 500
        endif
        
        @setvar! PotionStockCheck 0
        
        while PotionStockCheck < 8 and findtype 'empty bottle%s%' self
            if PotionStockCheck = 0 and ExplosionPotionAmount != 0
                @setvar! PotionType 3853
                @setvar! KegColour 419
                @setvar! PotionAmounttoFill ExplosionPotionAmount
                @setvar! PotionStockCheck 1
            elseif PotionStockCheck = 1 and HealingPotionAmount != 0
                @setvar! PotionType 3852
                @setvar! KegColour 253
                @setvar! PotionAmounttoFill HealingPotionAmount
                @setvar! PotionStockCheck 2
            elseif PotionStockCheck = 2 and CurePotionAmount != 0
                @setvar! PotionType 3847
                @setvar! KegColour 44
                @setvar! PotionAmounttoFill CurePotionAmount
                @setvar! PotionStockCheck 3
            elseif PotionStockCheck = 3 and RefreshPotionAmount != 0
                @setvar! PotionType 3851
                @setvar! KegColour 37
                @setvar! PotionAmounttoFill RefreshPotionAmount
                @setvar! PotionStockCheck 4
            elseif PotionStockCheck = 4 and StrengthPotionAmount != 0
                @setvar! PotionType 3849
                @setvar! KegColour 956
                @setvar! PotionAmounttoFill StrengthPotionAmount
                @setvar! PotionStockCheck 5
            elseif PotionStockCheck = 5 and AgilityPotionAmount != 0
                @setvar! PotionType 3848
                @setvar! KegColour 93
                @setvar! PotionAmounttoFill AgilityPotionAmount
                @setvar! PotionStockCheck 6
            elseif PotionStockCheck = 6 and ResistPotionAmount != 0
                @setvar! PotionType 3846
                @setvar! KegColour 1109
                @setvar! PotionAmounttoFill ResistPotionAmount
                @setvar! PotionStockCheck 7
            elseif PotionStockCheck = 7 and PoisonPotionAmount != 0
                @setvar! PotionType 3850
                @setvar! KegColour 363
                @setvar! PotionAmounttoFill PoisonPotionAmount
                @setvar! PotionStockCheck 8
            else
                break
            endif

            while counttype PotionType self < PotionAmounttoFill
                if not findtype 'empty bottle%s%' self
                    if EnableOverheadMessages = 1 and timer 'PotionKegTimer' > 5000
                        overhead "[ NO EMPTY BOTTLES... ]" 337
                        settimer 'PotionKegTimer' 0
                    endif
                    break
                endif

                if findtype 'keg' self KegColour as myKeg
                    dclick myKeg
                    wait 250
                    if EnableOverheadMessages = 1
                        if timer 'PotionKegTimer' > 2000
                            overhead '[ FILLING POTS... ]' KegColour
                            settimer 'PotionKegTimer' 0
                        endif
                    endif
                else
                    if EnableOverheadMessages = 1 and timer 'PotionKegTimer' > 5000
                        overhead "[ NO KEG TO USE... ]" KegColour
                        settimer 'PotionKegTimer' 0
                    endif
                    break
                endif
            endwhile

            if counttype PotionType self < PotionAmounttoFill and not findtype 'empty bottle%s%' self
                if EnableOverheadMessages = 1 and timer 'PotionKegTimer' > 5000
                    overhead "[ NO EMPTY BOTTLES... ]" 337
                    settimer 'PotionKegTimer' 0
                endif
                break
            endif
        endwhile
    endif

    if EnableReagentSplitter = 1
        if findtype "reagent satchel" self as MyWizardBag   
            while findtype "reagent satchel" self as MyWizardBag
                getlabel MyWizardBag MyWizardBaglabel
                wait 500
                if "decorative" in MyWizardBaglabel
                        @ignore MyWizardBag
                        wait 500
                    else 
                        break
                    endif
                endif
            endwhile
            
            dclick MyWizardBag
            wait 500

            if EnableOverheadMessages = 1
                overhead "[ SPLITTING REGS... ]" 2338
            endif
                
            # Spiders Silk
            @setvar! ReagentStack 0
            @setvar! ReagentSerial 3981
            @setvar! ReagentCount 0
            
            while findtype ReagentSerial self as regs 
                @setvar! ReagentCount index
                @ignore regs
            endwhile
            
            @clearignore
            
            if counttype ReagentSerial self <= 10
                @setvar! ReagentStack 2
            elseif counttype ReagentSerial self <= 20
                @setvar! ReagentStack 4       
            elseif counttype ReagentSerial self <= 50
                @setvar! ReagentStack 10    
            elseif counttype ReagentSerial self <= 100
                @setvar! ReagentStack 20    
            elseif counttype ReagentSerial self <= 150
                @setvar! ReagentStack 30
            elseif counttype ReagentSerial self <= 200
                @setvar! ReagentStack 40
            else 
                @setvar! ReagentStack 50
            endif
            
            while findtype ReagentSerial self as regs
                @setvar! moveRegs 0 
                
                if ReagentCount = 0
                    @setvar! moveRegs 1
                elseif ReagentCount != 0 and not find regs MyWizardBag
                    @setvar! moveRegs 1
                endif
                
                if moveRegs = 1
                    if index = 0
                        lift regs ReagentStack
                        drop MyWizardBag 44 65 0
                        wait 150
                    elseif index = 1
                        lift regs ReagentStack
                        drop MyWizardBag 68 65 0
                        wait 150
                    elseif index = 2
                        lift regs ReagentStack
                        drop MyWizardBag 96 65 0
                        wait 150
                    elseif index = 3
                        lift regs ReagentStack
                        drop MyWizardBag 121 65 0
                        wait 150
                    else
                        lift regs ReagentStack
                        drop MyWizardBag 142 65 0
                        wait 150
                    endif
                endif
                
                @ignore regs 
                
                if moveRegs = 1
                    wait 500
                endif
            endwhile

            if EnableOverheadMessages = 1
                overhead "[ SPLITTING REGS... ]" 3
            endif
            
            # Black Pearl
            @setvar! ReagentSerial 3962
            @setvar! ReagentCount 0

            while findtype ReagentSerial self as regs 
                @setvar! ReagentCount index
                @ignore regs
            endwhile

            @clearignore

            if counttype ReagentSerial self <= 10
                @setvar! ReagentStack 2
            elseif counttype ReagentSerial self <= 20
                @setvar! ReagentStack 4       
            elseif counttype ReagentSerial self <= 50
                @setvar! ReagentStack 10    
            elseif counttype ReagentSerial self <= 100
                @setvar! ReagentStack 20    
            elseif counttype ReagentSerial self <= 150
                @setvar! ReagentStack 30
            elseif counttype ReagentSerial self <= 200
                @setvar! ReagentStack 40
            else 
                @setvar! ReagentStack 50
            endif

            while findtype ReagentSerial self as regs
                @setvar! moveRegs 0 
                
                if ReagentCount = 0
                    @setvar! moveRegs 1
                elseif ReagentCount != 0 and not find regs MyWizardBag
                    @setvar! moveRegs 1
                endif
            
                if moveRegs = 1
                    if index = 0
                        lift regs ReagentStack
                        drop MyWizardBag 44 76 0
                        wait 150
                    elseif index = 1
                        lift regs ReagentStack
                        drop MyWizardBag 68 76 0
                        wait 150
                    elseif index = 2
                        lift regs ReagentStack
                        drop MyWizardBag 96 76 0
                        wait 150
                    elseif index = 3
                        lift regs ReagentStack
                        drop MyWizardBag 121 76 0
                        wait 150
                    else
                        lift regs ReagentStack
                        drop MyWizardBag 142 76 0
                        wait 150
                    endif
                endif
                
                @ignore regs 
                
                if moveRegs = 1
                    wait 500
                endif
            endwhile

            if EnableOverheadMessages = 1
                overhead "[ SPLITTING REGS... ]" 363
            endif
            
            # Nightshade
            @setvar! ReagentSerial 3976
            @setvar! ReagentCount 0

            while findtype ReagentSerial self as regs 
                @setvar! ReagentCount index
                @ignore regs
            endwhile
            
            @clearignore

            if counttype ReagentSerial self <= 10
                @setvar! ReagentStack 2
            elseif counttype ReagentSerial self <= 20
                @setvar! ReagentStack 4       
            elseif counttype ReagentSerial self <= 50
                @setvar! ReagentStack 10    
            elseif counttype ReagentSerial self <= 100
                @setvar! ReagentStack 20    
            elseif counttype ReagentSerial self <= 150
                @setvar! ReagentStack 30
            elseif counttype ReagentSerial self <= 200
                @setvar! ReagentStack 40
            else 
                @setvar! ReagentStack 50
            endif

            while findtype ReagentSerial self as regs
                @setvar! moveRegs 0 
                
                if ReagentCount = 0
                    @setvar! moveRegs 1
                elseif ReagentCount != 0 and not find regs MyWizardBag
                    @setvar! moveRegs 1
                endif

                if moveRegs = 1
                    if index = 0
                        lift regs ReagentStack
                        drop MyWizardBag 44 88 0
                        wait 150
                    elseif index = 1
                        lift regs ReagentStack
                        drop MyWizardBag 68 88 0
                        wait 150
                    elseif index = 2
                        lift regs ReagentStack
                        drop MyWizardBag 96 88 0
                        wait 150
                    elseif index = 3
                        lift regs ReagentStack
                        drop MyWizardBag 121 88 0
                        wait 150
                    else
                        lift regs ReagentStack
                        drop MyWizardBag 142 88 0
                        wait 150
                    endif
                endif

                @ignore regs 
                
                if moveRegs = 1
                    wait 500
                endif
            endwhile

            if EnableOverheadMessages = 1
                overhead "[ SPLITTING REGS... ]" 442
            endif
            
            # Mandrake Root
            @setvar! ReagentSerial 3974
            @setvar! ReagentCount 0

            while findtype ReagentSerial self as regs 
                @setvar! ReagentCount index
                @ignore regs
            endwhile
            @clearignore

            if counttype ReagentSerial self <= 10
                @setvar! ReagentStack 2
            elseif counttype ReagentSerial self <= 20
                @setvar! ReagentStack 4       
            elseif counttype ReagentSerial self <= 50
                @setvar! ReagentStack 10    
            elseif counttype ReagentSerial self <= 100
                @setvar! ReagentStack 20    
            elseif counttype ReagentSerial self <= 150
                @setvar! ReagentStack 30
            elseif counttype ReagentSerial self <= 200
                @setvar! ReagentStack 40
            else 
                @setvar! ReagentStack 50
            endif

            while findtype ReagentSerial self as regs
                @setvar! moveRegs 0 
                
                if ReagentCount = 0
                    @setvar! moveRegs 1
                elseif ReagentCount != 0 and not find regs MyWizardBag
                    @setvar! moveRegs 1
                endif
                
                if moveRegs = 1
                    if index = 0
                        lift regs ReagentStack
                        drop MyWizardBag 44 100 0
                        wait 150
                    elseif index = 1
                        lift regs ReagentStack
                        drop MyWizardBag 68 100 0
                        wait 150
                    elseif index = 2
                        lift regs ReagentStack
                        drop MyWizardBag 96 100 0
                        wait 150
                    elseif index = 3
                        lift regs ReagentStack
                        drop MyWizardBag 121 100 0
                        wait 150
                    else
                        lift regs ReagentStack
                        drop MyWizardBag 142 100 0
                        wait 150
                    endif
                endif
                
                @ignore regs 
                
                if moveRegs = 1
                    wait 500
                endif
            endwhile

            if EnableOverheadMessages = 1
                overhead "[ SPLITTING REGS... ]" 153
            endif
            
            # Sulfurous Ash
            @setvar! ReagentSerial 3980
            @setvar! ReagentCount 0

            while findtype ReagentSerial self as regs 
                @setvar! ReagentCount index
                @ignore regs
            endwhile

            @clearignore

            if counttype ReagentSerial self <= 10
                @setvar! ReagentStack 2
            elseif counttype ReagentSerial self <= 20
                @setvar! ReagentStack 4       
            elseif counttype ReagentSerial self <= 50
                @setvar! ReagentStack 10    
            elseif counttype ReagentSerial self <= 100
                @setvar! ReagentStack 20    
            elseif counttype ReagentSerial self <= 150
                @setvar! ReagentStack 30
            elseif counttype ReagentSerial self <= 200
                @setvar! ReagentStack 40
            else 
                @setvar! ReagentStack 50
            endif

            while findtype ReagentSerial self as regs
                @setvar! moveRegs 0 
                
                if ReagentCount = 0
                    @setvar! moveRegs 1
                elseif ReagentCount != 0 and not find regs MyWizardBag
                    @setvar! moveRegs 1  
                endif
                
                if moveRegs = 1
                    if index = 0
                        lift regs ReagentStack
                        drop MyWizardBag 44 112 0
                        wait 150
                    elseif index = 1
                        lift regs ReagentStack
                        drop MyWizardBag 68 112 0
                        wait 150
                    elseif index = 2
                        lift regs ReagentStack
                        drop MyWizardBag 96 112 0
                        wait 150
                    elseif index = 3
                        lift regs ReagentStack
                        drop MyWizardBag 121 112 0
                        wait 150
                    else
                        lift regs ReagentStack
                        drop MyWizardBag 142 112 0
                        wait 150
                    endif
                endif
                        
                @ignore regs 
                
                if moveRegs = 1
                    wait 500
                endif
            endwhile

            if EnableOverheadMessages = 1
                overhead "[ SPLITTING REGS... ]" 247
            endif
            
            # Giseng
            @setvar! ReagentSerial 3973
            @setvar! ReagentCount 0

            while findtype ReagentSerial self as regs 
                @setvar! ReagentCount index
                @ignore regs
            endwhile

            @clearignore

            if counttype ReagentSerial self <= 10
                @setvar! ReagentStack 2
            elseif counttype ReagentSerial self <= 20
                @setvar! ReagentStack 4       
            elseif counttype ReagentSerial self <= 50
                @setvar! ReagentStack 10    
            elseif counttype ReagentSerial self <= 100
                @setvar! ReagentStack 20    
            elseif counttype ReagentSerial self <= 150
                @setvar! ReagentStack 30
            elseif counttype ReagentSerial self <= 200
                @setvar! ReagentStack 40
            else 
                @setvar! ReagentStack 50
            endif

            while findtype ReagentSerial self as regs
                @setvar! moveRegs 0 
                
                if ReagentCount = 0
                    @setvar! moveRegs 1
                elseif ReagentCount != 0 and not find regs MyWizardBag
                    @setvar! moveRegs 1
                endif

                if moveRegs = 1
                    if index = 0
                        lift regs ReagentStack
                        drop MyWizardBag 44 124 0
                        wait 150
                    elseif index = 1
                        lift regs ReagentStack
                        drop MyWizardBag 68 124 0
                        wait 150
                    elseif index = 2
                        lift regs ReagentStack
                        drop MyWizardBag 96 124 0
                        wait 150
                    elseif index = 3
                        lift regs ReagentStack
                        drop MyWizardBag 121 124 0
                        wait 150
                    else
                        lift regs ReagentStack
                        drop MyWizardBag 142 124 0
                        wait 150
                    endif
                endif
                        
                @ignore regs 
                
                if moveRegs = 1
                    wait 500
                endif
            endwhile

            if EnableOverheadMessages = 1
                overhead "[ SPLITTING REGS... ]" 33
            endif
            
            # Bloodmoss
            @setvar! ReagentSerial 3963
            @setvar! ReagentCount 0

            while findtype ReagentSerial self as regs 
                @setvar! ReagentCount index
                @ignore regs
            endwhile
            
            @clearignore

            if counttype ReagentSerial self <= 10
                @setvar! ReagentStack 2
            elseif counttype ReagentSerial self <= 20
                @setvar! ReagentStack 4       
            elseif counttype ReagentSerial self <= 50
                @setvar! ReagentStack 10    
            elseif counttype ReagentSerial self <= 100
                @setvar! ReagentStack 20    
            elseif counttype ReagentSerial self <= 150
                @setvar! ReagentStack 30
            elseif counttype ReagentSerial self <= 200
                @setvar! ReagentStack 40
            else 
                @setvar! ReagentStack 50
            endif

            while findtype ReagentSerial self as regs
                @setvar! moveRegs 0 
                
                if ReagentCount = 0
                    @setvar! moveRegs 1
                elseif ReagentCount != 0 and not find regs MyWizardBag
                    @setvar! moveRegs 1
                endif
                
                if moveRegs = 1
                    if index = 0
                        lift regs ReagentStack
                        drop MyWizardBag 44 136 0
                        wait 150
                    elseif index = 1
                        lift regs ReagentStack
                        drop MyWizardBag 68 136 0
                        wait 150
                    elseif index = 2
                        lift regs ReagentStack
                        drop MyWizardBag 96 136 0
                        wait 150
                    elseif index = 3
                        lift regs ReagentStack
                        drop MyWizardBag 121 136 0
                        wait 150
                    else
                        lift regs ReagentStack
                        drop MyWizardBag 142 136 0
                        wait 150
                    endif
                endif
                        
                @ignore regs 
                
                if moveRegs = 1
                    wait 500
                endif
            endwhile

            if EnableOverheadMessages = 1
                overhead "[ SPLITTING REGS... ]" 646
            endif
            
            # Garlic
            @setvar! ReagentSerial 3972
            @setvar! ReagentCount 0

            while findtype ReagentSerial self as regs 
                @setvar! ReagentCount index
                @ignore regs
            endwhile
            
            @clearignore

            if counttype ReagentSerial self <= 10
                @setvar! ReagentStack 2
            elseif counttype ReagentSerial self <= 20
                @setvar! ReagentStack 4       
            elseif counttype ReagentSerial self <= 50
                @setvar! ReagentStack 10    
            elseif counttype ReagentSerial self <= 100
                @setvar! ReagentStack 20    
            elseif counttype ReagentSerial self <= 150
                @setvar! ReagentStack 30
            elseif counttype ReagentSerial self <= 200
                @setvar! ReagentStack 40
            else 
                @setvar! ReagentStack 50
            endif

            while findtype ReagentSerial self as regs
                @setvar! moveRegs 0 
                
                if ReagentCount = 0
                    @setvar! moveRegs 1
                elseif ReagentCount != 0 and not find regs MyWizardBag
                    @setvar! moveRegs 1
                endif
                
                if moveRegs = 1
                    if index = 0
                        lift regs ReagentStack
                        drop MyWizardBag 44 148 0
                        wait 150
                    elseif index = 1
                        lift regs ReagentStack
                        drop MyWizardBag 68 148 0
                        wait 150
                    elseif index = 2
                        lift regs ReagentStack
                        drop MyWizardBag 96 148 0
                        wait 150
                    elseif index = 3
                        lift regs ReagentStack
                        drop MyWizardBag 121 148 0
                        wait 150
                    else
                        lift regs ReagentStack
                        drop MyWizardBag 142 148 0
                        wait 150
                    endif
                endif
                
                @ignore regs 
                
                if moveRegs = 1
                    wait 500
                endif
            endwhile
        else 
            if EnableOverheadMessages = 1
                overhead "[ NO WIZARD BAG! ]" 337
                wait 500
            endif
        endif
    endif

    overhead "[ SCRIPT COMPLETE! ]" 88
    hotkey "Organizer Agent-01"
    stop
    
    if dead 
        stop
    endif
endwhile

////////////////////////
//   SCRIPT FINISH    //
////////////////////////





    // Thank you for using my scripts!  I can be contacted via email here: dan@danstockman.com 
    // Good luck out there and say hello if you see me in Avadon (Lord Glacier) - please don't PK me lol
    
    