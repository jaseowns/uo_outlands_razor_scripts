# This is an automated backup - check out https://outlands.uorazorscripts.com/script/3cae6333-e0fd-4287-8762-34d7ea78e952 for latest
# Automation by Jaseowns
## Script: Bapeth's Ship Launcher
## Created by: BAZZACUNT#9523
#############################################

# Bapeths Ship Launcher
# Bind this script to a hotkey and play near a dockmaster
#
# Script starts here
clearsysmsg 
overhead 'Launch sequence initiated...' 45
if findtype 3763|3762|3740|3742|10245 backpack as instrument
    @ignore instrument
endif
if findtype 3834 backpack 0 as bbook
    @ignore bbook
endif
if not findtype 5365 backpack
    overhead 'I forgot a Spyglass...' 38
    overhead 'Launch Aborted' 38
    stop
endif
if not findtype 48261 backpack
    overhead "I could use a Spell Foci..." 78
    overhead "Any Foci type will give me extra magic damage..." 78
    pause 1000
endif
if followers = 0
    overhead "I should get some followers..." 45
    pause 1000
endif

for 25
    hotkey "Next Monster Target"
    @setvar bdockmaster lasttarget
    if noto bdockmaster = "invulnerable"
        getlabel bdockmaster desc
        if "dockmaster" in desc
            menu bdockmaster 1
            getlabel backpack ping
            if gumpexists 3287496917
                gumpresponse 10
                getlabel backpack ping
                if insysmsg 'You have traveled'
                    overhead 'Travel cooldown...' 38
                    overhead 'Launch Aborted' 38
                    gumpclose 3287496917
                    stop
                elseif insysmsg 'You have been onboard'
                    overhead 'Onboard cooldown...' 38
                    overhead 'Launch Aborted' 38
                    hotkey "Cancel Current Target"
                    gumpclose 3287496917
                    stop
                endif
                wft 500
                overhead "Select Launch Location" 88
                while targetexists 
                    //donothing
                endwhile
                getlabel backpack ping
                gumpclose 3287496917
                break
            endif
        endif
    endif
endfor

if insysmsg 'A ship cannot be placed'
    overhead 'Cannot place there...' 38
    overhead 'Try again...' 38
    gumpclose 3287496917
    replay
elseif insysmsg 'That location is too far away'
    overhead 'Cannot place there...' 38
    overhead 'Try again...' 38
    gumpclose 3287496917
    replay
elseif insysmsg 'You have been onboard'
    overhead 'Onboard cooldown...' 38
    overhead 'Launch Aborted' 38
    hotkey "Cancel Current Target"
    gumpclose 3287496917
    stop
elseif insysmsg "while on a house"
    overhead "I cannot place that from inside this house..." 38
    overhead "Launch Aborted..." 38
    gumpclose 3287496917
    gumpclose 4216593270
    stop
endif
if not gumpexists 4216593270
    say "[ship"
    waitforgump 4216593270 500
endif

if gumpexists 4216593270
    gumpresponse 21
    waitforgump 4216593270 500
    getlabel backpack ping
    gumpresponse 22
    waitforgump 4216593270 500
    getlabel backpack ping
    gumpresponse 29
    waitforgump 4216593270 500
    getlabel backpack ping
    gumpresponse 24
    waitforgump 4216593270 500
    getlabel backpack ping
    say "[Reload" 88
    overhead '*Reloading*' 45
    waitforgump 4216593270 500
    getlabel backpack ping
    gumpclose 4216593270
    if insysmsg "may ready the crew"
        overhead "Crew is not ready..." 38
    endif
    overhead "Set my Hatch..." 77
    overhead "Set my Hatch..." 77
    overhead "Set my Hatch..." 77
    setlasttarget 
    wft 500
    while targetexists 
        //donothing
    endwhile
    @setvar "shiphold" lasttarget 
    if not find "shiphold" ground -1 -1 22
        overhead "Error, launch code resetting..." 38
        replay
    endif
    overhead 'Pull Bars!' 88
    overhead 'Pull Bars!' 88
    overhead 'Pull Bars!' 88
    pause 3000
    if gumpexists 4216593270
        gumpclose 4216593270
    endif
    if skill "Necromancy" >= 50 and not gumpexists 622436516
        say [necromancyhotbar
        pause 250
    endif
    script "Passive Captain"
endif