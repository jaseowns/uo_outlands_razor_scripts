# This is an automated backup - check out https://outlands.uorazorscripts.com/script/e0d2f166-f84c-4890-83a6-bbb585689984 for latest
# Automation by Jaseowns
## Script: Bapeth's Map-Trap Script
## Created by: barryroser#0
#############################################

# Map-Trap Script by Bapeth
#
# Jan 13th 2026 - Added cooldown timer "Fortune/Harvest" for the recent aspect swap nerf
#
# "What it does":
# Digs for treasure
# Uses explorer pack
# Places initial trap
# Summons an Earth Elemental
# Uses both "Harvest/Fortune and Gadget" aspect to maximize damage and loot/xp
# Uses up to three mastery chains - one for "Trap Damage", one for "Special/Rare Loot Chance" (optional), and one for T8 "Link Dumping" (optional)
# Swaps to your preferred Aspect Spell Book for XP gain (optional)
# Detects hidden while digging (this may not work if player has recently detonated a trap)
# Auto opens and loots treasure chests (Reagent Satchel and Quiver can be used to hold regs/arrows/bolts to reduce weight)
# Auto equips a looted link from a T8 chest
# Auto Gate Travels to users house if there is too much gold to carry
# Auto demolishes chest when empty
#
# "Full variable reset"
# If an error has occurred while the script is setting mastery chains, go into "WARMODE + Open the Party Menu", then play the script to wipe all variable memory and start fresh
#
# "REQUIRED": <---------- "Important information!"
# User must create five cooldowns named:
#
# "Aspect Armor"
# Type: Regular
# Trigger: Overhead Message
# Trigger Text: aspect armor activated
# -------------- Cooldown : 30
#    
# "Aspect Book"
# Type: Regular
# Trigger: Overhead Message
# Trigger Text: aspect activated
# -------------- Cooldown : 30
#    
# "Aspect Proc"
# Type: Regular
# Trigger: Overhead Message
# Trigger Text: *innovation*
# -------------- Cooldown : 30
#    
# "Chain Swap"
# Type: Regular
# Trigger: N/A
# Trigger Text: N/A
# -------------- Cooldown : N/A
#
# "Fortune/Harvest"  <--- This is a timer for the recent aspect swap nerf
# Type: Regular
# Trigger: Sys Message
# Trigger Text: Fortune loot and experience bonuses will become
# Trigger Text: Harvest skill and yield bonuses become
# -------------- Cooldown : 60
#
# Cooldowns can be found in the in-game options menu
#
# "Spell Book Aspect Swapping"
# The script can now swap your aspect spellbook from Gadget to any aspect you would like to gain XP on
# This part if the script is activated during the "Lockpicking Phase"
# See the list of aspects below to set your preferred aspect for XP gain
#
# "Default Aspect Armor"
# The user may select from "Harvest or Fortune" as the aspect to open the chest with
# See below for settings
#
# "Auto Loot Control"
# This script uses the razor "Auto-Queue Object Delay" setting
# Make sure this setting is turned ON in the razor Options tab > Targeting & Queues sub-tab
# Set "object delay to 503" ---> AUTO LOOTING WILL BE SLOW IF YOU DONT DO THIS!
#
# "Lootbag"
# Set by using the razor hotkey "Set Grab Item Hotbag" (Default is your Main Backpack)
#
# "HOW TO USE":
#
# Items needed in backpack - Shovel, T-map, Explorer Pack (if user has carto skill), Ground Traps, Lockpicks, Trap Kit, Mastery Chain
# Items needed equipped - Set of armor, Spellbook
#
# "PEACEMODE" (Gadget / Trap Chain)
# In peacemode play the script while looking for treasure - The script will ensure you are in Gadget aspect and your Trap Chain is equipped
# When a chest is found, an elemental will be summoned, a trap placed, and the explorers pack used
#
# The script will stop once the chest has been fully dug up to allow for the player to manually kill all monsters
# It is best to stay the elemental(s) in the direct center of the trap and wait for the mobs to move into range
# Use a wall of stone strategically to gather ranged/caster mobs within the trap square
# Detonate the trap and ready another trap if needed ---> repeat as needed
#
# "WARMODE" (Harvest / Loot Chain)
# In warmode play the script when all monsters are dead - The script will ensure you are in Harvest aspect and your Loot Chain is equipped
# At this time an optional spell book aspect swap will take place
# Mastery chain cooldown is 30 seconds, which is longer than low-level maps will take to open - the user should wait 10 seconds before approaching the chest (loot monster corpses during this time)
# Approach the chest (within 1 tile) and the script will automatically cast invis on the user and begin picking/looting
# When the script is done looting, it will switch back to Gadget aspect and equip the Trap Chain
# If the gold is too heavy to carry, the script will use gate travel (Read below)
# When the chest is empty, the script will auto delete the empty chest
#
# You are now ready to go do another T-map!
#
# "Auto-Gate Travel"
# If there is too much gold within the treasure chest for the player to carry, the auto-gate travel routine will activate
# The script will gate to a rune named "House" or a rune named "Inn" within the users runebook/tome
# If a "Bank Deposit Safe" is nearby, the script will use it otherwise, it will drop gold at the users feet
# Ensure you have a rune in your runebook/tome marked for and named "House" or "Inn" <---------- "Important information!"
# To select between a House or Inn see below - Default is House
#
# "Notes":
# If Inn room is selected for Auto-Gate Travel know that it is only capable one a single gate-hop from the treasure site to the Inn room
# In the extremely rare case that there is more than 60000 gold in the treasure chest (2 stacks or more) you will have to manually return to the chest to pick up the remaining gold
# Houses on the other hand are capable of multiple gate-hops and do not have this potential issue
#
# Rename your summons by doing a Ctrl + F search for "rename" and editing the script with whatever you prefer (must be unique and contain no spaces)
#
# Some antiquity items may not be on the loot list - If the chest does not auto delete, double-check it for an un-looted antiquity
#
# If you would like to add a script to quickly recall, dump/sort loot, and restock your character see the link below
# "Bapeths One Tile Item Dump & Restock" link :  https://outlands.uorazorscripts.com/script/fc599b28-5594-483a-ae25-b48b33967eec
# This script can be tied into the Map-Trap script by simply downloading it, setting it up, and naming -EXACTLY- as you see here
#
#~~"Recommended Build"~~
#
#  "Trapper Mapper"
# Alchemy -------120
# Detect Hidden -120
# Tinkering -----120
# Magery --------100
# Lockpicking -- 100
# Cartography -- 80
# Spirit Speak --80
#
#########################################################################################################################################
#
# "SCRIPT SETTINGS"
#
# Set your "Home Type" for the Auto-Gate Travel feature choose either "House" or "Inn" and set the value to 1
# One of these must always be set to 1 - do not set both to 1!
#
# HOME TYPE SETTINGS
@setvar! "House" 1
@setvar! "Inn" 0
#
#########################################################################################################################################
#
# Set the "follower cap" for your earth elementals to a value of 1 or 2
# Setting it to 1 will block summoning en elemental if you already have one
# Setting it to 2 will summon an additional elemental if you already have one
# Default is set to 1 - no extra elemental is summoned
#
# EARTH ELEMENTAL SETTING
@setvar! "Summon Earth" 2
#
#########################################################################################################################################
#
# Set your lockpicking phase "Armor Aspect" choose either Harvest or Fortune and set the value to 1
# One of these must always be set to 1 - do not set both to 1!
#
# WARMODE ARMOR SETTINGS
@setvar! "Harvest Armor" 1
@setvar! "Fortune Armor" 0
#
#########################################################################################################################################
#
# Set your Spellbook Aspect for "Chest XP Gain" during the lockpicking phase
# Choose one aspect below and change the value from 0 to 1 (Default is Gadget)
# One of these must always be set to 1 - do not set more than one to 1!
# 
# WARMODE SPELLBOOK SETTINGS
@setvar! "Air Aspect Spellbook" 0
@setvar! "Arcane Aspect Spellbook" 0
@setvar! "Artisan Aspect Spellbook" 0
@setvar! "Blood Aspect Spellbook" 0
@setvar! "Command Aspect Spellbook" 0
@setvar! "Death Aspect Spellbook" 0
@setvar! "Discipline Aspect Spellbook" 0
@setvar! "Earth Aspect Spellbook" 0
@setvar! "Eldritch Aspect Spellbook" 0
@setvar! "Fire Aspect Spellbook" 0
@setvar! "Fortune Aspect Spellbook" 0
@setvar! "Frost Aspect Spellbook" 0
@setvar! "Gadget Aspect Spellbook" 0
@setvar! "Harvest Aspect Spellbook" 0
@setvar! "Holy Aspect Spellbook" 0
@setvar! "Lightning Aspect Spellbook" 1
@setvar! "Lyric Aspect Spellbook" 0
@setvar! "Madness Aspect Spellbook" 0
@setvar! "Poison Aspect Spellbook" 0
@setvar! "Shadow Aspect Spellbook" 0
@setvar! "Void Aspect Spellbook" 0
@setvar! "Water Aspect Spellbook" 0
#
############################################################################################################################################
#
# Set your Spellbook Aspect for "Mob XP Gain" during the digging/fighting phase
# Choose one aspect below and change the value from 0 to 1
# Default is set to Gadget in order to proc the Gadget special *innovation*
# Setting the below setting to anything but Gadget will stop *innovation* from occuring during combat
# One of these must always be set to 1 - do not set more than one to 1!
#
# PEACEMODE SPELLBOOK SETTINGS
@setvar! "Combat Air Aspect Spellbook" 0
@setvar! "Combat Arcane Aspect Spellbook" 0
@setvar! "Combat Artisan Aspect Spellbook" 0
@setvar! "Combat Blood Aspect Spellbook" 0
@setvar! "Combat Command Aspect Spellbook" 0
@setvar! "Combat Death Aspect Spellbook" 0
@setvar! "Combat Discipline Aspect Spellbook" 0
@setvar! "Combat Earth Aspect Spellbook" 0
@setvar! "Combat Eldritch Aspect Spellbook" 0
@setvar! "Combat Fire Aspect Spellbook" 0
@setvar! "Combat Fortune Aspect Spellbook" 0
@setvar! "Combat Frost Aspect Spellbook" 0
@setvar! "Combat Gadget Aspect Spellbook" 0
@setvar! "Combat Harvest Aspect Spellbook" 0
@setvar! "Combat Holy Aspect Spellbook" 0
@setvar! "Combat Lightning Aspect Spellbook" 1
@setvar! "Combat Lyric Aspect Spellbook" 0
@setvar! "Combat Madness Aspect Spellbook" 0
@setvar! "Combat Poison Aspect Spellbook" 0
@setvar! "Combat Shadow Aspect Spellbook" 0
@setvar! "Combat Void Aspect Spellbook" 0
@setvar! "Combat Water Aspect Spellbook" 0
#
##############################################################################################################################################
#
//Do not edit below this line unless you know what you are doing!
if warmode and gumpexists 3527489586
    warmode off
    gumpclose 3527489586
    overhead "VARIBLE RESET..." 38
    if varexist "OneChain"
        @unsetvar "OneChain"
    endif
    if varexist "TwoChain"
        @unsetvar "TwoChain"
    endif    
    if varexist "TrapChain"
        @unsetvar "TrapChain"
    endif
    if varexist "LootChain"
        @unsetvar "LootChain"
    endif
    if varexist "linkdumpchain"
        @unsetvar "linkdumpchain"
    endif
    if varexist "enabledlinkdump"
        @unsetvar "enabledlinkdump"
    endif
    overhead "MEMORY WIPED..." 38
    pause 2000
endif

if not varexist "OneChain" and not varexist "TwoChain"
    overhead "Are you using 1 or 2 Mastery Chains?" 56
    pause 1200
    hotkey "Set Last Target"
    wft 500
    while targetexists
        if not timerexists chainselect
            createtimer chainselect
            settimer chainselect 4500
        elseif timer chainselect >= 4500
            settimer chainselect 0
            overhead "Select trap kit for 2 chains" 88
            overhead "Select backpack for 1 chain" 78
        endif
    endwhile
    getlabel lasttarget desc
    if "trap kit" in desc
        @setvar "TwoChain" lasttarget 
        overhead "I have selected for Two Chains" 88
    elseif "backpack" in desc
        @setvar "OneChain" lasttarget 
        overhead "I have selected for One Chain" 78
    endif
    if timerexists chainselect
        removetimer chainselect
    endif
    pause 2000
endif

if varexist "TwoChain"
    if not varexist "TrapChain"
        hotkey "Set Last Target" 
        wft 500
        while targetexists
            if not timerexists chainselect
                createtimer chainselect
                settimer chainselect 4500
            elseif timer chainselect >= 4500
                settimer chainselect 0
                overhead "Set Trap Chain..." 88
            endif
        endwhile
        @setvar "TrapChain" lasttarget 
        overhead "Trap Chain Set..." 88
        overhead "Trap Chain Set..." 88 "TrapChain"
        pause 1500
    endif
    if timerexists chainselect
        removetimer chainselect
    endif
    if not varexist "LootChain"
        hotkey "Set Last Target" 
        wft 500
        while targetexists
            if not timerexists chainselect
                createtimer chainselect
                settimer chainselect 4500
            elseif timer chainselect >= 4500
                settimer chainselect 0
                overhead "Set Loot Chain..." 78
            endif
        endwhile
        @setvar "LootChain" lasttarget 
        overhead "Loot Chain Set..." 78
        overhead "Loot Chain Set..." 78 "LootChain"
        pause 1500
    endif
endif
if timerexists chainselect
    removetimer chainselect
endif

if not varexist "linkdumpchain"
    hotkey "Cancel Current Target"
    hotkey "Set Last Target"
    wft 500
    while targetexists
        if not timerexists lootcontainerselect
            createtimer lootcontainerselect
            settimer lootcontainerselect 4500
        elseif timer lootcontainerselect >= 4500
            settimer lootcontainerselect 0
            overhead "Set Chain to Dump Links" 96
            overhead "This is for T8 looted links" 96
            overhead "Select Backpack if none..." 45
        endif
    endwhile
    getlabel lasttarget desc
    if "backpack" in desc
        @setvar "linkdumpchain" lasttarget
    else
        @setvar "linkdumpchain" lasttarget
        @setvar "enabledlinkdump" 0
        overhead "Link Dump Chain Set!" 96
        overhead "Link Dump Chain Set!" 96 "linkdumpchain"
        pause 1500
    endif
endif

if skill "Cartography" >= 10 and findtype "adventure pack" backpack as advpack
    @setvar! "bappack" advpack
endif

if skill "Tinkering" >= 80 and findtype "metal trap" backpack as btrap
    @setvar! "baptrap" btrap
endif
if not warmode and not timerexists checkforgadget
    createtimer checkforgadget
    removetimer checkforharvest   
elseif warmode and not timerexists checkforharvest
    createtimer checkforharvest
    removetimer checkforgadget 
endif
if timerexists bchestopen
    removetimer bchestopen
endif
if timerexists fullchaincheck
    removetimer fullchaincheck
endif

if not targetexists and not casting and not findbuff "Food Satisfaction"
    if findtype 2429|28885|29774|29773|28880|28888|28881|28883|28886|28879 backpack as food
        dclick food
        cooldown "Food" 3600000
        getlabel backpack ping
    endif
endif

if not warmode
    if varexist "TwoChain"
        getlabel "TrapChain" chaindesc
        if "active" in chaindesc
            //donothing
        else 
            menu "TrapChain" 0
            getlabel backpack ping
            overhead "Trap Chain Activated" 2669
            overhead "Trap Chain Activated" 2669 "TrapChain"
            cooldown "Chain Swap" 30000
        endif
    endif
    if timerexists checkforgadget
        if findlayer self innertorso as chestarmor
            getlabel chestarmor desc
            if "gadget" in desc
                if timerexists gobackformoregold
                    removetimer gobackformoregold
                endif
                if timerexists gategold
                    removetimer gategold
                endif
            else
                if not cooldown "Aspect Armor" and not cooldown "Aspect Proc"
                    clearsysmsg
                    say "[AspectArmor Gadget"
                    getlabel backpack ping
                endif
            endif
        endif
        if not cooldown "Aspect Book" and not cooldown "Aspect Proc" and findlayer self righthand as bookinhand
            getlabel bookinhand righthanddesc
            if "Combat Air Aspect Spellbook" = 1
                if "air" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Air"
                    getlabel backpack ping
                endif
            elseif "Combat Arcane Aspect Spellbook" = 1
                if "arcane" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Arcane"
                    getlabel backpack ping
                endif
            elseif "Combat Artisan Aspect Spellbook" = 1
                if "artisan" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Artisan"
                    getlabel backpack ping
                endif
            elseif "Combat Blood Aspect Spellbook" = 1
                if "blood" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Blood"
                    getlabel backpack ping
                endif
            elseif "Combat Command Aspect Spellbook" = 1
                if "command" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Command"
                    getlabel backpack ping
                endif
            elseif "Combat Death Aspect Spellbook" = 1
                if "death" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Death"
                    getlabel backpack ping
                endif
            elseif "Combat Discipline Aspect Spellbook" = 1
                if "discipline" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Discipline"
                    getlabel backpack ping
                endif
            elseif "Combat Earth Aspect Spellbook" = 1
                if "earth" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Earth"
                    getlabel backpack ping
                endif
            elseif "Combat Eldritch Aspect Spellbook" = 1
                if "eldritch" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Eldritch"
                    getlabel backpack ping
                endif
            elseif "Combat Fire Aspect Spellbook" = 1
                if "fire" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Fire"
                    getlabel backpack ping
                endif
            elseif "Combat Fortune Aspect Spellbook" = 1
                if "fortune" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Fortune"
                    getlabel backpack ping
                endif
            elseif "Combat Frost Aspect Spellbook" = 1
                if "frost" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Frost"
                    getlabel backpack ping
                endif
            elseif "Combat Gadget Aspect Spellbook" = 1
                if "gadget" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Gadget"
                    getlabel backpack ping
                endif
            elseif "Combat Harvest Aspect Spellbook" = 1
                if "harvest" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Harvest"
                    getlabel backpack ping
                endif
            elseif "Combat Holy Aspect Spellbook" = 1
                if "holy" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Holy"
                    getlabel backpack ping
                endif
            elseif "Combat Lightning Aspect Spellbook" = 1
                if "lightning" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Lightning"
                    getlabel backpack ping
                endif
            elseif "Combat Lyric Aspect Spellbook" = 1
                if "lyric" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Lyric"
                    getlabel backpack ping
                endif
            elseif "Combat Madness Aspect Spellbook" = 1
                if "madness" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Madness"
                    getlabel backpack ping
                endif
            elseif "Combat Poison Aspect Spellbook" = 1
                if "poison" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Poison"
                    getlabel backpack ping
                endif
            elseif "Combat Shadow Aspect Spellbook" = 1
                if "shadow" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Shadow"
                    getlabel backpack ping
                endif
            elseif "Combat Void Aspect Spellbook" = 1
                if "void" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Void"
                    getlabel backpack ping
                endif
            elseif "Combat Water Aspect Spellbook" = 1
                if "water" in righthanddesc
                    //donothing
                else 
                    say "[AspectSpellbook Water"
                    getlabel backpack ping
                endif
            endif
        endif
    endif
    if timerexists dugchest and not findtype "map" backpack
        removetimer dugchest
    elseif timerexists dugchest and findtype "map" backpack as checkmapprog
        getlabel checkmapprog mapdesc
        if "in progress" in mapdesc
            //donothing
        else 
            removetimer dugchest
        endif
    endif
    if not timerexists dugchest
        if findtype "map" backpack 0 -1 as BapMap
            getlabel BapMap Mapdesc
            if "in progress" in Mapdesc
                overhead "The chest has been dug up!" 45
                createtimer dugchest
            endif
        elseif findtype "map" backpack 2091 -1 as BapMap
            if "in progress" in Mapdesc
                overhead "The chest has been dug!" 45
                createtimer dugchest
            endif
        else
            overhead "I will need a treasure map..." 38
            stop
        endif
    endif
    if not findtype "shovel" backpack
        overhead "I will need a shovel..." 38
        stop
    endif
    if not timerexists dugchest and findtype "shovel" backpack as bshovel
        dclick bshovel
        pause 1200
        if insysmsg "Perhaps you should step outdoors."
            overhead "I should hunt outside..." 45
            pause 2000 
            replay
        elseif findbuff "Entangle"
            if not timerexists detectdig
                createtimer detectdig
                settimer detectdig 11000
            endif
            if timer detectdig >= 11000 and skill "detectinghidden" >= 20
                settimer detectdig 0
                skill "detectinghidden"
                wft 500
                target self
                hotkey "Cancel Current Target"
            endif
            if mana >= 64 and not findbuff "Magic Reflection"
                cast "Magic Reflection"
                getlabel backpack ping
                if casting 
                    while casting 
                        //nothing
                    endwhile
                    pause 330
                endif
            endif
            if mana >= 54 and not findbuff "Reactive Armor"
                cast "Reactive Armor"
                getlabel backpack ping
                if casting 
                    while casting 
                        //nothing
                    endwhile
                    pause 330
                endif
            endif
            if "Summon Earth" = 1 and mana >= 50 and followers < 2
                cast "Earth Elemental"
            elseif "Summon Earth" = 2 and mana >= 50 and followers < 4
                cast "Earth Elemental"
            endif
            if varexist "bappack"
                dclick "bappack"
            endif
            getlabel backpack ping
            pause 500
            dclick "baptrap"
            while queued
                //donothing
            endwhile
            getlabel backpack ping
            pause 500
            if not findbuff "Strength" and findtype "white potion" backpack as wpot
                dclick wpot
                while queued
                    //donothing
                endwhile
                getlabel backpack ping
                pause 500
            endif
            if not findbuff "Agility" and findtype "blue potion" backpack as bpot
                dclick bpot
                while queued
                    //donothing
                endwhile
                getlabel backpack ping
                pause 500
            endif
            if not findbuff "Magic Resist Potion" and findtype "black potion" backpack as respot
                dclick respot
                while queued
                    //donothing
                endwhile
                getlabel backpack ping
                pause 500
            endif
            while findbuff "Entangle"
                if not find "bsummon1" ground and findtype "an earth elemental|a fire elemental|a water elemental|an air elemental|a daemon" ground -1 -1 1 as sum1  
                    if noto sum1 = "friend"
                        # Name your summon if you like (no spaces must be unique)
                        rename sum1 "MapGolem"
                    endif
                elseif not find "bsummon1" ground and findtype "MapGolem" ground as sum1
                    @setvar! "bsummon1" sum1
                endif
                if not find "bsummon2" ground and findtype "an earth elemental|a fire elemental|a water elemental|an air elemental|a daemon" ground -1 -1 1 as sum2  
                    if noto sum2 = "friend"
                        # Name your summon if you like (no spaces must be unique)
                        rename sum2 "MapGolems"
                    endif
                elseif not find "bsummon2" gorund and findtype "MapGolems" ground as sum2
                    @setvar! "bsummon2" sum2
                endif
            endwhile
            pause 1100
            overhead "Time to slay monsters!!!" 88
            stop
        endif
    endif
elseif warmode
    if varexist "TwoChain"
        getlabel "LootChain" chaindesc
        if "active" in chaindesc
            //donothing
        else 
            menu "LootChain" 0
            getlabel backpack ping
            if "Harvest Armor" = 1
                overhead "Loot Chain Activated" 2086
                overhead "Loot Chain Activated" 2086 "LootChain"
            elseif "Fortune Armor" = 1
                overhead "Loot Chain Activated" 2843
                overhead "Loot Chain Activated" 2843 "LootChain"
            endif
            cooldown "Chain Swap" 30000
        endif
    endif
    if timerexists checkforharvest
        if findlayer self innertorso as chestarmor
            getlabel chestarmor desc
            if "harvest" in desc
                if timerexists harvestspam
                    removetimer harvestspam
                endif
            elseif "fortune" in desc
                if timerexists harvestspam
                    removetimer harvestspam
                endif                
            else
                if cooldown "Aspect Armor"
                    if not timerexists harvestspam
                        createtimer harvestspam
                    endif
                endif
                if cooldown "Aspect Proc"
                    if not timerexists harvestspam
                        createtimer harvestspam
                    endif
                endif
                if not cooldown "Aspect Armor" and not cooldown "Aspect Proc"
                    clearsysmsg
                    if "Harvest Armor" = 1
                        say "[AspectArmor Harvest"
                    elseif "Fortune Armor" = 1
                        say "[AspectArmor Fortune"
                    endif
                    getlabel backpack ping
                endif
            endif
        endif
        if cooldown "Aspect Book"
            if not timerexists bookaspectspam
                createtimer bookaspectspam
            endif
        endif
        if cooldown "Aspect Proc"
            if not timerexists bookaspectspam
                createtimer bookaspectspam
            endif
        endif
        if not cooldown "Aspect Book" and not cooldown "Aspect Proc" and findlayer self righthand as bookinhand
            if timerexists bookaspectspam
                removetimer bookaspectspam
            endif
            if timerexists bookaspectspam
                removetimer bookaspectspam
            endif
            getlabel bookinhand bookdesc
            if "Air Aspect Spellbook" = 1
                if "air" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Air"
                    getlabel backpack ping
                endif
            elseif "Arcane Aspect Spellbook" = 1
                if "arcane" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Arcane"
                    getlabel backpack ping
                endif
            elseif "Artisan Aspect Spellbook" = 1
                if "artisan" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Artisan"
                    getlabel backpack ping
                endif
            elseif "Blood Aspect Spellbook" = 1
                if "blood" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Blood"
                    getlabel backpack ping
                endif
            elseif "Command Aspect Spellbook" = 1
                if "command" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Command"
                    getlabel backpack ping
                endif
            elseif "Death Aspect Spellbook" = 1
                if "death" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Death"
                    getlabel backpack ping
                endif
            elseif "Discipline Aspect Spellbook" = 1
                if "discipline" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Discipline"
                    getlabel backpack ping
                endif
            elseif "Earth Aspect Spellbook" = 1
                if "earth" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Earth"
                    getlabel backpack ping
                endif
            elseif "Eldritch Aspect Spellbook" = 1
                if "eldritch" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Eldritch"
                    getlabel backpack ping
                endif
            elseif "Fire Aspect Spellbook" = 1
                if "fire" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Fire"
                    getlabel backpack ping
                endif
            elseif "Fortune Aspect Spellbook" = 1
                if "fortune" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Fortune"
                    getlabel backpack ping
                endif
            elseif "Frost Aspect Spellbook" = 1
                if "frost" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Frost"
                    getlabel backpack ping
                endif
            elseif "Gadget Aspect Spellbook" = 1
                if "gadget" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Gadget"
                    getlabel backpack ping
                endif
            elseif "Harvest Aspect Spellbook" = 1
                if "harvest" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Harvest"
                    getlabel backpack ping
                endif
            elseif "Holy Aspect Spellbook" = 1
                if "holy" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Holy"
                    getlabel backpack ping
                endif
            elseif "Lightning Aspect Spellbook" = 1
                if "lightning" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Lightning"
                    getlabel backpack ping
                endif
            elseif "Lyric Aspect Spellbook" = 1
                if "lyric" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Lyric"
                    getlabel backpack ping
                endif
            elseif "Madness Aspect Spellbook" = 1
                if "madness" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Madness"
                    getlabel backpack ping
                endif
            elseif "Poison Aspect Spellbook" = 1
                if "poison" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Poison"
                    getlabel backpack ping
                endif
            elseif "Shadow Aspect Spellbook" = 1
                if "shadow" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Shadow"
                    getlabel backpack ping
                endif
            elseif "Void Aspect Spellbook" = 1
                if "void" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Void"
                    getlabel backpack ping
                endif
            elseif "Water Aspect Spellbook" = 1
                if "water" in bookdesc
                    //donothing
                else 
                    say "[AspectSpellbook Water"
                    getlabel backpack ping
                endif
            endif
        endif
    endif
    if findtype "wooden chest|metal chest" ground -1 -1 1 as bchest
        @setvar! "newchest" bchest
        gumpclose 736038070
        clearsysmsg 
        dclick bchest
        for 10
            if findtype "quiver" self as bapquiver
                getlabel bapquiver desc
                if "blessed" in desc
                    @ignore bapquiver
                else 
                    break
                endif
            endif
        endfor
        if findtype "quiver" self as bapquiver
            menu bapquiver 0
        endif
        for 10
            if findtype "reagent satchel" self as bapregsatch
                getlabel bapregsatch desc
                if "blessed" in desc
                    @ignore bapregsatch
                else 
                    break
                endif
            endif
        endfor
        if findtype "reagent satchel" self as bapregsatch
            menu bapregsatch 0
        endif
        getlabel backpack ping
        if gumpexists 736038070 and ingump "Cleared Of Traps"
            while gumpexists 736038070
                gumpresponse 4
                waitforgump 736038070 500
                if insysmsg "You attempt to pick the lock"
                    clearsysmsg
                    break
                elseif insysmsg "You must rid the area"
                    overhead "I must kill these monsters first..." 88
                    stop
                endif
            endwhile
            overhead "*picking*" 1060 bchest
            if followers >= 1
                hotkey "Cancel Current Target"
                say "All Patrol" 45
                wft 500
                target self
                hotkey "Cancel Current Target"
            endif
            while not dead 
                if insysmsg "Another player"
                    gumpclose 736038070
                    dclick bchest
                    waitforgump 736038070 1000
                    gumpresponse 7
                    waitforgump 736038070 1000
                endif
                if not hidden and mana >= 20
                    cast "Invisibility"
                    wft 5000
                    target self
                    getlabel backpack ping
                    hotkey "Cancel Current Target"
                endif
                if insysmsg "You successfully pick the lock"
                    break
                endif
                if not findtype "wooden chest|metal chest" ground -1 -1 2
                    break
                endif
                if timerexists harvestspam and not cooldown "Aspect Proc" and not cooldown "Aspect Armor"
                    if findlayer self innertorso as chestarmor
                        getlabel chestarmor desc
                        if "harvest" in desc
                            if timerexists harvestspam
                                removetimer harvestspam
                            endif
                        elseif "fortune" in desc
                            if timerexists harvestspam
                                removetimer harvestspam
                            endif                
                        else
                            if "Harvest Armor" = 1
                                say "[AspectArmor Harvest"
                            elseif "Fortune Armor" = 1
                                say "[AspectArmor Fortune"
                            endif
                            getlabel backpack ping
                        endif
                    endif
                endif
                if timerexists bookaspectspam and not cooldown "Aspect Proc" and not cooldown "Aspect Book" and findlayer self righthand as bookinhand
                    getlabel bookinhand bookdesc
                    if "Air Aspect Spellbook" = 1
                        if "air" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Air"
                            getlabel backpack ping
                        endif
                    elseif "Arcane Aspect Spellbook" = 1
                        if "arcane" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Arcane"
                            getlabel backpack ping
                        endif
                    elseif "Artisan Aspect Spellbook" = 1
                        if "artisan" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Artisan"
                            getlabel backpack ping
                        endif
                    elseif "Blood Aspect Spellbook" = 1
                        if "blood" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Blood"
                            getlabel backpack ping
                        endif
                    elseif "Command Aspect Spellbook" = 1
                        if "command" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Command"
                            getlabel backpack ping
                        endif
                    elseif "Death Aspect Spellbook" = 1
                        if "death" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Death"
                            getlabel backpack ping
                        endif
                    elseif "Discipline Aspect Spellbook" = 1
                        if "discipline" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Discipline"
                            getlabel backpack ping
                        endif
                    elseif "Earth Aspect Spellbook" = 1
                        if "earth" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Earth"
                            getlabel backpack ping
                        endif
                    elseif "Eldritch Aspect Spellbook" = 1
                        if "eldritch" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Eldritch"
                            getlabel backpack ping
                        endif
                    elseif "Fire Aspect Spellbook" = 1
                        if "fire" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Fire"
                            getlabel backpack ping
                        endif
                    elseif "Fortune Aspect Spellbook" = 1
                        if "fortune" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Fortune"
                            getlabel backpack ping
                        endif
                    elseif "Frost Aspect Spellbook" = 1
                        if "frost" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Frost"
                            getlabel backpack ping
                        endif
                    elseif "Gadget Aspect Spellbook" = 1
                        if "gadget" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Gadget"
                            getlabel backpack ping
                        endif
                    elseif "Harvest Aspect Spellbook" = 1
                        if "harvest" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Harvest"
                            getlabel backpack ping
                        endif
                    elseif "Holy Aspect Spellbook" = 1
                        if "holy" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Holy"
                            getlabel backpack ping
                        endif
                    elseif "Lightning Aspect Spellbook" = 1
                        if "lightning" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Lightning"
                            getlabel backpack ping
                        endif
                    elseif "Lyric Aspect Spellbook" = 1
                        if "lyric" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Lyric"
                            getlabel backpack ping
                        endif
                    elseif "Madness Aspect Spellbook" = 1
                        if "madness" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Madness"
                            getlabel backpack ping
                        endif
                    elseif "Poison Aspect Spellbook" = 1
                        if "poison" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Poison"
                            getlabel backpack ping
                        endif
                    elseif "Shadow Aspect Spellbook" = 1
                        if "shadow" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Shadow"
                            getlabel backpack ping
                        endif
                    elseif "Void Aspect Spellbook" = 1
                        if "void" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Void"
                            getlabel backpack ping
                        endif
                    elseif "Water Aspect Spellbook" = 1
                        if "water" in bookdesc
                            removetimer bookaspectspam
                        else 
                            say "[AspectSpellbook Water"
                            getlabel backpack ping
                        endif
                    endif
                endif
                if insysmsg "You have worn out your tool"
                    overhead "This tool is worn out!" 805
                    while gumpexists 736038070
                        gumpresponse 4
                        waitforgump 736038070 1000
                        if insysmsg "You attempt to pick the lock"
                            clearsysmsg
                            break
                        endif
                        if insysmsg "It appears to be unlocked"
                            clearsysmsg
                            break
                        endif
                    endwhile
                endif
                if insysmsg "You make some progress on the lock"
                    overhead "*click*" 810 bchest
                endif
                if insysmsg "You successfully pick the lock"
                    overhead "*pop*" 2091 bchest
                    break
                endif 
            endwhile
        endif
        while findtype "chain link|37477|29368|18660|20099|31303|31165|tribal ruins|electric ankh|54230|44985|glass display|20049|Pig Iron|broken shield|blackrock fragment|gargish fragment|11753|18705|55247|49482|53694|54570|53696|53876|50612|55420|53280|53473|54831|50278|49528|bottle set|entrail bucket|mounted stalaghorn|sea glass bulb|juggling daggers|st patricks cross|divination orb|mirror display|murder of crows|charmed cobra|prodigy fiddle|wilting rose belljar|scale of balance|screaming mandrake|statue of the siren|the final hour|55204|specimen jars|shattered weapon|bird cage|widows grief|54684|27612|49223|54591|54601|54718|7408|19948|58325|19959|19822|49730|49729|19944|19949|47613|47612|47611|47610|47611|3986|3966|cathedral tapestry|Darkscale tapestry|large painting|landscape painting|portrait painting|figurine|statue|20291|44987|49730|47107|18653|45127|20103|47103|29363|47105|29361|43453|5899|47109|45250|41509|43447|18657|4025|51308|45156|51304|45214|28769|28799|28803|28765|45211|45248|51259|45220|51328|45218|3842|51327|45222|45241|51336|11858|51375|45282|54722|45255|45246|28795|44983|45235|45251|45238|51258|51314|28761|45236|51260|54718|18400|58325|45252|18656|47111|3839|45239|45242|45254|45281|45247|42241|45216|28775|2594|51321|3838|51318|5901|5905|45259|5903|48407|51302|4248|27611|15296|43166|5359|5981|4026|3985|25359|17686|3836|17087|5356|29030|24434|22336|29036|3843|29025|51098|29034|8826|51094|576|3827|22326|45315|3891|2539|39898|39896|39892|39918|39911|39916|39897|39905|39891|39917|39912|39909|39889|31047|31017|31049|31019|31055|31051|31053|31025|31027|31031|31041|54717|31021|31011|31023|31029|31043|31003|31035|31033|31045|31037|31002|20006|31169|31006|30999|31012|31009|30996|7109|7107|31128|31188|20014|31014|31004|31142|31001|31000|37181|31010|30998|31172|30988|30997|31038|31141|20008|31005|31191|31008|31007|30994|30993|31182|30989|20012|31186|31178|31015|30991|20010|20016|31184|31190|30990|30995|31176|31180|30992|31130|5207|7031|7026|7034|7033|7027|7035|7029|5078|5063|5059|5105|5060|5138|5129|5201|5142|5143|5076|5106|7610|5139|5090|5103|5132|7177|5061|7181|7179|3920|5042|5127|5117|5185|5125|3938|5177|3937|5044|5121|3915|3909|3568|3932|5123|5144|5119|5056|5135|5187|5074|5089|3934|3913|3917|3721|5075|5046|5049|7170|5146|5205|5203|5115|5204|5040|5179|5070|5182|5085|5181|3719|7173|5131|3911|5101|7175|7169|3713|5112|22187|9917|3859|3862|3878|3865|3856|3873|3877|3834|3742|3762|3740|3763|10245|3572|3573|3571|3885|7127|4225|12686|19985|19981|19984|19982|19983|19991|19989|19986|19987|19988|19994|19995|19992|19993|19990|19980|19977|19976|19978|7154|19979|43423|7154|4225|7127|3861|24343" "newchest" as bitem
            if not timerexists bchestopen
                createtimer bchestopen
                overhead "The treasure is mine!" 2091
            endif
            hotkey 'Grab Item' 
            target bitem
            while queued
                //donothing
            endwhile
            if not timerexists fullchaincheck and varexist "enabledlinkdump" and findtype "chain link" backpack as lootedlink
                clearsysmsg 
                dclick "linkdumpchain"
                waitforgump 2785326818 500
                gumpresponse 31
                waitforgump 2785326818 500
                gumpresponse 31
                waitforgump 2785326818 500
                gumpclose 2785326818
                if insysmsg "You install 1 link into"
                    overhead "Link added to Dump Chain" 88
                elseif insysmsg "You do not have any slots available to install"
                    overhead "Warning!" 38
                    overhead "Dump Chain Full!" 38
                    createtimer fullchaincheck
                endif
            endif
            if insysmsg "That container cannot hold more weight"
                if findtype "gold coin" backpack as goldcoinz
                    drop backpack
                    lift goldcoinz 60000
                    drop bchest -1 -1 0
                    while queued
                        //donothing
                    endwhile
                    if not timerexists gategold
                        createtimer gategold
                    endif
                else
                    break
                endif
            endif
        endwhile
        while findtype 7981|7982|7983|7984|7985|7986|7987|7988|7989|7990|7991|7992|7993|7994|7995|7996|7997|7998|7999|8000|8001|8002|8003|8004|8005|8006|8007|8008|8009|8010|8011|8012|8013|8014|8015|8016|8017|8018|8019|8020|8021|8022|8023|8024|8025|8026|8027|8028|8029|8031|8032|8033|8034|8035|8036|8037|8038|8039|8041|8042|8043|8044|3962|3963|3972|3973|3974|3976|3980|3981|3617|7163|3903 "newchest" as supplyitems
            hotkey 'Grab Item' 
            target supplyitems
            while queued
                //donothing
            endwhile
            for 10
                if findtype "quiver" self as bapquiver
                    getlabel bapquiver desc
                    if "blessed" in desc
                        @ignore bapquiver
                    else 
                        break
                    endif
                endif
            endfor
            if findtype "quiver" self as bapquiver
                menu bapquiver 0
            endif
            for 10
                if findtype "reagent satchel" self as bapregsatch
                    getlabel bapregsatch desc
                    if "blessed" in desc
                        @ignore bapregsatch
                    else 
                        break
                    endif
                endif
            endfor
            if findtype "reagent satchel" self as bapregsatch
                menu bapregsatch 0
            endif
            if insysmsg "That container cannot hold more weight"
                if findtype "gold coin" backpack as goldcoinz
                    drop backpack
                    lift goldcoinz 60000
                    drop bchest -1 -1 0
                    while queued
                        //donothing
                    endwhile
                    if not timerexists gategold
                        createtimer gategold
                    endif
                elseif findtype 3903|7163 backpack as heavyarrows
                    drop backpack
                    lift heavyarrows 60000
                    drop 0
                    while queued
                        //donothing
                    endwhile
                elseif findtype 3903|7163 "newchest" as heavyarrows
                    drop backpack
                    lift heavyarrows 60000
                    drop 0
                    while queued
                        //donothing
                    endwhile
                else
                    break
                endif
            endif
        endwhile
        while findtype "gold coin" "newchest" as goldcoinz
            clearsysmsg 
            hotkey 'Grab Item' 
            target goldcoinz
            while queued
                //donothing
            endwhile
            getlabel backpack ping
            if insysmsg "That container cannot hold more weight"
                for 15
                    if findtype "gold coin" "newchest" as grabsome
                        drop backpack
                        lift grabsome 1444
                        drop backpack -1 -1 0
                    else
                        break
                    endif
                    while queued
                        //donothing
                    endwhile
                    getlabel backpack ping
                    if diffweight <= 0
                        break
                    endif
                endfor
                while diffweight <= 2 and findtype "gold coin" backpack as overmaxgold
                    drop backpack
                    lift overmaxgold 444
                    drop "newchest" -1 -1 0
                    while queued
                        //donothing
                    endwhile
                endwhile    
                if findtype "gold coin" "newchest" as firstdrop
                    drop backpack
                    lift firstdrop 60000
                    drop "newchest" -1 -1 0
                endif
                while queued 
                    //donothing
                endwhile
                if findtype "gold coin" "newchest" as seconddrop
                    drop backpack
                    lift seconddrop 60000
                    drop "newchest" -1 -1 0
                    while queued 
                        //donothing
                    endwhile
                endif
                if not timerexists gategold
                    createtimer gategold
                endif
                break
            endif
        endwhile
        if not timerexists gategold and findtype "gold coin" bchest
            createtimer gategold
        endif
        while mana <= 39 and timerexists gategold
            if not findbuff "Activly Meditating"
                skill "Meditation"
                getlabel backpack ping
            endif
        endwhile
        while timerexists gategold and findtype "gold coin" bchest as heavygold
            if mana >= 40 and not findtype 3948 ground 0 -1 2
                clearsysmsg 
                if "House" = 1
                    say "[gate House"
                elseif "Inn" = 1
                    say "[gate Inn"
                endif
            endif
            getlabel backpack ping
            if insysmsg "Players may only travel to or from a waypost"
                removetimer gategold
                warmode off
                overhead "I am within a Faction Zone" 45
                overhead "Auto-Gate terminated" 45
                if diffweight >= 0 and findtype "gold coin" backpack as failgategold
                    drop backpack
                    lift failgategold
                    drop "newchest" -1 -1 0
                    while queued
                        //donothing
                    endwhile
                endif
                if varexist "TwoChain"
                    getlabel "TrapChain" chaindesc
                    if "active" in chaindesc
                        //donothing
                    else 
                        menu "TrapChain" 0
                        getlabel backpack ping
                        overhead "Trap Chain Activated" 2669
                        overhead "Trap Chain Activated" 2669 "TrapChain"
                        cooldown "Chain Swap" 30000
                    endif
                endif
                if not cooldown "Aspect Book" and not cooldown "Aspect Proc" and findlayer self righthand as bookinhand
                    getlabel bookinhand righthanddesc
                    if "Combat Air Aspect Spellbook" = 1
                        if "air" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Air"
                            getlabel backpack ping
                        endif
                    elseif "Combat Arcane Aspect Spellbook" = 1
                        if "arcane" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Arcane"
                            getlabel backpack ping
                        endif
                    elseif "Combat Artisan Aspect Spellbook" = 1
                        if "artisan" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Artisan"
                            getlabel backpack ping
                        endif
                    elseif "Combat Blood Aspect Spellbook" = 1
                        if "blood" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Blood"
                            getlabel backpack ping
                        endif
                    elseif "Combat Command Aspect Spellbook" = 1
                        if "command" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Command"
                            getlabel backpack ping
                        endif
                    elseif "Combat Death Aspect Spellbook" = 1
                        if "death" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Death"
                            getlabel backpack ping
                        endif
                    elseif "Combat Discipline Aspect Spellbook" = 1
                        if "discipline" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Discipline"
                            getlabel backpack ping
                        endif
                    elseif "Combat Earth Aspect Spellbook" = 1
                        if "earth" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Earth"
                            getlabel backpack ping
                        endif
                    elseif "Combat Eldritch Aspect Spellbook" = 1
                        if "eldritch" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Eldritch"
                            getlabel backpack ping
                        endif
                    elseif "Combat Fire Aspect Spellbook" = 1
                        if "fire" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Fire"
                            getlabel backpack ping
                        endif
                    elseif "Combat Fortune Aspect Spellbook" = 1
                        if "fortune" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Fortune"
                            getlabel backpack ping
                        endif
                    elseif "Combat Frost Aspect Spellbook" = 1
                        if "frost" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Frost"
                            getlabel backpack ping
                        endif
                    elseif "Combat Gadget Aspect Spellbook" = 1
                        if "gadget" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Gadget"
                            getlabel backpack ping
                        endif
                    elseif "Combat Harvest Aspect Spellbook" = 1
                        if "harvest" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Harvest"
                            getlabel backpack ping
                        endif
                    elseif "Combat Holy Aspect Spellbook" = 1
                        if "holy" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Holy"
                            getlabel backpack ping
                        endif
                    elseif "Combat Lightning Aspect Spellbook" = 1
                        if "lightning" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Lightning"
                            getlabel backpack ping
                        endif
                    elseif "Combat Lyric Aspect Spellbook" = 1
                        if "lyric" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Lyric"
                            getlabel backpack ping
                        endif
                    elseif "Combat Madness Aspect Spellbook" = 1
                        if "madness" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Madness"
                            getlabel backpack ping
                        endif
                    elseif "Combat Poison Aspect Spellbook" = 1
                        if "poison" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Poison"
                            getlabel backpack ping
                        endif
                    elseif "Combat Shadow Aspect Spellbook" = 1
                        if "shadow" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Shadow"
                            getlabel backpack ping
                        endif
                    elseif "Combat Void Aspect Spellbook" = 1
                        if "void" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Void"
                            getlabel backpack ping
                        endif
                    elseif "Combat Water Aspect Spellbook" = 1
                        if "water" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Water"
                            getlabel backpack ping
                        endif
                    endif
                endif
                say "[AspectArmor Gadget"
                overhead "Time to move on..." 88
                stop
            elseif insysmsg "Magical travel is not allowed in this location"
                removetimer gategold
                warmode off
                overhead "I can not open a gate here" 45
                overhead "Auto-Gate terminated" 45
                if diffweight >= 0 and findtype "gold coin" backpack as failgategold
                    drop backpack
                    lift failgategold
                    drop "newchest" -1 -1 0
                    while queued
                        //donothing
                    endwhile
                endif
                if varexist "TwoChain"
                    getlabel "TrapChain" chaindesc
                    if "active" in chaindesc
                        //donothing
                    else 
                        menu "TrapChain" 0
                        getlabel backpack ping
                        overhead "Trap Chain Activated" 2669
                        overhead "Trap Chain Activated" 2669 "TrapChain"
                        cooldown "Chain Swap" 30000
                    endif
                endif
                if not cooldown "Aspect Book" and not cooldown "Aspect Proc" and findlayer self righthand as bookinhand
                    getlabel bookinhand righthanddesc
                    if "Combat Air Aspect Spellbook" = 1
                        if "air" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Air"
                            getlabel backpack ping
                        endif
                    elseif "Combat Arcane Aspect Spellbook" = 1
                        if "arcane" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Arcane"
                            getlabel backpack ping
                        endif
                    elseif "Combat Artisan Aspect Spellbook" = 1
                        if "artisan" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Artisan"
                            getlabel backpack ping
                        endif
                    elseif "Combat Blood Aspect Spellbook" = 1
                        if "blood" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Blood"
                            getlabel backpack ping
                        endif
                    elseif "Combat Command Aspect Spellbook" = 1
                        if "command" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Command"
                            getlabel backpack ping
                        endif
                    elseif "Combat Death Aspect Spellbook" = 1
                        if "death" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Death"
                            getlabel backpack ping
                        endif
                    elseif "Combat Discipline Aspect Spellbook" = 1
                        if "discipline" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Discipline"
                            getlabel backpack ping
                        endif
                    elseif "Combat Earth Aspect Spellbook" = 1
                        if "earth" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Earth"
                            getlabel backpack ping
                        endif
                    elseif "Combat Eldritch Aspect Spellbook" = 1
                        if "eldritch" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Eldritch"
                            getlabel backpack ping
                        endif
                    elseif "Combat Fire Aspect Spellbook" = 1
                        if "fire" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Fire"
                            getlabel backpack ping
                        endif
                    elseif "Combat Fortune Aspect Spellbook" = 1
                        if "fortune" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Fortune"
                            getlabel backpack ping
                        endif
                    elseif "Combat Frost Aspect Spellbook" = 1
                        if "frost" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Frost"
                            getlabel backpack ping
                        endif
                    elseif "Combat Gadget Aspect Spellbook" = 1
                        if "gadget" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Gadget"
                            getlabel backpack ping
                        endif
                    elseif "Combat Harvest Aspect Spellbook" = 1
                        if "harvest" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Harvest"
                            getlabel backpack ping
                        endif
                    elseif "Combat Holy Aspect Spellbook" = 1
                        if "holy" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Holy"
                            getlabel backpack ping
                        endif
                    elseif "Combat Lightning Aspect Spellbook" = 1
                        if "lightning" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Lightning"
                            getlabel backpack ping
                        endif
                    elseif "Combat Lyric Aspect Spellbook" = 1
                        if "lyric" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Lyric"
                            getlabel backpack ping
                        endif
                    elseif "Combat Madness Aspect Spellbook" = 1
                        if "madness" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Madness"
                            getlabel backpack ping
                        endif
                    elseif "Combat Poison Aspect Spellbook" = 1
                        if "poison" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Poison"
                            getlabel backpack ping
                        endif
                    elseif "Combat Shadow Aspect Spellbook" = 1
                        if "shadow" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Shadow"
                            getlabel backpack ping
                        endif
                    elseif "Combat Void Aspect Spellbook" = 1
                        if "void" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Void"
                            getlabel backpack ping
                        endif
                    elseif "Combat Water Aspect Spellbook" = 1
                        if "water" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Water"
                            getlabel backpack ping
                        endif
                    endif
                endif
                say "[AspectArmor Gadget"
                overhead "Time to move on..." 88
                stop
            else
                drop backpack
                lift heavygold 60000
                while casting 
                    //donothing
                endwhile
                getlabel backpack ping
                pause 350
                if "House" = 1 and findtype "gold coin" bchest
                    createtimer gobackformoregold
                else 
                    if timerexists gobackformoregold
                        removetimer gobackformoregold
                    endif
                endif
                if "Inn" = 1
                    getlabel bchest Innitemdesc
                    if "0 items, 0 stones" in Innitemdesc
                        warmode off
                        menu bchest 1
                    else 
                        overhead "I left some gold in the chest!" 45
                        overhead "I should go back!" 45
                    endif
                endif
                if findtype 3948 ground 0 -1 2 as bluegate
                    dclick bluegate
                    waitforgump 3899019871 1600
                    gumpresponse 2
                    getlabel backpack ping
                    pause 350
                endif
                if "Inn" = 1
                    say 'Room' 88
                    waitforgump 2393832411 500
                    if ingump "Enter Your Room" 2393832411
                        gumpresponse 4
                    elseif ingump "Rent This Room" 2393832411
                        gumpresponse 5
                        waitforgump 2393832411 500
                        gumpresponse 100
                    endif
                    pause 350
                endif
                if findtype "bank deposit safe" ground -1 -1 2 as bankdepot
                    drop bankdepot -1 -1 0
                    while queued
                        //donothing
                    endwhile
                    getlabel backpack ping
                    if findtype "gold coin" backpack
                        menu bankdepot 0
                    endif
                else 
                    drop 0
                    while queued
                        //donothing
                    endwhile
                    getlabel backpack ping
                    while findtype "gold coin" backpack as goldremaining
                        drop backpack
                        lift goldremaining 60000
                        drop 0
                        while queued
                            //donothing
                        endwhile
                    endwhile
                endif
                if "Inn" = 1 
                    if varexist "TwoChain"
                        getlabel "TrapChain" chaindesc
                        if "active" in chaindesc
                            //donothing
                        else 
                            menu "TrapChain" 0
                            getlabel backpack ping
                            overhead "Trap Chain Activated" 2669
                            overhead "Trap Chain Activated" 2669 "TrapChain"
                            cooldown "Chain Swap" 30000
                        endif
                    endif
                    if findlayer self innertorso as chestarmor
                        getlabel chestarmor desc
                        if "gadget" in desc
                            if timerexists gobackformoregold
                                removetimer gobackformoregold
                            endif
                            if timerexists gategold
                                removetimer gategold
                            endif
                        else
                            if not cooldown "Aspect Armor" and not cooldown "Aspect Proc"
                                clearsysmsg
                                say "[AspectArmor Gadget"
                                getlabel backpack ping
                            endif
                        endif
                        if not cooldown "Aspect Book" and not cooldown "Aspect Proc" and findlayer self righthand as bookinhand
                            getlabel bookinhand righthanddesc
                            if "Combat Air Aspect Spellbook" = 1
                                if "air" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Air"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Arcane Aspect Spellbook" = 1
                                if "arcane" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Arcane"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Artisan Aspect Spellbook" = 1
                                if "artisan" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Artisan"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Blood Aspect Spellbook" = 1
                                if "blood" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Blood"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Command Aspect Spellbook" = 1
                                if "command" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Command"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Death Aspect Spellbook" = 1
                                if "death" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Death"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Discipline Aspect Spellbook" = 1
                                if "discipline" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Discipline"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Earth Aspect Spellbook" = 1
                                if "earth" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Earth"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Eldritch Aspect Spellbook" = 1
                                if "eldritch" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Eldritch"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Fire Aspect Spellbook" = 1
                                if "fire" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Fire"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Fortune Aspect Spellbook" = 1
                                if "fortune" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Fortune"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Frost Aspect Spellbook" = 1
                                if "frost" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Frost"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Gadget Aspect Spellbook" = 1
                                if "gadget" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Gadget"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Harvest Aspect Spellbook" = 1
                                if "harvest" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Harvest"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Holy Aspect Spellbook" = 1
                                if "holy" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Holy"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Lightning Aspect Spellbook" = 1
                                if "lightning" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Lightning"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Lyric Aspect Spellbook" = 1
                                if "lyric" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Lyric"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Madness Aspect Spellbook" = 1
                                if "madness" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Madness"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Poison Aspect Spellbook" = 1
                                if "poison" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Poison"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Shadow Aspect Spellbook" = 1
                                if "shadow" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Shadow"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Void Aspect Spellbook" = 1
                                if "void" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Void"
                                    getlabel backpack ping
                                endif
                            elseif "Combat Water Aspect Spellbook" = 1
                                if "water" in righthanddesc
                                    //donothing
                                else 
                                    say "[AspectSpellbook Water"
                                    getlabel backpack ping
                                endif
                            endif
                        endif
                    endif
                    if timerexists gobackformoregold
                        removetimer gobackformoregold
                    endif
                    if timerexists gategold
                        removetimer gategold
                    endif
                    if timerexists dugchest and not findtype "map" backpack
                        removetimer dugchest
                    endif
                    warmode on
                    getlabel backpack ping
                    script "Bapeths One Tile Item Dump & Restock"
                    overhead "Time to move on..." 88
                    warmode off
                    stop
                endif
                if "House" = 1 and timerexists gobackformoregold
                    if findtype 3948 ground 0 -1 2 as bluegate
                        dclick bluegate
                        waitforgump 3899019871 1600
                        gumpresponse 2
                        getlabel backpack ping
                        pause 350
                    endif
                    dclick bchest 
                    while queued
                        //donothing
                    endwhile
                    getlabel backpack ping
                endif
            endif
        endwhile
    endif
    if findtype 3948 ground 0 -1 2 as bluegate
        dclick bluegate
        waitforgump 3899019871 1600
        gumpresponse 2
        getlabel backpack ping
        pause 350
    endif
    if findtype "wooden chest|metal chest" ground -1 -1 1 as bchest
        @setvar! "newchest" bchest
        getlabel "newchest" itemdesc
        if "0 items, 0 stones" in itemdesc
            warmode off
            menu "newchest" 1
            if varexist "TwoChain"
                getlabel "TrapChain" chaindesc
                if "active" in chaindesc
                    //donothing
                else 
                    menu "TrapChain" 0
                    getlabel backpack ping
                    overhead "Trap Chain Activated" 2669
                    overhead "Trap Chain Activated" 2669 "TrapChain"
                    cooldown "Chain Swap" 30000
                endif
            endif
            if findlayer self innertorso as chestarmor
                getlabel chestarmor desc
                if "gadget" in desc
                    if timerexists gobackformoregold
                        removetimer gobackformoregold
                    endif
                    if timerexists gategold
                        removetimer gategold
                    endif
                else
                    if not cooldown "Aspect Armor" and not cooldown "Aspect Proc"
                        clearsysmsg
                        say "[AspectArmor Gadget"
                        getlabel backpack ping
                    endif
                endif
                if not cooldown "Aspect Book" and not cooldown "Aspect Proc" and findlayer self righthand as bookinhand
                    getlabel bookinhand righthanddesc
                    if "Combat Air Aspect Spellbook" = 1
                        if "air" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Air"
                            getlabel backpack ping
                        endif
                    elseif "Combat Arcane Aspect Spellbook" = 1
                        if "arcane" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Arcane"
                            getlabel backpack ping
                        endif
                    elseif "Combat Artisan Aspect Spellbook" = 1
                        if "artisan" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Artisan"
                            getlabel backpack ping
                        endif
                    elseif "Combat Blood Aspect Spellbook" = 1
                        if "blood" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Blood"
                            getlabel backpack ping
                        endif
                    elseif "Combat Command Aspect Spellbook" = 1
                        if "command" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Command"
                            getlabel backpack ping
                        endif
                    elseif "Combat Death Aspect Spellbook" = 1
                        if "death" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Death"
                            getlabel backpack ping
                        endif
                    elseif "Combat Discipline Aspect Spellbook" = 1
                        if "discipline" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Discipline"
                            getlabel backpack ping
                        endif
                    elseif "Combat Earth Aspect Spellbook" = 1
                        if "earth" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Earth"
                            getlabel backpack ping
                        endif
                    elseif "Combat Eldritch Aspect Spellbook" = 1
                        if "eldritch" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Eldritch"
                            getlabel backpack ping
                        endif
                    elseif "Combat Fire Aspect Spellbook" = 1
                        if "fire" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Fire"
                            getlabel backpack ping
                        endif
                    elseif "Combat Fortune Aspect Spellbook" = 1
                        if "fortune" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Fortune"
                            getlabel backpack ping
                        endif
                    elseif "Combat Frost Aspect Spellbook" = 1
                        if "frost" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Frost"
                            getlabel backpack ping
                        endif
                    elseif "Combat Gadget Aspect Spellbook" = 1
                        if "gadget" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Gadget"
                            getlabel backpack ping
                        endif
                    elseif "Combat Harvest Aspect Spellbook" = 1
                        if "harvest" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Harvest"
                            getlabel backpack ping
                        endif
                    elseif "Combat Holy Aspect Spellbook" = 1
                        if "holy" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Holy"
                            getlabel backpack ping
                        endif
                    elseif "Combat Lightning Aspect Spellbook" = 1
                        if "lightning" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Lightning"
                            getlabel backpack ping
                        endif
                    elseif "Combat Lyric Aspect Spellbook" = 1
                        if "lyric" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Lyric"
                            getlabel backpack ping
                        endif
                    elseif "Combat Madness Aspect Spellbook" = 1
                        if "madness" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Madness"
                            getlabel backpack ping
                        endif
                    elseif "Combat Poison Aspect Spellbook" = 1
                        if "poison" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Poison"
                            getlabel backpack ping
                        endif
                    elseif "Combat Shadow Aspect Spellbook" = 1
                        if "shadow" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Shadow"
                            getlabel backpack ping
                        endif
                    elseif "Combat Void Aspect Spellbook" = 1
                        if "void" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Void"
                            getlabel backpack ping
                        endif
                    elseif "Combat Water Aspect Spellbook" = 1
                        if "water" in righthanddesc
                            //donothing
                        else 
                            say "[AspectSpellbook Water"
                            getlabel backpack ping
                        endif
                    endif
                endif
            endif
            if timerexists gobackformoregold
                removetimer gobackformoregold
            endif
            if timerexists gategold
                removetimer gategold
            endif
            if timerexists dugchest and not findtype "map" backpack
                removetimer dugchest
            endif
            if skill "Spirit Speak" >= 80 and followers >= 1
                skill "spiritspeak"
            endif
            if followers >= 1
                pause 400
                say "All Follow Me" 45
            endif
            overhead "Time to move on..." 88
            script "Bapeths One Tile Item Dump & Restock"
            stop
        endif
    endif
endif
loop