# This is an automated backup - check out https://outlands.uorazorscripts.com/script/5ca89fcd-a03c-410e-9e2c-075284071f56 for latest
# Automation by Jaseowns
## Script: DANSTOCK'S ULTIMATE HARVESTING AUTO PILOT SCRIPT
## Created by: danstock._98439#0
#############################################

/////// DANSTOCK'S ULTIMATE HARVESTING AUTO PILOT SCRIPT
/////   UO Outlands Razor script - Last updated Oct 10, 2024 (email any bug reports/tips to dan@danstockman.com) 
///     Created by DanStock.
//      Inspired by many scripts found on https://outlands.uorazorscripts.com/

##########################################################################################################
####    PLEASE READ SCRIPT DETAILS BELOW FOR IMPORTANT COOLDOWN, FILTER AND VARIABLE INSTRUCTIONS!    ####
####             Most features are turned OFF by default and can be enabled below!!                   ####
##########################################################################################################

# Required (or optional *) inventory items:

    # Hatchet or Pickaxe
    # A blessed escape runebook (charged w/ recall scrolls if no Magery skill)
    # Trapped pouches 
    # Healing, Cure and Refresh potions
    # Skinning knife *
    # Bandages * 
    # Adventurers rope *
    # Tool Kit *
    # Potion Satchel *
    # Wizard's Satchel *
    # Harvest Aspected weapon of choice (Swords, Macing or Spellbook) *
    # Harvest Aspect armour of choice *

# IMPT: Please add the following COOLDOWNS (case sensitive) in UO client under Options -> Cooldowns:

    // Healing Potion
    // Cure Potion
    // Refresh Potion
    // Travel
    // Target Timer
    // Move Timer
    // Weight Timer
    // Inventory Timer
    // Satchel Timer
    // Forge Radar
    // Ore Radar
    // Gold Radar
    // Ore Vacuum
    // Gold Vacuum
    // ExplosionCD
    // EnergyBoltCD
    // LightningCD
    // MagicArrowCD
    // HarmCD
    // FireballCD
    // FlamestrikeCD
    // Spirit Speak
    // Magic Shield
    // Spell Fail  (w/ overhead text trigger of "The spell fizzles" and a 2 second cooldown)

# Use the following organizer agents (or swap for your own):

    # Organizer Agent-01 hotbag   (for boards, logs, seeds, etc.)
    # Organizer Agent-02 hotbag   (for main LUMBER inventory items)
    # Organizer Agent-03 hotbag   (for ingots, seeds, etc.)
    # Organizer Agent-04 hotbag   (for main MINING inventory items)

    # Organizer Agent-05 hotbag * (optional - for unloading at HOME or INN ROOM - Turn on EnableOrganizerAgents below)
    // See Shared Variables section below to turn on or off the use of Resource Stockpile, Storage Shelf, Bank Safe and Magic Item Recycler in lieu of Organizer Agent-05!

    // Use the following optional agents to unload non-stockpile or shelf items (Turn on EnableTreasureChest below):
    # Organizer Agent-06 hotbag * (optional - I use for unloading Tmaps, SS, orbs, RM, etc.)
    # Organizer Agent-07 hotbag * (optional - I use for unloading Runes)
    # Organizer Agent-08 hotbag * (optional - I use for unloading Black Goods, etc.)
    # Organizer Agent-09 hotbag * (optional - I use for unloading seeds, soil, grain, etc.)

# System messages to text filter in Razor for clean UI:

    // "What do you want to use this item on?" 
    // "You do not see any harvestable resources nearby"
    // "You cannot produce any wood from that"
    // "You hack at the tree"
    // "You chop some"
    // "You dig some"
    // "You loosen some"
    // "You smelt the ore"
    // "You must wait"
    // "You shape the logs into boards"
    // "You do not see any nearby forges"
    // "Mining skillgain"
    // "Lumberjacking skillgain"
    // "No one matching that"
    // "You will now hunt"
    // "Organize Agent"
    // "queue"
    // "Macro"
    // "Achievement"
    // "You have worn out your tool"
    // "You carve materials from the corpse"
    // "Target item to grab"

    ############################################################################################################################
    ##### YOU CAN ENABLE AND/OR DISABLE EACH HALF OF THE SCRIPT HERE (if using both harvest skills on the same character): #####
    ############################################################################################################################

@setvar! EnableMining 1
@setvar! EnableLumberjacking 1 

    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////// ANYTIME YOU NEED TO RESET OR CHANGE PERMANENT VARIABLES (ie. ESCAPE RUNEBOOK, TREASURE CHEST, INGOT AND BOARD BAGS): ////// 
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    # Run script once with this ALLVARIABLERESET set to 1 to clear ALL variables. 
    # Then reset ALLVARIABLERESET back to 0 and restart script to prompt for new targets!

@setvar! ALLVARIABLERESET 0

    if ALLVARIABLERESET = 1
        unsetvar lumber_runebook
        unsetvar boardbag
        unsetvar mining_runebook
        unsetvar ingotbag
        unsetvar TreasureChest
        overhead "All permanent script variables reset!" 0
        wait 500
        sysmsg "Restart script to prompt for new targets..." 0
        sysmsg "Make sure to set ALLVARIABLERESET back to 0" 84
        overhead "[ STOPPING SCRIPT! ]" 337
        stop    
    endif 

    #################################################
    //         Mining Specific Variables:          //
    #################################################

    if skill "Mining" >= 50 and EnableMining = 1

@setvar! EnableOreVacuum 1
@setvar! EnablePlayerForgeRadar 1
@setvar! EnableAutoSmeltPlayerForge 1
@setvar! EnableAutoSmeltNaturalForge 1

@setvar! EnableIngotAutoRecall 1
@setvar! IngotRecallAmount 3000

@setvar! EnableIngotBag 0
@setvar! OpenIngotBag 0

@setvar! EnableWeightWarningMessage 1
@setvar! GreenWarningWeight 400
@setvar! YellowWarningWeight 430
@setvar! RedWeightLimit 445

    endif

    #################################################
    //         Lumber Specific Variables:          //
    #################################################

    if skill "Lumberjacking" >= 50 and EnableLumberjacking = 1

@setvar! LogsToBoards 1

@setvar! EnableBoardAutoRecall 1
@setvar! BoardRecallAmount 3000

@setvar! EnableBoardBag 0
@setvar! OpenBoardBag 0

@setvar! EnableWeightWarningMessage 1
@setvar! GreenWarningWeight 400
@setvar! YellowWarningWeight 430
@setvar! RedWeightLimit 449

    endif

    ########################################
    //     Magery Specific Variables:     //
    ########################################
    
    if skill "Magery" >= 50

    # Defensive:
@setvar! EnableCastRecall 0
@setvar! EnableMagicReflection 0
@setvar! EnableReactiveArmour 0
@setvar! EnableProtection 0
@setvar! EnableCastHeal 0
@setvar! EnableCastCure 0
@setvar! CastHealHPlowdiff 5
@setvar! CastHealHPmeddiff 25
@setvar! CastHealHPhighdiff 50

    # Offensive:
@setvar! EnableCastExplosion 0
@setvar! EnableCastEnergyBolt 0
@setvar! EnableCastLightning 0
@setvar! EnableCastMagicArrow 0
@setvar! EnableCastHarm 0
@setvar! EnableCastFireball 0
@setvar! EnableCastFlamestrike 0

    # Summons:
@setvar! EnableSummons 0
@setvar! NameSummonedPets 0
@setvar! TotalSummonCount 0

    // Number of summoned pets (0, 1 or 2 each - up to 4 total):
@setvar! SummonFireElemental 0
@setvar! SummonEarthElemental 0
@setvar! SummonAirElemental 0
@setvar! SummonWaterElemental 0
@setvar! SummonDemon 0

    // Add pet names to list below (must be unique):
        if NameSummonedPets = 1
            if not listexists petNameList
                createlist petNameList
            endif

            if list petNameList = 0
                pushlist petNameList "PetnameHere1"
                pushlist petNameList "PetnameHere2"
                pushlist petNameList "PetnameHere3"
                pushlist petNameList "PetnameHere4"
                pushlist petNameList "PetnameHere5"
                pushlist petNameList "PetnameHere6"
                pushlist petNameList "PetnameHere7"
                pushlist petNameList "PetnameHere8"
                pushlist petNameList "PetnameHere9"
                pushlist petNameList "PetnameHere10"
            endif
        else
            clearlist petNameList
        endif 
        
    endif

    ########################################
    //         Shared Variables           //
    ########################################

@setvar! EnableRedAlertRecall 1
@setvar! EnableParalyzePouch 1

@setvar! EnableHealPotion 1
@setvar! HealPotHP 40

@setvar! EnableCurePotion 1
@setvar! CurePotHP 85

@setvar! EnableRefreshPotion 1
@setvar! RefreshPotSPdiff 11

@setvar! AllInventoryMessage 1
    // or
@setvar! YellowInventoryMessage 1
@setvar! OrangeInventoryMessage 1
@setvar! RedInventoryMessage 1
@setvar! WhiteInventoryMessage 0
@setvar! BlueInventoryMessage 0
@setvar! BlackInventoryMessage 0
@setvar! RopeInventoryMessage 0

@setvar! EnableAutoAttackGreyMOB 0
@setvar! EnableAutoCarving 0
@setvar! EnableGoldVacuum 0
@setvar! EnableCheeseTimer 0
@setvar! EnableToolCountdown 0
@setvar! EnableRecycleTool 0
@setvar! EnableSatchels 0
@setvar! EnableWeaponWarning 0

    // Choose only one (or none):
@setvar! OwnerInnRecall 0 
@setvar! CoOwnerInnRecall 0
@setvar! HouseRecall 0

    # Use ">info" to ID your own house door:
@setvar! MyDoor 0x50F70A17
@setvar! HideAtHomeorInn 0

    # Script can use Razor Organizer Agents to organize or you can use Resource Stockpile, Storage Shelf, etc. instead:
@setvar! EnableOrganizerAgents 0
    // or
@setvar! EnableBankSafe 0
@setvar! EnableStockpile 0
@setvar! EnableStorageShelf 0
@setvar! EnableMagicRecycler 0
@setvar! EnableRepairBench 0
@setvar! EnableTreasureChest 0



    ############################################
    #########    SCRIPT STARTS HERE    #########
    ############################################

if hidden 
    overhead "[ HIDDEN... ]" 6
    sysmsg "You cannot use this script while hidden!  Please unhide and try again..." 0
    stop
endif

if EnableRedAlertRecall = 1
    if insysmsg "Now tracking" or insysmsg "Distance to destination"
        @setvar! TimeToGo 1
    endif
endif 

if insysmsg "Captcha successful"
    overhead "I guess you got the magic numbers correct??" 2086
    wait 2000
    overhead "Alright, let's get to work..." 2086
endif

if insysmsg "You have unlocked a codex upgrade point"
    overhead "[ CODEX POINT UNLOCKED! ]" 2114
endif 
 
if insysmsg "enough experience to upgrade"
    overhead "[ ASPECT TIER UNLOCKED! ]" 2086
endif 

if insysmsg "something invisible out of the way"
    overhead "[ ¼ SOMEONE HIDDEN ¼ ]" 6
endif 

if paralyzed and EnableParalyzePouch = 1
    overhead "[[[[ POP!! ]]]]" 2117
    say "[pouch" 
    @setvar! TimeToGo 1
endif

if insysmsg 'world is saving' 
    for 40
        wait 100
        if insysmsg 'world save complete' 
            overhead '[ SAVE COMPLETE! ]' 253 
            clearsysmsg            
        endif  
    endfor 
    clearsysmsg    
endif 

if EnableRedAlertRecall = 1 and TimeToGo = 1
    overhead "[[[[ RED ALERT!! ]]]]" 37
    wait 250
    overhead "Looks like trouble coming!" 2086
     
            if paralyzed 
                overhead "[[[[ POP!! ]]]]" 2117
                say "[pouch"
            endif
        
            if skill 'Healing' > 50 and not bandaging and hits < maxhits
                hotkey "Bandage self"
                overhead '* applying bandages... *' 88
            endif 
                
            if diffhits > 25 and not cooldown "Healing Potion"
                if findtype "Yellow Potion" self as healpot
                    overhead '* drinking heal potion... *' 253
                    dclick healpot
                    cooldown "Healing Potion" 10500
                else 
                    overhead '[ NO HEAL POTS! ]' 337
                endif
            endif 
            
            if poisoned and not cooldown "Cure Potion"
                if findtype "Orange Potion" self as curepot
                    overhead '* drinking cure potion... *' 44
                    dclick curepot
                    cooldown "Cure Potion" 10500
                else
                    overhead [ NO CURE POTS! ]" 337
                endif
            endif
        
            if stam < maxstam and not cooldown "Refresh Potion"
                if findtype "Red Potion" self as refreshpot
                    overhead '* drinking refresh potion... *' 34
                    dclick refreshpot
                    cooldown "Refresh Potion" 10500
                else 
                    overhead '[ NO REFRESH POTS! ]' 337
               endif
           endif

    if skill "Mining" >= 50
        if skill "Magery" >= 60 and CastRecall = 1
            cast "Recall"
            wft 2500
            target mining_runebook
                for 5
                wait 500
                if insysmsg 'Your concentration is disturbed'
                    overhead 'Shit! Trying that again...' 2086
                    cast "Recall"
                    wft 2500
                    target mining_runebook
                    clearsysmsg
                endif
                endfor
        else
            dclick mining_runebook
            waitforgump 1551740969 
            gumpresponse 2
            wait 500             
                for 5
                wait 500
                if insysmsg 'Your concentration is disturbed'
                    overhead 'Shit! Trying that again...' 2086
                    dclick mining_runebook
                    waitforgump 1551740969 
                    gumpresponse 2
                    wait 500 
                    clearsysmsg 
                endif
            endfor
         endif
    endif 

    if skill "Lumberjacking" >= 50
        if skill "Magery" >= 60 and CastRecall = 1
            cast "Recall"
            wft 2500
            target mining_runebook
                for 5
                wait 500
                if insysmsg 'Your concentration is disturbed'
                    overhead 'Shit! Trying that again...' 2086
                    cast "Recall"
                    wft 2500
                    target mining_runebook
                    clearsysmsg
                endif
            endfor       
        else
            dclick lumber_runebook
            waitforgump 1551740969 
            gumpresponse 2
            wait 500             
                for 5
                wait 500
                if insysmsg 'Your concentration is disturbed'
                    overhead 'Shit! Trying that again...' 2086
                    dclick lumber_runebook
                    waitforgump 1551740969 
                    gumpresponse 2
                    wait 500 
                    clearsysmsg 
                endif
            endfor
        endif
    endif     
    
    wait 1000
    overhead "Whew. I think we got away!" 2086
    @setvar! TimeToGo 0
    sysmsg "Auto Recall trigger condition reset!" 0

    if skill "Mace Fighting" > 50 and not findtype "sledgehammer|giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick" hand and findtype "sledgehammer|giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick" backpack as weapon
        getlabel weapon WeaponLabel
            for 5
                if "unidentified" in WeaponLabel
                    @ignore weapon
                    if not findtype "sledgehammer|giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick" hand and findtype "sledgehammer|giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick" self as weapon
                        getlabel weapon WeaponLabel
                    else
                        overhead "[ NO WEAPON! ]" 337
                        break
                    endif
                endif
            endfor
        dclick weapon      
    endif 

    if skill "Swordsmanship" > 50 and not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" hand and findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" backpack as weapon
        getlabel weapon WeaponLabel
            for 5
                if "unidentified" in WeaponLabel
                    @ignore weapon
                    if not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" hand and findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" self as weapon
                        getlabel weapon WeaponLabel
                    else
                        overhead "[ NO WEAPON! ]" 337
                        break
                    endif
                endif
            endfor
        dclick weapon      
    endif 

    if skill "Magery" >= 80 and not findtype "spellbook" hand and findtype "spellbook" backpack as myspellbook
        getlabel myspellbook SpellbookLabel
                for 5
                    wait 100
                    if "unidentified" in SpellbookLabel or "blessed" in SpellbookLabel
                        @ignore myspellbook 
                        if not findtype "spellbook" hand and findtype "spellbook" self as myspellbook
                            getlabel myspellbook SpellbookLabel
                        else 
                            overhead "[ NO SPELLBOOK! ]" 337
                            break
                        endif
                    endif 
                endfor
        dclick myspellbook
    endif 

    wait 1000

    if HouseRecall = 1
        wait 1500
        if find MyDoor ground -1 -1 2 
            dclick MyDoor 
            overhead "* door slams! *" 0 MyDoor
            wait 500
        endif
    endif 

    if OwnerInnRecall = 1
        wait 2000
        say "Innkeeper, I need a room!"
        waitforgump 2393832411
        gumpresponse 4
        wait 3000
    endif

    if CoOwnerInnRecall = 1
        wait 2000
        say "Innkeeper, I need a room!"
        waitforgump 2393832411
        gumpresponse 5
        wait 2000
        gumpresponse 100
        wait 2000
    endif

    if HideAtHomeorInn = 1
        overhead "Home Sweet Home!" 2086
        useskill "Hiding"
        wait 250
    endif

    if OpenIngotBag = 1 
        dclick ingotbag
        wait 250
    endif

    if OpenBoardBag = 1 
        dclick boardbag
        wait 250
    endif

    for 11
    if findtype "iron ore" backpack as ore
        if findtype "forge" ground -1 -1 2 as forge or findtype 0x0FB1 ground -1 -1 2 as forge
            overhead "* smelting ore... *" 2114 forge
            dclick ore
            overhead "* forging ingots... *" 2117
            wait 1000
            hotkey 'Organizer Agent-03'  
            wait 250
        endif 
    endif
    endfor     

    for 11
    if findtype 'log%s' backpack and LogsToBoards = 1 
        wait 500
        overhead '* making boards... *' 0
        dclicktype 'log%s' 
        wait 250
        hotkey 'Organizer Agent-01'
        wait 1500
    endif
    endfor   

    if EnableOrganizerAgents = 1
        if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
            overhead "* storing ingots... *" 37
            hotkey "Organizer Agent-05"
            wait 3500
            if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
                hotkey "Organizer Agent-05"
                wait 3500
            endif
            if findtype "cut up leather|iron ingot%s|board%s|feather%s|seed of renewal|shaft%s|blank scroll%s%|gold coin" backpack
                hotkey "Organizer Agent-05"
                wait 500
            endif
        endif
    endif

    if EnableBankSafe = 1
        if findtype "bank deposit safe" ground -1 -1 2 as safe
            while findtype "gold coin" self as gold
                lift gold 60000
                overhead "* depositing gold... *" 149
                drop safe -1 -1 -1
                wait 1000
            endwhile
            while findtype 2539 self as dubs
                lift dubs 60000
                drop safe -1 -1 -1
                overhead "* depositing doubloons... *" 149
                wait 1000
            endwhile
        else
            overhead "[ NO BANK SAFE FOUND ]" 337
            sysmsg "Disable 'EnableBankSafe' in script variables to turn off this feature!" 0
        endif
    endif

    if EnableStockpile = 1
        if findtype "resource container" ground -1 -1 2 as resource
            menu resource 0
            wft 500
            target self
            overhead "* unloading resources... *" 84
            wait 1000
        else
            overhead "[ NO RESOURCE STOCKPILE FOUND ]" 337
            sysmsg "Disable 'EnableStockpile' in script variables to turn off this feature!" 0
        endif
    endif

    if EnableStorageShelf = 1
        if findtype "storage shelf" ground -1 -1 2 as shelf
            menu shelf 0
            wft 500
            target self
            overhead "* restocking... *" 37
            wait 1000
            gumpclose 3232825965
        else
            overhead "[ NO STORAGE SHELF FOUND ]" 337
            sysmsg "Disable 'EnableStorageShelf' in script variables to turn off this feature!" 0
        endif       
        if findtype "storage shelf" ground -1 -1 2 as shelf
            menu shelf 1
            wft 500
            target self   
            overhead "* resupplying... *" 93
            wait 1000
        endif
    endif

    if EnableRepairBench = 1
        if findtype "repair bench" ground -1 -1 2 as RepairBench
            clearsysmsg 
            dclick RepairBench
            wait 1000
                if insysmsg "You do not have any items equipped or in your backpack in need of repairs."
                    overhead "* nothing to repair! *" 0
                else
                    settimer RepairTimer 0
                while timer RepairTimer <= 5000 
                    if insysmsg "Repair"
                        break
                    endif
                endwhile
                    overhead "* all items repaired! *" 0
                    overhead "Repair took: {{RepairTimer}}ms" 149
                    removetimer RepairTimer
                endif
        else
            overhead "[ NO REPAIR BENCH FOUND ]" 337
            sysmsg "Disable 'EnableRepairBench' in script variables to turn off this feature!" 0
        endif
    endif

    if EnableMagicRecycler = 1
        if findtype "ornate elven chest|magic item recycler" ground -1 -1 2 as recycler
            menu recycler 1
            wait 1000
                if insysmsg "0 recyclable"
                    overhead "* nothing to recycle! *" 6
                else
                    overhead "* recycling magic items... *" 6
                    wait 200
                endif
        else
            overhead "[ NO MAGIC ITEM RECYCLER FOUND ]" 337
            sysmsg "Disable 'EnableMagicRecycler' in script variables to turn off this feature!" 0
        endif
    endif

    if EnableTreasureChest = 1
        if not varexist TreasureChest
            for 5
                wait 500
                overhead "Please select a location your treasures..." 0
                setvar TreasureChest
                wait 3000
                sysmsg "Disable 'EnableTreasureChest' in script variables to turn off this feature!" 0
            endfor            
        else        
            if findtype "black market goods|seed of renewal|dirt patch|bag of seeds|void orb|rune|scroll of calling|bottle|dye bottle|map" self
                dclick TreasureChest
                overhead "* storing loot... *" 69
                wait 250
                hotkey "Organizer Agent-06"
                wait 250
                hotkey "Organizer Agent-07"
                wait 250
                hotkey "Organizer Agent-08"
                wait 250
                hotkey "Organizer Agent-09"
                wait 1000

                if findtype "black market goods|seed of renewal|dirt patch|bag of seeds|void orb|rune|scroll of calling|bottle|dye bottle|map" self
                    wait 1000
                    hotkey "Organizer Agent-06"
                    wait 250
                    hotkey "Organizer Agent-07"
                    wait 250
                    hotkey "Organizer Agent-08"
                    wait 250
                    hotkey "Organizer Agent-09"
                endif 
            endif 
        endif
    endif    
        hotkey "Organizer Agent-04"
        wait 100
        hotkey "Organizer Agent-02"
        overhead "[ STOPPING SCRIPT! ]" 337
        stop     
endif

if EnableRedAlertRecall = 1
    if skill 'Tracking' > 50 and not findbuff 'tracking'
        overhead 'I should keep an eye out for trouble...' 2086
            while not gumpexists 4267467659
                useskill 'tracking'
                wait 250
            endwhile
                if gumpexists 4267467659
                    while not insysmsg "You will now hunt all hostile players."
                        gumpresponse 8 4267467659
                        waitforgump 4267467659 5000
                    endwhile
                    gumpresponse 6 4267467659
                    wait 1000
                    clearsysmsg                     
                endif
        gumpclose 4267467659
        overhead "[ AUTO RECALL ACTIVATED! ]" 334
    endif 
endif

if skill 'Healing' > 50 
    if not bandaging and hits < maxhits
        overhead '* applying bandages... *' 88
        hotkey "Bandage Self"
    endif
    
    if counttype 'clean bandage%s%' < 5 and not cooldown "Inventory Timer"
        overhead "[ RESTOCK BANDAGES! ]" 88
        cooldown "Inventory Timer" 15000
    endif 
endif

if EnableCastHeal = 1
    if skill 'Magery' >= 40 and diffhits > CastHealHPlowdiff and diffhits < CastHealHPmeddiff and mana >= 4
        if not findtype "spellbook" hand and findtype "spellbook" backpack as myspellbook
            getlabel myspellbook SpellbookLabel
                for 5
                    wait 100
                    if "unidentified" in SpellbookLabel or "blessed" in SpellbookLabel
                        @ignore myspellbook 
                        if not findtype "spellbook" hand and findtype "spellbook" self as myspellbook
                            getlabel myspellbook SpellbookLabel
                        else 
                            overhead "[ NO SPELLBOOK! ]" 337
                            break
                        endif
                    endif 
                endfor
            dclick myspellbook
            wait 250
        endif
        cast 'Heal'
        wait 100
        while not casting                   
            if targetexists
                hotkey 'cancel current target'
            endif
                cast 'Heal'
                wait 100
        endwhile  
        wft 1500
        target 'self' 
        wait 250  

    elseif skill 'Magery' >= 60 and diffhits > CastHealHPhighdiff and mana >= 11
        if not findtype "spellbook" hand and findtype "spellbook" backpack as myspellbook
            getlabel myspellbook SpellbookLabel
                for 5
                    wait 100
                    if "unidentified" in SpellbookLabel or "blessed" in SpellbookLabel
                        @ignore myspellbook 
                        if not findtype "spellbook" hand and findtype "spellbook" self as myspellbook
                            getlabel myspellbook SpellbookLabel
                        else 
                            overhead "[ NO SPELLBOOK! ]" 337
                            break
                        endif
                    endif 
                endfor
            dclick myspellbook
            wait 250
        endif
        cast 'Greater Heal'
        wait 100
        while not casting                   
            if targetexists
                hotkey 'cancel current target'
            endif
                cast 'Greater Heal'
                wait 100
        endwhile  
        wft 1500
        target 'self' 
        wait 250  
 
    elseif skill 'Magery' >= 40 and diffhits > CastHealHPmeddiff and mana >= 4
        if not findtype "spellbook" hand and findtype "spellbook" backpack as myspellbook
            getlabel myspellbook SpellbookLabel
                for 5
                    wait 100
                    if "unidentified" in SpellbookLabel or "blessed" in SpellbookLabel
                        @ignore myspellbook 
                        if not findtype "spellbook" hand and findtype "spellbook" self as myspellbook
                            getlabel myspellbook SpellbookLabel
                        else 
                            overhead "[ NO SPELLBOOK! ]" 337
                            break
                        endif
                    endif 
                endfor
            dclick myspellbook
            wait 250
        endif
        cast 'Heal'
        wait 100
        while not casting                   
            if targetexists
                hotkey 'cancel current target'
            endif
                cast 'Heal'
                wait 100
        endwhile  
        wft 1500
        target 'self' 
        wait 250 
    endif
endif 

if EnableCastCure = 1
    if poisoned and skill 'Magery' >= 40 and mana >= 6
        if not findtype "spellbook" hand and findtype "spellbook" backpack as myspellbook
            getlabel myspellbook SpellbookLabel
                for 5
                    wait 100
                    if "unidentified" in SpellbookLabel or "blessed" in SpellbookLabel
                        @ignore myspellbook 
                        if not findtype "spellbook" hand and findtype "spellbook" self as myspellbook
                            getlabel myspellbook SpellbookLabel
                        else 
                            overhead "[ NO SPELLBOOK! ]" 337
                            break
                        endif
                    endif 
                endfor
            dclick myspellbook
            wait 250
        endif
        cast 'Cure'
        wait 100
        while not casting                   
            if targetexists
                hotkey 'cancel current target'
            endif
                cast 'Cure'  
                wait 100
        endwhile  
        wft 1500
        target 'self' 
        wait 250 
    endif 
endif
            
if EnableCurePotion = 1
    if poisoned and not cooldown "Cure Potion" and hits < CurePotHP
        if findtype "Orange Potion" self as curepot
            overhead '* drinking cure potion... *' 44
            dclick curepot
            cooldown "Cure Potion" 10500
        else
            overhead "[ NO CURE POTS! ]" 337
        endif
    endif
endif 

if EnableHealPotion = 1
    if hits < HealPotHP and not cooldown "Healing Potion"
        if findtype "Yellow Potion" self as healpot
            overhead '* drinking heal potion... *' 253
            dclick healpot
            cooldown "Healing Potion" 10500
        else 
            overhead '[ NO HEAL POTS! ]' 337
        endif
    endif
endif 

if EnableRefreshPotion = 1
    if diffstam >= RefreshPotSPdiff and not cooldown "Refresh Potion"
        if findtype "Red Potion" self as refreshpot
            overhead '* drinking refresh potion... *' 34
            dclick refreshpot
            cooldown "Refresh Potion" 10500
        else 
            overhead '[ NO REFRESH POTS! ]' 337
        endif
    endif
endif

if EnableMagicReflection = 1 
    if skill 'Magery' >= 60 and not findbuff 'Magic Reflection' and not cooldown "Magic Shield" and mana > 14
        overhead 'I should shield myself...' 2086
        if not findtype "spellbook" hand and findtype "spellbook" backpack as myspellbook
            getlabel myspellbook SpellbookLabel
                for 5
                    wait 100
                    if "unidentified" in SpellbookLabel or "blessed" in SpellbookLabel
                        @ignore myspellbook 
                        if not findtype "spellbook" hand and findtype "spellbook" self as myspellbook
                            getlabel myspellbook SpellbookLabel
                        else 
                            overhead "[ NO SPELLBOOK! ]" 337
                            break
                        endif
                    endif 
                endfor
            dclick myspellbook
            wait 250
        endif
        for 10
            cast 'Magic Reflection' 
            waitfortarget 1500
            hotkey 'Target Self'
            wait 1000
                if insysmsg "That spell will not adhere"
                    cooldown "Magic Shield" 30000
                    overhead "Too soon for a new shield.  Give me a sec..." 2086
                    replay
                endif 
                if cooldown "Spell Fail"
                    wait 1000
                    overhead "Let me try that again..." 2086
                    wait 1000
                else
                    break
                endif 
        endfor 
        wait 500
        overhead "[ MAGIC REFLECTION ACTIVATED! ]" 10
        wait 1500
        replay
    endif  
endif 

if EnableReactiveArmour = 1 
    if skill 'Magery' >= 30 and not findbuff 'Reactive Armor' and mana >= 4
        overhead 'I should buff my armour...' 2086
        if not findtype "spellbook" hand and findtype "spellbook" backpack as myspellbook
            getlabel myspellbook SpellbookLabel
                for 5
                    wait 100
                    if "unidentified" in SpellbookLabel or "blessed" in SpellbookLabel
                        @ignore myspellbook 
                        if not findtype "spellbook" hand and findtype "spellbook" self as myspellbook
                            getlabel myspellbook SpellbookLabel
                        else 
                            overhead "[ NO SPELLBOOK! ]" 337
                            break
                        endif
                    endif 
                endfor
            dclick myspellbook
            wait 250
        endif
        for 10
            cast 'Reactive Armor' 
            waitfortarget 1500
            hotkey 'Target Self'
            wait 1000
                if insysmsg "That spell will not adhere"
                    cooldown "Magic Armor" 30000
                    overhead "Too soon for a new magic armor.  Give me a sec..." 2086
                    replay
                endif 
                if cooldown "Spell Fail"
                    wait 500
                    overhead "Let me try that again..." 2086
                    wait 500
                else
                    break
                endif 
        endfor 
        wait 500
        overhead "[ REACTIVE ARMOUR ACTIVATED! ]" 77
        wait 1000
        replay
    endif  
endif 

if EnableGoldVacuum = 1
    if findtype "gold coin" ground -1 -1 15 as droppedmoney and not cooldown "Gold Radar"   
        overhead "[ $ ]" 149 droppedmoney         
        overhead "¼" 149 droppedmoney
        cooldown "Gold Radar" 3500
    endif
    
    if findtype "gold coin" ground -1 -1 2 as droppedmoney and not cooldown "Gold Vacuum"
        overhead "[ CLEANUP... ]" 149
        hotkey "Grab Item"
        wft 2500
        target droppedmoney
        wait 250
        if insysmsg "Invalid or inaccessible item"
            overhead "I can't get to that!" 2086
            wait 500
            @ignore droppedmoney
        endif  
        cooldown "Gold Vacuum" 500
    endif
endif 

if EnableAutoCarving = 1
    if findtype 'Elven SpellBlade' self 
        if findtype "corpse" ground -1 -1 2 as deadbody
            dclicktype "Elven Spellblade"
            waitfortarget 1500
            target 'self'
            overhead "* skinning corpse... *" 337
            @ignore deadbody
        endif 
    else
        if not cooldown "Inventory Timer"
            overhead "[ NO SKINNING KNIFE! ]" 337
            sysmsg "Disable EnableAutoCarving in script variables to turn off this overhead message!" 0
            cooldown "Inventory Timer" 15000
        endif
        wait 500
    endif 
endif

if skill 'Magery' >= 80 and skill 'Spirit Speak' >= 80 and EnableSummons = 1 
    
    if followers = 0
        @setvar! NeedtoSummon 1
    elseif followers = 1 and TotalSummonCount > 0
        @setvar! NeedtoSummon 1      
    
    elseif followers = 2 and TotalSummonCount = 1
        @setvar! NeedtoSummon 0 
    elseif followers = 2 and TotalSummonCount = 2
        @setvar! NeedtoSummon 1
    elseif followers = 2 and TotalSummonCount = 3
        @setvar! NeedtoSummon 1
    elseif followers = 2 and TotalSummonCount = 4
        @setvar! NeedtoSummon 1
    
    elseif followers = 3 and TotalSummonCount = 1
        @setvar! NeedtoSummon 0 
    elseif followers = 3 and TotalSummonCount = 2
        @setvar! NeedtoSummon 0
    elseif followers = 3 and TotalSummonCount = 3
        @setvar! NeedtoSummon 1
    elseif followers = 3 and TotalSummonCount = 4
        @setvar! NeedtoSummon 1
    
    elseif followers = 4 and TotalSummonCount = 1
        @setvar! NeedtoSummon 0 
    elseif followers = 4 and TotalSummonCount = 2
        @setvar! NeedtoSummon 0
    elseif followers = 4 and TotalSummonCount = 3
        @setvar! NeedtoSummon 0
    elseif followers = 4 and TotalSummonCount = 4
        @setvar! NeedtoSummon 1  
    elseif followers = 5
        @setvar! NeedtoSummon 0
    endif
    
if NeedtoSummon = 1
    
    overhead "I need a bodyguard..." 2086
    
    if not varexist myMainTankPet
        @setvar! myMainTankPet 0
    endif
    if not varexist fireOne
        @setvar! fireOne 0
    endif 
    if not varexist fireTwo
        @setvar! fireTwo 0
    endif
    if not varexist earthOne
        @setvar! earthOne 0
    endif
    if not varexist earthTwo
        @setvar! earthTwo 0
    endif
    if not varexist demonOne
        @setvar! demonOne 0
    endif
    if not varexist demonTwo
        @setvar! demonTwo 0
    endif
    if not varexist airOne
        @setvar! airOne 0
    endif
    if not varexist airTwo
        @setvar! airTwo 0
    endif
    if not varexist waterOne
        @setvar! waterOne 0
    endif
    if not varexist waterTwo
        @setvar! waterTwo 0
    endif

    removelist summonList
    createlist summonList
    
    if SummonEarthElemental > 0
        if dead earthOne or not find earthOne ground -1 -1 18         
            pushlist summonList "Earth Elemental"
            @setvar! earthOne 1
        endif
        if SummonEarthElemental > 1
            if dead earthTwo or not find earthTwo ground -1 -1 18
                pushlist summonList "Earth Elemental"
                @setvar! earthTwo 1
            endif
        endif
    endif

    if SummonFireElemental > 0
        if dead fireOne or not find fireOne ground -1 -1 18 
            pushlist summonList "Fire Elemental"
            @setvar! fireOne 1
        endif
        if SummonFireElemental > 1
            if dead fireTwo or not find fireTwo ground -1 -1 18
                pushlist summonList "Fire Elemental"
                @setvar! fireTwo 1
            endif
        endif
    endif

    if SummonDemon > 0
        if dead demonOne or not find demonOne ground -1 -1 18
            pushlist summonList "Earth Elemental"
            @setvar! demonOne 1
        endif
        if SummonDemon > 1
            if dead demonTwo or not find demonTwo ground -1 -1 18
                pushlist summonList "Earth Elemental"
                @setvar! demonTwo 1
            endif
        endif
    endif

    if SummonAirElemental > 0
        if dead airOne or not find airOne ground -1 -1 18
            pushlist summonList "Air Elemental"
            @setvar! airOne 1
        endif
        if SummonAirElemental > 1
            if dead airTwo or not find airTwo ground -1 -1 18
                pushlist summonList "Air Elemental"
                @setvar! airTwo 1
            endif
        endif
    endif

    if SummonWaterElemental > 0
        if dead waterOne or not find waterOne ground -1 -1 18
            pushlist summonList "Water Elemental"
            @setvar! waterOne 1
        endif
        if SummonWaterElemental > 1
            if dead waterTwo or not find waterTwo ground -1 -1 18
                pushlist summonList "Water Elemental"
                @setvar! waterTwo 1
            endif
        endif
    endif    

    if not findtype "spellbook" hand and findtype "spellbook" backpack as myspellbook
        getlabel myspellbook SpellbookLabel
            for 5
                wait 100
                if "unidentified" in SpellbookLabel or "blessed" in SpellbookLabel
                    @ignore myspellbook 
                    if not findtype "spellbook" hand and findtype "spellbook" self as myspellbook
                        getlabel myspellbook SpellbookLabel
                    else 
                        overhead "[ NO SPELLBOOK! ]" 337
                        break
                    endif
                endif 
            endfor
        dclick myspellbook
        wait 250
    endif

    foreach summon in summonList
            while mana < 50
                if diffhits >= 50
                    replay
                endif
                wait 500
                if not findbuff "Actively Meditating"
                    useskill "meditation"
                    overhead "* meditating... *" 10
                endif
                wait 1000
            endwhile    

                    cast summon
                    wft 500
                    if targetexists 
                        hotkey "Target Self"
                        wait 200
                    endif
                    
                    while casting 
                        wait 500
                    endwhile
                    
                    if diffhits >= 40
                        overhead "Hang on, I need a heal!" 2086
                        hotkey '> Interrupt'
                        replay
                    endif
                    wait 500                
               
        @setvar! myFreshlySummonedPet 0
        
            if summon = "Earth Elemental" and findtype 14 ground -1 -1 2 as myPet
                @setvar! myFreshlySummonedPet myPet
                if earthOne = 1
                    @setvar! earthOne myPet
                elseif earthTwo = 1
                    @setvar! earthTwo myPet
                endif

            elseif summon = "Fire Elemental" and findtype 15 ground -1 -1 2 as myPet 
                @setvar! myFreshlySummonedPet myPet
                if fireOne = 1
                    @setvar! fireOne myPet
                elseif fireTwo = 1
                    @setvar! fireTwo myPet
                endif

            elseif summon = "Summon Daemon" and findtype 9 ground -1 -1 2 as myPet
                @setvar! myFreshlySummonedPet myPet
                if demonOne = 1
                    @setvar! demonOne myPet
                elseif demonTwo = 1
                    @setvar! demonTwo myPet
                endif

            elseif summon = "Water Elemental" and findtype 16 ground -1 -1 2 as myPet
                @setvar! myFreshlySummonedPet myPet
                if waterOne = 1
                    @setvar! waterOne myPet
                elseif waterTwo = 1
                    @setvar! waterTwo myPet
                endif

            elseif summon = "Air Elemental" and findtype 13 ground -1 -1 2 as myPet
                @setvar! myFreshlySummonedPet myPet
                if airOne = 1
                    @setvar! airOne myPet
                elseif airTwo = 1
                    @setvar! airTwo myPet
                endif
            endif
        
            if myFreshlySummonedPet = 0
                overhead "I don't see my elemental..." 2086
                wait 500
                break
            endif 
            
            if NameSummonedPets = 0
                wait 2000
                overhead "{{summon}} will protect you now...." 1909 myFreshlySummonedPet
                menu myFreshlySummonedPet 3
                @ignore myFreshlySummonedPet        
                wait 500
                poplist summonList "front"
                cooldown "Guard Timer" 10000
                break
            endif
            
            if NameSummonedPets = 1 and list petNameList > 0
                wait 500
                overhead "What is your name, minion?" 2086
                wait 250
                foreach petName in petNameList
                    rename myFreshlySummonedPet petName
                    wait 250
                    if insysmsg "That name is unacceptable"
                        sysmsg "Unable to name summon: {{petName}}" 34
                        clearsysmsg 
                        poplist petNameList "front"
                        wait 500
                    else 
                        break
                    endif
                endfor
                wait 1000
                overhead "You may call me {{petName}}, master." 1909 myFreshlySummonedPet
                wait 1500
                overhead "{{petName}} will protect you now...." 1909 myFreshlySummonedPet
                menu myFreshlySummonedPet 3
                @ignore myFreshlySummonedPet
                poplist petNameList front
                cooldown "Guard Timer" 10000
                break
            endif
        endfor
    endif
endif
    
if EnableSummons = 1 
    if dead myMainTankPet
        if not dead earthOne
            @setvar! myMainTankPet earthOne
        elseif not dead earthTwo
            @setvar! myMainTankPet earthTwo
        elseif not dead waterOne
            @setvar! myMainTankPet waterOne
        elseif not dead waterTwo
            @setvar! myMainTankPet waterTwo
        elseif not dead demonOne
            @setvar! myMainTankPet demonOne
        elseif not dead demonTwo
            @setvar! myMainTankPet demonTwo
        elseif not dead fireOne
            @setvar! myMainTankPet fireOne
        elseif not dead fireTwo
            @setvar! myMainTankPet fireTwo
        elseif not dead airOne
            @setvar! myMainTankPet airOne
        elseif not dead airTwo
            @setvar! myMainTankPet airTwo
        endif
        wait 1000
    else 
        if not cooldown "Guard Timer"
            overhead "* guarding... *" 2114 myMainTankPet
            cooldown "Guard Timer" 6000
        endif 
    endif
endif 

if EnableWeaponWarning = 1
    if skill "Mace Fighting" > 50 and not findtype "sledgehammer|giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick" self and not cooldown "Inventory Timer"
        overhead "[ NO WEAPON! ]" 337
        cooldown "Inventory Timer" 10000
        sysmsg "Disable 'EnableWeaponWarning' in script variables to turn off this feature!" 0        
    endif 

    if skill "Swordsmanship" > 50 and not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" self and not cooldown "Inventory Timer"
        overhead "[ NO WEAPON! ]" 337
        cooldown "Inventory Timer" 10000
        sysmsg "Disable 'EnableWeaponWarning' in script variables to turn off this feature!" 0        
    endif

    if skill "Magery" > 80 and findtype "spellbook" self as myspellbook and not cooldown "Inventory Timer"
        getlabel myspellbook SpellbookLabel
        for 5
            if "unidentified" in SpellbookLabel or "blessed" in SpellbookLabel
                @ignore myspellbook 
                if findtype "spellbook" self as myspellbook
                    getlabel myspellbook SpellbookLabel
                elseif not cooldown "Inventory Timer"
                    overhead "[ NO SPELLBOOK! ]" 337
                    cooldown "Inventory Timer" 10000
                    sysmsg "Disable 'EnableWeaponWarning' in script variables to turn off this feature!" 0
                    break
                endif
            endif 
        endfor
    endif 
endif

if AllInventoryMessage = 1 and not cooldown "Inventory Timer"
    if counttype "Yellow Potion" self = 0 and YellowInventoryMessage = 1
        overhead "[ RESTOCK HEAL POTS! ]" 253
        cooldown "Inventory Timer" 10000
        sysmsg "Disable YellowInventoryMessage in script variables to turn off this overhead message!" 0
    endif 

    if counttype "Orange Potion" self = 0 and OrangeInventoryMessage = 1
        overhead "[ RESTOCK CURE POTS! ]" 44
        cooldown "Inventory Timer" 10000
        sysmsg "Disable OrangeInventoryMessage in script variables to turn off this overhead message!" 0
    endif 

    if counttype "Red Potion" self = 0 and RedInventoryMessage = 1
        overhead "[ RESTOCK REFRESH POTS! ]" 37
        cooldown "Inventory Timer" 10000
        sysmsg "Disable RedInventoryMessage in script variables to turn off this overhead message!" 0
    endif 

    if counttype "White Potion" self = 0 and WhiteInventoryMessage = 1 
        overhead "[ RESTOCK STRENGTH POTS! ]" 956
        cooldown "Inventory Timer" 10000
        sysmsg "Disable WhiteInventoryMessage in script variables to turn off this overhead message!" 0
    endif 

    if counttype "Blue Potion" self = 0 and BlueInventoryMessage = 1
        overhead "[ RESTOCK AGILITY POTS! ]" 93
        cooldown "Inventory Timer" 10000
        sysmsg "Disable BlueInventoryMessage in script variables to turn off this overhead message!" 0
    endif 

    if counttype "Black Potion" self = 0 and BlackInventoryMessage = 1
        overhead "[ RESTOCK MAGIC RESIST POTS! ]" 0
        cooldown "Inventory Timer" 10000
        sysmsg "Disable BlackInventoryMessage in script variables to turn off this overhead message!" 0
    endif 

    if counttype "rope" self = 0 and RopeInventoryMessage = 1
        overhead "[ RESTOCK ROPE! ]" 2799
        cooldown "Inventory Timer" 10000
        sysmsg "Disable RopeInventoryMessage in script variables to turn off this overhead message!" 0
    endif 
endif

if EnableCheeseTimer = 1
    if not findbuff 'food satisfaction' and findtype "wedge%s% of cheese|fish steak%s%" self
        overhead "Hold on, I shouldn't do this on an empty stomach..." 2086
        wait 500
        if findtype "wedge%s% of cheese|fish steak%s%" backpack as food
            overhead "* eating food... *" 0
            dclick food
            wait 1500
            overhead "Ok, I'm ready to get to work!" 2086
        endif
    endif 
endif 

if EnableToolCountdown = 1
    if findtype 'pickaxe|hatchet' hand as MyAxe
        getlabel MyAxe AxeLabel
        if '(5 uses' in AxeLabel or '(4 uses' in AxeLabel or '(3 uses' in AxeLabel or '(2 uses' in AxeLabel or '(1 use' in AxeLabel
            if EnableRecycleTool = 0
                sysmsg "YOUR TOOL IS ABOUT TO BREAK....." 153
            endif 
            if EnableRecycleTool = 1
                sysmsg "YOUR TOOL IS ABOUT TO BE RECYCLED....." 93
            endif 
        endif 
    endif 
endif

if EnableRecycleTool = 1
    if findtype 'tool kit' self as ToolKit
        if findtype 'pickaxe|hatchet' hand as MyAxe
            getlabel MyAxe AxeLabel
            if '(2 use' in AxeLabel
                overhead "[ RECYCLING TOOL! ]" 93
                clearhands both
                wait 250
                if not gumpexists 949095101 
                    dclick ToolKit
                    waitforgump 949095101 2000
                endif 
        
                for 5
                gumpresponse 3 949095101
                wait 250
                    if insysmsg "Target an individual item"
                        target MyAxe
                        wait 250
                        gumpclose 949095101
                        overhead "Every little bit counts..." 2086
                        hotkey 'Organizer Agent-03' 
                        replay
                    else
                        gumpresponse 2
                        wait 250
                endfor 
                endif 
            endif 
        endif 
    endif

    if not findtype 'tool kit' self and not cooldown "Inventory Timer"
        overhead "[ NO TOOL KIT! ]" 337
        cooldown "Inventory Timer" 15000
        sysmsg "Disable 'EnableRecycleTool' in script variables to turn off this overhead message!" 0
    endif
endif 

if insysmsg "As the owner" or insysmsg "Your house and its contents"
    wait 1000
    if find MyDoor ground -1 -1 2
        overhead "* door slams! *" 0 MyDoor
        dclick MyDoor 
        wait 500
    endif
endif

clearsysmsg
hotkey 'Cancel Current Target'

if EnableAutoAttackGreyMOB = 1 
    if warmode
        overhead "Someone looks like they wanna fight..." 2086
    
        if skill "Mace Fighting" > 50 and not findtype "sledgehammer|giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick" hand and findtype "sledgehammer|giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick" backpack as weapon
            getlabel weapon WeaponLabel
                for 5
                    wait 100
                    if "unidentified" in WeaponLabel
                        @ignore weapon
                        if skill "Mace Fighting" > 50 and not findtype "sledgehammer|giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick" hand and findtype "sledgehammer|giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick" backpack as weapon
                            getlabel weapon WeaponLabel
                        endif
                    endif 
                endfor
            dclick weapon      
            wait 100
        endif 

        if skill "Swordsmanship" > 50 and not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" hand and findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" backpack as weapon
            getlabel weapon WeaponLabel
                for 5
                    wait 100
                    if "unidentified" in WeaponLabel
                        @ignore weapon
                        if skill "Swordsmanship" > 50 and not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" hand and findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" backpack as weapon
                            getlabel weapon WeaponLabel
                        endif
                    endif 
                endfor
            dclick weapon      
            wait 100
        endif 

        if skill "Magery" >= 80 and not findtype "spellbook" hand and findtype "spellbook" backpack as spellbook
            getlabel spellbook SpellbookLabel
                for 5
                    wait 100
                    if "unidentified" in SpellbookLabel or "blessed" in SpellbookLabel
                        @ignore spellbook 
                        if skill "Magery" > 80 and not findtype "spellbook" hand and findtype "spellbook" backpack as spellbook
                            getlabel spellbook SpellbookLabel
                        endif
                    endif 
                endfor
            dclick spellbook
            wait 100
        endif 
                
            clearsysmsg
            for 1000
                hotkey 'Target Closest Non-Friendly Monster'
                wait 500
                            
                    if insysmsg "No one matching that was found" 
                        hotkey 'Cancel Current Target'      
                        @setvar CurrentTarget 0
                        overhead "Is there no one else??" 2086
                        wait 2500
                        overhead "Alright then, I guess it's back to work..." 2086
                        hotkey 'Toggle Peace Only'
                        hotkey 'Clear Target Queue'
                        clearsysmsg 
                        replay                                    
                    endif 
                    
                    @setvar CurrentTarget lasttarget 
                    getlabel CurrentTarget TargetDesc

                while not dead CurrentTarget

                        if EnableRedAlertRecall = 1
                            if insysmsg "Now tracking" or insysmsg "Distance to destination"
                                @setvar! TimeToGo 1
                                hotkey 'Toggle Peace Only'
                                hotkey 'Clear Target Queue'
                                clearsysmsg 
                                replay
                            endif
                        endif 

                        if not cooldown "Target Timer"
                            if "Paragon" in TargetDesc
                                overhead " ¼ PARAGON! ¼ " 12 CurrentTarget 
                                cooldown "Target Timer" 4000
                            else 
                                overhead " ¼ TARGET ¼ " 253 CurrentTarget 
                                cooldown "Target Timer" 4000
                            endif   
                        endif                             
                  
                        if skill 'Healing' > 50 and not bandaging and hits < maxhits
                            overhead '* applying bandages... *' 88
                            hotkey "Bandage Self"
                        endif

                        if EnableCurePotion = 1
                            if poisoned and not cooldown "Cure Potion" and hits < CurePotHP
                                if findtype "Orange Potion" self as curepot
                                    overhead '* drinking cure potion... *' 44
                                    dclick curepot
                                    cooldown "Cure Potion" 10500
                                else
                                    overhead "[ NO CURE POTS! ]" 337
                                endif
                            endif
                        endif 

                        if EnableHealPotion = 1
                            if hits < HealPotHP and not cooldown "Healing Potion"
                                if findtype "Yellow Potion" self as healpot
                                    overhead '* drinking heal potion... *' 253
                                    dclick healpot
                                    cooldown "Healing Potion" 10500
                                else 
                                    overhead '[ NO HEAL POTS! ]' 337
                                endif
                            endif
                        endif 

                        if EnableRefreshPotion = 1
                            if diffstam > RefreshPotSPdiff and not cooldown "Refresh Potion"
                                if findtype "Red Potion" self as refreshpot
                                    overhead '* drinking refresh potion... *' 34
                                    dclick refreshpot
                                    cooldown "Refresh Potion" 10500
                                else 
                                    overhead '[ NO REFRESH POTS! ]' 337
                                endif
                            endif
                        endif
                            
                        if paralyzed and EnableParalyzePouch = 1
                            overhead "[[[[ POP!! ]]]]" 2117
                            say "[pouch" 
                            @setvar! TimeToGo 1
                            replay
                        endif

                    if skill "Mace Fighting" or skill "Swordsmanship" > 50
                        attack CurrentTarget                        
                        wait 500
                    endif 
                    
                    if skill "Magery" >= 70

                        if not findbuff "Actively Meditating" and mana < 40
                            hotkey "Meditation"
                            wait 250
                            while mana < 40
                                wait 500
                                if not cooldown "Move Timer"
                                    overhead "* meditating... *" 6
                                    cooldown "Move Timer" 4000
                                endif
                            endwhile
                        endif  

                        if EnableCastHeal = 1
                            if not findtype "spellbook" hand and findtype "spellbook" backpack as myspellbook
                                getlabel myspellbook SpellbookLabel
                                    for 5
                                        wait 100
                                        if "unidentified" in SpellbookLabel or "blessed" in SpellbookLabel
                                            @ignore myspellbook 
                                            if not findtype "spellbook" hand and findtype "spellbook" self as myspellbook
                                                getlabel myspellbook SpellbookLabel
                                            else 
                                                overhead "[ NO SPELLBOOK! ]" 337
                                                break
                                            endif
                                        endif 
                                    endfor
                                    dclick myspellbook
                                    wait 250
                            endif

                            if skill 'Magery' >= 40 and diffhits > CastHealHPmeddiff and diffhits < CastHealHPhighdiff and mana >= 4
                                cast 'Heal'
                                wait 100
                                while not casting                   
                                    if targetexists
                                        hotkey 'cancel current target'
                                    endif
                                        cast 'Heal'
                                        wait 100
                                endwhile  
                                    wft 1500
                                    target 'self' 
                                    wait 100  

                            elseif skill 'Magery' >= 60 and diffhits > CastHealHPhighdiff and mana >= 11
                                cast 'Greater Heal'
                                wait 100
                                    while not casting                   
                                        if targetexists
                                            hotkey 'cancel current target'
                                        endif
                                            cast 'Greater Heal'
                                            wait 100
                                    endwhile  
                                        wft 1500
                                        target 'self' 
                                        wait 100  
 
                                        elseif skill 'Magery' >= 40 and diffhits > CastHealHPhighdiff and mana >= 4 and mana < 11
                                cast 'Heal'
                                wait 100
                                    while not casting                   
                                        if targetexists
                                            hotkey 'cancel current target'
                                        endif
                                            cast 'Heal'
                                            wait 100
                                    endwhile  
                                        wft 1500
                                        target 'self' 
                                        wait 100 
                            endif

                            if poisoned and skill 'Magery' >= 40 and mana >= 6
                                if not findtype "spellbook" hand and findtype "spellbook" backpack as myspellbook
                                    getlabel myspellbook SpellbookLabel
                                    for 5
                                        wait 100
                                        if "unidentified" in SpellbookLabel or "blessed" in SpellbookLabel
                                            @ignore myspellbook 
                                            if not findtype "spellbook" hand and findtype "spellbook" self as myspellbook
                                                getlabel myspellbook SpellbookLabel
                                            else 
                                                overhead "[ NO SPELLBOOK! ]" 337
                                                break
                                            endif
                                        endif 
                                    endfor
                                    dclick myspellbook
                                    wait 250
                                endif
                                cast 'Cure'
                                wait 100
                                    while not casting                   
                                        if targetexists
                                            hotkey 'cancel current target'
                                        endif
                                            cast 'Cure'  
                                            wait 100
                                    endwhile  
                                wft 1500
                                target 'self' 
                                wait 100 
                            endif 
                        endif   
                        
                        if not findtype "spellbook" hand and findtype "spellbook" backpack as myspellbook
                            getlabel myspellbook SpellbookLabel
                                for 5
                                    wait 100
                                    if "unidentified" in SpellbookLabel or "blessed" in SpellbookLabel
                                        @ignore myspellbook 
                                        if not findtype "spellbook" hand and findtype "spellbook" self as myspellbook
                                            getlabel myspellbook SpellbookLabel
                                        else 
                                            overhead "[ NO SPELLBOOK! ]" 337
                                            break
                                        endif
                                    endif 
                                endfor
                            dclick myspellbook
                            wait 250
                        endif

                        wait 500
                        
                        if mana >= 12 and EnableCastExplosion = 1 and not cooldown "ExplosionCD"
                            if not find CurrentTarget ground -1 -1 15 or diffhits >= 30
                                hotkey '> Interrupt'
                                break
                            else
                                cast 'Explosion'
                                wait 500
                                while casting 
                                    wait 50
                                endwhile
                            endif 
                            wait 500
                            target CurrentTarget
                            wait 1000
                                if insysmsg "cannot be seen" 
                                    overhead "I can't see that!" 2086
                                else 
                                    cooldown ExplosionCD 10000
                                    wait 500
                                endif
                        endif              

                        if mana >= 12 and EnableCastEnergyBolt = 1 and not cooldown "EnergyBoltCD"
                            if not find CurrentTarget ground -1 -1 15 or diffhits >= 30
                                hotkey '> Interrupt'
                                break
                            else
                                cast 'Energy Bolt'
                                wait 500
                                while casting 
                                    wait 50
                                endwhile
                            endif 
                            wait 500
                            target CurrentTarget
                            wait 500
                                if insysmsg "cannot be seen" 
                                    overhead "I can't see that!" 2086
                                else 
                                    cooldown EnergyBoltCD 10000
                                    wait 500
                                endif
                        endif       
         
                        if mana >= 12 and EnableCastLighting = 1 and not cooldown "LightningCD"
                           if not find CurrentTarget ground -1 -1 15 or diffhits >= 30
                                hotkey '> Interrupt'
                                break
                            else
                                cast 'Lightning'
                                wait 500
                                while casting 
                                    wait 50
                                endwhile
                            endif 
                            wait 500
                            target CurrentTarget
                            wait 500
                                if insysmsg "cannot be seen" 
                                    overhead "I can't see that!" 2086
                                else 
                                    cooldown LightningCD 5000
                                    wait 500
                                endif
                        endif      
        
                        if mana >= 5 and EnableCastMagicArrow = 1 and not cooldown "MagicArrowCD"
                            if not find CurrentTarget ground -1 -1 15 or diffhits >= 30
                                hotkey '> Interrupt'
                                break
                            else
                                cast 'magic arrow'
                                wait 5000
                                while casting 
                                    wait 50
                                endwhile
                            endif 
                            wait 500
                            target CurrentTarget
                            wait 500
                                if insysmsg "cannot be seen" 
                                    overhead "I can't see that!" 2086
                                else 
                                    cooldown MagicArrowCD 15000
                                    wait 500
                                endif
                        endif            
                
                        if mana >= 9 and EnableCastHarm = 1 and not cooldown "HarmCD"
                            if not find CurrentTarget ground -1 -1 15 or diffhits >= 30
                                hotkey '> Interrupt'
                                break
                            else
                                cast 'harm'
                                wait 500
                                while casting 
                                    wait 50
                                endwhile
                            endif 
                            wft 2500
                            target CurrentTarget
                            wait 500
                                if insysmsg "cannot be seen" 
                                    overhead "I can't see that!" 2086
                                else 
                                    cooldown HarmCD 15000
                                    wait 500
                                endif
                            
                        endif            
                
                        if mana >= 12 and EnableCastFireball = 1 and not cooldown "FireballCD"
                            if not find CurrentTarget ground -1 -1 15 or diffhits >= 30
                                hotkey '> Interrupt'
                                break
                            else
                                cast 'fireball'
                                wait 500
                                while casting 
                                    wait 50
                                endwhile
                            endif 
                            wft 2500
                            target CurrentTarget
                            wait 500
                                if insysmsg "cannot be seen" 
                                    overhead "I can't see that!" 2086
                                else 
                                    cooldown FireballCD 15000
                                    wait 500
                                endif
                        endif

                        if mana >= 40 and EnableCastFlamestrike = 1 and not cooldown "FlamestrikeCD"
                            if not find CurrentTarget ground -1 -1 15 or diffhits >= 30
                                hotkey '> Interrupt'
                                break
                            else
                                cast 'flamestrike'
                                wait 500
                                while casting 
                                    wait 50
                                endwhile
                            endif 
                            wft 2500
                            target CurrentTarget
                            wait 1000
                                if insysmsg "cannot be seen" 
                                    overhead "I can't see that!" 2086
                                else 
                                    cooldown FlamestrikeCD 3000
                                    wait 500
                                endif
                        endif
                        
                        
                        
                    endif
                endwhile
                
                            if insysmsg "You have unlocked a codex upgrade point"
                                overhead "[ CODEX POINT UNLOCKED! ]" 2114
                                clearsysmsg
                            endif 
 
                            if insysmsg "enough experience to upgrade"
                                overhead "[ ASPECT UPGRADE AVAILABLE! ]" 2086
                                clearsysmsg
                            endif 
                        
                            if insysmsg "You have gained"
                                overhead "Did you see that?? I just killed {{TargetDesc}}!" 2086
                                hotkey 'Cancel Current Target'
                                @setvar CurrentTarget 0

                                if skill "Spirit Speak" >= 80 and not cooldown "Spirit Speak"
                                    useskill "Spirit Speak"
                                    cooldown "Spirit Speak" 11000
                                endif
                            endif
                            
                            if findtype 'Elven SpellBlade' backpack and EnableAutoCarving = 1
                                if findtype "corpse" ground -1 -1 2 as corpse
                                    hotkey 'Cancel Current Target'
                                    dclicktype "Elven Spellblade"
                                    wft 1500
                                    target self
                                    overhead "* skinning {{TargetDesc}}... *" 339
                                    @ignore corpse
                                endif 
                            endif   
                            
                    endfor                    
            hotkey 'Cancel Current Target'
            @setvar! TimeToGo 1
            replay 
        
        if skill "Mace Fighting" > 50 and not findtype "sledgehammer|giant club|flail|cudgel|quarter staff|war mace|maul|war axe|mace|hammer pick" self or skill "Swordsmanship" > 50 and not findtype "double axe|two handed axe|battle axe|halberd|katana|bardiche|cutlass|broadsword|scimitar|viking sword|longsword" self
            overhead "I can't fight without a weapon!"  2086
            hotkey 'Toggle Peace Only'
            hotkey 'Cancel Current Target'
            @setvar! TimeToGo 1
            replay 
        endif 
        hotkey 'Cancel Current Target'
        hotkey 'Toggle Peace Only'
        replay
    endif
endif

////////////////////////////////
// MINING SCRIPT STARTS HERE: //
////////////////////////////////

if not dead and skill "Mining" > 49.9 and EnableMining = 1 and not cooldown "Travel"

if not varexist ingotbag and EnableIngotBag = 1
    wait 500
    for 5
        if not varexist ingotbag
        overhead "Please select your ingot storage bag..." 0
        wait 500
        setvar ingotbag
        wait 2500
        sysmsg "Disable 'EnableIngotBag' in script variables to turn off this feature!" 0
        else 
            break
        endif
    endfor
endif

if not varexist mining_runebook and EnableRedAlertRecall = 1
    wait 500
    for 5
        if not varexist mining_runebook
        overhead "Please select your escape runebook..." 0
        wait 500
        setvar mining_runebook
        wait 2500
        sysmsg "Disable 'EnableRedAlertRecall' in script variables to turn off this feature!" 0
        else 
            break
        endif
    endfor
endif
    
if EnablePlayerForgeRadar = 1
    if findtype "4017|6526|6538|6550|6562" ground -1 -1 15 as forge or findtype 0x0FB1 ground -1 -1 15 as forge and findtype "iron ore" backpack and not cooldown "Forge Radar"
        overhead "[ FORGE HERE! ]" 44 forge
        overhead "¼" 44 forge
        cooldown "Forge Radar" 3500
    endif 
endif
          
if EnableOreVacuum = 1
    if findtype "iron ore" ground -1 -1 15 as droppedore and not cooldown "Ore Radar"   
        overhead "[ ORE ]" 93 droppedore             
        overhead "¼" 93 droppedore
        cooldown "Ore Radar" 3500
    endif

    if findtype "iron ingot%s" ground -1 -1 15 as droppedingots and not cooldown "Ore Radar"   
        overhead "[ INGOTS ]" 69 droppedingots              
        overhead "¼" 69 droppedingots
        cooldown "Ore Radar" 3500
    endif
    
    if findtype "iron ore|iron ingot%s" ground -1 -1 2 as droppedmetal and not cooldown "Ore Vacuum"
        overhead "[ CLEANUP... ]" 93
        hotkey "Grab Item"
        wft 2500
        target droppedmetal
        wait 250
        if insysmsg "Invalid or inaccessible item"
            overhead "I can't get to that!" 2086
            wait 250
            @ignore droppedmetal
        endif
        hotkey 'Organizer Agent-03'  
        cooldown "Ore Vacuum" 500
    endif
endif 

if counttype "iron ingot%s" > IngotRecallAmount and EnableIngotAutoRecall = 1
    overhead "I'd hate to lose all this hard work..." 2086
    wait 2500
    overhead "I'm going to go unload before it's too late!" 2086
    sysmsg "Disable 'EnableIngotAutoRecall' in script variables to turn off this feature!" 0
    wait 2000
    @setvar! TimeToGo 1
    replay
endif 

if not findtype 'pickaxe' hand and findtype 'pickaxe' backpack
    dclicktype 'pickaxe' backpack
    wait 250
endif

if EnableAutoSmeltNaturalForge = 1 
    if findtype "iron ore" backpack as ore and Working = 0  
        @setvar! ForgeFound 0
    
        if not timerexists AutoSmeltNaturalForgeTimer
            settimer AutoSmeltNaturalForgeTimer 2500
        endif

        if timer AutoSmeltNaturalForgeTimer >= 2500
            dclick ore
            wait 500
            if insysmsg "You do not see any nearby forges"
                settimer AutoSmeltNaturalForgeTimer 0
                clearsysmsg
            else
                @setvar! ForgeFound 1
                clearsysmsg
                wait 250
            endif
        endif

        for 11
        if ForgeFound = 1 and findtype "iron ore" backpack as ore
            dclick ore
            wait 500
            if insysmsg "You do not see any nearby forges"
               settimer AutoSmeltNaturalForgeTimer 0
                @setvar! ForgeFound 0
                clearsysmsg
                replay
            endif
            hotkey 'Organizer Agent-03'  
            wait 500
        endif
        endfor 
    endif
endif 

if EnableAutoSmeltPlayerForge = 1
    for 10
    if findtype "forge" ground -1 -1 2 as forge or findtype 0x0FB1 ground -1 -1 2 as forge and findtype "iron ore" backpack as ore
        overhead "* smelting ore... *" 2114 forge
        dclick ore
        overhead "* forging ingots... *" 2117
        wait 1000
        if insysmsg "You do not see any nearby forges"
           settimer AutoSmeltNaturalForgeTimer 0
           @setvar! ForgeFound 0
             replay
        endif
        hotkey 'Organizer Agent-03'  
        wait 500
    endif
    endfor
endif

if EnableWeightWarningMessage = 1 and not cooldown "Weight Timer"
    if weight > GreenWarningWeight and weight < YellowWarningWeight
        overhead "[ WEIGHT WARNING! ]" 1270
        cooldown "Weight Timer" 3500
    endif

    if weight > YellowWarningWeight and weight < RedWeightLimit
        overhead "[ TIME TO FORGE! ]" 149
        cooldown "Weight Timer" 3500
    endif 

    if weight > RedWeightLimit
        @setvar! Working 0
        overhead "[ WEIGHT LIMIT REACHED!!! ]" 337
        wait 2000
        overhead "Find a forge in order to continue..." 0
        wait 1000
        replay
    endif
endif 

hotkey 'Use item in hand' 
wft 500
hotkey 'Target Self' 
wait 503

        if insysmsg "Now tracking" or insysmsg "Distance to destination"
            @setvar! TimeToGo 1
            replay 
        
                elseif insysmsg 'world is saving'                     
                        for 40
                            wait 100
                            if insysmsg 'world save complete' 
                                overhead '[ SAVE COMPLETE! ]' 253 
                                clearsysmsg 
                                replay
                            endif 
                        endfor 
                    clearsysmsg 
                    replay 
        
                elseif insysmsg 'Harvesting is not allowed' 
                    overhead 'You need to leave town...' 84
                    clearsysmsg 
                    wait 5000 
                    replay 
            
                elseif insysmsg 'You have worn out your tool' 
                    overhead "My pickaxe broke!" 2086
                    wait 1500 
                    clearsysmsg
                    replay

                elseif insysmsg "You must wait"
                    overhead 'Hang on one sec...' 2086
                    wait 1000
                    clearsysmsg 
                    replay 

                elseif insysmsg "must wait 59"
                        cooldown "Travel" 59000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 58"
                        cooldown "Travel" 58000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 57"
                        cooldown "Travel" 57000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 56"
                        cooldown "Travel" 56000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 55"
                        cooldown "Travel" 55000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 54"
                        cooldown "Travel" 54000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 53"
                        cooldown "Travel" 53000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 52"
                        cooldown "Travel" 52000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 51"
                        cooldown "Travel" 51000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 50"
                        cooldown "Travel" 50000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 49"
                        cooldown "Travel" 49000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 48"
                        cooldown "Travel" 48000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 47"
                        cooldown "Travel" 47000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 46"
                       cooldown "Travel" 46000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 45"
                        cooldown "Travel" 45000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 44"
                        cooldown "Travel" 44000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 43"
                        cooldown "Travel" 43000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 42"
                        cooldown "Travel" 42000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 41"
                        cooldown "Travel" 41000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 40"
                        cooldown "Travel" 40000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 39"
                        cooldown "Travel" 39000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 38"
                        cooldown "Travel" 38000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 37"
                        cooldown "Travel" 37000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 36"
                        cooldown "Travel" 36000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay                     
                    elseif insysmsg "must wait 35"
                        cooldown "Travel" 35000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 34"
                        cooldown "Travel" 34000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 33"
                        cooldown "Travel" 33000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 32"
                        cooldown "Travel" 32000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 31"
                        cooldown "Travel" 31000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 30"
                        cooldown "Travel" 30000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 29"
                        cooldown "Travel" 29000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 28"
                        cooldown "Travel" 28000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 27"
                        cooldown "Travel" 27000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 26"
                        cooldown "Travel" 26000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 25"
                        cooldown "Travel" 25000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 24"
                        cooldown "Travel" 24000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 23"
                        cooldown "Travel" 23000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 22"
                        cooldown "Travel" 22000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 21"
                        cooldown "Travel" 21000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 20"
                        cooldown "Travel" 20000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 19"
                        cooldown "Travel" 19000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 18"
                        cooldown "Travel" 18000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 17"
                        cooldown "Travel" 17000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 16"
                        cooldown "Travel" 16000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 15"
                        cooldown "Travel" 15000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a little bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 14"
                        cooldown "Travel" 14000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a little bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 13"
                        cooldown "Travel" 13000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a little bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 12"
                        cooldown "Travel" 12000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a little bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 11"
                        cooldown "Travel" 11000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a little bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 10"
                        cooldown "Travel" 10000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a few more seconds to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 9"
                        cooldown "Travel" 9000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a few more seconds to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 8"
                        cooldown "Travel" 8000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a few more seconds to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 7"
                        cooldown "Travel" 7000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a few more seconds to recover!" 2086
                        clearsysmsg 
                        replay                     
                    elseif insysmsg "must wait 6"
                        cooldown "Travel" 6000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a few more seconds to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 5"
                        cooldown "Travel" 5000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a few more seconds to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 4"
                        cooldown "Travel" 4000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a few more seconds to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 3"
                        cooldown "Travel" 3000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a few more seconds to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 2"
                        cooldown "Travel" 2000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a couple more seconds to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 1"
                        cooldown "Travel" 1000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a second to recover!" 2086
                        clearsysmsg 
                        replay 
            
                elseif insysmsg "You loosen some rocks"
                    overhead '* fail! *' 337
                    clearsysmsg 
                    replay
                    
                elseif insysmsg 'You do not see any' or insysmsg 'You cannot produce any'
                    @setvar! Working 0
                    if MOVE = 1
                        if not cooldown "Move Timer"
                            @setvar! MOVE 0
                            overhead "[ KEEP MOVING... ]" 2128
                            cooldown "Move Timer" 3500
                        endif

                        if EnableSatchels = 1
                            if findtype "Ginseng|Garlic|Blood Moss|Sulfurous Ash|Mandrake Root%s%|Nightshade|Black Pearl%s%|Spider's Silk" backpack and findtype "reagent satchel" self as MyWizardBag
                                if not cooldown "Satchel Timer"
                                    menu MyWizardBag 0
                                    cooldown "Satchel Timer" 30000
                                endif
                            endif
    
                            if findtype "Yellow Potion|Orange Potion|Red Potion|White Potion|Blue Potion|Black Potion|" backpack and findtype 31262 self as MyPotBag
                                if not cooldown "Satchel Timer" 
                                    menu MyPotBag 0
                                    cooldown "Satchel Timer" 30000
                                endif
                            endif 
                        endif
                
                        if insysmsg "Being perfectly rested" 
                            overhead "Outta my way!  I've got a pickaxe and know how to use it..." 2086
                            if EnableSummons = 1
                                wait 1000
                                overhead "Shall we incinerate them, master?" 44 myMainTankPet
                                menu myMainTankPet 3
                            endif
                        endif
                
                        if insysmsg "Now tracking" or insysmsg "Distance to destination" and EnableRedAlertRecall = 1
                            @setvar! TimeToGo 1
                            replay
                        endif

                        if paralyzed and EnableParalyzePouch = 1
                            overhead "[[[[ POP!! ]]]]" 2117
                            say "[pouch" 
                            @setvar! TimeToGo 1
                            replay
                        endif
                
                        if insysmsg "As the owner" or insysmsg "Your house and its contents"
                            wait 1500
                            if find MyDoor ground -1 -1 2
                                overhead "* door slams! *" 0 MyDoor
                                dclick MyDoor 
                                wait 500
                            endif
                        endif
                        
                        if findtype 'iron ore|iron ingots' backpack 
                            hotkey 'Organizer Agent-03'
                        endif
                            hotkey 'Organizer Agent-04'
                            replay
                    endif
                    
                    if MOVE = 0
                        if not cooldown "Move Timer"
                            overhead "[ KEEP MOVING... ]" 69
                            cooldown "Move Timer" 3500
                            @setvar! MOVE 1
                        endif

                        if EnableSatchels = 1
                            if findtype "Ginseng|Garlic|Blood Moss|Sulfurous Ash|Mandrake Root%s%|Nightshade|Black Pearl%s%|Spider's Silk" backpack and findtype "reagent satchel" self as MyWizardBag
                                if not cooldown "Satchel Timer"
                                    menu MyWizardBag 0
                                    cooldown "Satchel Timer" 30000
                                endif
                            endif
    
                            if findtype "Yellow Potion|Orange Potion|Red Potion|White Potion|Blue Potion|Black Potion|" backpack and findtype 31262 self as MyPotBag
                                if not cooldown "Satchel Timer" 
                                    menu MyPotBag 0
                                    cooldown "Satchel Timer" 30000
                                endif
                            endif 
                        endif
                    
                        if insysmsg "Being perfectly rested" 
                            overhead "Move it!  I've got work to do" 2086
                            if EnableSummons = 1
                                wait 1000
                                overhead "Do you require our services, master?" 44 myMainTankPet
                                menu myMainTankPet 3
                            endif 
                        endif
                
                        if insysmsg "Now tracking" or insysmsg "Distance to destination" and EnableRedAlertRecall = 1
                            @setvar! TimeToGo 1
                            replay
                        endif

                        if paralyzed and EnableParalyzePouch = 1
                            overhead "[[[[ POP!! ]]]]" 2117
                            say "[pouch" 
                            @setvar! TimeToGo 1
                            replay
                        endif                
 
                        if insysmsg "As the owner" or insysmsg "Your house and its contents"
                            wait 1500
                            if find MyDoor ground -1 -1 2
                                overhead "* door slams! *" 0 MyDoor
                                dclick MyDoor 
                                wait 500
                            endif
                        endif                        

                        if findtype 'iron ore|iron ingots' backpack 
                            hotkey 'Organizer Agent-03'
                        endif
                            hotkey 'Organizer Agent-04'
                            replay                      
                    endif
                    clearsysmsg 
                    @setvar! MOVE 1
                replay   
            endif 
   
    if insysmsg "Mining skillgain" 
        if skill 'Mining' > 100.0 and skill 'Mining' < 119.9
            sysmsg "Hmm... these stones are tricky to work with..." 84
         
        elseif skill 'Mining' = 119.9
            overhead "THIS COULD BE IT......" 2086
            sysmsg "Hmm... there is something special about these stones..." 84
            
        elseif skill 'Mining' = 120.0
            overhead "FINALLY!!!" 2086
            wait 2000
            overhead "We made it!" 2086
            wait 1500
            clearsysmsg 
            overhead "[ TIME FOR A WELL DESERVED BREAK! ]" 337
            stop    
        endif  
    endif      

            if insysmsg "Now tracking" or insysmsg "Distance to destination"
                @setvar! TimeToGo 1
                replay
        
            elseif insysmsg 'world is saving' 
                    for 40
                        wait 100
                        if insysmsg 'world save complete' 
                            wait 100
                            overhead '[ SAVE COMPLETE! ]' 253 
                            clearsysmsg 
                        endif 
                    endfor 
                clearsysmsg
              
            elseif insysmsg "You dig some iron ore" 
                @setvar! Working 1
                overhead '* you harvest iron ore *' 1900
                replay    
        
            elseif insysmsg "You dig some dull copper ore" 
                @setvar! Working 1
                overhead '* you harvest dull copper ore *' 2419
                replay     
  
            elseif insysmsg "You dig some shadow iron ore" 
                @setvar! Working 1
                overhead '* you harvest shadow iron ore *' 2406
                replay     

            elseif insysmsg "You dig some copper ore" 
                @setvar! Working 1
                overhead '* you harvest copper ore *' 2413
                replay  

            elseif insysmsg "You dig some bronze ore" 
                @setvar! Working 1
                overhead '* you harvest bronze ore *' 2418
                replay  

            elseif insysmsg "You dig some golden ore" 
                @setvar! Working 1
                overhead '* you harvest golden ore! *' 2213
                replay  

            elseif insysmsg "You dig some agapite ore" 
                @setvar! Working 1
                overhead '* you harvest agapite ore! *' 2425
                replay  

            elseif insysmsg "You dig some verite ore" 
                @setvar! Working 1
                overhead '* you harvest verite ore!! *' 2207
                replay  

            elseif insysmsg "You dig some valorite ore" 
                @setvar! Working 1
                overhead '* you harvest valorite ore!! *' 2219
                replay  

            elseif insysmsg "You dig some avarite ore" 
                @setvar! Working 1
                overhead '* you harvest avarite ore!!! *' 1763
                replay     
            endif    
    replay    
endif

////////////////////////////////
// LUMBER SCRIPT STARTS HERE: //
////////////////////////////////

if not dead and skill "Lumberjacking" > 49.9 and EnableLumberjacking = 1 and not cooldown "Travel"

if not varexist boardbag and EnableBoardBag = 1
    wait 500
    for 5
        if not varexist boardbag
        overhead "Please select your lumber storage bag..." 0
        wait 500
        setvar boardbag
        wait 2500
        sysmsg "Disable 'EnableBoardBag' in script variables to turn off this feature!" 0
        else 
            break
        endif
    endfor
endif

if not varexist lumber_runebook and EnableRedAlertRecall = 1
    wait 500
    for 5
        if not varexist lumber_runebook
        overhead "Please select your escape runebook..." 0
        wait 500
        setvar lumber_runebook
        wait 2500
        sysmsg "Disable 'EnableRedAlertRecall' in script variables to turn off this feature!" 0
        else 
            break
        endif
    endfor
endif    

if counttype "board%s" > BoardRecallAmount and EnableBoardAutoRecall = 1
    overhead "I'd hate to lose all this hard work..." 2086
    wait 2500
    overhead "I'm going to go unload before it's too late!" 2086
    sysmsg "Disable 'EnableBoardAutoRecall' in script variables to turn off this feature!" 0
    wait 2000
    @setvar! TimeToGo 1
    replay
endif         

if not findtype 'hatchet' self
    overhead "I can't work with no hatchet!" 2086
    wait 1500
    @setvar! TimeToGo 1
    replay
endif
 
if not findtype 'hatchet' hand and findtype 'hatchet' backpack
    dclicktype 'hatchet' backpack
    wait 250
endif

if EnableWeightWarningMessage = 1 and not cooldown "Weight Timer"
    if weight > GreenWarningWeight and weight < YellowWarningWeight
        overhead "[ WEIGHT WARNING! ]" 126
        cooldown  "Weight Timer" 3500
    endif

    if weight > YellowWarningWeight and weight < RedWeightLimit
        overhead "[ TIME TO UNLOAD! ]" 149
        cooldown  "Weight Timer" 3500
    endif 

    if weight > RedWeightLimit
        overhead "[ WEIGHT LIMIT REACHED!!! ]" 337
        wait 2000
        overhead "Please reduce weight in order to continue..." 0
        cooldown  "Weight Timer" 3000
        replay
    endif
endif

hotkey 'Use item in hand' 
waitfortarget 1500
hotkey 'Target Self'   
wait 503

        if insysmsg "Now tracking" or insysmsg "Distance to destination" and EnableRedAlertRecall = 1
            @setvar! TimeToGo 1
            replay 
        
                elseif insysmsg 'world is saving' 
                        for 40
                            wait 100
                            if insysmsg 'world save complete' 
                                wait 100
                                overhead '[ SAVE COMPLETE! ]' 253 
                                clearsysmsg 
                            endif 
                        endfor 
                    clearsysmsg                    
        
                elseif insysmsg 'Harvesting is not allowed' 
                    overhead 'You need to leave town...' 0 
                    wait 5000 
                    replay 
            
                elseif insysmsg 'You broke your axe' 
                    overhead "My axe broke!" 2086
                    wait 1500
                    replay 
                    
                elseif insysmsg "must wait 59"
                        cooldown "Travel" 59000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 58"
                        cooldown "Travel" 58000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 57"
                        cooldown "Travel" 57000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 56"
                        cooldown "Travel" 56000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 55"
                        cooldown "Travel" 55000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 54"
                        cooldown "Travel" 54000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 53"
                        cooldown "Travel" 53000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 52"
                        cooldown "Travel" 52000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 51"
                        cooldown "Travel" 51000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 50"
                        cooldown "Travel" 50000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 49"
                        cooldown "Travel" 49000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 48"
                        cooldown "Travel" 48000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 47"
                        cooldown "Travel" 47000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 46"
                       cooldown "Travel" 46000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 45"
                        cooldown "Travel" 45000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 44"
                        cooldown "Travel" 44000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 43"
                        cooldown "Travel" 43000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 42"
                        cooldown "Travel" 42000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 41"
                        cooldown "Travel" 41000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 40"
                        cooldown "Travel" 40000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 39"
                        cooldown "Travel" 39000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 38"
                        cooldown "Travel" 38000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 37"
                        cooldown "Travel" 37000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 36"
                        cooldown "Travel" 36000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay                     
                    elseif insysmsg "must wait 35"
                        cooldown "Travel" 35000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 34"
                        cooldown "Travel" 34000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 33"
                        cooldown "Travel" 33000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 32"
                        cooldown "Travel" 32000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 31"
                        cooldown "Travel" 31000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 30"
                        cooldown "Travel" 30000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 29"
                        cooldown "Travel" 29000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 28"
                        cooldown "Travel" 28000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 27"
                        cooldown "Travel" 27000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 26"
                        cooldown "Travel" 26000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 25"
                        cooldown "Travel" 25000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 24"
                        cooldown "Travel" 24000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 23"
                        cooldown "Travel" 23000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 22"
                        cooldown "Travel" 22000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 21"
                        cooldown "Travel" 21000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 20"
                        cooldown "Travel" 20000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 19"
                        cooldown "Travel" 19000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 18"
                        cooldown "Travel" 18000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 17"
                        cooldown "Travel" 17000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a minute to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 16"
                        cooldown "Travel" 16000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 15"
                        cooldown "Travel" 15000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a little bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 14"
                        cooldown "Travel" 14000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a little bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 13"
                        cooldown "Travel" 13000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a little bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 12"
                        cooldown "Travel" 12000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a little bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 11"
                        cooldown "Travel" 11000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a little bit longer to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 10"
                        cooldown "Travel" 10000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a few more seconds to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 9"
                        cooldown "Travel" 9000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a few more seconds to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 8"
                        cooldown "Travel" 8000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a few more seconds to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 7"
                        cooldown "Travel" 7000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a few more seconds to recover!" 2086
                        clearsysmsg 
                        replay                     
                    elseif insysmsg "must wait 6"
                        cooldown "Travel" 6000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a few more seconds to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 5"
                        cooldown "Travel" 5000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a few more seconds to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 4"
                        cooldown "Travel" 4000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a few more seconds to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 3"
                        cooldown "Travel" 3000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a few more seconds to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 2"
                        cooldown "Travel" 2000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a couple more seconds to recover!" 2086
                        clearsysmsg 
                        replay 
                    elseif insysmsg "must wait 1"
                        cooldown "Travel" 1000
                        overhead "I'm tired from travelling..." 2086
                        wait 1500 
                        overhead "Just give me a second to recover!" 2086
                        clearsysmsg 
                        replay

                    elseif insysmsg "You must wait"
                        overhead "Hang on one sec..." 2086
                        wait 1000
                        clearsysmsg 
                        replay

                    elseif insysmsg 'You do not see any' or insysmsg 'You cannot produce any'                    
                        if MOVE = 1
                            if not cooldown "Move Timer"
                                overhead "[ KEEP MOVING... ]" 2128
                                cooldown "Move Timer" 3500
                                @setvar! MOVE 0
                            endif
                
                            if insysmsg "Now tracking" or insysmsg "Distance to destination" and EnableRedAlertRecall = 1
                                @setvar! TimeToGo 1
                                replay
                            endif

                            if paralyzed and EnableParalyzePouch = 1
                                overhead "[[[[ POP!! ]]]]" 2117
                                say "[pouch" 
                                @setvar! TimeToGo 1
                                replay
                            endif

                            if EnableSatchels = 1
                                if findtype "Ginseng|Garlic|Blood Moss|Sulfurous Ash|Mandrake Root%s%|Nightshade|Black Pearl%s%|Spider's Silk" backpack and findtype "reagent satchel" self as MyWizardBag
                                    if not cooldown "Satchel Timer"
                                        menu MyWizardBag 0
                                        cooldown "Satchel Timer" 30000
                                    endif
                                endif
    
                                if findtype "Yellow Potion|Orange Potion|Red Potion|White Potion|Blue Potion|Black Potion|" backpack and findtype 31262 self as MyPotBag
                                    if not cooldown "Satchel Timer" 
                                        menu MyPotBag 0
                                        cooldown "Satchel Timer" 30000
                                    endif
                                endif 
                            endif
                
                            if insysmsg "As the owner" or insysmsg "Your house and its contents"
                                wait 1500
                                if find MyDoor ground -1 -1 2
                                    overhead "* door slams! *" 0 MyDoor
                                    dclick MyDoor 
                                    wait 500
                                endif
                            endif
                        
                            for 10
                            if findtype 'log%s' backpack and LogsToBoards = 1
                                overhead '* making boards... *' 0
                                dclicktype 'log%s' 
                                wait 500
                            endif
                            endfor
                        
                            hotkey 'Organizer Agent-01'
                            wait 250
                            hotkey 'Organizer Agent-02'
                            replay
                        endif 
                    
                        if MOVE = 0
                            if not cooldown "Move Timer"
                                overhead "[ KEEP MOVING... ]" 69
                                cooldown "Move Timer" 3500
                                @setvar! MOVE 1
                            endif
                
                            if insysmsg "Now tracking" or insysmsg "Distance to destination" and EnableRedAlertRecall = 1
                                @setvar! TimeToGo 1
                                replay
                            endif

                            if paralyzed and EnableParalyzePouch = 1
                                overhead "[[[[ POP!! ]]]]" 2117
                                say "[pouch" 
                                @setvar! TimeToGo 1
                                replay
                            endif

                            if EnableSatchels = 1
                                if findtype "Ginseng|Garlic|Blood Moss|Sulfurous Ash|Mandrake Root%s%|Nightshade|Black Pearl%s%|Spider's Silk" backpack and findtype "reagent satchel" self as MyWizardBag
                                    if not cooldown "Satchel Timer"
                                        menu MyWizardBag 0
                                        cooldown "Satchel Timer" 30000
                                    endif
                                endif
    
                                if findtype "Yellow Potion|Orange Potion|Red Potion|White Potion|Blue Potion|Black Potion|" backpack and findtype 31262 self as MyPotBag
                                    if not cooldown "Satchel Timer" 
                                        menu MyPotBag 0
                                        cooldown "Satchel Timer" 30000
                                    endif
                                endif 
                            endif
                
                            if insysmsg "As the owner" or insysmsg "Your house and its contents"
                                wait 1500
                                if find MyDoor ground -1 -1 2
                                    overhead "* door slams! *" 0 MyDoor
                                    dclick MyDoor 
                                    wait 500
                                endif
                            endif
                        
                            for 10
                            if findtype 'log%s' backpack and LogsToBoards = 1
                                overhead '* making boards... *' 0
                                dclicktype 'log%s' 
                                wait 500
                            endif
                            endfor
                        
                            hotkey 'Organizer Agent-01'
                            wait 250
                            hotkey 'Organizer Agent-02'
                            replay
                        endif 

                        clearsysmsg
                        @setvar! MOVE 1
                        replay    
                   endif 

    overhead '* chopping wood... *' 2128
    
    if insysmsg "Lumberjacking skillgain" 
        if skill 'Lumberjacking' > 100.0 and skill 'Lumberjacking' < 119.9
            sysmsg "Hmm... this tree will really test my skills..." 84
         
        elseif skill 'Lumberjacking' = 119.9
            overhead "THIS COULD BE IT......" 2086
            sysmsg "Hmm... there is something special about this tree..." 84
            
        elseif skill 'Lumberjacking' = 120.0
            overhead "FINALLY!!!" 2086
            wait 2000
            overhead "We made it!" 2086
            wait 1500
            clearsysmsg 
            overhead "[ TIME FOR A WELL DESERVED BREAK! ]" 337
            stop
        endif
    endif

    wait 3800

            if insysmsg "Now tracking" or insysmsg "Distance to destination" and EnableRedAlertRecall = 1
                @setvar! TimeToGo 1
                replay
                 
            elseif insysmsg 'world is saving' 
                for 40
                    wait 100
                    if insysmsg 'world save complete' 
                        wait 100
                        overhead '[ SAVE COMPLETE! ]' 253 
                        clearsysmsg 
                    endif  
                endfor 
                clearsysmsg               

            elseif insysmsg "You hack"
                overhead '* fail... *' 337
                replay          
           
            elseif insysmsg "You chop some logs" 
                overhead '* you harvest logs *' 349
                replay
            
            elseif insysmsg "You chop some dullwood logs" 
                overhead '* you harvest dullwood *' 2419
                replay
             
            elseif insysmsg "You chop some shadowwood logs" 
                overhead '* you harvest shadowwood *' 2406
                replay
            
            elseif insysmsg "You chop some copperwood logs" 
                overhead '* you harvest copperwood *' 2413
                replay
            
            elseif insysmsg "You chop some bronzewood logs" 
                overhead '* you harvest bronzewood *' 2418
                replay
            
            elseif insysmsg "You chop some goldenwood logs" 
                overhead '* you harvest goldenwood! *' 2213
                replay
            
            elseif insysmsg "You chop some rosewood logs" 
                overhead '* you harvest rosewood! *' 2425
                replay
            
            elseif insysmsg "You chop some verewood logs" 
                overhead '* you harvest verewood!! *' 2207
                replay
            
            elseif insysmsg "You chop some valewood logs" 
                overhead '* you harvest valewood!! *' 2219
                replay
            
            elseif insysmsg "You chop some avarwood logs" 
                overhead '* you harvest avarwood!!! *' 1763
                replay
            endif      
    replay
endif
    
if dead 
    wait 3000
    overhead "Well... shit..." 2086
    wait 1000
    overhead '[ STOPPING SCRIPT... ]' 337
    stop
endif

if not cooldown "Travel"  
    wait 500
    overhead "Train skill to 50.0 at NPC and then restart script!" 0
    wait 2500
    overhead '[ STOPPING SCRIPT... ]' 337
    stop    
else 
    if not cooldown "Move Timer" 
        overhead "* resting... *" 98
        cooldown "Move Timer" 5000
    endif
    
    if EnableSatchels = 1
        if findtype "Ginseng|Garlic|Blood Moss|Sulfurous Ash|Mandrake Root%s%|Nightshade|Black Pearl%s%|Spider's Silk" backpack and findtype "reagent satchel" self as MyWizardBag
            if not cooldown "Satchel Timer"
                menu MyWizardBag 0
                cooldown "Satchel Timer" 30000
            endif
        endif
    
        if findtype "Yellow Potion|Orange Potion|Red Potion|White Potion|Blue Potion|Black Potion|" backpack and findtype 31262 self as MyPotBag
            if not cooldown "Satchel Timer" 
                menu MyWizardBag 0
                cooldown "Satchel Timer" 30000
            endif
        endif 
    endif
                    
    if insysmsg "Being perfectly rested" 
        overhead "Leave me alone, I'm trying to rest here..." 2086
        clearsysmsg 
    endif
                
    if insysmsg "Now tracking" or insysmsg "Distance to destination" and EnableRedAlertRecall = 1
        @setvar! TimeToGo 1
        replay
    endif

    if paralyzed and EnableParalyzePouch = 1
        overhead "[[[[ POP!! ]]]]" 2117
        say "[pouch" 
        @setvar! TimeToGo 1
        replay
    endif                
 
    if insysmsg "As the owner" or insysmsg "Your house and its contents"
        wait 1500
        if find MyDoor ground -1 -1 2
            overhead "* door slams! *" 0 MyDoor
            dclick MyDoor 
            wait 500
        endif
    endif                        
    
    if findtype 'iron ore|iron ingots' backpack 
       hotkey 'Organizer Agent-03'
    endif
    
    for 10
    if findtype 'log%s' backpack and LogsToBoards = 1
        overhead '* making boards... *' 0
        dclicktype 'log%s' 
        wait 500
    endif
    endfor                        
        hotkey 'Organizer Agent-01'
        wait 250
        hotkey 'Organizer Agent-02'
        wait 250
        hotkey 'Organizer Agent-03'
        wait 250
        hotkey 'Organizer Agent-04'
    replay
endif 
replay

// THE END! //